---
author: "Th√©o Lassale"
editor_options: 
  chunk_output_type: console
date: '`r Sys.Date()`'
output:
  html_document:
  theme: flatly
toc: true
toc_float: true
code_folding: hide
---
  
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r loaddata}
rm(list = ls())
# renv::load("~/MODICED_link/")
```

```{r load_libraries}
library(tidyverse)
library(rtracklayer)
library(edgeR)
library(ggvenn)
library(ComplexHeatmap)
library(DOSE)
library(enrichplot)
library(org.Mm.eg.db)
library(forcats)
library(reactome.db)
library(ReactomePA)
library(KEGGREST)
library(msigdb)
library(biomaRt)
library(immunedeconv)
library(gridExtra)
library(decoupleR)
```



```{r annotation}
gtf <- import("/data/annotations/pipelines/Mouse/mm10/gtf/gencode.vM22.annotation.gtf")
gtf_annot <- gtf %>% as_tibble() %>% filter(type == "gene") %>%  mutate(gene_id = str_remove(gene_id, "\\..*"))


in.dir <- "/data/kdi_prod/project_result/1929/01.00"
annot_gene <- read_delim(file.path(in.dir,"results/counts/tableannot.csv"), delim = ",") %>%
  dplyr::select(gene_id, gene_name) %>%
  full_join(gtf_annot[, c("gene_id","gene_type")], by="gene_id")

annot_gene_mod_2 <- read.csv("/data/users/tlassale/MODICED_link/ICD_core_RNA/results/counts/tableannot.csv") %>% dplyr::select(gene_id, gene_name) %>% full_join(gtf_annot[, c("gene_id","gene_type")], by="gene_id")

```

```{r samplePlan_in_vivo}
sample_plan <- read.csv("/data/kdi_prod/project_result/1929/01.00/samples/sample_plan.csv", header=FALSE)
colnames(sample_plan) <- c("sample ID", "sample Name", "Path_to_R1", "Path_to_R2")
rownames(sample_plan) <- NULL
sample_plan[grepl("Ct", sample_plan$`sample ID`) | grepl("CT", sample_plan$`sample ID`), "treatment"] <- "PBS"
sample_plan[1:3, "treatment"] <- "MTX"
sample_plan[4:6, "treatment"] <- "PBS"
sample_plan[!grepl("PBS", sample_plan$`sample ID`) & grepl("MTX", sample_plan$`sample ID`), "treatment"] <- "MTX"
sample_plan[grepl("Cis", sample_plan$`sample ID`),"treatment"] <- "Cis"
sample_plan[grepl("Oxa", sample_plan$`sample ID`),"treatment"] <- "Oxa"
sample_plan[grepl("D3", sample_plan$`sample ID`), "Time_point"] <- 3
sample_plan[grepl("D10", sample_plan$`sample ID`), "Time_point"] <- 10
sample_plan[grepl("D22", sample_plan$`sample ID`) | grepl("D24", sample_plan$`sample ID`) , "Time_point"] <- 22

sample_annot <- read.csv("/data/kdi_prod/project_result/1929/01.00/samples/sample_annot.csv", check.names = FALSE)
sample_annot$`Sample ID` <- make.names(sample_annot$`Sample ID`)
sample_annot <- sample_annot %>% dplyr::rename("sample ID" = "Sample ID")
sample_plan$`sample ID`<- make.names(sample_plan$`sample ID`)
all_sample <- full_join(sample_plan, sample_annot, by = "sample ID")
all_sample$ID <- stringr::str_remove(stringr::str_remove_all(all_sample$`sample ID`, "_D3|_D10|_D22|.D22"), "MTX_PBS_|OCP_")

sample_plan <- tidyr::unite(all_sample, col = "new_name", Treatment, Day, Sheet, ID, remove = FALSE, sep = "_")
rownames(sample_plan) <- sample_plan$new_name
```


```{r counts_table_in_vivo}
counts_in_vivo <- read_delim(file.path(in.dir,"results/counts/tablecounts_raw.csv"), delim = ",") %>%
  dplyr::rename("gene_id" = "...1") %>% 
  inner_join(., annot_gene, by = "gene_id") %>% 
  relocate(gene_name, .after = gene_id) %>%
  relocate(gene_type, .after = gene_name)

colnames(counts_in_vivo) <- make.names(colnames(counts_in_vivo))
counts_in_vivo <- counts_in_vivo[,c("gene_id","gene_name", "gene_type", sample_plan$`sample ID`)]
colnames(counts_in_vivo)[4:ncol(counts_in_vivo)] <- sample_plan$new_name
```


```{r get_counts_MP_and_OCP_in_vivo}
# 1st dataset (counts_table + sample_plan) - MTX vs PBS
counts_in_vivo_MP <- counts_in_vivo %>% 
  dplyr::select(gene_id, gene_name, gene_type, contains("MTX") & !contains("C3h_D24")) %>% 
  as.data.frame() %>% 
  column_to_rownames("gene_id")

sample_plan_MP <- sample_plan %>% filter(new_name %in% colnames(counts_in_vivo_MP))
sample_plan_MP[,"Treatment"] <- paste(sample_plan_MP$treatment, sample_plan_MP$Day, sep ="_")


# 2nd dataset (counts_table + sample_plan) - Oxa/Cis vs PBS                          
counts_in_vivo_OCP <- counts_in_vivo %>% 
  dplyr::select(gene_id, gene_name, gene_type, contains("OCP") & !contains("C3h_D24")) %>% 
  as.data.frame() %>% 
  column_to_rownames("gene_id")

sample_plan_OCP <- sample_plan %>% filter(new_name %in% colnames(counts_in_vivo_OCP))
sample_plan_OCP[,"Treatment"] <- paste(sample_plan_OCP$treatment, sample_plan_OCP$Day, sep ="_")
```


```{r get_final_counts_in_vivo}
y_raw_MP <- DGEList(counts = dplyr::select(counts_in_vivo_MP, -c("gene_name","gene_type")) , samples = sample_plan_MP, genes = counts_in_vivo_MP$gene_name)
design_MP <- model.matrix(~ 0 + Treatment, data=y_raw_MP$samples)
colnames(design_MP) <- sub("Treatment","", colnames(design_MP))
keep <- filterByExpr(y_raw_MP,design_MP)
y_MP <- y_raw_MP[keep,]
y_MP <- calcNormFactors(y_MP, method="TMM")
v_MP <- voomWithQualityWeights(y_MP, design_MP)
fit_MP <- lmFit(v_MP, design_MP)


y_raw_OCP <- DGEList(counts = dplyr::select(counts_in_vivo_OCP, -c("gene_name","gene_type")) , samples = sample_plan_OCP, genes = counts_in_vivo_OCP$gene_name)
design_OCP <- model.matrix(~ 0 + Treatment, data=y_raw_OCP$samples)
colnames(design_OCP) <- sub("Treatment","", colnames(design_OCP))
keep <- filterByExpr(y_raw_OCP,design_OCP)
y_OCP <- y_raw_OCP[keep,]
y_OCP <- calcNormFactors(y_OCP, method="TMM")
v_OCP <- voomWithQualityWeights(y_OCP, design_OCP)
fit_OCP <- lmFit(v_OCP, design_OCP)
```



```{r}
y_MP_log <- cbind(y_MP$counts, y_MP$genes)
y_MP_log <- y_MP_log %>% dplyr::relocate(genes, .before = "MTX_D3_MTX_PBS_D3_11")
rownames(y_MP_log) <- make.names(y_MP_log$genes, unique=TRUE)
y_MP_log <- y_MP_log %>% dplyr::select(-genes)
y_MP_log <- y_MP_log %>% cpm(log=TRUE) %>% as.data.frame()

y_OCP_log <- cbind(y_OCP$counts, y_OCP$genes)
y_OCP_log <- y_OCP_log %>% dplyr::relocate(genes, .before = "Cis_D3_OCP_D3_Cis1")
rownames(y_OCP_log) <- make.names(y_OCP_log$genes, unique=TRUE)
y_OCP_log <- y_OCP_log %>% dplyr::select(-genes)
y_OCP_log <- y_OCP_log %>% cpm(log=TRUE) %>% as.data.frame()
```



```{r get_contrasts_in_vivo}
contrast_MP <- makeContrasts(MP_D3 = MTX_D3 - PBS_D3, MP_D10 = MTX_D10 - PBS_D10, MP_D22 = MTX_D22 - PBS_D22, levels = design_MP)
fit_contrast_MP <- contrasts.fit(fit_MP, contrast_MP)
fit_contrast_MP <- eBayes(fit_contrast_MP)

contrast_OP <- makeContrasts(OP_D3 = Oxa_D3 - PBS_D3, OP_D10 = Oxa_D10 - PBS_D10, OP_D22 = Oxa_D22 - PBS_D22, levels = design_OCP)
fit_contrast_OP <- contrasts.fit(fit_OCP, contrast_OP)
fit_contrast_OP <- eBayes(fit_contrast_OP)


contrast_CP <- makeContrasts(CP_D3 = Cis_D3 - PBS_D3, CP_D10 = Cis_D10 - PBS_D10, CP_D22 = Cis_D22 - PBS_D22, levels = design_OCP)
fit_contrast_CP <- contrasts.fit(fit_OCP, contrast_CP)
fit_contrast_CP <- eBayes(fit_contrast_CP)
```




```{r get_top_tables_MTX_in_vivo}
# Get top tables for MTX
get_top_tables_MTX <- function(fit_contrast, coef_interest_1,  coef_interest_2, coef_interest_3, contrast_interest_1, contrast_interest_2, contrast_interest_3){
  
  genes_MTX_D3 <- topTable(fit_contrast, sort.by= "P", adjust.method = "BH", number = Inf, coef = coef_interest_1) %>% dplyr::rename("gene_name" = "genes") %>% mutate(contrast = contrast_interest_1)
  rownames(genes_MTX_D3) <- NULL
  genes_MTX_D10 <- topTable(fit_contrast, sort.by= "P", adjust.method = "BH", number = Inf, coef = coef_interest_2) %>% dplyr::rename("gene_name" = "genes") %>% mutate(contrast = contrast_interest_2)
  rownames(genes_MTX_D10) <- NULL
  genes_MTX_D22 <- topTable(fit_contrast, sort.by= "P", adjust.method = "BH", number = Inf, coef = coef_interest_3) %>% dplyr::rename("gene_name" = "genes") %>% mutate(contrast = contrast_interest_3)
  rownames(genes_MTX_D22) <- NULL
  
  # Concatenate top tables over timepoints
  genes_MTX <- bind_rows(genes_MTX_D3, genes_MTX_D10, genes_MTX_D22)
  
}
```


```{r get_top_tables_OXA_in_vivo}
# Get top tables for OXA
get_top_tables_OXA <- function(fit_contrast, coef_interest_1, coef_interest_2, coef_interest_3, contrast_interest_1, contrast_interest_2, contrast_interest_3){
  
  genes_OXA_D3 <- topTable(fit_contrast, sort.by= "P", adjust.method = "BH", number = Inf, coef = coef_interest_1) %>% dplyr::rename("gene_name" = "genes") %>% mutate(contrast = contrast_interest_1)
  rownames(genes_OXA_D3) <- NULL
  genes_OXA_D10 <- topTable(fit_contrast, sort.by= "P", adjust.method = "BH", number = Inf, coef = coef_interest_2) %>% dplyr::rename("gene_name" = "genes") %>% mutate(contrast = contrast_interest_2)
  rownames(genes_OXA_D10) <- NULL
  genes_OXA_D22 <- topTable(fit_contrast, sort.by= "P", adjust.method = "BH", number = Inf, coef = coef_interest_3) %>% dplyr::rename("gene_name" = "genes") %>% mutate(contrast = contrast_interest_3)
  rownames(genes_OXA_D22) <- NULL
  
  # Concatenate top tables over timepoints
  genes_OXA <- bind_rows(genes_OXA_D3, genes_OXA_D10, genes_OXA_D22)
  
}
```


```{r get_top_tables_CIS_in_vivo}
# Get top tables for CIS
get_top_tables_CIS <- function(fit_contrast, coef_interest_1, coef_interest_2, coef_interest_3, contrast_interest_1, contrast_interest_2, contrast_interest_3){
  
  genes_CIS_D3 <- topTable(fit_contrast, sort.by= "P", adjust.method = "BH", number = Inf, coef = coef_interest_1) %>% dplyr::rename("gene_name" = "genes") %>% mutate(contrast = contrast_interest_1)
  rownames(genes_CIS_D3) <- NULL
  genes_CIS_D10 <- topTable(fit_contrast, sort.by= "P", adjust.method = "BH", number = Inf, coef = coef_interest_2) %>% dplyr::rename("gene_name" = "genes") %>% mutate(contrast = contrast_interest_2)
  rownames(genes_CIS_D10) <- NULL
  genes_CIS_D22 <- topTable(fit_contrast, sort.by= "P", adjust.method = "BH", number = Inf, coef = coef_interest_3) %>% dplyr::rename("gene_name" = "genes") %>% mutate(contrast = contrast_interest_3)
  rownames(genes_CIS_D22) <- NULL
  
  # Concatenate top tables over timepoints
  genes_CIS <- bind_rows(genes_CIS_D3, genes_CIS_D10, genes_CIS_D22)
  
}
```


```{r concat_in_vivo}
# Concatenate all the top tables together
genes_total_in_vivo <- bind_rows(get_top_tables_MTX(fit_contrast_MP, "MP_D3", "MP_D10", "MP_D22", "MTX_D3", "MTX_D10", "MTX_D22"), get_top_tables_OXA(fit_contrast_OP, "OP_D3", "OP_D10", "OP_D22", "OXA_D3", "OXA_D10", "OXA_D22"), get_top_tables_CIS(fit_contrast_CP, "CP_D3", "CP_D10", "CP_D22", "CIS_D3", "CIS_D10", "CIS_D22"))
write.csv(genes_total_in_vivo, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/genes_topTable_in_vivo.csv", col.names = TRUE, row.names = FALSE, quote = FALSE)

```

```{r samplePlan_in_vitro}
sample_plan_mod_2 <- read.csv("/data/users/tlassale/MODICED_link/ICD_core_RNA/samplePlan.csv", header=FALSE)
colnames(sample_plan_mod_2) <- c("Sample_ID", "Sample_Name", "Path_to_R1")
sample_plan_mod_2[grepl("MTX", sample_plan_mod_2$Sample_Name), "Treatment"] <- "MTX"
sample_plan_mod_2[grepl("OXA", sample_plan_mod_2$Sample_Name), "Treatment"] <- "OXA"
sample_plan_mod_2[grepl("CIS", sample_plan_mod_2$Sample_Name), "Treatment"] <- "CIS"
sample_plan_mod_2[grepl("Control", sample_plan_mod_2$Sample_Name), "Treatment"] <- "Control"

sample_plan_mod_2[grepl("3h", sample_plan_mod_2$Sample_Name), "Time_Point"] <- "3h"
sample_plan_mod_2[grepl("6h", sample_plan_mod_2$Sample_Name), "Time_Point"] <- "6h"
sample_plan_mod_2[grepl("12h", sample_plan_mod_2$Sample_Name), "Time_Point"] <- "12h"
sample_plan_mod_2[grepl("18h", sample_plan_mod_2$Sample_Name), "Time_Point"] <- "18h"
sample_plan_mod_2[grepl("24h", sample_plan_mod_2$Sample_Name), "Time_Point"] <- "24h"

sample_plan_mod_2 <- sample_plan_mod_2 %>% tidyr::unite(col = "Treatment_hour", Treatment, Time_Point, remove = FALSE, sep = "_") %>% relocate(Treatment_hour, .after = Time_Point)
rownames(sample_plan_mod_2) <- sample_plan_mod_2$Sample_Name

```

```{r counts_table_in_vitro}

counts_mod_2 <- read_delim("/data/users/tlassale/MODICED_link/ICD_core_RNA/results/counts/tablecounts_raw_2.csv", delim=",")

# Add gene name + gene type to table of counts
counts_mod_2 <- counts_mod_2 %>% 
                 dplyr::rename("gene_id" = "...1") %>% 
                 inner_join(., annot_gene_mod_2, by = "gene_id") %>%
                 dplyr::relocate(gene_name, .after = gene_id) %>% 
                 dplyr::relocate(gene_type, .after = gene_name)
                 

counts_mod_2 <- counts_mod_2[, c("gene_id", "gene_type", "gene_name", sample_plan_mod_2$Sample_ID)]
colnames(counts_mod_2)[4:ncol(counts_mod_2)] <- sample_plan_mod_2$Sample_Name
```


```{r get_final_counts_in_vitro}
dge <- DGEList(counts = dplyr::select(counts_mod_2, -c(1:3)), samples = sample_plan_mod_2, genes = counts_mod_2$gene_name)
design_dge <- model.matrix(~ 0 + Treatment_hour, data= dge$samples)
colnames(design_dge) <- sub("Treatment_hour", "", colnames(design_dge))
keep <- filterByExpr(dge, design_dge)
counts_in_vitro <- dge[keep,]
counts_in_vitro <- calcNormFactors(counts_in_vitro, method="TMM")
counts_in_vitro <- cbind(counts_in_vitro$counts, counts_in_vitro$genes)
counts_in_vitro <- counts_in_vitro %>% relocate(genes, .before= "1_MTX1_3h")
rownames(counts_in_vitro) <- make.names(counts_in_vitro$genes, unique=TRUE)
counts_in_vitro <- counts_in_vitro %>% dplyr::select(-genes)
counts_in_vitro <- cpm(counts_in_vitro, log=TRUE)
counts_in_vitro_final <- counts_in_vitro %>% as.data.frame()
```



# **Additional Analyses**


## ** In-vivo/In-vitro overlap DEGs (abs(logFC) > 1)** {.tabset .tabset-fade .tabset-pills}


### MTX(24h)+OXA(24h) vs MTX(D3)

```{r} 
# In-vitro DEGs (abs(log FC > 1)) in MTX(24h)+OXA(24h) (pydeseq2+LV)
in_vitro_degs_pydeseq_lv <- c("Cpne5","C1qtnf3", "Galn3h6", "1700018B08Rik", "Ccl5", "Galn3h6", "Clec2l", "Txndc2", "Meltf", "Myrf", "Akap14", "Tg", "Hsf5", "Esrrb", "Gabrr2", "4932415D10Rik", "Reep2", "Akap5", "Abca6")

# Get all diff genes (in vivo) in MTX(D3) and OXA(D3) tumors
diff_gene_list_MTX_vs_PBS_D3 <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/gene_list_MTX_vs_PBS_D3.csv")
diff_gene_list_Oxa_vs_PBS_D3 <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/gene_list_OXA_vs_PBS_D3.csv")

# Get shared (all) DEGs in MTX(D3) and OXA(D3) tumors
diff_genes_shared_D3_MTX_OXA <- intersect(diff_gene_list_MTX_vs_PBS_D3$genes, diff_gene_list_Oxa_vs_PBS_D3$genes)


# Get common DEGs between MTX(24h)+OXA(24h) (in vitro) and MTX(D3) (in vivo) ---> "Tg"
intersect(in_vitro_degs_pydeseq_lv, diff_gene_list_MTX_vs_PBS_D3$genes)

# Get common DEGs between MTX(24h)+OXA(24h) (in vitro) and OXA(D3) (in vivo) ---> no overlap
intersect(in_vitro_degs_pydeseq_lv, diff_gene_list_Oxa_vs_PBS_D3$genes)

# Get common DEGs between MTX(24h)+OXA(24h) (in vitro) and MTX(D3)+OXA(D3) (in vivo) ---> no overlap
intersect(in_vitro_degs_pydeseq_lv, diff_genes_shared_D3_MTX_OXA)
```


### MTX(24)+OXA(24h) vs MTX(D10)

```{r} 
# Get all diff genes (in vivo) in MTX(D10) and OXA(D10) tumors
diff_gene_list_MTX_vs_PBS_D10 <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/gene_list_MTX_vs_PBS_D10.csv")
diff_gene_list_Oxa_vs_PBS_D10 <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/gene_list_OXA_vs_PBS_D10.csv")

# Get shared (all) DEGs in MTX(D10) and OXA(D10) tumors
diff_genes_shared_D10_MTX_OXA <- intersect(diff_gene_list_MTX_vs_PBS_D10$genes, diff_gene_list_Oxa_vs_PBS_D10$genes)


# Get common DEGs between MTX(24h)+OXA(24h) (in vitro) and MTX(D10) (in vivo) ---> no overlap
intersect(in_vitro_degs_pydeseq_lv, diff_gene_list_MTX_vs_PBS_D10$genes)

# Get common DEGs between MTX(24h)+OXA(24h) (in vitro) and OXA(D10) (in vivo) ---> "Galn3h6", "Ccl5", "Galn3h6", "Abca6"
intersect(in_vitro_degs_pydeseq_lv, diff_gene_list_Oxa_vs_PBS_D10$genes)


# Get common DEGs between MTX(24h)+OXA(24h) (in vitro) and MTX(D10)+OXA(D10) (in vivo) ---> no overlap
intersect(in_vitro_degs_pydeseq_lv, diff_genes_shared_D10_MTX_OXA) 

```

## ** Longitudinal expression (in vivo) of overlapping genes (in vivo/in vitro)** {.tabset .tabset-fade .tabset-pills} 


```{r get_counts}
counts_in_vivo_df <- counts_in_vivo %>% as.data.frame() 
rownames(counts_in_vivo_df) <- make.names(counts_in_vivo_df$gene_name, unique=TRUE)
counts_in_vivo_time <- counts_in_vivo_df %>% dplyr::select(-c("gene_id", "gene_type", "gene_name"))
counts_in_vivo_to_keep <- counts_in_vivo_time[rowSums(counts_in_vivo_time) > 10,]
```


```{r get_mean_counts}
get_mean_counts_in_vivo <- function(treatment_D3, treatment_D10, treatment_D22){
  
  # Get cpm counts at treatment/timepoint of interest
  counts_in_vivo_normalized_in_vivo <- counts_in_vivo_to_keep %>% cpm() %>% as.data.frame() %>% dplyr::select(contains(treatment_D3) | contains(treatment_D10) | contains(treatment_D22))
  
  # Get counts+mean_counts at D3 for treatment of interest
  counts_in_vivo_normalized_in_vivo_D3 <- counts_in_vivo_normalized_in_vivo %>% dplyr::select(contains(treatment_D3))
  mean_counts_in_vivo_in_vivo_D3 <- rowMeans(counts_in_vivo_normalized_in_vivo_D3) %>% as.data.frame() %>% dplyr::rename("3" = ".")

  # Get counts+mean_counts at D10 for treatment of interest
  counts_in_vivo_normalized_in_vivo_D10 <- counts_in_vivo_normalized_in_vivo %>% dplyr::select(contains(treatment_D10))
  mean_counts_in_vivo_in_vivo_D10 <- rowMeans(counts_in_vivo_normalized_in_vivo_D10) %>% as.data.frame() %>% dplyr::rename("10" = ".")
  
  
  # Get counts+mean_counts at D22 for treatment of interest
  counts_in_vivo_normalized_in_vivo_D22 <- counts_in_vivo_normalized_in_vivo %>% dplyr::select(contains(treatment_D22))
  mean_counts_in_vivo_in_vivo_D22 <- rowMeans(counts_in_vivo_normalized_in_vivo_D22) %>% as.data.frame() %>% dplyr::rename("22" = ".")
  
  
  # Get mean counts for treatment of interest at all timepoints
  mean_counts_in_vivo_df <- bind_cols(mean_counts_in_vivo_in_vivo_D3, mean_counts_in_vivo_in_vivo_D10, mean_counts_in_vivo_in_vivo_D22)
  
}
```


```{r}
# MTX
mean_counts_in_vivo_MTX <- get_mean_counts_in_vivo("MTX_D3", "MTX_D10", "MTX_D22")
# OXA
mean_counts_in_vivo_OXA <- get_mean_counts_in_vivo("OXA_D3", "OXA_D10", "OXA_D22")
# CIS
mean_counts_in_vivo_CIS <- get_mean_counts_in_vivo("CIS_D3", "CIS_D10", "CIS_D22")
```


```{r}
get_mean_expression_in_vivo <- function(gene, filen, treatmen3h, treatment2, treatmen18h){

  # Get and plot mean expression of gene of interest over MTX
  expression_gene_in_vivo_MTX <- mean_counts_in_vivo_MTX[gene,]
  expression_gene_in_vivo_MTX_t <- expression_gene_in_vivo_MTX %>% t() %>% as_tibble() %>% rownames_to_column("Time") %>% as.data.frame() %>% dplyr::rename(mean_expression_gene_in_vivo_MTX = gene)
  expression_gene_in_vivo_MTX_t$Time <- c(3, 10, 22)
  expression_gene_in_vivo_MTX_t_plot <- ggplot(expression_gene_in_vivo_MTX_t, mapping=aes(x=Time, y=mean_expression_gene_in_vivo_MTX)) + geom_line() + labs(x  = "Time", y = paste0("mean_expression_", gene, "_","MTX"), title = paste0(gene, "_", "longitudinal_expression", "_", treatmen3h)) + theme(plot.title = element_text(face="bold", hjust = 0.5))
  
  
  # Get and plot mean expression of gene of interest over OXA
  expression_gene_in_vivo_Oxa <- mean_counts_in_vivo_OXA[gene,]
  expression_gene_in_vivo_Oxa_t <- expression_gene_in_vivo_Oxa %>% t() %>% as_tibble() %>% rownames_to_column("Time") %>% as.data.frame() %>% dplyr::rename(mean_expression_gene_in_vivo_OXA = gene)
  expression_gene_in_vivo_Oxa_t$Time <- c(3, 10, 22)
  expression_gene_in_vivo_Oxa_t_plot <- ggplot(expression_gene_in_vivo_Oxa_t, mapping=aes(x=Time, y=mean_expression_gene_in_vivo_OXA)) + geom_line() + labs(x  = "Time", y = paste0("mean_expression_", gene, "_","OXA"), title = paste0(gene, "_", "longitudinal_expression", "_", treatment2)) + theme(plot.title = element_text(face="bold", hjust = 0.5))

  
  # Get and plot mean expression of gene of interest over CIS
  expression_gene_in_vivo_Cis <- mean_counts_in_vivo_CIS[gene,]
  expression_gene_in_vivo_Cis_t <- expression_gene_in_vivo_Cis %>% t() %>% as_tibble() %>% rownames_to_column("Time") %>% as.data.frame() %>% dplyr::rename(mean_expression_gene_in_vivo_CIS = gene)
  expression_gene_in_vivo_Cis_t$Time <- c(3, 10, 22)
  expression_gene_in_vivo_Cis_t_plot <- ggplot(expression_gene_in_vivo_Cis_t, mapping=aes(x=Time, y=mean_expression_gene_in_vivo_CIS)) + geom_line() + labs(x  = "Time", y = paste0("mean_expression_", gene, "_","CIS"), title = paste0(gene, "_", "longitudinal_expression", "_", treatmen18h)) + theme(plot.title = element_text(face="bold", hjust = 0.5))
  
  # Save mean expression plots as a grid
  pdf(filen) 
  grid.arrange(expression_gene_in_vivo_MTX_t_plot, expression_gene_in_vivo_Oxa_t_plot, expression_gene_in_vivo_Cis_t_plot, ncol = 2, nrow = 2)
  dev.off()
  
  }
```

### Il6
```{r}
get_mean_expression_in_vivo("Il6", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Il6_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```

### Ccl5
```{r}
get_mean_expression_in_vivo("Ccl5", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Ccl5_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```

### Galn3h6
```{r}
get_mean_expression_in_vivo("Galn3h6", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Galn3h6_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```

### Abca6
```{r}
get_mean_expression_in_vivo("Abca6", "Mean_Expression_Abca6_MTX", "Mean_Expression_Galn3h6_OXA", "Mean_Expression_Galn3h6_CIS", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Abca6_expression_in_vivo.pdf")
```

### Tg
```{r}
get_mean_expression_in_vivo("Tg", "Mean_Expression_Tg_MTX", "Mean_Expression_Tg_OXA", "Mean_Expression_Tg_CIS", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Tg_expression_in_vivo.pdf")
```



# **Cytokines/tf/receptor/ligand based analyses (in vivo)**


```{r}

# Load CytReg_v2 (mouse) database
cytreg_v2 <- read.csv("/data/kdi_prod/.kdi/project_workspace_0/1929/acl/01.00/cytreg_v2.csv")
cytreg_v2_mouse <- cytreg_v2 %>% filter(species == "M") %>% filter(function. == "A" | function. == "R" | function. == "Activation")

# Load icellnet (mouse) database
icellnet_db <- read.csv("/data/kdi_prod/.kdi/project_workspace_0/1929/acl/01.00/icelldb_mapped.csv", header= TRUE)

# Convert human gene symbols to mouse gene symbols
cytokines_mouse <- stringr::str_to_title(cytreg_v2_mouse$cytokine)
tf_mouse <- stringr::str_to_title(cytreg_v2_mouse$tf)

# Get updated tf+cytokines mouse database
cytreg_v2_mouse_final <- cytreg_v2_mouse %>% bind_cols(cytokines_mouse, tf_mouse) %>% dplyr::rename("cyto" = "...9", "TF" = "...10") %>% dplyr::select(-c("cytokine", "tf")) %>% dplyr::relocate(cyto, .after = source) %>% dplyr::relocate(TF, .after = cyto)

```


```{r}
# Get diff genes and order thems
all_genes_info <- genes_total_in_vivo %>% dplyr::filter(abs(logFC) > 1.3, adj.P.Val < 0.05)

# Create timepoint and treatment columns
all_genes_info[grepl("D3", all_genes_info$contrast), "timepoint"] <- "D3"
all_genes_info[grepl("D10", all_genes_info$contrast), "timepoint"] <- "D10"
all_genes_info[grepl("D22", all_genes_info$contrast), "timepoint"] <- "D22"
all_genes_info[grepl("MTX", all_genes_info$contrast), "treatment"] <- "MTX"
all_genes_info[grepl("OXA", all_genes_info$contrast), "treatment"] <- "OXA"
all_genes_info[grepl("CIS", all_genes_info$contrast), "treatment"] <- "CIS"

```


```{r get_mapped_proteins}

get_mapped_proteins <- function(all_genes_info, gene_list, filen, filen2, title1, title2){
  
  # Get degs of interest
  degs_interest <- all_genes_info %>% 
    filter(gene_name %in% gene_list) %>%
    dplyr::arrange(desc(abs(logFC)), adj.P.Val)
  
  # Get top 10 diff degs of interest
  degs_interest_top_10 <- degs_interest %>% 
    dplyr::slice(1:10) %>%
    write.csv(filen) 
  
  # Get number of diff degs of interest per timepoint
  abundances_timepoint <- ggplot(degs_interest, mapping = aes(x = timepoint)) + geom_bar(stat="count", width=0.7, fill="steelblue") + theme_minimal() + labs(title= title1) +  theme(plot.title = element_text(face="bold", hjust = 0.5))
  
  
  # Get number of diff degs of interest per treatment
  abundances_treatment <- ggplot(degs_interest, mapping = aes(x = treatment)) + geom_bar(stat="count", width=0.7, fill="steelblue") + theme_minimal() + labs(title= title2) +  theme(plot.title = element_text(face = "bold", hjust = 0.5))
  
  # Save as a grid
  pdf(filen2)
  grid <- grid.arrange(abundances_timepoint, abundances_treatment)
  dev.off()
}
```


```{r get_mapped_cytokines}
get_mapped_proteins(all_genes_info, cytreg_v2_mouse_final$cyto, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/cyto_top_10.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/cyto_abundances.pdf", "Cytokines abundance per timepoint", "Cytokines abundance per treatment")
```

```{r get_mapped_tf}
get_mapped_proteins(all_genes_info, cytreg_v2_mouse_final$TF, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/tf_top_10.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/tf_abundances.pdf", "TF abundance per timepoint", "TF abundance per treatment")
```

```{r get_mapped_ligand1}
get_mapped_proteins(all_genes_info, icellnet_db$Ligand.1, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/ligand_1_top_10.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/ligand1_abundances.pdf", "Ligand1 abundance per timepoint", "Ligand2 abundance per treatment")
```

```{r get_mapped_ligand2}
get_mapped_proteins(all_genes_info, icellnet_db$Ligand.2, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/ligand_2_top_10.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/ligand2_abundances.pdf","Ligand2 abundance per timepoint", "Ligand2 abundance per treatment")
```


```{r get_mapped_Receptor1}
get_mapped_proteins(all_genes_info, icellnet_db$Receptor.1, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/receptor_1_top_10.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/receptor1_abundances.pdf", "Receptor1 abundance per timepoint", "Receptor1 abundance per treatment")
```

```{r get_mapped_Receptor2}
get_mapped_proteins(all_genes_info, icellnet_db$Receptor.2, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/receptor_2_top_10.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/receptor2_abundances.pdf","Receptor2 abundance per timepoint", "Receptor2 abundance per treatment")
```


```{r get_mapped_Receptor3}
get_mapped_proteins(all_genes_info, icellnet_db$Receptor.3, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/receptor_3_top_10.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/receptor3_abundances.pdf", "Receptor3 abundance per timepoint", "Receptor3 abundance per treatment")
```


## ** Top 5 diff cytokines (in vivo)**


### Cxcl5
```{r}
get_mean_expression_in_vivo("Cxcl5", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Cxcl5_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```


### Ccl24
```{r}
get_mean_expression_in_vivo("Ccl24", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Ccl24_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```

### Ifng
```{r}
get_mean_expression_in_vivo("Ifng", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Ifng_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```

### Cxcl3
```{r}
get_mean_expression_in_vivo("Cxcl3", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Cxcl3_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```

### Tnfsf11
```{r}
get_mean_expression_in_vivo("Tnfsf11", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Tnfsf11_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```



## ** Top 5 diff TF (in vivo)**



### Bcl11b

```{r}
get_mean_expression_in_vivo("Bcl11b", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Bcl11b_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```


### Tbx21

```{r}
get_mean_expression_in_vivo("Tbx21", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Tbx21_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```

### Eomes

```{r}
get_mean_expression_in_vivo("Eomes", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Eomes_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```

### Irf4

```{r}
get_mean_expression_in_vivo("Irf4", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Irf4_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```

### Nr1h3

```{r}
get_mean_expression_in_vivo("Nr1h3", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Nr1h3_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```


## ** Top 5 diff Receptor1 (in vivo)**



### Ackr1

```{r}
get_mean_expression_in_vivo("Ackr1", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Ackr1_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```


### Agtr2

```{r}
get_mean_expression_in_vivo("Agtr2", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Agtr2_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```


### Cxcr2

```{r}
get_mean_expression_in_vivo("Cxcr2", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Cxcr2_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```


### Il18r1

```{r}
get_mean_expression_in_vivo("Il18r1", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Il18r1_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```

### Xcr1


```{r}
get_mean_expression_in_vivo("Xcr1", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Xcr1_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```



## ** Top 5 diff Receptor2 (in vivo)**


### Il12rb2

```{r}
get_mean_expression_in_vivo("Il12rb2", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Il12rb2_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```


### Il2rb

```{r}
get_mean_expression_in_vivo("Il2rb", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Il2rb_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```

### Csf2rb2

```{r}
get_mean_expression_in_vivo("Csf2rb2", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Csf2rb2_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```


### Kdr

```{r}
get_mean_expression_in_vivo("Kdr", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Kdr_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```


## ** Top 5 diff Ligand1 (in vivo)**


### Fgf23

```{r}
get_mean_expression_in_vivo("Fgf23", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Fgf23_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```


### Dsc3

```{r}
get_mean_expression_in_vivo("Dsc3", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Dsc3_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```

### Gdf10

```{r}
get_mean_expression_in_vivo("Gdf10", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Gdf10_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```

### Cxcl5

```{r}
get_mean_expression_in_vivo("Cxcl5", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Cxcl5_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```

### Efemp1

```{r}
get_mean_expression_in_vivo("Efemp1", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Efemp1_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```


## **Top 5 diff Ligand2 (in vivo)**


### Il12b


```{r}
get_mean_expression_in_vivo("Il12b", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Il12b_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```


### Ebi3

```{r}
get_mean_expression_in_vivo("Ebi3", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/Ebi3_expression_in_vivo.pdf", "MTX", "OXA", "CIS")
```


## **DecoupleR**


### In-vivo

```{r}
net <- decoupleR::get_progeny(organism = "mouse", top = 500)
progeny_in_vivo_MTX <- run_mlm(mat=y_MP_log, net=net, .source='source', .target='target',
                  .mor='weight', minsize = 5)

progeny_in_vivo_MTX_mat <- progeny_in_vivo_MTX %>%
  pivot_wider(id_cols = 'condition', names_from = 'source',
              values_from = 'score') %>%
  column_to_rownames('condition') %>%
  as.matrix() %>% scale()
write.csv(progeny_in_vivo_MTX_mat, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/pathways_activity_PROGENy_MTX.csv")

png(file = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/pathways_activity_PROGENy_MTX_pheatmap.csv")
pheatmap(progeny_in_vivo_MTX_mat, border_color = NA, color=my_color, breaks = my_breaks)
dev.off()
```



```{r}
progeny_in_vivo_OXA <- run_mlm(mat=y_OCP_log, net=net, .source='source', .target='target',
                  .mor='weight', minsize = 5)

progeny_in_vivo_OXA_mat <- progeny_in_vivo_OXA %>%
  pivot_wider(id_cols = 'condition', names_from = 'source',
              values_from = 'score') %>%
  column_to_rownames('condition') %>%
  as.matrix() %>% scale()
write.csv(progeny_in_vivo_OXA_mat, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/pathways_activity_PROGENy_OXA.csv")


png(file = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vivo/in_vivo_results/pathways_activity_PROGENy_OXA_pheatmap.csv")
pheatmap(progeny_in_vivo_OXA_mat, border_color = NA, color=my_color, breaks = my_breaks)
dev.off()
```



### In-vitro

```{r}
progeny_in_vitro <- run_mlm(mat=counts_in_vitro, net=net, .source='source', .target='target',
                  .mor='weight', minsize = 5)
                  

progeny_in_vitro_mat <- progeny_in_vitro %>%
  pivot_wider(id_cols = 'condition', names_from = 'source',
              values_from = 'score') %>%
  column_to_rownames('condition') %>%
  as.matrix() %>% scale() %>% as.data.frame() 

write.csv(progeny_in_vitro_mat, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/pathways_activity_PROGENy.csv")

get_pheatmaps_in_vitro <- function(time, filen, progeny_in_vitro_mat){
  progeny_in_vitro_mat_for_pheatmap <- progeny_in_vitro_mat %>% as.data.frame() %>%  dplyr::slice(which(grepl(time, rownames(.))))
  palette_length = 100
  my_color = colorRampPalette(c("Darkblue", "white","red"))(palette_length)
  my_breaks <- c(seq(-3, 0, length.out=ceiling(palette_length/2) + 1),
               seq(0.05, 3, length.out=floor(palette_length/2)))
  png(file=filen)
  pheatmap(as.matrix(progeny_in_vitro_mat_for_pheatmap), border_color = NA, color=my_color, breaks = my_breaks)
  dev.off()
}

get_pheatmaps_in_vitro("3h", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/pathways_activity_PROGENy_pheatmap_3h.png", progeny_in_vitro_mat)
get_pheatmaps_in_vitro("6h", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/pathways_activity_PROGENy_pheatmap_6h.png", progeny_in_vitro_mat)
get_pheatmaps_in_vitro("12h", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/pathways_activity_PROGENy_pheatmap_12h.png", progeny_in_vitro_mat)
get_pheatmaps_in_vitro("18h", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/pathways_activity_PROGENy_pheatmap_18h.png", progeny_in_vitro_mat)
get_pheatmaps_in_vitro("24h", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/pathways_activity_PROGENy_pheatmap_24h.png", progeny_in_vitro_mat)


progeny_in_vitro_mat_for_pheatmap_6h <- progeny_in_vitro_mat %>% as.data.frame() %>%  dplyr::slice(which(grepl("6h", rownames(progeny_in_vitro_mat))))
png(file="/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/pathways_activity_PROGENy_pheatmap_6h.png")
pheatmap(as.matrix(progeny_in_vitro_mat_for_pheatmap_6h), border_color = NA, color=my_color, breaks = my_breaks)
dev.off()


progeny_in_vitro_mat_for_pheatmap_12h <- progeny_in_vitro_mat %>% as.data.frame() %>%  dplyr::slice(which(grepl("12h", rownames(progeny_in_vitro_mat))))
png(file="/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/pathways_activity_PROGENy_pheatmap_12h.png")
pheatmap(as.matrix(progeny_in_vitro_mat_for_pheatmap_12h), border_color = NA, color=my_color, breaks = my_breaks)
dev.off()

progeny_in_vitro_mat_for_pheatmap_18h <- progeny_in_vitro_mat %>% as.data.frame() %>%  dplyr::slice(which(grepl("18h", rownames(progeny_in_vitro_mat))))
png(file="/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/pathways_activity_PROGENy_pheatmap_18h.png")
pheatmap(as.matrix(progeny_in_vitro_mat_for_pheatmap_18h), border_color = NA, color=my_color, breaks = my_breaks)
dev.off()


progeny_in_vitro_mat_for_pheatmap_24h <- progeny_in_vitro_mat %>% as.data.frame() %>%  dplyr::slice(which(grepl("24h", rownames(progeny_in_vitro_mat))))
png(file="/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/pathways_activity_PROGENy_pheatmap_24h.png")
pheatmap(as.matrix(progeny_in_vitro_mat_for_pheatmap_24h), border_color = NA, color=my_color, breaks = my_breaks)
dev.off()
```


## **Enrichment of miRNAs**


```{r}
counts_in_vitro_final_enrich <- counts_in_vitro_final %>% rownames_to_column("gene_name") %>% inner_join(counts_mod_2[, c("gene_name", "gene_type")], by= "gene_name")
counts_in_vitro_final_enrich_miRNA <- counts_in_vitro_final_enrich %>% filter(gene_type == "miRNA") %>% dplyr::select(-"gene_type") %>% column_to_rownames("gene_name")
design_dge <- model.matrix(~ 0 + Treatment_hour, data= dge$samples)
fit_dea <- lmFit(counts_in_vitro_final_enrich_miRNA, design_dge)
```

```{r get_contrasts_in_vitro}
contrasts_dea_3h <- makeContrasts(MP_3h = MTX_3h - Control_3h, OP_3h = OXA_3h - Control_3h, CP_3h = CIS_3h - Control_3h, levels = design_dge)
fit_contrast_3h <- contrasts.fit(fit_dea, contrasts_dea_3h)
fit_contrast_3h <- eBayes(fit_contrast_3h)

contrasts_dea_6h <- makeContrasts(MP_6h = MTX_6h - Control_6h, OP_6h = OXA_6h - Control_6h, CP_6h = CIS_6h - Control_6h, levels = design_dge)
fit_contrast_6h <- contrasts.fit(fit_dea, contrasts_dea_6h)
fit_contrast_6h <- eBayes(fit_contrast_6h)

contrasts_dea_12h <- makeContrasts(MP_12h = MTX_12h - Control_12h, OP_12h = OXA_12h - Control_12h, CP_12h = CIS_12h - Control_12h, levels = design_dge)
fit_contrast_12h <- contrasts.fit(fit_dea, contrasts_dea_12h)
fit_contrast_12h <- eBayes(fit_contrast_12h)

contrasts_dea_18h <- makeContrasts(MP_18h = MTX_18h - Control_18h, OP_18h = OXA_18h - Control_18h, CP_18h = CIS_18h - Control_18h, levels = design_dge)
fit_contrast_18h <- contrasts.fit(fit_dea, contrasts_dea_18h)
fit_contrast_18h <- eBayes(fit_contrast_18h)

contrasts_dea_24h <- makeContrasts(MP_24h = MTX_24h - Control_24h, OP_24h = OXA_24h - Control_24h, CP_24h = CIS_24h - Control_24h, levels = design_dge)
fit_contrast_24h <- contrasts.fit(fit_dea, contrasts_dea_24h)
fit_contrast_24h <- eBayes(fit_contrast_24h)
```

```{r}
genes <- topTable(fit_contrast, sort.by= "P", adjust.method = "BH", number = Inf, coef = a) %>%
  rownames_to_column("gene_id")
```



## **MTX+OXA vs CIS**


### *Import TF of Il6 and Ccl5*

```{r}

cytokines_mouse <- read.csv("~/MODICED_link/Bulk_RNA_in_vivo+Bulk_RNA_in_vitro/databases_imported/cytokines_mouse.csv")
cytokines_mouse$Cytokine.Name <- str_to_title(cytokines_mouse$Cytokine.Name)
cytokines_mouse$TF.Name <- str_to_title(cytokines_mouse$TF.Name)
tf_genes_checkpoint <- read.delim("~/MODICED_link/Bulk_RNA_in_vivo+Bulk_RNA_in_vitro/databases_imported/tf_checkpoint_db_gene_regulation.tsv", header=TRUE)
tf_genes_tflink <- read.delim("~/MODICED_link/Bulk_RNA_in_vivo+Bulk_RNA_in_vitro/databases_imported/TFLink_Mus_musculus_tf_gene_regulation.gz")
tf_genes_trrust_v2 <- read.delim("~/MODICED_link/Bulk_RNA_in_vivo+Bulk_RNA_in_vitro/databases_imported/TRRUST_v2_tf_gene_interaction.tsv", header=FALSE)



  
# Il6
tf_genes_tflink_Il6 <- tf_genes_tflink %>% dplyr::filter(Name.Target == c("Il6"))
dim(tf_genes_tflink_Il6)
tf_genes_trrust_v2_Il6 <- tf_genes_trrust_v2 %>% dplyr::filter(V2 == "Il6") %>% dplyr::select(c(V1,V2,V3))
dim(tf_genes_trrust_v2_Il6)
tf_genes_cytreg_v2_Il6 <- cytokines_mouse %>% dplyr::filter(Cytokine.Name == "Il6") %>% dplyr::select(c(Cytokine.Name, TF.Name, TF.Function))
dim(tf_genes_cytreg_v2_Il6)
tf_genes_Il6_cytreg_trrust_v2 <- tf_genes_cytreg_v2_Il6[which(tf_genes_cytreg_v2_Il6$TF.Name %in% tf_genes_trrust_v2_Il6$V1),]
tf_genes_Il6_only_cytreg <-  tf_genes_cytreg_v2_Il6[which(!(tf_genes_cytreg_v2_Il6$TF.Name %in% tf_genes_trrust_v2_Il6$V1)),]
tf_genes_Il6 <- rbind(tf_genes_Il6_cytreg_trrust_v2, tf_genes_Il6_only_cytreg)
rownames(tf_genes_Il6) <- NULL
tf_genes_Il6[c(2,6,7,13,25,32),"TF.Function"] <- "activator" 




# Ccl5
#tf_genes_tflink_Ccl5 <- tf_genes_tflink %>% dplyr::filter(Name.Target == c("Ccl5"))
dim(tf_genes_tflink_Ccl5)
tf_genes_trrust_v2_Ccl5 <- tf_genes_trrust_v2 %>% dplyr::filter(V2 == "Ccunun l5") %>% dplyr::select(c(V1,V2,V3))
dim(tf_genes_trrust_v2_Ccl5)
tf_genes_cytreg_v2_Ccl5 <- cytokines_mouse %>% dplyr::filter(Cytokine.Name == "Ccl5") %>% dplyr::select(c(Cytokine.Name, TF.Name, TF.Function))
dim(tf_genes_cytreg_v2_Ccl5)
tf_genes_Ccl5_cytreg_trrust_v2 <- tf_genes_cytreg_v2_Ccl5[which(tf_genes_cytreg_v2_Ccl5$TF.Name %in% tf_genes_trrust_v2_Ccl5$V1),]
tf_genes_Ccl5_only_cytreg <-  tf_genes_cytreg_v2_Ccl5[which(!(tf_genes_cytreg_v2_Ccl5$TF.Name %in% tf_genes_trrust_v2_Ccl5$V1)),]
tf_genes_Ccl5 <- rbind(tf_genes_Ccl5_cytreg_trrust_v2, tf_genes_Ccl5_only_cytreg)
rownames(tf_genes_Ccl5) <- NULL
tf_genes_Ccl5[c(6,11,18),"TF.Function"] <- "bifunctional"

```



### DEA


```{r run_dea}
library(tidyverse)
library(edgeR)
sample_plan_in_vitro <- readRDS("~/MODICED_link/Bulk_RNA_in_vitro/preprocessing_in_vitro_RNA/sample_plan_in_vitro_for_analysis.rds")
attach(sample_plan_in_vitro)
counts_in_vitro_df <- readRDS("~/MODICED_link/Bulk_RNA_in_vitro/preprocessing_in_vitro_RNA/counts_in_vitro_for_analysis.rds") %>% as.data.frame()
counts_in_vitro_df_genes <- counts_in_vitro_df %>% dplyr::select(1:3)
counts_in_vitro_df_samples <- counts_in_vitro_df %>% dplyr::select(-c(1:3))
dlist <- DGEList(counts = counts_in_vitro_df_samples, samples = sample_plan_in_vitro$Sample_Name, genes = counts_in_vitro_df_genes$gene_name)
dsgn <- model.matrix(~ 0 + Treatment_hour, data=dlist$samples)
colnames(dsgn) <- sub("Treatment_hour","",colnames(dsgn))
keep <- filterByExpr(dlist$counts, dsgn)
dlist_filtered <- dlist[keep,]
dlist_filtered <- calcNormFactors(dlist_filtered, method="TMM")
voom <- voomWithQualityWeights(dlist_filtered, dsgn)
fit_dea <- lmFit(voom, dsgn)
```


```{r get_contrasts}
# MTX+OXA vs CIS
contrasts_dea__3h <- makeContrasts(MTX_3h_OXA_3h_vs_CIS_3h = CIS_3h - ((MTX_3h+OXA_3h)/2), levels=dsgn)
fit_contrast_dea_3h <- contrasts.fit(fit_dea, contrasts_dea__3h)
fit_contrast_dea_3h <- eBayes(fit_contrast_dea_3h)

contrasts_dea__6h <- makeContrasts(MTX_6h_OXA_6h_vs_CIS_6h = CIS_6h - ((MTX_6h+OXA_6h)/2) , levels=dsgn)
fit_contrast_dea_6h <- contrasts.fit(fit_dea, contrasts_dea__6h)
fit_contrast_dea_6h <- eBayes(fit_contrast_dea_6h)

contrasts_dea__12h <- makeContrasts(MTX_12h_OXA_12h_vs_CIS_12h = CIS_12h - ((MTX_12h+OXA_12h)/2), levels=dsgn)
fit_contrast_dea_12h <- contrasts.fit(fit_dea, contrasts_dea__12h)
fit_contrast_dea_12h <- eBayes(fit_contrast_dea_12h)

contrasts_dea__18h <- makeContrasts(MTX_18h_OXA_18h_vs_CIS_18h = CIS_18h - ((MTX_18h+OXA_18h)/2), levels=dsgn)
fit_contrast_dea_18h <- contrasts.fit(fit_dea, contrasts_dea__18h)
fit_contrast_dea_18h <- eBayes(fit_contrast_dea_18h)

contrasts_dea__24h <- makeContrasts(MTX_24h_OXA_24h_vs_CIS_24h = CIS_24h -((MTX_24h+OXA_24h)/2), levels=dsgn)
fit_contrast_dea_24h <- contrasts.fit(fit_dea, contrasts_dea__24h)
fit_contrast_dea_24h <- eBayes(fit_contrast_dea_24h)

```

```{r save_dea_results}
get_dea_results_MTX_OXA_CIS <- function(timepoint, fit_contrast_dea){
  
  all_genes <- topTable(fit_contrast_dea, sort.by= "P", adjust.method = "BH", number = Inf)
  all_genes <- all_genes %>% dplyr::rename("gene_name" = "genes") %>% inner_join(counts_in_vitro_df[,c("gene_type", "gene_name","gene_id")], by="gene_name", relationship="many-to-many") %>% relocate(gene_id, .after = gene_name)
  all_genes$contrast <- rep(paste("MTX",timepoint,"OXA",timepoint,"vs","CIS",timepoint,sep="_"))
  write.csv(all_genes,  paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", timepoint, "/all_genes.csv"))
  
  diff_genes <- all_genes %>% dplyr::filter(adj.P.Val < 0.05 & abs(logFC)> 0) %>% mutate(group = if_else(logFC < 0, "down", "up"))
  rownames(diff_genes) <- NULL
  write.csv(diff_genes, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/",timepoint, "/diff_genes.csv"))
}
```





```{r plot_dea_results_all_genes_cytokines}
plot_genes_and_cytokines_dea_MTX_OXA_CIS <- function(timepoint){
  
  all_genes <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", timepoint,"/all_genes.csv"))

genes_cytokines <- all_genes %>% dplyr::filter(gene_name %in% cytokines_mouse$Cytokine.Name)
write.csv(genes_cytokines, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/",timepoint,"/all_cytokines.csv"))

diff_genes_cytokines <- genes_cytokines %>% dplyr::filter(adj.P.Val < 0.05, abs(logFC)>1) %>% mutate(group = if_else(logFC < 0, "down", "up"))

up_reg_cytokines <- diff_genes_cytokines %>% filter(group=="up") %>% write.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/",timepoint,"/up_reg_cytokines.csv"))

down_reg_cytokines <- diff_genes_cytokines %>% filter(group=="down") %>% write.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/",timepoint,"/down_reg_cytokines.csv"))

volcano_all_genes <- all_genes %>% 
  ggplot(mapping=aes(x=logFC, y =-log10(adj.P.Val), label=gene_name)) + 
  geom_point(color="grey") +
  geom_point(data = filter(all_genes,logFC > 1 & adj.P.Val < 0.05), color="red") + 
  geom_point(data = filter(all_genes,logFC < -1 & adj.P.Val < 0.05), color="blue") + 
  geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") + 
  geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") + 
  ylab("-log10(adj.P.value)") + 
  xlab("log2(FoldChange)") + 
  theme_linedraw() + 
  ggtitle(paste("MTX_",timepoint,"+","OXA_",timepoint,"_vs_","CIS_",timepoint,": all_genes",sep="")) + 
  theme(plot.title=element_text(hjust=0.5, face="bold"))
  
ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/",timepoint,"/volcano_all_cytokines.png"))  

volcano_all_genes_plotly <- plotly::ggplotly(volcano_all_genes)
htmlwidgets::saveWidget(
                widget = volcano_all_genes_plotly,
                file = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/",timepoint,"/volcano_all_genes.html"))


volcano_all_cytokines <- genes_cytokines %>% 
  ggplot(mapping=aes(x=logFC, y =-log10(adj.P.Val), label=gene_name)) + 
  geom_point(color="grey") +
  geom_point(data = filter(genes_cytokines,logFC > 1 & adj.P.Val < 0.05), color="red") + 
  geom_point(data = filter(genes_cytokines,logFC < -1 & adj.P.Val < 0.05), color="blue") + 
  geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") + 
  geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") + 
  ylab("-log10(adj.P.value)") + 
  xlab("log2(FoldChange)") + 
  theme_linedraw() + 
  ggtitle(paste("MTX_",timepoint,"+","OXA_",timepoint,"_vs_","CIS_",timepoint,": all_cytokines",sep="")) + 
  theme(plot.title=element_text(hjust=0.5, face="bold"))

ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/",timepoint,"/volcano_all_cytokines.png"))

volcano_all_cytokines_plotly <- plotly::ggplotly(volcano_all_cytokines)
htmlwidgets::saveWidget(
                widget = volcano_all_cytokines_plotly,
                file = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/",timepoint,"/volcano_all_cytokines.html"))


# all cytokines (with labels)
volcano_cytokines_with_labels <- genes_cytokines %>% 
  ggplot(mapping = aes(x=logFC, y=-log10(adj.P.Val), 
                       label=gene_name)) +
  
  geom_point(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 
                           0.05), 
             color="red", size=3,shape=21, fill="red") +
  
  geom_point(data=filter(genes_cytokines, logFC < 1 & logFC > -1 & 
                           adj.P.Val > 0.05), color="grey", 
             size=3,shape=21, fill="grey") +
  
  geom_point(data=filter(genes_cytokines, logFC < 1 & logFC > -1 & 
                                                      adj.P.Val <= 
                           0.05), color="green", size=3,shape=21, 
             fill="green") +
  
                               
  geom_point(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 0.05), color="red", size=3,shape=21, fill="red") +
  
                              
  geom_point(data=filter(genes_cytokines, logFC < -1 & adj.P.Val <= 0.05), color="blue", size=3,shape=21, fill="blue") +
                             
                      
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 0.05),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
                               
                      
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC < -1 & adj.P.Val <= 0.05),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
                             
                               
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC > -1 & logFC < 1),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
  
  geom_hline(yintercept = -log10(0.05), colour = "black", linetype 
             ="dashed") +
  
  geom_vline(xintercept = c(-1,1), colour="black", linetype 
             ="dashed") +
  
  ggtitle(paste("MTX_",timepoint,"+","OXA_",timepoint,"_vs_","CIS_",timepoint,": all_cytokines",sep="")) +
  
  theme(plot.title = element_text(hjust=0.5,face="bold")) +
  
  theme(axis.title = element_text(face="bold")) +
                           
  theme(axis.text = element_text(face="bold")) 

ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/",timepoint,"/volcano_all_cytokines_with_labels.png"), width = 17, height = 10)

}

```



## **MTX vs OXA***

### DEA
```{r}
# MTX vs OXA
contrasts_dea_MTX_OXA_3h <- makeContrasts(MTX_3h_OXA_3h = MTX_3h - OXA_3h, levels=dsgn)
fit_contrast_dea_MTX_OXA_3h <- contrasts.fit(fit_dea, contrasts_dea_MTX_OXA_3h)
fit_contrast_dea_MTX_OXA_3h <- eBayes(fit_contrast_dea_MTX_OXA_3h)

contrasts_dea_MTX_OXA_6h <- makeContrasts(MTX_6h_OXA_6h = MTX_6h - OXA_6h, levels=dsgn)
fit_contrast_dea_MTX_OXA_6h <- contrasts.fit(fit_dea, contrasts_dea_MTX_OXA_6h)
fit_contrast_dea_MTX_OXA_6h <- eBayes(fit_contrast_dea_MTX_OXA_6h)

contrasts_dea_MTX_OXA_12h <- makeContrasts(MTX_12h_OXA_12h = MTX_12h - OXA_12h, levels=dsgn)
fit_contrast_dea_MTX_OXA_12h <- contrasts.fit(fit_dea, contrasts_dea_MTX_OXA_12h)
fit_contrast_dea_MTX_OXA_12h <- eBayes(fit_contrast_dea_MTX_OXA_12h)

contrasts_dea_MTX_OXA_18h <- makeContrasts(MTX_18h_OXA_18h = MTX_18h - OXA_18h, levels=dsgn)
fit_contrast_dea_MTX_OXA_18h <- contrasts.fit(fit_dea, contrasts_dea_MTX_OXA_18h)
fit_contrast_dea_MTX_OXA_18h <- eBayes(fit_contrast_dea_MTX_OXA_18h)

contrasts_dea_MTX_OXA_24h <- makeContrasts(MTX_24h_OXA_24h = MTX_24h - OXA_24h, levels=dsgn)
fit_contrast_dea_MTX_OXA_24h <- contrasts.fit(fit_dea, contrasts_dea_MTX_OXA_24h)
fit_contrast_dea_MTX_OXA_24h <- eBayes(fit_contrast_dea_MTX_OXA_24h)

```

```{r save_dea_results}
get_dea_results_MTX_OXA <- function(timepoint, fit_contrast_dea){
  
  all_genes <- topTable(fit_contrast_dea, sort.by= "P", adjust.method = "BH", number = Inf)
  all_genes <- all_genes %>% dplyr::rename("gene_name" = "genes") %>% inner_join(counts_in_vitro_df[,c("gene_type", "gene_name","gene_id")], by="gene_name", relationship="many-to-many") %>% relocate(gene_id, .after = gene_name)
  all_genes$contrast <- rep(paste("MTX_",timepoint,"_vs_","OXA_",timepoint,sep=""))
  write.csv(all_genes,  paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_OXA/", timepoint, "/all_genes.csv"))
  
  diff_genes <- all_genes %>% dplyr::filter(adj.P.Val < 0.05 & abs(logFC)> 0) %>% mutate(group = if_else(logFC < 0, "down", "up"))
  rownames(diff_genes) <- NULL
  write.csv(diff_genes, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_OXA/",timepoint, "/diff_genes.csv"))
}
```



#### 3h
```{r}
get_dea_results_MTX_OXA("3h", fit_contrast_dea_MTX_OXA_3h)
```

#### 6h
```{r}
get_dea_results_MTX_OXA("6h", fit_contrast_dea_MTX_OXA_6h)
```

#### 12h
```{r}
get_dea_results_MTX_OXA("12h", fit_contrast_dea_MTX_OXA_12h)
```

#### 18h
```{r}
get_dea_results_MTX_OXA("18h", fit_contrast_dea_MTX_OXA_18h)
```

#### 24h
```{r}
get_dea_results_MTX_OXA("24h", fit_contrast_dea_MTX_OXA_24h)
```












## **MTX vs CIS***

### DEA
```{r}
# MTX vs CIS
contrasts_dea_MTX_CIS_3h <- makeContrasts(MTX_3h_CIS_3h = MTX_3h - CIS_3h, levels=dsgn)
fit_contrast_dea_MTX_CIS_3h <- contrasts.fit(fit_dea, contrasts_dea_MTX_CIS_3h)
fit_contrast_dea_MTX_CIS_3h <- eBayes(fit_contrast_dea_MTX_CIS_3h)

contrasts_dea_MTX_CIS_6h <- makeContrasts(MTX_6h_CIS_6h = MTX_6h - CIS_6h, levels=dsgn)
fit_contrast_dea_MTX_CIS_6h <- contrasts.fit(fit_dea, contrasts_dea_MTX_CIS_6h)
fit_contrast_dea_MTX_CIS_6h <- eBayes(fit_contrast_dea_MTX_CIS_6h)

contrasts_dea_MTX_CIS_12h <- makeContrasts(MTX_12h_CIS_12h = MTX_12h - CIS_12h, levels=dsgn)
fit_contrast_dea_MTX_CIS_12h <- contrasts.fit(fit_dea, contrasts_dea_MTX_CIS_12h)
fit_contrast_dea_MTX_CIS_12h <- eBayes(fit_contrast_dea_MTX_CIS_12h)

contrasts_dea_MTX_CIS_18h <- makeContrasts(MTX_18h_CIS_18h = MTX_18h - CIS_18h, levels=dsgn)
fit_contrast_dea_MTX_CIS_18h <- contrasts.fit(fit_dea, contrasts_dea_MTX_CIS_18h)
fit_contrast_dea_MTX_CIS_18h <- eBayes(fit_contrast_dea_MTX_CIS_18h)

contrasts_dea_MTX_CIS_24h <- makeContrasts(MTX_24h_CIS_24h = MTX_24h - CIS_24h, levels=dsgn)
fit_contrast_dea_MTX_CIS_24h <- contrasts.fit(fit_dea, contrasts_dea_MTX_CIS_24h)
fit_contrast_dea_MTX_CIS_24h <- eBayes(fit_contrast_dea_MTX_CIS_24h)

```

```{r save_dea_results}
get_dea_results_MTX_CIS <- function(timepoint, fit_contrast_dea){
  
  all_genes <- topTable(fit_contrast_dea, sort.by= "P", adjust.method = "BH", number = Inf)
  all_genes <- all_genes %>% dplyr::rename("gene_name" = "genes") %>% inner_join(counts_in_vitro_df[,c("gene_type", "gene_name","gene_id")], by="gene_name", relationship="many-to-many") %>% relocate(gene_id, .after = gene_name)
  all_genes$contrast <- rep(paste("MTX_",timepoint,"_vs_","CIS_",timepoint,sep=""))
  write.csv(all_genes,  paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/", timepoint, "/all_genes.csv"))
  
  diff_genes <- all_genes %>% dplyr::filter(adj.P.Val < 0.05 & abs(logFC)> 0) %>% mutate(group = if_else(logFC < 0, "down", "up"))
  rownames(diff_genes) <- NULL
  write.csv(diff_genes, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/",timepoint, "/diff_genes.csv"))
}
```



```{r plot_dea_results_all_genes_cytokines}
plot_genes_and_cytokines_dea_MTX_CIS <- function(timepoint){
  
  all_genes <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/",timepoint,"/all_genes.csv"))

genes_cytokines <- all_genes %>% dplyr::filter(gene_name %in% cytokines_mouse$Cytokine.Name)
write.csv(genes_cytokines, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/",timepoint,"/all_cytokines.csv"))

diff_genes_cytokines <- genes_cytokines %>% dplyr::filter(adj.P.Val < 0.05, abs(logFC)>1) %>% mutate(group = if_else(logFC < 0, "down", "up"))

up_reg_cytokines <- diff_genes_cytokines %>% filter(group=="up") %>% write.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/",timepoint,"/up_reg_cytokines.csv"))

down_reg_cytokines <- diff_genes_cytokines %>% filter(group=="down") %>% write.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/",timepoint,"/down_reg_cytokines.csv"))

volcano_all_genes <- all_genes %>% 
  ggplot(mapping=aes(x=logFC, y =-log10(adj.P.Val), label=gene_name)) + 
  geom_point(color="grey") +
  geom_point(data = filter(all_genes,logFC > 1 & adj.P.Val < 0.05), color="red") + 
  geom_point(data = filter(all_genes,logFC < -1 & adj.P.Val < 0.05), color="blue") + 
  geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") + 
  geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") + 
  ylab("-log10(adj.P.value)") + 
  xlab("log2(FoldChange)") + 
  theme_linedraw() + 
  ggtitle(paste("MTX",timepoint,"vs","CIS",timepoint,": all_genes",sep="_")) + 
  theme(plot.title=element_text(hjust=0.5, face="bold"))
  
ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/",timepoint,"/volcano_all_cytokines.png"))  

volcano_all_genes_plotly <- plotly::ggplotly(volcano_all_genes)
htmlwidgets::saveWidget(
                widget = volcano_all_genes_plotly,
                file = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/",timepoint,"/volcano_all_genes.html"))


volcano_all_cytokines <- genes_cytokines %>% 
  ggplot(mapping=aes(x=logFC, y =-log10(adj.P.Val), label=gene_name)) + 
  geom_point(color="grey") +
  geom_point(data = filter(genes_cytokines,logFC > 1 & adj.P.Val < 0.05), color="red") + 
  geom_point(data = filter(genes_cytokines,logFC < -1 & adj.P.Val < 0.05), color="blue") + 
  geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") + 
  geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") + 
  ylab("-log10(adj.P.value)") + 
  xlab("log2(FoldChange)") + 
  theme_linedraw() + 
  ggtitle(paste("MTX_",timepoint, "_vs_","CIS_",timepoint,": all_cytokines",sep="")) + 
  theme(plot.title=element_text(hjust=0.5, face="bold"))

ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/",timepoint,"/volcano_all_cytokines.png"))

volcano_all_cytokines_plotly <- plotly::ggplotly(volcano_all_cytokines)
htmlwidgets::saveWidget(
                widget = volcano_all_cytokines_plotly,
                file = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/",timepoint,"/volcano_all_cytokines.html"))


# all cytokines (with labels)
volcano_cytokines_with_labels <- genes_cytokines %>% 
  ggplot(mapping = aes(x=logFC, y=-log10(adj.P.Val), 
                       label=gene_name)) +
  
  geom_point(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 
                           0.05), 
             color="red", size=3,shape=21, fill="red") +
  
  geom_point(data=filter(genes_cytokines, logFC < 1 & logFC > -1 & 
                           adj.P.Val > 0.05), color="grey", 
             size=3,shape=21, fill="grey") +
  
  geom_point(data=filter(genes_cytokines, logFC < 1 & logFC > -1 & 
                                                      adj.P.Val <= 
                           0.05), color="green", size=3,shape=21, 
             fill="green") +
  
                               
  geom_point(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 0.05), color="red", size=3,shape=21, fill="red") +
  
                              
  geom_point(data=filter(genes_cytokines, logFC < -1 & adj.P.Val <= 0.05), color="blue", size=3,shape=21, fill="blue") +
                             
                      
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 0.05),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
                               
                      
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC < -1 & adj.P.Val <= 0.05),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
                             
                               
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC > -1 & logFC < 1),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
  
  geom_hline(yintercept = -log10(0.05), colour = "black", linetype 
             ="dashed") +
  
  geom_vline(xintercept = c(-1,1), colour="black", linetype 
             ="dashed") +
  
  ggtitle(paste("MTX_",timepoint,"_vs_","CIS_",timepoint,": all_cytokines",sep="")) +
  
  theme(plot.title = element_text(hjust=0.5,face="bold")) +
  
  theme(axis.title = element_text(face="bold")) +
                           
  theme(axis.text = element_text(face="bold")) 

ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/",timepoint,"/volcano_all_cytokines_with_labels.png"), width = 17, height = 10)

}

```

#### 3h
```{r}
get_dea_results_MTX_CIS("3h", fit_contrast_dea_MTX_CIS_3h)
plot_genes_and_cytokines_dea_MTX_CIS("3h")
```

#### 6h
```{r}
get_dea_results_MTX_CIS("6h", fit_contrast_dea_MTX_CIS_6h)
plot_genes_and_cytokines_dea_MTX_CIS("6h")
```

#### 12h
```{r}
get_dea_results_MTX_CIS("12h", fit_contrast_dea_MTX_CIS_12h)
plot_genes_and_cytokines_dea_MTX_CIS("12h")
```

#### 18h
```{r}
get_dea_results_MTX_CIS("18h", fit_contrast_dea_MTX_CIS_18h)
plot_genes_and_cytokines_dea_MTX_CIS("18h")
```

#### 24h
```{r}
get_dea_results_MTX_CIS("24h", fit_contrast_dea_MTX_CIS_24h)
plot_genes_and_cytokines_dea_MTX_CIS("24h")
```




## **OXA vs CIS***

### DEA
```{r}
# OXA vs CIS
contrasts_dea_OXA_CIS_3h <- makeContrasts(OXA_3h_CIS_3h = OXA_3h - CIS_3h, levels=dsgn)
fit_contrast_dea_OXA_CIS_3h <- contrasts.fit(fit_dea, contrasts_dea_OXA_CIS_3h)
fit_contrast_dea_OXA_CIS_3h <- eBayes(fit_contrast_dea_OXA_CIS_3h)

contrasts_dea_OXA_CIS_6h <- makeContrasts(OXA_6h_CIS_6h = OXA_6h - CIS_6h, levels=dsgn)
fit_contrast_dea_OXA_CIS_6h <- contrasts.fit(fit_dea, contrasts_dea_OXA_CIS_6h)
fit_contrast_dea_OXA_CIS_6h <- eBayes(fit_contrast_dea_OXA_CIS_6h)

contrasts_dea_OXA_CIS_12h <- makeContrasts(OXA_12h_CIS_12h = OXA_12h - CIS_12h, levels=dsgn)
fit_contrast_dea_OXA_CIS_12h <- contrasts.fit(fit_dea, contrasts_dea_OXA_CIS_12h)
fit_contrast_dea_OXA_CIS_12h <- eBayes(fit_contrast_dea_OXA_CIS_12h)

contrasts_dea_OXA_CIS_18h <- makeContrasts(OXA_18h_CIS_18h = OXA_18h - CIS_18h, levels=dsgn)
fit_contrast_dea_OXA_CIS_18h <- contrasts.fit(fit_dea, contrasts_dea_OXA_CIS_18h)
fit_contrast_dea_OXA_CIS_18h <- eBayes(fit_contrast_dea_OXA_CIS_18h)

contrasts_dea_OXA_CIS_24h <- makeContrasts(OXA_24h_CIS_24h = OXA_24h - CIS_24h, levels=dsgn)
fit_contrast_dea_OXA_CIS_24h <- contrasts.fit(fit_dea, contrasts_dea_OXA_CIS_24h)
fit_contrast_dea_OXA_CIS_24h <- eBayes(fit_contrast_dea_OXA_CIS_24h)

```

```{r save_dea_results}
get_dea_results_OXA_CIS <- function(timepoint, fit_contrast_dea){
  
  all_genes <- topTable(fit_contrast_dea, sort.by= "P", adjust.method = "BH", number = Inf)
  all_genes <- all_genes %>% dplyr::rename("gene_name" = "genes") %>% inner_join(counts_in_vitro_df[,c("gene_type", "gene_name","gene_id")], by="gene_name", relationship="many-to-many") %>% relocate(gene_id, .after = gene_name)
  all_genes$contrast <- rep(paste("OXA_",timepoint,"_vs_","CIS_",timepoint,sep=""))
  write.csv(all_genes,  paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/", timepoint, "/all_genes.csv"))
  
  diff_genes <- all_genes %>% dplyr::filter(adj.P.Val < 0.05 & abs(logFC)> 0) %>% mutate(group = if_else(logFC < 0, "down", "up"))
  rownames(diff_genes) <- NULL
  write.csv(diff_genes, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/",timepoint, "/diff_genes.csv"))
}
```



```{r plot_dea_results_all_genes_cytokines}
plot_genes_and_cytokines_dea_OXA_CIS <- function(timepoint){
  
  all_genes <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/",timepoint,"/all_genes.csv"))

genes_cytokines <- all_genes %>% dplyr::filter(gene_name %in% cytokines_mouse$Cytokine.Name)
write.csv(genes_cytokines, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/",timepoint,"/all_cytokines.csv"))

diff_genes_cytokines <- genes_cytokines %>% dplyr::filter(adj.P.Val < 0.05, abs(logFC)>1) %>% mutate(group = if_else(logFC < 0, "down", "up"))

up_reg_cytokines <- diff_genes_cytokines %>% filter(group=="up") %>% write.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/",timepoint,"/up_reg_cytokines.csv"))

down_reg_cytokines <- diff_genes_cytokines %>% filter(group=="down") %>% write.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/",timepoint,"/down_reg_cytokines.csv"))

volcano_all_genes <- all_genes %>% 
  ggplot(mapping=aes(x=logFC, y =-log10(adj.P.Val), label=gene_name)) + 
  geom_point(color="grey") +
  geom_point(data = filter(all_genes,logFC > 1 & adj.P.Val < 0.05), color="red") + 
  geom_point(data = filter(all_genes,logFC < -1 & adj.P.Val < 0.05), color="blue") + 
  geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") + 
  geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") + 
  ylab("-log10(adj.P.value)") + 
  xlab("log2(FoldChange)") + 
  theme_linedraw() + 
  ggtitle(paste("OXA",timepoint,"vs","CIS",timepoint,": all_genes",sep="_")) + 
  theme(plot.title=element_text(hjust=0.5, face="bold"))
  
ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/",timepoint,"/volcano_all_cytokines.png"))  

volcano_all_genes_plotly <- plotly::ggplotly(volcano_all_genes)
htmlwidgets::saveWidget(
                widget = volcano_all_genes_plotly,
                file = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/",timepoint,"/volcano_all_genes.html"))


volcano_all_cytokines <- genes_cytokines %>% 
  ggplot(mapping=aes(x=logFC, y =-log10(adj.P.Val), label=gene_name)) + 
  geom_point(color="grey") +
  geom_point(data = filter(genes_cytokines,logFC > 1 & adj.P.Val < 0.05), color="red") + 
  geom_point(data = filter(genes_cytokines,logFC < -1 & adj.P.Val < 0.05), color="blue") + 
  geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") + 
  geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") + 
  ylab("-log10(adj.P.value)") + 
  xlab("log2(FoldChange)") + 
  theme_linedraw() + 
  ggtitle(paste("OXA_",timepoint, "_vs_","CIS_",timepoint,": all_cytokines",sep="")) + 
  theme(plot.title=element_text(hjust=0.5, face="bold"))

ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/",timepoint,"/volcano_all_cytokines.png"))

volcano_all_cytokines_plotly <- plotly::ggplotly(volcano_all_cytokines)
htmlwidgets::saveWidget(
                widget = volcano_all_cytokines_plotly,
                file = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/",timepoint,"/volcano_all_cytokines.html"))


# all cytokines (with labels)
volcano_cytokines_with_labels <- genes_cytokines %>% 
  ggplot(mapping = aes(x=logFC, y=-log10(adj.P.Val), 
                       label=gene_name)) +
  
  geom_point(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 
                           0.05), 
             color="red", size=3,shape=21, fill="red") +
  
  geom_point(data=filter(genes_cytokines, logFC < 1 & logFC > -1 & 
                           adj.P.Val > 0.05), color="grey", 
             size=3,shape=21, fill="grey") +
  
  geom_point(data=filter(genes_cytokines, logFC < 1 & logFC > -1 & 
                                                      adj.P.Val <= 
                           0.05), color="green", size=3,shape=21, 
             fill="green") +
  
                               
  geom_point(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 0.05), color="red", size=3,shape=21, fill="red") +
  
                              
  geom_point(data=filter(genes_cytokines, logFC < -1 & adj.P.Val <= 0.05), color="blue", size=3,shape=21, fill="blue") +
                             
                      
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 0.05),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
                               
                      
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC < -1 & adj.P.Val <= 0.05),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
                             
                               
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC > -1 & logFC < 1),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
  
  geom_hline(yintercept = -log10(0.05), colour = "black", linetype 
             ="dashed") +
  
  geom_vline(xintercept = c(-1,1), colour="black", linetype 
             ="dashed") +
  
  ggtitle(paste("OXA_",timepoint,"_vs_","CIS_",timepoint,": all_cytokines",sep="")) +
  
  theme(plot.title = element_text(hjust=0.5,face="bold")) +
  
  theme(axis.title = element_text(face="bold")) +
                           
  theme(axis.text = element_text(face="bold")) 

ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/",timepoint,"/volcano_all_cytokines_with_labels.png"), width = 17, height = 10)

}
    
```


```{r plot_dea_results_all_genes_tf_Il6_Ccl5}
plot_all_genes_tf_Il6_Ccl5_OXA_CIS <- function(timepoint){
  
  all_genes <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", timepoint,"/all_genes.csv"))
  
  diff_genes <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", timepoint,"/diff_genes.csv")) 
  
  all_tf_Il6 <- all_genes %>% dplyr::filter(gene_name %in% tf_genes_Il6$TF.Name) %>% remove_rownames() %>% dplyr::rename(TF.Name = gene_name) %>% inner_join(tf_genes_Il6[,c("TF.Name","TF.Function")], by="TF.Name")
write.csv(all_tf_Il6, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", timepoint,"/all_tf_Il6.csv"))

  all_tf_Ccl5 <- all_genes %>% dplyr::filter(gene_name %in% tf_genes_Ccl5$TF.Name) %>% remove_rownames() %>% dplyr::rename(TF.Name = gene_name) %>%   inner_join(tf_genes_Ccl5[,c("TF.Name","TF.Function")], by="TF.Name")
write.csv(all_tf_Ccl5, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", timepoint,"/all_tf_Ccl5.csv"))
  
  diff_tf_Il6 <- diff_genes %>% dplyr::filter(gene_name %in% tf_genes_Il6$TF.Name) %>% remove_rownames() %>% dplyr::rename(TF.Name = gene_name) %>% inner_join(tf_genes_Il6[,c("TF.Name","TF.Function")], by="TF.Name")
write.csv(diff_tf_Il6, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", timepoint,"/diff_tf_Il6.csv"))
  
  diff_tf_Ccl5 <- diff_genes %>% dplyr::filter(gene_name %in% tf_genes_Ccl5$TF.Name) %>% remove_rownames() %>% dplyr::rename(TF.Name = gene_name) %>% inner_join(tf_genes_Ccl5[,c("TF.Name","TF.Function")],  by="TF.Name")
write.csv(diff_tf_Ccl5, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", timepoint,"/diff_tf_Ccl5.csv"))
  
  diff_tf_Il6$group <- paste(diff_tf_Il6$group,diff_tf_Il6$TF.Function, sep="_")
  diff_tf_Ccl5$group <- paste(diff_tf_Ccl5$group,diff_tf_Ccl5$TF.Function, sep="_")
  
  
volcano_all_genes_tf_Il6 <- ggplot(diff_tf_Il6, mapping = aes(x=logFC, y=-log10(adj.P.Val))) + 
    geom_point(data = all_genes, color = "gray30", alpha = 0.8) +
    geom_point(data = filter(all_genes, gene_name == "Il6"), fill = "tomato", size=3, shape = 21) +
    geom_point(data = inner_join(all_genes, tf_genes_Il6, by = c("gene_name" = "TF.Name")), size=3, shape = 21, aes(fill=str_to_title(TF.Function))) +
    geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") + 
    geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") +
    ggrepel::geom_label_repel(data = filter(all_genes, gene_name == "Il6"), aes(label = gene_name), color = "black", fill = "tomato", label.size = 0.10, label.padding = 0.10) + 
    ggrepel::geom_label_repel(data = inner_join(all_genes, tf_genes_Il6, by = c("gene_name" = "TF.Name")), color="black", aes(label=gene_name,fill=str_to_title(TF.Function)), max.overlaps = Inf, label.size=0.10, label.padding = 0.10) +
    ylab("-log10(adj.P.value)") + 
    xlab("log2(FoldChange)") + 
    theme_linedraw() + 
    scale_fill_brewer(palette = "Se18h", guide = guide_legend(override.aes = aes(label = "")), name = "Function") + 
    ggtitle(paste("MTX_",timepoint,"+","OXA_",timepoint,"_vs_","CIS_",timepoint,": all_genes_Il6_and_its_TFs",sep="")) + 
    theme(plot.title=element_text(hjust=0.5, face="bold"))
  
  
ggsave(filename = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/",timepoint,"/volcano_all_genes_Il6_and_its_TFs.png"))
  
  
volcano_all_genes_tf_Ccl5 <- ggplot(diff_tf_Ccl5, mapping = aes(x=logFC, y=-log10(adj.P.Val))) + 
    geom_point(data = all_genes, color = "gray30", alpha = 0.8) +
    geom_point(data = filter(all_genes, gene_name == "Ccl5"), fill = "tomato", size=3, shape = 21) +
    geom_point(data = inner_join(all_genes, tf_genes_Ccl5, by = c("gene_name" = "TF.Name")), size=3, shape = 21, aes(fill=str_to_title(TF.Function))) +
    geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") + 
    geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") +
    ggrepel::geom_label_repel(data = filter(all_genes, gene_name == "Ccl5"), aes(label = gene_name), color = "black", fill = "tomato", label.size = 0.10, label.padding = 0.10) + 
    ggrepel::geom_label_repel(data = inner_join(all_genes, tf_genes_Ccl5, by = c("gene_name" = "TF.Name")), color="black", aes(label=gene_name,fill=str_to_title(TF.Function)), max.overlaps = Inf, label.size=0.10, label.padding = 0.10) +
    ylab("-log10(adj.P.value)") + 
    xlab("log2(FoldChange)") + 
    theme_linedraw() + 
    scale_fill_brewer(palette = "Se18h", guide = guide_legend(override.aes = aes(label = "")), name = "Function") + 
    ggtitle(paste("MTX_",timepoint,"+","OXA_",timepoint,"_vs_","CIS_",timepoint,": all_genes_Ccl5_and_its_TFs",sep="")) + 
    theme(plot.title=element_text(hjust=0.5, face="bold"))
  
  
ggsave(filename = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/",timepoint,"/volcano_all_genes_Ccl5_and_its_TFs.png"))
  
  # Plotly                
  volcano_all_genes_tf_Il6_plotly <- plotly::ggplotly(volcano_all_genes_tf_Il6)
  htmlwidgets::saveWidget(widget = volcano_all_genes_tf_Il6_plotly, file = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/",timepoint,"/volcano_all_genes_Il6_and_its_TFs.html"))
  
  # Plotly                
  volcano_all_genes_tf_Ccl5_plotly <- plotly::ggplotly(volcano_all_genes_tf_Ccl5)
  htmlwidgets::saveWidget(widget = volcano_all_genes_tf_Ccl5_plotly, file = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", timepoint, "/volcano_all_genes_Ccl5_and_its_TFs.html"))
              
}

```



#### 3h
```{r}
get_dea_results_OXA_CIS("3h", fit_contrast_dea_OXA_CIS_3h)
plot_genes_and_cytokines_dea_OXA_CIS("3h")
plot_all_genes_tf_Il6_Ccl5_OXA_CIS("3h")
```

#### 6h
```{r}
get_dea_results_OXA_CIS("6h", fit_contrast_dea_OXA_CIS_6h)
plot_genes_and_cytokines_dea_OXA_CIS("6h")
plot_all_genes_tf_Il6_Ccl5_OXA_CIS("6h")
```

#### 12h
```{r}
get_dea_results_OXA_CIS("12h", fit_contrast_dea_OXA_CIS_12h)
plot_genes_and_cytokines_dea_OXA_CIS("12h")
plot_all_genes_tf_Il6_Ccl5_OXA_CIS("12h")
```

#### 18h
```{r}
get_dea_results_OXA_CIS("18h", fit_contrast_dea_OXA_CIS_18h)
plot_genes_and_cytokines_dea_OXA_CIS("18h")
plot_all_genes_tf_Il6_Ccl5_OXA_CIS("18h")
```

#### 24h
```{r}
get_dea_results_OXA_CIS("24h", fit_contrast_dea_OXA_CIS_24h)
plot_genes_and_cytokines_dea_OXA_CIS("24h")
plot_all_genes_tf_Il6_Ccl5_OXA_CIS("24h")
```




```{r save_dea_results}
get_dea_results_CIS_MTX <- function(timepoint, fit_contrast_dea){
  
  all_genes <- topTable(fit_contrast_dea, sort.by= "P", adjust.method = "BH", number = Inf)
  all_genes <- all_genes %>% dplyr::rename("gene_name" = "genes") %>% inner_join(counts_in_vitro_df[,c("gene_type", "gene_name","gene_id")], by="gene_name", relationship="many-to-many") %>% relocate(gene_id, .after = gene_name)
  all_genes$contrast <- rep(paste("CIS_",timepoint,"_vs_","MTX_",timepoint,sep=""))
  write.csv(all_genes,  paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_MTX/", timepoint, "/all_genes.csv"))
  
  diff_genes <- all_genes %>% dplyr::filter(adj.P.Val < 0.05 & abs(logFC)> 0) %>% mutate(group = if_else(logFC < 0, "down", "up"))
  rownames(diff_genes) <- NULL
  write.csv(diff_genes, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_MTX/",timepoint, "/diff_genes.csv"))
}
```


# CIS vs MTX
```{r}
contrasts_dea_CIS_MTX_3h <- makeContrasts(CIS_3h_MTX_3h = CIS_3h - MTX_3h, levels=dsgn)
fit_contrast_dea_CIS_MTX_3h <- contrasts.fit(fit_dea, contrasts_dea_CIS_MTX_3h)
fit_contrast_dea_CIS_MTX_3h <- eBayes(fit_contrast_dea_CIS_MTX_3h)

contrasts_dea_CIS_MTX_6h <- makeContrasts(CIS_6h_MTX_6h = CIS_6h - MTX_6h, levels=dsgn)
fit_contrast_dea_CIS_MTX_6h <- contrasts.fit(fit_dea, contrasts_dea_CIS_MTX_6h)
fit_contrast_dea_CIS_MTX_6h <- eBayes(fit_contrast_dea_CIS_MTX_6h)

contrasts_dea_CIS_MTX_12h <- makeContrasts(CIS_12h_MTX_12h = CIS_12h - MTX_12h, levels=dsgn)
fit_contrast_dea_CIS_MTX_12h <- contrasts.fit(fit_dea, contrasts_dea_CIS_MTX_12h)
fit_contrast_dea_CIS_MTX_12h <- eBayes(fit_contrast_dea_CIS_MTX_12h)

contrasts_dea_CIS_MTX_18h <- makeContrasts(CIS_18h_MTX_18h = CIS_18h - MTX_18h, levels=dsgn)
fit_contrast_dea_CIS_MTX_18h <- contrasts.fit(fit_dea, contrasts_dea_CIS_MTX_18h)
fit_contrast_dea_CIS_MTX_18h <- eBayes(fit_contrast_dea_CIS_MTX_18h)

contrasts_dea_CIS_MTX_24h <- makeContrasts(CIS_24h_MTX_24h = CIS_24h - MTX_24h, levels=dsgn)
fit_contrast_dea_CIS_MTX_24h <- contrasts.fit(fit_dea, contrasts_dea_CIS_MTX_24h)
fit_contrast_dea_CIS_MTX_24h <- eBayes(fit_contrast_dea_CIS_MTX_24h)
```







### TF analysis of Il6 and its TFs
```{r}
all_genes_3h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", "3h","/all_genes.csv")) 
all_genes_6h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", "6h","/all_genes.csv"))
all_genes_12h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", "12h","/all_genes.csv"))
all_genes_18h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", "18h","/all_genes.csv"))
all_genes_24h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", "24h","/all_genes.csv"))



diff_genes_3h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", "3h","/diff_genes.csv")) 
diff_genes_6h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", "6h","/diff_genes.csv"))
diff_genes_12h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", "12h","/diff_genes.csv"))
diff_genes_18h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", "18h","/diff_genes.csv"))
diff_genes_24h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/", "24h","/diff_genes.csv"))
```


#### Il6 + TF_Il6 (logFC)
```{r}
diff_tf_Il6_3h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","3h","/all_tf_Il6.csv"))
diff_tf_Il6_6h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","6h","/all_tf_Il6.csv"))
diff_tf_Il6_12h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","12h","/all_tf_Il6.csv"))
diff_tf_Il6_18h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","18h","/all_tf_Il6.csv"))
diff_tf_Il6_24h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","24h","/all_tf_Il6.csv"))


all_tf_Il6_3h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","3h","/all_tf_Il6.csv"))
all_tf_Il6_6h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","6h","/all_tf_Il6.csv"))
all_tf_Il6_12h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","12h","/all_tf_Il6.csv"))
all_tf_Il6_18h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","18h","/all_tf_Il6.csv"))
all_tf_Il6_24h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","24h","/all_tf_Il6.csv"))


Il6_logFC_3h <- all_genes_3h %>% filter(gene_name == "Il6")
Il6_logFC_6h <- all_genes_6h %>% filter(gene_name == "Il6")
Il6_logFC_12h <- all_genes_12h %>% filter(gene_name == "Il6")
Il6_logFC_18h <- all_genes_18h %>% filter(gene_name == "Il6")
Il6_logFC_24h <- all_genes_24h %>% filter(gene_name == "Il6")

all_tf_Il6_down_3h <- all_tf_Il6_3h %>% dplyr::filter(logFC < 0 & adj.P.Val <= 0.05) 
all_tf_Il6_down_6h <- all_tf_Il6_6h %>% dplyr::filter(logFC < 0 & adj.P.Val <= 0.05) 
all_tf_Il6_up_12h <- all_tf_Il6_12h %>% dplyr::filter(logFC > 1 & adj.P.Val <= 0.05) 
all_tf_Il6_up_18h <- all_tf_Il6_18h %>% dplyr::filter(logFC > 1 & adj.P.Val <= 0.05) 
all_tf_Il6_up_24h <- all_tf_Il6_24h %>% dplyr::filter(logFC > 1 & adj.P.Val <= 0.05) 


# Il6_TF with log FC < 0 and adj.p.val <= 0.05 overlapping at 3h and 6h (i.e. similar pattern with Il6 at these timepoints)
intersect_3h_6h <- intersect(all_tf_Il6_down_3h$TF.Name, all_tf_Il6_down_6h$TF.Name)
tf_Il6_down_as_Il6_3h <- all_tf_Il6_3h %>% dplyr::filter(TF.Name %in% intersect_3h_6h) %>% dplyr::select(c('TF.Name','logFC','TF.Function')) 
tf_Il6_down_as_Il6_6h <- all_tf_Il6_6h %>% dplyr::filter(TF.Name %in% intersect_3h_6h) %>% dplyr::select(c('TF.Name','logFC','TF.Function')) 
tf_Il6_down_as_Il6_3h_6h <- inner_join(tf_Il6_down_as_Il6_3h, tf_Il6_down_as_Il6_6h, by="TF.Name")


# Il6_TF with log FC > 1 and adj.p.val <= 0.05 overlapping at 12h, 18h, and 24h (i.e. similar pattern with Il6 at these timepoints)

intersect_12h_18h_up <- inner_join(all_tf_Il6_up_12h, all_tf_Il6_up_18h, by="TF.Name")
intersect_12h_18h_24h_up <- inner_join(intersect_12h_18h_up, all_tf_Il6_up_24h, by="TF.Name") %>% dplyr::rename("LogFC_12h" = "logFC.x", "LogFC_18h" = "logFC.y", "LogFC_24h" = "logFC")



# Combine Nr4a1, Cepbd and Fos tfs
Nr4a1_tf <- data.frame(timepoint = c("12","18","24"), logFC = c(intersect_12h_18h_24h_up$LogFC_12h[1], intersect_12h_18h_24h_up$LogFC_18h[1], intersect_12h_18h_24h_up$LogFC_24h[1]), TF = rep(intersect_12h_18h_24h_up$TF.Name[1],3), TF.Function=intersect_12h_18h_24h_up$TF.Function[1])

Irf2_tf <- data.frame(timepoint = c("12","18","24"), logFC = c(intersect_12h_18h_24h_up$LogFC_12h[2], intersect_12h_18h_24h_up$LogFC_18h[2], intersect_12h_18h_24h_up$LogFC_24h[2]), TF = rep(intersect_12h_18h_24h_up$TF.Name[2],3), TF.Function=intersect_12h_18h_24h_up$TF.Function[2])

Fos_tf <- data.frame(timepoint = c("12","18","24"), logFC = c(intersect_12h_18h_24h_up$LogFC_12h[3], intersect_12h_18h_24h_up$LogFC_18h[3], intersect_12h_18h_24h_up$LogFC_24h[3]), TF = rep(intersect_12h_18h_24h_up$TF.Name[3],3), TF.Function=intersect_12h_18h_24h_up$TF.Function[3])

Il6_logFC <- data.frame(timepoint= c("12","18","24"), logFC = c(Il6_logFC_12h$logFC, Il6_logFC_18h$logFC, Il6_logFC_24h$logFC), gene_name= rep("Il6",3))

all_tfs <- rbind(Nr4a1_tf, Irf2_tf, Fos_tf) %>% dplyr::arrange(timepoint)



# Plot logFC of Nr4a1, Irf2, and Fos at 12h, 18h, and 24h
ggplot(all_tfs, aes(x = timepoint, y=logFC)) +
  geom_point(size=2, shape=21, aes(fill=str_to_title(TF.Function))) +
  geom_point(data=Il6_logFC, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(aes(label = TF, fill=str_to_title(TF.Function)), label.size = 0.15, label.padding = 0.10) +   
  ggrepel::geom_label_repel(data=Il6_logFC, aes(label=gene_name), fill="tomato", label.padding = 0.08, label.size=0.15) +
  geom_path(aes(group=TF, color=str_to_title(TF.Function))) +
  geom_path(data=Il6_logFC, aes(group=gene_name), color="tomato") +
  scale_fill_brewer(palette = "Se18h", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Se18h", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Nr4a1 + Fos + Cepbd =  Top 3 up-regulated TFs at 12h, 18h, and 24h") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold"))
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/Il6_TFs_up_regulated_at_12h_18h_24h_logFC.png")


```

```{r}
object_for_cytokine_expression <- cbind(voom$E, dlist_filtered$genes) %>% remove_rownames() 
rownames(object_for_cytokine_expression) <- make.names(object_for_cytokine_expression$genes, unique=TRUE)
object_for_cytokine_expression <- object_for_cytokine_expression %>% dplyr::select(-"genes")
```


#### Il6 + TF_Il6 (longitudinal expression in Cis)

```{r}

# Il6
counts_in_vitro_df_Il6_Cis <- object_for_cytokine_expression %>% filter(rownames(.) == "Il6") %>% dplyr::select(contains("CIS"))
# counts_in_vitro_df_Il6_Cis <- counts_in_vitro_df_Il6_Cis[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il6") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il6",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il6_Cis$name <- rep("Il6",5)



# Nr4a1
counts_in_vitro_df_Nr4a1_Cis <- object_for_cytokine_expression %>% filter(rownames(.) == "Nr4a1") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Nr4a1_Cis <- counts_in_vitro_df_Nr4a1_Cis[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Nr4a1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Nr4a1_Cis$name <- rep("Nr4a1",5)
counts_in_vitro_df_Nr4a1_Cis$TF.Function <- tf_genes_Il6 %>% filter(TF.Name == "Nr4a1") %>% dplyr::pull(TF.Function)

# Irf2
counts_in_vitro_df_Irf2_Cis <- object_for_cytokine_expression %>% filter(rownames(.) == "Irf2") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Irf2_Cis <- counts_in_vitro_df_Irf2_Cis[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Irf2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Irf2_Cis$name <- rep("Irf2",5)
counts_in_vitro_df_Irf2_Cis$TF.Function <- tf_genes_Il6 %>% filter(TF.Name == "Irf2") %>% dplyr::pull(TF.Function)

# Fos
counts_in_vitro_df_Fos_Cis <- object_for_cytokine_expression %>% filter(rownames(.) == "Fos") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Fos_Cis <- counts_in_vitro_df_Fos_Cis[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Fos") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), name = rep("Fos",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Fos_Cis$name <- rep("Fos",5) 
counts_in_vitro_df_Fos_Cis$TF.Function <- tf_genes_Il6 %>% filter(TF.Name == "Fos") %>% dplyr::pull(TF.Function)

# Klf4
counts_in_vitro_df_Klf4_Cis <- object_for_cytokine_expression %>% filter(rownames(.) == "Klf4") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Klf4_Cis <- counts_in_vitro_df_Klf4_Cis[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Klf4") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), name = rep("Klf4",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Klf4_Cis$name <- rep("Klf4",5) 
counts_in_vitro_df_Klf4_Cis$TF.Function <- tf_genes_Il6 %>% filter(TF.Name == "Klf4") %>% dplyr::pull(TF.Function)


# Jun
counts_in_vitro_df_Jun_Cis <- object_for_cytokine_expression %>% filter(rownames(.) == "Jun") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Jun_Cis <- counts_in_vitro_df_Jun_Cis[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Jun") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), name = rep("Jun",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Jun_Cis$name <- rep("Jun",5) 
counts_in_vitro_df_Jun_Cis$TF.Function <- tf_genes_Il6 %>% filter(TF.Name == "Jun") %>% dplyr::pull(TF.Function)
counts_merged <- rbind(counts_in_vitro_df_Nr4a1_Cis, counts_in_vitro_df_Irf2_Cis, counts_in_vitro_df_Jun_Cis, counts_in_vitro_df_Klf4_Cis, counts_in_vitro_df_Fos_Cis)  %>% dplyr::arrange(timepoint)




ggplot(counts_merged, aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_Cis, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_Cis, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_Cis, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Se18h", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Se18h", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of TFs targetting Il6 in CIS: Nr4a1 + Fos + Cepbd + Jun + Klf4") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/Longitudinal_expression_of_TFs_targetting_Il6_in_CIS: Nr4a1 + Fos + Cepbd + Jun + Klf4.png")
```



#### Ccl5 + TF_Ccl5 (logFC)
```{r}
diff_tf_Ccl5_3h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","3h","/all_tf_Ccl5.csv"))
diff_tf_Ccl5_6h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","6h","/all_tf_Ccl5.csv"))
diff_tf_Ccl5_12h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","12h","/all_tf_Ccl5.csv"))
diff_tf_Ccl5_18h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","18h","/all_tf_Ccl5.csv"))
diff_tf_Ccl5_24h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","24h","/all_tf_Ccl5.csv"))


all_tf_Ccl5_3h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","3h","/all_tf_Ccl5.csv"))
all_tf_Ccl5_6h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","6h","/all_tf_Ccl5.csv"))
all_tf_Ccl5_12h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","12h","/all_tf_Ccl5.csv"))
all_tf_Ccl5_18h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","18h","/all_tf_Ccl5.csv"))
all_tf_Ccl5_24h <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/","24h","/all_tf_Ccl5.csv"))


Ccl5_logFC_3h <- all_genes_3h %>% filter(gene_name == "Ccl5")
Ccl5_logFC_6h <- all_genes_6h %>% filter(gene_name == "Ccl5")
Ccl5_logFC_12h <- all_genes_12h %>% filter(gene_name == "Ccl5")
Ccl5_logFC_18h <- all_genes_18h %>% filter(gene_name == "Ccl5")
Ccl5_logFC_24h <- all_genes_24h %>% filter(gene_name == "Ccl5")

Ccl5_logFC <- data.frame(timepoint= c("3","6", "12","18","24"), logFC = c(Ccl5_logFC_3h$logFC, Ccl5_logFC_6h$logFC, Ccl5_logFC_12h$logFC, Ccl5_logFC_18h$logFC, Ccl5_logFC_24h$logFC), gene_name= rep("Ccl5",5))
Ccl5_logFC_12h_18h_24h <- data.frame(timepoint= c("12","18","24"), logFC = c(Ccl5_logFC_12h$logFC, Ccl5_logFC_18h$logFC, Ccl5_logFC_24h$logFC), gene_name= rep("Ccl5",3)) 

all_tf_Ccl5_down_3h <- all_tf_Ccl5_3h %>% dplyr::filter(logFC < 0 & adj.P.Val <= 0.05) 
all_tf_Ccl5_down_6h <- all_tf_Ccl5_6h %>% dplyr::filter(logFC < 0 & adj.P.Val <= 0.05) 
all_tf_Ccl5_down_12h <- all_tf_Ccl5_12h %>% dplyr::filter(logFC < 0 & adj.P.Val <= 0.05) 
all_tf_Ccl5_down_18h <- all_tf_Ccl5_18h %>% dplyr::filter(logFC < 0 & adj.P.Val <= 0.05) 
all_tf_Ccl5_down_24h <- all_tf_Ccl5_24h %>% dplyr::filter(logFC < 0 & adj.P.Val <= 0.05) 


# Ccl5_TF with log FC < 0 and adj.p.val <= 0.05 overlapping at 3h, 6h, 12h, 18h, 24h (i.e. similar pattern with Ccl5 at these timepoints)
intersect_3h_6h_down <- intersect(all_tf_Ccl5_down_3h$TF.Name, all_tf_Ccl5_down_6h$TF.Name)
intersect_3h_6h_12h_down <- intersect(intersect_3h_6h_down, all_tf_Ccl5_down_12h$TF.Name)
intersect_3h_6h_12h_down <- intersect(intersect_3h_6h_down, all_tf_Ccl5_down_12h$TF.Name)
intersect_3h_6h_12h_18h_down <- intersect(intersect_3h_6h_12h_down, all_tf_Ccl5_down_18h$TF.Name)
intersect_3h_6h_12h_18h_24h_down <- intersect(intersect_3h_6h_12h_18h_down, all_tf_Ccl5_down_24h$TF.Name)

tf_Ccl5_down_as_Ccl5_3h <- all_tf_Ccl5_3h %>% dplyr::filter(TF.Name %in% intersect_3h_6h_12h_18h_24h_down) %>% dplyr::select(c('TF.Name','logFC','TF.Function', 'adj.P.Val')) 
tf_Ccl5_down_as_Ccl5_6h <- all_tf_Ccl5_6h %>% dplyr::filter(TF.Name %in% intersect_3h_6h_12h_18h_24h_down) %>% dplyr::select(c('TF.Name','logFC','TF.Function', 'adj.P.Val')) 
tf_Ccl5_down_as_Ccl5_12h <- all_tf_Ccl5_12h %>% dplyr::filter(TF.Name %in% intersect_3h_6h_12h_18h_24h_down) %>% dplyr::select(c('TF.Name','logFC','TF.Function', 'adj.P.Val')) 
tf_Ccl5_down_as_Ccl5_18h <- all_tf_Ccl5_18h %>% dplyr::filter(TF.Name %in% intersect_3h_6h_12h_18h_24h_down) %>% dplyr::select(c('TF.Name','logFC','TF.Function', 'adj.P.Val')) 
tf_Ccl5_down_as_Ccl5_24h <- all_tf_Ccl5_24h %>% dplyr::filter(TF.Name %in% intersect_3h_6h_12h_18h_24h_down) %>% dplyr::select(c('TF.Name','logFC','TF.Function', 'adj.P.Val')) 


tf_Ccl5_down_as_Ccl5_3h_6h <- inner_join(tf_Ccl5_down_as_Ccl5_3h, tf_Ccl5_down_as_Ccl5_6h, by="TF.Name")
tf_Ccl5_down_as_Ccl5_3h_6h_12h <- inner_join(tf_Ccl5_down_as_Ccl5_3h_6h, tf_Ccl5_down_as_Ccl5_12h,  by="TF.Name")
tf_Ccl5_down_as_Ccl5_3h_6h_12h_18h <- inner_join(tf_Ccl5_down_as_Ccl5_3h_6h_12h, tf_Ccl5_down_as_Ccl5_18h,  by="TF.Name")
tf_Ccl5_down_as_Ccl5_3h_6h_12h_18h_24h <- inner_join(tf_Ccl5_down_as_Ccl5_3h_6h_12h_18h, tf_Ccl5_down_as_Ccl5_24h, by="TF.Name") %>% dplyr::rename("LogFC_3h" = "logFC.x", "LogFC_6h" = "logFC.y", "LogFC_12h" = "logFC.x.x", "LogFC_18h" = "logFC.y.y", "LogFC_24h" = "logFC")


# Combine Irf2 and Irf5 tfs (five timepoints)
Irf2_tf <- data.frame(timepoint = c("3", "6", "12","18","24"), 
                      logFC = c(tf_Ccl5_down_as_Ccl5_3h_6h_12h_18h_24h$LogFC_3h[1], tf_Ccl5_down_as_Ccl5_3h_6h_12h_18h_24h$LogFC_6h[1], tf_Ccl5_down_as_Ccl5_3h_6h_12h_18h_24h$LogFC_12h[1], tf_Ccl5_down_as_Ccl5_3h_6h_12h_18h_24h$LogFC_18h[1], tf_Ccl5_down_as_Ccl5_3h_6h_12h_18h_24h$LogFC_24h[1]),
                      TF = rep(tf_Ccl5_down_as_Ccl5_3h_6h_12h_18h_24h$TF.Name[1],5),
                      TF.Function=rep(tf_Ccl5_down_as_Ccl5_3h_6h_12h_18h_24h$TF.Function[1],5))


Irf5_tf <- data.frame(timepoint = c("3", "6", "12","18","24"), 
                      logFC = c(tf_Ccl5_down_as_Ccl5_3h_6h_12h_18h_24h$LogFC_3h[2], tf_Ccl5_down_as_Ccl5_3h_6h_12h_18h_24h$LogFC_6h[2], tf_Ccl5_down_as_Ccl5_3h_6h_12h_18h_24h$LogFC_12h[2], tf_Ccl5_down_as_Ccl5_3h_6h_12h_18h_24h$LogFC_18h[2], tf_Ccl5_down_as_Ccl5_3h_6h_12h_18h_24h$LogFC_24h[2]),
                      TF = rep(tf_Ccl5_down_as_Ccl5_3h_6h_12h_18h_24h$TF.Name[2],5),
                      TF.Function=rep(tf_Ccl5_down_as_Ccl5_3h_6h_12h_18h_24h$TF.Function[2],5))



all_tfs_down <- rbind(Irf2_tf, Irf5_tf) %>% dplyr::arrange(timepoint)



# Plot logFC of Irf2 and Irf5 at 3h, 6h, 12h, 18h, and 24h
ggplot(all_tfs_down, aes(x = factor(timepoint, level=c("3","6","12","18","24")), y=logFC)) +
  geom_point(size=2, shape=21, aes(fill=str_to_title(TF.Function))) +
  geom_point(data=Ccl5_logFC, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(aes(label = TF, fill=str_to_title(TF.Function)), label.size = 0.15, label.padding = 0.10) +   
  ggrepel::geom_label_repel(data=Ccl5_logFC, aes(label=gene_name), fill="tomato", label.padding = 0.08, label.size=0.15) +
  geom_line(aes(group=TF, color=str_to_title(TF.Function))) +
  geom_line(data=Ccl5_logFC, aes(group=gene_name), color="tomato") +
  scale_fill_brewer(palette = "Se18h", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Se18h", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Irf2 + Irf5 = down-regulated TFs at each timepoint") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "timepoint", y="logFC")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/Ccl5_TFs_down_regulated_a18hh_6h_12h_18h_and_24h_logFC.png")




# Ccl5_TF with log FC < 0 and adj.p.val <= 0.05 overlapping at 12h, 18h, 24h (i.e. similar pattern with Ccl5 at these timepoints)
intersect_12h_18h_down <- intersect(all_tf_Ccl5_down_12h$TF.Name, all_tf_Ccl5_down_18h$TF.Name)
intersect_12h_18h_24h_down <- intersect(intersect_12h_18h_down, all_tf_Ccl5_down_24h$TF.Name)


tf_Ccl5_down_as_Ccl5_12h_2 <- all_tf_Ccl5_12h %>% dplyr::filter(TF.Name %in% intersect_12h_18h_24h_down) %>% dplyr::select(c('TF.Name','logFC','TF.Function', 'adj.P.Val')) 
tf_Ccl5_down_as_Ccl5_18h_2 <- all_tf_Ccl5_18h %>% dplyr::filter(TF.Name %in% intersect_12h_18h_24h_down) %>% dplyr::select(c('TF.Name','logFC','TF.Function', 'adj.P.Val')) 
tf_Ccl5_down_as_Ccl5_24h_2 <- all_tf_Ccl5_24h %>% dplyr::filter(TF.Name %in% intersect_12h_18h_24h_down) %>% dplyr::select(c('TF.Name','logFC','TF.Function', 'adj.P.Val')) 


tf_Ccl5_down_as_Ccl5_12h_18h_2 <- inner_join(tf_Ccl5_down_as_Ccl5_12h_2, tf_Ccl5_down_as_Ccl5_18h_2, by="TF.Name") 
tf_Ccl5_down_as_Ccl5_12h_18h_24h_2 <- inner_join(tf_Ccl5_down_as_Ccl5_12h_18h_2, tf_Ccl5_down_as_Ccl5_24h_2, by="TF.Name") %>% dplyr::rename("LogFC_12h" = "logFC.x", "LogFC_18h" = "logFC.y", "LogFC_24h" = "logFC")



# Combine Nfkb1, Ets1, Hif1a, Sta3h tfs (three timepoints)
Nfkb1_tf <- data.frame(timepoint = c("12","18","24"), logFC = c(tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$LogFC_12h[1], tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$LogFC_18h[1], tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$LogFC_24h[1]), TF = rep(tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$TF.Name[1],3), TF.Function = rep(tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$TF.Function[1],3))

Ets1_tf <- data.frame(timepoint = c("12","18","24"), logFC = c(tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$LogFC_12h[3], tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$LogFC_18h[3], tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$LogFC_24h[3]), TF = rep(tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$TF.Name[3],3), TF.Function = rep(tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$TF.Function[3],3))


Hif1a_tf <- data.frame(timepoint = c("12","18","24"), logFC = c(tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$LogFC_12h[4], tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$LogFC_18h[4], tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$LogFC_24h[4]), TF = rep(tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$TF.Name[4],3), TF.Function = rep(tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$TF.Function[4],3))


Sta3h_tf <- data.frame(timepoint = c("12","18","24"), logFC = c(tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$LogFC_12h[6], tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$LogFC_18h[6], tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$LogFC_24h[6]), TF = rep(tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$TF.Name[6],3), TF.Function = rep(tf_Ccl5_down_as_Ccl5_12h_18h_24h_2$TF.Function[6],3))


all_tfs_down_12_18_24h <- rbind(Nfkb1_tf, Ets1_tf, Hif1a_tf, Sta3h_tf) %>% dplyr::arrange(timepoint)


# Plot logFC of Nfkb1, Ets1, Hif1a, Sta3h
ggplot(all_tfs_down_12_18_24h, aes(x = factor(timepoint, level=c("12","18","24")), y=logFC)) +
  geom_point(size=2, shape=21, aes(fill=str_to_title(TF.Function))) +
  geom_point(data=Ccl5_logFC_12h_18h_24h, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(aes(label = TF, fill=str_to_title(TF.Function)), label.size = 0.15, label.padding = 0.10) +   
  ggrepel::geom_label_repel(data=Ccl5_logFC_12h_18h_24h, aes(label=gene_name), fill="tomato", label.padding = 0.08, label.size=0.15) +
  geom_line(aes(group=TF, color=str_to_title(TF.Function))) +
  geom_line(data=Ccl5_logFC_12h_18h_24h, aes(group=gene_name), color="tomato") +
  scale_fill_brewer(palette = "Se18h", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Se18h", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Nfkb1 + Ets1 + Hif1a + Sta3h = down-regulated TFs only at 12h, 18h, and 24h") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "timepoint", y="logFC")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/Ccl5_TFs_down_regulated_only_at_12h_18h_and_24h_logFC.png")
```

#### Ccl5 + TF_Ccl5 (longitudinal expression in MTX and OXA)

##### MTX
```{r}
# Ccl5
counts_in_vitro_df_Ccl5_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl5") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Ccl5_MTX <- counts_in_vitro_df_Ccl5_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl5_MTX$name <- rep("Ccl5",5)



# Nfkb1
counts_in_vitro_df_Nfkb1_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Nfkb1") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Nfkb1_MTX <- counts_in_vitro_df_Nfkb1_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Nfkb1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Nfkb1_MTX$name <- rep("Nfkb1",5)
counts_in_vitro_df_Nfkb1_MTX$TF.Function <- tf_genes_Ccl5 %>% filter(TF.Name == "Nfkb1") %>% dplyr::pull(TF.Function)

# Irf2
counts_in_vitro_df_Irf2_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Irf2") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Irf2_MTX <- counts_in_vitro_df_Irf2_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Irf2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Irf2_MTX$name <- rep("Irf2",5)
counts_in_vitro_df_Irf2_MTX$TF.Function <- tf_genes_Ccl5 %>% filter(TF.Name == "Irf2") %>% dplyr::pull(TF.Function)

# Sta3h
counts_in_vitro_df_Sta3h_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Sta3h") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Sta3h_MTX <- counts_in_vitro_df_Sta3h_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Sta3h") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Sta3h_MTX$name <- rep("Sta3h",5) 
counts_in_vitro_df_Sta3h_MTX$TF.Function <- tf_genes_Ccl5 %>% filter(TF.Name == "Sta3h") %>% dplyr::pull(TF.Function)

# Cebpb
counts_in_vitro_df_Cebpb_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Cebpb") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Cebpb_MTX <- counts_in_vitro_df_Cebpb_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cebpb") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cebpb_MTX$name <- rep("Cebpb",5) 
counts_in_vitro_df_Cebpb_MTX$TF.Function <- tf_genes_Ccl5 %>% filter(TF.Name == "Cebpb") %>% dplyr::pull(TF.Function)

# Irf5
counts_in_vitro_df_Irf5_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Irf5") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Irf5_MTX <- counts_in_vitro_df_Irf5_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Irf5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Irf5_MTX$name <- rep("Irf5",5) 
counts_in_vitro_df_Irf5_MTX$TF.Function <- tf_genes_Ccl5 %>% filter(TF.Name == "Irf5") %>% dplyr::pull(TF.Function)


# Hif1a
counts_in_vitro_df_Hif1a_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Hif1a") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Hif1a_MTX <- counts_in_vitro_df_Hif1a_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Hif1a") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Hif1a_MTX$name <- rep("Hif1a",5) 
counts_in_vitro_df_Hif1a_MTX$TF.Function <- tf_genes_Ccl5 %>% filter(TF.Name == "Hif1a") %>% dplyr::pull(TF.Function)



counts_merged_Ccl5 <- rbind(counts_in_vitro_df_Nfkb1_MTX, counts_in_vitro_df_Irf2_MTX, counts_in_vitro_df_Sta3h_MTX, counts_in_vitro_df_Cebpb_MTX, counts_in_vitro_df_Irf5_MTX, counts_in_vitro_df_Hif1a_MTX)



ggplot(counts_merged_Ccl5, aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Ccl5_MTX, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Ccl5_MTX, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Ccl5_MTX, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Se18h", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Se18h", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of TFs targetting Ccl5 in MTX: Nfkb1 + Cebpb + Irf2 + Irf5 + Sta3h") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/Longitudinal_expression_of_TFs_targetting_Ccl5_in_MTX: Nfkb1 + Cebpb + Irf2 + Irf5 + Sta3h.png")

```



##### OXA

```{r}
# Ccl5
counts_in_vitro_df_Ccl5_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl5") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Ccl5_OXA <- counts_in_vitro_df_Ccl5_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl5_OXA$name <- rep("Ccl5",5)



# Nfkb1
counts_in_vitro_df_Nfkb1_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Nfkb1") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Nfkb1_OXA <- counts_in_vitro_df_Nfkb1_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Nfkb1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Nfkb1_OXA$name <- rep("Nfkb1",5)
counts_in_vitro_df_Nfkb1_OXA$TF.Function <- tf_genes_Ccl5 %>% filter(TF.Name == "Nfkb1") %>% dplyr::pull(TF.Function)

# Irf2
counts_in_vitro_df_Irf2_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Irf2") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Irf2_OXA <- counts_in_vitro_df_Irf2_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Irf2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Irf2_OXA$name <- rep("Irf2",5)
counts_in_vitro_df_Irf2_OXA$TF.Function <- tf_genes_Ccl5 %>% filter(TF.Name == "Irf2") %>% dplyr::pull(TF.Function)

# Sta3h
counts_in_vitro_df_Sta3h_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Sta3h") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Sta3h_OXA <- counts_in_vitro_df_Sta3h_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Sta3h") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Sta3h_OXA$name <- rep("Sta3h",5) 
counts_in_vitro_df_Sta3h_OXA$TF.Function <- tf_genes_Ccl5 %>% filter(TF.Name == "Sta3h") %>% dplyr::pull(TF.Function)

# Cebpb
counts_in_vitro_df_Cebpb_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Cebpb") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Cebpb_OXA <- counts_in_vitro_df_Cebpb_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cebpb") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cebpb_OXA$name <- rep("Cebpb",5) 
counts_in_vitro_df_Cebpb_OXA$TF.Function <- tf_genes_Ccl5 %>% filter(TF.Name == "Cebpb") %>% dplyr::pull(TF.Function)

# Irf5
counts_in_vitro_df_Irf5_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Irf5") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Irf5_OXA <- counts_in_vitro_df_Irf5_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Irf5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Irf5_OXA$name <- rep("Irf5",5) 
counts_in_vitro_df_Irf5_OXA$TF.Function <- tf_genes_Ccl5 %>% filter(TF.Name == "Irf5") %>% dplyr::pull(TF.Function)


# Hif1a
counts_in_vitro_df_Hif1a_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Hif1a") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Hif1a_OXA <- counts_in_vitro_df_Hif1a_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Hif1a") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Hif1a_OXA$name <- rep("Hif1a",5) 
counts_in_vitro_df_Hif1a_OXA$TF.Function <- tf_genes_Ccl5 %>% filter(TF.Name == "Hif1a") %>% dplyr::pull(TF.Function)



counts_merged_Ccl5 <- rbind(counts_in_vitro_df_Nfkb1_OXA, counts_in_vitro_df_Irf2_OXA, counts_in_vitro_df_Sta3h_OXA, counts_in_vitro_df_Cebpb_OXA, counts_in_vitro_df_Irf5_OXA, counts_in_vitro_df_Hif1a_OXA)



ggplot(counts_merged_Ccl5, aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Ccl5_OXA, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Ccl5_OXA, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Ccl5_OXA, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Se18h", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Se18h", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of TFs targetting Ccl5 in OXA: Nfkb1 + Cebpb + Irf2 + Irf5 + Sta3h") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/Longitudinal_expression_of_TFs_targetting_Ccl5_in_OXA: Nfkb1 + Cebpb + Irf2 + Irf5 + Sta3h.png")
```



## **Longitudinal expression of all the TFs (cytreg_v2+trust_v2) targetting Il6 and Ccl5**

### Il6 (in CIS)
```{r}

counts_in_vitro_df_Il6_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Il6") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Il6_CIS <- counts_in_vitro_df_Il6_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il6") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il6",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il6_CIS$name <- rep("Il6",5)

# 1 to 5
df_tf_Il6_CIS <- data.frame()
object_for_cytokine_expression_Il6 <- object_for_cytokine_expression %>% filter(rownames(.) %in% tf_genes_Il6$TF.Name) %>% dplyr::select(contains("CIS"))
for (i in 1:nrow(object_for_cytokine_expression_Il6)){
  
  counts_in_vitro_df_tf_Il6_CIS <- object_for_cytokine_expression_Il6 %>% dplyr::slice(i)
  counts_in_vitro_df_tf_Il6_CIS <- counts_in_vitro_df_tf_Il6_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>% dplyr::rename("Mean_Expression" = object_for_cytokine_expression_Il6 %>% dplyr::slice(i) %>% rownames()) %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
  counts_in_vitro_df_tf_Il6_CIS$name <- object_for_cytokine_expression_Il6 %>% dplyr::slice(i) %>% rownames()
  counts_in_vitro_df_tf_Il6_CIS$TF.Function <- tf_genes_Il6 %>% filter(TF.Name == object_for_cytokine_expression_Il6 %>% dplyr::slice(i) %>% rownames()) %>% dplyr::pull(TF.Function)
  df_tf_Il6_CIS <- rbind(df_tf_Il6_CIS, counts_in_vitro_df_tf_Il6_CIS)
}
saveRDS(df_tf_Il6_CIS, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tf_Il6_CIS_for_visualization_expression.rds")

# 1 to 4 TFs
tfs_il6_1_to_4 <- ggplot(df_tf_Il6_CIS[1:20,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_CIS, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_CIS, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_CIS, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in CIS-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_CIS_1_to_4.png")


# 5 to 8 TFs
tfs_il6_5_to_8 <- ggplot(df_tf_Il6_CIS[21:40,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_CIS, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_CIS, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_CIS, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in CIS-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_CIS_5_to_8.png")

# 9 to 12 TFs
tfs_il6_9_to_12 <- ggplot(df_tf_Il6_CIS[41:60,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_CIS, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_CIS, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_CIS, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in CIS-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_CIS_9_to_12.png")

# 13 to 16 TFs
tfs_il6_13_to_16 <- ggplot(df_tf_Il6_CIS[61:80,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_CIS, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_CIS, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_CIS, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs of Il6 in CIS-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_CIS_13_to_16.png")


# 17 to 20 TFs
tfs_il6_17_to_20 <- ggplot(df_tf_Il6_CIS[81:100,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_CIS, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_CIS, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_CIS, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in CIS-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_CIS_17_to_20.png")


# 21 to 24 TFs
tfs_il6_21_to_24 <- ggplot(df_tf_Il6_CIS[101:120,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_CIS, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_CIS, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_CIS, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs of Il6 in CIS-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_CIS_21_to_24.png")


# 25 to 29 TFs
tfs_il6_25_to_29 <- ggplot(df_tf_Il6_CIS[121:145,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_CIS, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_CIS, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_CIS, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in CIS-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_CIS_25_to_29.png")


```


### Il6 (in MTX)
```{r}

counts_in_vitro_df_Il6_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Il6") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Il6_MTX <- counts_in_vitro_df_Il6_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il6") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il6",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il6_MTX$name <- rep("Il6",5)

# 1 to 5
df_tf_Il6_CIS_MTX <- data.frame()
object_for_cytokine_expression_Il6 <- object_for_cytokine_expression %>% filter(rownames(.) %in% tf_genes_Il6$TF.Name) %>% dplyr::select(contains("MTX"))
for (i in 1:nrow(object_for_cytokine_expression_Il6)){
  
  counts_in_vitro_df_tf_Il6_CIS_MTX_MTX <- object_for_cytokine_expression_Il6 %>% dplyr::slice(i)
  counts_in_vitro_df_tf_Il6_CIS_MTX_MTX <- counts_in_vitro_df_tf_Il6_CIS_MTX_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>% dplyr::rename("Mean_Expression" = object_for_cytokine_expression_Il6 %>% dplyr::slice(i) %>% rownames()) %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
  counts_in_vitro_df_tf_Il6_CIS_MTX_MTX$name <- object_for_cytokine_expression_Il6 %>% dplyr::slice(i) %>% rownames()
  counts_in_vitro_df_tf_Il6_CIS_MTX_MTX$TF.Function <- tf_genes_Il6 %>% filter(TF.Name == object_for_cytokine_expression_Il6 %>% dplyr::slice(i) %>% rownames()) %>% dplyr::pull(TF.Function)
  df_tf_Il6_CIS_MTX <- rbind(df_tf_Il6_CIS_MTX, counts_in_vitro_df_tf_Il6_CIS_MTX_MTX)
}
saveRDS(df_tf_Il6_CIS_MTX, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tf_Il6_MTX_for_visualization_expression.rds")

# 1 to 4 TFs
tfs_il6_1_to_4 <- ggplot(df_tf_Il6_CIS_MTX[1:20,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_MTX, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_MTX, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_MTX, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in MTX-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_MTX_1_to_4.png")


# 5 to 8 TFs
tfs_il6_5_to_8 <- ggplot(df_tf_Il6_CIS_MTX[21:40,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_MTX, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_MTX, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_MTX, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in MTX-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_MTX_5_to_8.png")

# 9 to 12 TFs
tfs_il6_9_to_12 <- ggplot(df_tf_Il6_CIS_MTX[41:60,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_MTX, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_MTX, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_MTX, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in MTX-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_MTX_9_to_12.png")

# 13 to 16 TFs
tfs_il6_13_to_16 <- ggplot(df_tf_Il6_CIS_MTX[61:80,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_MTX, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_MTX, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_MTX, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in MTX-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_MTX_13_to_16.png")


# 17 to 20 TFs
tfs_il6_17_to_20 <- ggplot(df_tf_Il6_CIS_MTX[81:100,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_MTX, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_MTX, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_MTX, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in MTX-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_MTX_17_to_20.png")


# 21 to 24 TFs
tfs_il6_21_to_24 <- ggplot(df_tf_Il6_CIS_MTX[101:120,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_MTX, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_MTX, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_MTX, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs of Il6 in MTX-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_MTX_21_to_24.png")


# 25 to 29 TFs
tfs_il6_25_to_29 <- ggplot(df_tf_Il6_CIS_MTX[121:145,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_MTX, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_MTX, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_MTX, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in MTX-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_MTX_25_to_29.png")


```


### Il6 (in OXA)
```{r}

counts_in_vitro_df_Il6_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Il6") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Il6_OXA <- counts_in_vitro_df_Il6_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il6") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il6",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il6_OXA$name <- rep("Il6",5)

# 1 to 5
df_tf_Il6_OXA <- data.frame()
object_for_cytokine_expression_Il6 <- object_for_cytokine_expression %>% filter(rownames(.) %in% tf_genes_Il6$TF.Name) %>% dplyr::select(contains("OXA"))
for (i in 1:nrow(object_for_cytokine_expression_Il6)){
  
  counts_in_vitro_df_tf_Il6_OXA_OXA <- object_for_cytokine_expression_Il6 %>% dplyr::slice(i)
  counts_in_vitro_df_tf_Il6_OXA_OXA <- counts_in_vitro_df_tf_Il6_OXA_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>% dplyr::rename("Mean_Expression" = object_for_cytokine_expression_Il6 %>% dplyr::slice(i) %>% rownames()) %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
  counts_in_vitro_df_tf_Il6_OXA_OXA$name <- object_for_cytokine_expression_Il6 %>% dplyr::slice(i) %>% rownames()
  counts_in_vitro_df_tf_Il6_OXA_OXA$TF.Function <- tf_genes_Il6 %>% filter(TF.Name == object_for_cytokine_expression_Il6 %>% dplyr::slice(i) %>% rownames()) %>% dplyr::pull(TF.Function)
  df_tf_Il6_OXA <- rbind(df_tf_Il6_OXA, counts_in_vitro_df_tf_Il6_OXA_OXA)
}
saveRDS(df_tf_Il6_OXA, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tf_Il6_OXA_for_visualization_expression.rds")

# 1 to 4 TFs
tfs_il6_1_to_4 <- ggplot(df_tf_Il6_OXA[1:20,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_OXA, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_OXA, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_OXA, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in OXA-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_OXA_1_to_4.png")


# 5 to 8 TFs
tfs_il6_5_to_8 <- ggplot(df_tf_Il6_OXA[21:40,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_OXA, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_OXA, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_OXA, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in OXA-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_OXA_5_to_8.png")

# 9 to 12 TFs
tfs_il6_9_to_12 <- ggplot(df_tf_Il6_OXA[41:60,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_OXA, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_OXA, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_OXA, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in OXA-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_OXA_9_to_12.png")

# 13 to 16 TFs
tfs_il6_13_to_16 <- ggplot(df_tf_Il6_OXA[61:80,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_OXA, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_OXA, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_OXA, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in OXA-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_OXA_13_to_16.png")


# 17 to 20 TFs
tfs_il6_17_to_20 <- ggplot(df_tf_Il6_OXA[81:100,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_OXA, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_OXA, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_OXA, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in OXA-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_OXA_17_to_20.png")


# 21 to 24 TFs
tfs_il6_21_to_24 <- ggplot(df_tf_Il6_OXA[101:120,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_OXA, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_OXA, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_OXA, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs of Il6 in OXA-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_OXA_21_to_24.png")


# 25 to 29 TFs
tfs_il6_25_to_29 <- ggplot(df_tf_Il6_OXA[121:145,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_OXA, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_OXA, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_OXA, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in OXA-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_OXA_25_to_29.png")


```



### Il6 (in Control)
```{r}

counts_in_vitro_df_Il6_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Il6") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Il6_Control <- counts_in_vitro_df_Il6_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il6") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il6",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il6_Control$name <- rep("Il6",5)

# 1 to 5
df_tf_Il6_Control <- data.frame()
object_for_cytokine_expression_Il6 <- object_for_cytokine_expression %>% filter(rownames(.) %in% tf_genes_Il6$TF.Name) %>% dplyr::select(contains("Control"))
for (i in 1:nrow(object_for_cytokine_expression_Il6)){
  
  counts_in_vitro_df_tf_Il6_Control_Control <- object_for_cytokine_expression_Il6 %>% dplyr::slice(i)
  counts_in_vitro_df_tf_Il6_Control_Control <- counts_in_vitro_df_tf_Il6_Control_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>% dplyr::rename("Mean_Expression" = object_for_cytokine_expression_Il6 %>% dplyr::slice(i) %>% rownames()) %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
  counts_in_vitro_df_tf_Il6_Control_Control$name <- object_for_cytokine_expression_Il6 %>% dplyr::slice(i) %>% rownames()
  counts_in_vitro_df_tf_Il6_Control_Control$TF.Function <- tf_genes_Il6 %>% filter(TF.Name == object_for_cytokine_expression_Il6 %>% dplyr::slice(i) %>% rownames()) %>% dplyr::pull(TF.Function)
  df_tf_Il6_Control <- rbind(df_tf_Il6_Control, counts_in_vitro_df_tf_Il6_Control_Control)
}
saveRDS(df_tf_Il6_Control, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tf_Il6_Control_for_visualization_expression.rds")

# 1 to 4 TFs
tfs_il6_1_to_4 <- ggplot(df_tf_Il6_Control[1:20,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_Control, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_Control, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_Control, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in Control-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_Control_1_to_4.png")


# 5 to 8 TFs
tfs_il6_5_to_8 <- ggplot(df_tf_Il6_Control[21:40,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_Control, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_Control, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_Control, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in Control-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_Control_5_to_8.png")

# 9 to 12 TFs
tfs_il6_9_to_12 <- ggplot(df_tf_Il6_Control[41:60,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_Control, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_Control, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_Control, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in Control-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_Control_9_to_12.png")

# 13 to 16 TFs
tfs_il6_13_to_16 <- ggplot(df_tf_Il6_Control[61:80,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_Control, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_Control, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_Control, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in Control-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_Control_13_to_16.png")


# 17 to 20 TFs
tfs_il6_17_to_20 <- ggplot(df_tf_Il6_Control[81:100,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_Control, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_Control, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_Control, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in Control-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_Control_17_to_20.png")


# 21 to 24 TFs
tfs_il6_21_to_24 <- ggplot(df_tf_Il6_Control[101:120,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_Control, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_Control, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_Control, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs of Il6 in Control-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_Control_21_to_24.png")


# 25 to 29 TFs
tfs_il6_25_to_29 <- ggplot(df_tf_Il6_Control[121:145,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Il6_Control, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_Control, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Il6_Control, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Il6 in Control-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Il6_longitudinal_expression_Control_25_to_29.png")


```






### Il6 + Foxp1 (in PBS+MTX+OXA+CIS)
```{r}
df_Foxp1_Il6_MTX <- df_tf_Il6_MTX %>% filter(name == "Foxp1") %>% dplyr::mutate("treatment_group" = "MTX")
counts_in_vitro_df_Il6_MTX_for_Foxp1 <- counts_in_vitro_df_Il6_MTX %>% dplyr::mutate("treatment_group" = "MTX") 


df_Foxp1_Il6_OXA <- df_tf_Il6_OXA %>% filter(name == "Foxp1")  %>% dplyr::mutate("treatment_group" = "OXA")
counts_in_vitro_df_Il6_OXA_for_Foxp1 <- counts_in_vitro_df_Il6_OXA %>% dplyr::mutate("treatment_group" = "OXA") 


df_Foxp1_Il6_CIS <- df_tf_Il6_CIS %>% filter(name == "Foxp1")  %>% dplyr::mutate("treatment_group" = "CIS")
counts_in_vitro_df_Il6_CIS_for_Foxp1 <- counts_in_vitro_df_Il6_CIS %>% dplyr::mutate("treatment_group" = "CIS") 


df_Foxp1_Il6_Control <- df_tf_Il6_Control %>% filter(name == "Foxp1")  %>% dplyr::mutate("treatment_group" = "Control")
counts_in_vitro_df_Il6_Control_for_Foxp1 <- counts_in_vitro_df_Il6_Control %>% dplyr::mutate("treatment_group" = "Control")

df_Foxp1_all <- rbind(df_Foxp1_Il6_MTX, df_Foxp1_Il6_OXA, df_Foxp1_Il6_CIS, df_Foxp1_Il6_Control)
counts_in_vitro_df_Il6_all_for_Foxp1 <- rbind(counts_in_vitro_df_Il6_MTX_for_Foxp1, counts_in_vitro_df_Il6_OXA_for_Foxp1, counts_in_vitro_df_Il6_CIS_for_Foxp1, counts_in_vitro_df_Il6_Control_for_Foxp1)


ggplot(df_Foxp1_all, aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(color=treatment_group, fill=treatment_group)) +
  geom_point(data=counts_in_vitro_df_Il6_all_for_Foxp1, aes(color=treatment_group, fill=treatment_group), size=2, shape=21) +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Il6_all_for_Foxp1, aes(label=name, fill=treatment_group), label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=treatment_group), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color = treatment_group, group=treatment_group)) +
  geom_line(data=counts_in_vitro_df_Il6_all_for_Foxp1, aes(color=treatment_group, group=treatment_group)) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Foxp1+Il6 in MTX/OXA/CIS/PBS tumours") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Foxp1_Il6_longitudinal_expression_treated_untreated.png")
```


```{r}
# 3h
Foxp1_expression_3h <- object_for_cytokine_expression %>% filter(rownames(.) == "Foxp1") %>% dplyr::select(contains("3h"))



contrast_MTX_3h_vs_OXA_3h <- makeContrasts(OXA_MTX_3h = OXA_3h - MTX_3h, levels = dsgn)
fit_contrast_MTX_3h_vs_OXA_3h <- contrasts.fit(fit_dea, contrast_MTX_3h_vs_OXA_3h)
fit_contrast_MTX_3h_vs_OXA_3h <- eBayes(fit_contrast_MTX_3h_vs_OXA_3h)
table_MTX_3h_OXA_3h <- topTable(fit_contrast_MTX_3h_vs_OXA_3h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "OXA_3h - MTX_3h")


contrast_CIS_3h_vs_OXA_3h <- makeContrasts(OXA_CIS_3h = OXA_3h - CIS_3h, levels = dsgn)
fit_contrast_CIS_3h_vs_OXA_3h <- contrasts.fit(fit_dea, contrast_CIS_3h_vs_OXA_3h)
fit_contrast_CIS_3h_vs_OXA_3h <- eBayes(fit_contrast_CIS_3h_vs_OXA_3h)
table_CIS_3h_OXA_3h <- topTable(fit_contrast_CIS_3h_vs_OXA_3h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "OXA_3h - CIS_3h")


contrast_MTX_3h_vs_CIS_3h <- makeContrasts(CIS_MTX_3h = CIS_3h - MTX_3h, levels = dsgn)
fit_contrast_MTX_3h_vs_CIS_3h <- contrasts.fit(fit_dea, contrast_MTX_3h_vs_CIS_3h)
fit_contrast_MTX_3h_vs_CIS_3h <- eBayes(fit_contrast_MTX_3h_vs_CIS_3h)
table_MTX_3h_CIS_3h <- topTable(fit_contrast_MTX_3h_vs_CIS_3h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "CIS_3h - MTX_3h")


contrast_Control_3h_vs_MTX_3h <- makeContrasts(MTX_3h_Control_3h = MTX_3h - Control_3h, levels = dsgn)
fit_contrast_Control_3h_vs_MTX_3h <- contrasts.fit(fit_dea, contrast_Control_3h_vs_MTX_3h)
fit_contrast_Control_3h_vs_MTX_3h <- eBayes(fit_contrast_Control_3h_vs_MTX_3h)
table_Control_3h_MTX_3h <- topTable(fit_contrast_Control_3h_vs_MTX_3h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "MTX_3h - Control_3h")


contrast_Control_3h_vs_OXA_3h <- makeContrasts(OXA_3h_Control_3h = OXA_3h - Control_3h, levels = dsgn)
fit_contrast_Control_3h_vs_OXA_3h <- contrasts.fit(fit_dea, contrast_Control_3h_vs_OXA_3h)
fit_contrast_Control_3h_vs_OXA_3h <- eBayes(fit_contrast_Control_3h_vs_OXA_3h)
table_Control_3h_OXA_3h <- topTable(fit_contrast_Control_3h_vs_OXA_3h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "OXA_3h - Control_3h")


contrast_Control_3h_vs_CIS_3h <- makeContrasts(CIS_3h_Control_3h = CIS_3h - Control_3h, levels = dsgn)
fit_contrast_Control_3h_vs_CIS_3h <- contrasts.fit(fit_dea, contrast_Control_3h_vs_CIS_3h)
fit_contrast_Control_3h_vs_CIS_3h <- eBayes(fit_contrast_Control_3h_vs_CIS_3h)
table_Control_3h_CIS_3h <- topTable(fit_contrast_Control_3h_vs_CIS_3h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "CIS_3h - Control_3h")

Foxp1_table_stats_comparison_3h <- rbind(table_MTX_3h_OXA_3h, table_CIS_3h_OXA_3h, table_MTX_3h_CIS_3h, table_Control_3h_MTX_3h, table_Control_3h_OXA_3h, table_Control_3h_CIS_3h)





# 6h
Foxp1_expression_6h <- object_for_cytokine_expression %>% filter(rownames(.) == "Foxp1") %>% dplyr::select(contains("6h"))



contrast_MTX_6h_vs_OXA_6h <- makeContrasts(OXA_MTX_6h = OXA_6h - MTX_6h, levels = dsgn)
fit_contrast_MTX_6h_vs_OXA_6h <- contrasts.fit(fit_dea, contrast_MTX_6h_vs_OXA_6h)
fit_contrast_MTX_6h_vs_OXA_6h <- eBayes(fit_contrast_MTX_6h_vs_OXA_6h)
table_MTX_6h_OXA_6h <- topTable(fit_contrast_MTX_6h_vs_OXA_6h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "OXA_6h - MTX_6h")


contrast_CIS_6h_vs_OXA_6h <- makeContrasts(OXA_CIS_6h = OXA_6h - CIS_6h, levels = dsgn)
fit_contrast_CIS_6h_vs_OXA_6h <- contrasts.fit(fit_dea, contrast_CIS_6h_vs_OXA_6h)
fit_contrast_CIS_6h_vs_OXA_6h <- eBayes(fit_contrast_CIS_6h_vs_OXA_6h)
table_CIS_6h_OXA_6h <- topTable(fit_contrast_CIS_6h_vs_OXA_6h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "OXA_6h - CIS_6h")


contrast_MTX_6h_vs_CIS_6h <- makeContrasts(CIS_MTX_6h = CIS_6h - MTX_6h, levels = dsgn)
fit_contrast_MTX_6h_vs_CIS_6h <- contrasts.fit(fit_dea, contrast_MTX_6h_vs_CIS_6h)
fit_contrast_MTX_6h_vs_CIS_6h <- eBayes(fit_contrast_MTX_6h_vs_CIS_6h)
table_MTX_6h_CIS_6h <- topTable(fit_contrast_MTX_6h_vs_CIS_6h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "CIS_6h - MTX_6h")


contrast_Control_6h_vs_MTX_6h <- makeContrasts(MTX_6h_Control_6h = MTX_6h - Control_6h, levels = dsgn)
fit_contrast_Control_6h_vs_MTX_6h <- contrasts.fit(fit_dea, contrast_Control_6h_vs_MTX_6h)
fit_contrast_Control_6h_vs_MTX_6h <- eBayes(fit_contrast_Control_6h_vs_MTX_6h)
table_Control_6h_MTX_6h <- topTable(fit_contrast_Control_6h_vs_MTX_6h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "MTX_6h - Control_6h")


contrast_Control_6h_vs_OXA_6h <- makeContrasts(OXA_6h_Control_6h = OXA_6h - Control_6h, levels = dsgn)
fit_contrast_Control_6h_vs_OXA_6h <- contrasts.fit(fit_dea, contrast_Control_6h_vs_OXA_6h)
fit_contrast_Control_6h_vs_OXA_6h <- eBayes(fit_contrast_Control_6h_vs_OXA_6h)
table_Control_6h_OXA_6h <- topTable(fit_contrast_Control_6h_vs_OXA_6h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "OXA_6h - Control_6h")


contrast_Control_6h_vs_CIS_6h <- makeContrasts(CIS_6h_Control_6h = CIS_6h - Control_6h, levels = dsgn)
fit_contrast_Control_6h_vs_CIS_6h <- contrasts.fit(fit_dea, contrast_Control_6h_vs_CIS_6h)
fit_contrast_Control_6h_vs_CIS_6h <- eBayes(fit_contrast_Control_6h_vs_CIS_6h)
table_Control_6h_CIS_6h <- topTable(fit_contrast_Control_6h_vs_CIS_6h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "CIS_6h - Control_6h")

Foxp1_table_stats_comparison_6h <- rbind(table_MTX_6h_OXA_6h, table_CIS_6h_OXA_6h, table_MTX_6h_CIS_6h, table_Control_6h_MTX_6h, table_Control_6h_OXA_6h, table_Control_6h_CIS_6h)





# 12h
Foxp1_expression_12h <- object_for_cytokine_expression %>% filter(rownames(.) == "Foxp1") %>% dplyr::select(contains("12h"))



contrast_MTX_12h_vs_OXA_12h <- makeContrasts(OXA_MTX_12h = OXA_12h - MTX_12h, levels = dsgn)
fit_contrast_MTX_12h_vs_OXA_12h <- contrasts.fit(fit_dea, contrast_MTX_12h_vs_OXA_12h)
fit_contrast_MTX_12h_vs_OXA_12h <- eBayes(fit_contrast_MTX_12h_vs_OXA_12h)
table_MTX_12h_OXA_12h <- topTable(fit_contrast_MTX_12h_vs_OXA_12h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "OXA_12h - MTX_12h")


contrast_CIS_12h_vs_OXA_12h <- makeContrasts(OXA_CIS_12h = OXA_12h - CIS_12h, levels = dsgn)
fit_contrast_CIS_12h_vs_OXA_12h <- contrasts.fit(fit_dea, contrast_CIS_12h_vs_OXA_12h)
fit_contrast_CIS_12h_vs_OXA_12h <- eBayes(fit_contrast_CIS_12h_vs_OXA_12h)
table_CIS_12h_OXA_12h <- topTable(fit_contrast_CIS_12h_vs_OXA_12h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "OXA_12h - CIS_12h")


contrast_MTX_12h_vs_CIS_12h <- makeContrasts(CIS_MTX_12h = CIS_12h - MTX_12h, levels = dsgn)
fit_contrast_MTX_12h_vs_CIS_12h <- contrasts.fit(fit_dea, contrast_MTX_12h_vs_CIS_12h)
fit_contrast_MTX_12h_vs_CIS_12h <- eBayes(fit_contrast_MTX_12h_vs_CIS_12h)
table_MTX_12h_CIS_12h <- topTable(fit_contrast_MTX_12h_vs_CIS_12h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "CIS_12h - MTX_12h")


contrast_Control_12h_vs_MTX_12h <- makeContrasts(MTX_12h_Control_12h = MTX_12h - Control_12h, levels = dsgn)
fit_contrast_Control_12h_vs_MTX_12h <- contrasts.fit(fit_dea, contrast_Control_12h_vs_MTX_12h)
fit_contrast_Control_12h_vs_MTX_12h <- eBayes(fit_contrast_Control_12h_vs_MTX_12h)
table_Control_12h_MTX_12h <- topTable(fit_contrast_Control_12h_vs_MTX_12h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "MTX_12h - Control_12h")


contrast_Control_12h_vs_OXA_12h <- makeContrasts(OXA_12h_Control_12h = OXA_12h - Control_12h, levels = dsgn)
fit_contrast_Control_12h_vs_OXA_12h <- contrasts.fit(fit_dea, contrast_Control_12h_vs_OXA_12h)
fit_contrast_Control_12h_vs_OXA_12h <- eBayes(fit_contrast_Control_12h_vs_OXA_12h)
table_Control_12h_OXA_12h <- topTable(fit_contrast_Control_12h_vs_OXA_12h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "OXA_12h - Control_12h")


contrast_Control_12h_vs_CIS_12h <- makeContrasts(CIS_12h_Control_12h = CIS_12h - Control_12h, levels = dsgn)
fit_contrast_Control_12h_vs_CIS_12h <- contrasts.fit(fit_dea, contrast_Control_12h_vs_CIS_12h)
fit_contrast_Control_12h_vs_CIS_12h <- eBayes(fit_contrast_Control_12h_vs_CIS_12h)
table_Control_12h_CIS_12h <- topTable(fit_contrast_Control_12h_vs_CIS_12h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "CIS_12h - Control_12h")

Foxp1_table_stats_comparison_12h <- rbind(table_MTX_12h_OXA_12h, table_CIS_12h_OXA_12h, table_MTX_12h_CIS_12h, table_Control_12h_MTX_12h, table_Control_12h_OXA_12h, table_Control_12h_CIS_12h)





# 18h
Foxp1_expression_18h <- object_for_cytokine_expression %>% filter(rownames(.) == "Foxp1") %>% dplyr::select(contains("18h"))



contrast_MTX_18h_vs_OXA_18h <- makeContrasts(OXA_MTX_18h = OXA_18h - MTX_18h, levels = dsgn)
fit_contrast_MTX_18h_vs_OXA_18h <- contrasts.fit(fit_dea, contrast_MTX_18h_vs_OXA_18h)
fit_contrast_MTX_18h_vs_OXA_18h <- eBayes(fit_contrast_MTX_18h_vs_OXA_18h)
table_MTX_18h_OXA_18h <- topTable(fit_contrast_MTX_18h_vs_OXA_18h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "OXA_18h - MTX_18h")


contrast_CIS_18h_vs_OXA_18h <- makeContrasts(OXA_CIS_18h = OXA_18h - CIS_18h, levels = dsgn)
fit_contrast_CIS_18h_vs_OXA_18h <- contrasts.fit(fit_dea, contrast_CIS_18h_vs_OXA_18h)
fit_contrast_CIS_18h_vs_OXA_18h <- eBayes(fit_contrast_CIS_18h_vs_OXA_18h)
table_CIS_18h_OXA_18h <- topTable(fit_contrast_CIS_18h_vs_OXA_18h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "OXA_18h - CIS_18h")


contrast_MTX_18h_vs_CIS_18h <- makeContrasts(CIS_MTX_18h = CIS_18h - MTX_18h, levels = dsgn)
fit_contrast_MTX_18h_vs_CIS_18h <- contrasts.fit(fit_dea, contrast_MTX_18h_vs_CIS_18h)
fit_contrast_MTX_18h_vs_CIS_18h <- eBayes(fit_contrast_MTX_18h_vs_CIS_18h)
table_MTX_18h_CIS_18h <- topTable(fit_contrast_MTX_18h_vs_CIS_18h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "CIS_18h - MTX_18h")


contrast_Control_18h_vs_MTX_18h <- makeContrasts(MTX_18h_Control_18h = MTX_18h - Control_18h, levels = dsgn)
fit_contrast_Control_18h_vs_MTX_18h <- contrasts.fit(fit_dea, contrast_Control_18h_vs_MTX_18h)
fit_contrast_Control_18h_vs_MTX_18h <- eBayes(fit_contrast_Control_18h_vs_MTX_18h)
table_Control_18h_MTX_18h <- topTable(fit_contrast_Control_18h_vs_MTX_18h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "MTX_18h - Control_18h")


contrast_Control_18h_vs_OXA_18h <- makeContrasts(OXA_18h_Control_18h = OXA_18h - Control_18h, levels = dsgn)
fit_contrast_Control_18h_vs_OXA_18h <- contrasts.fit(fit_dea, contrast_Control_18h_vs_OXA_18h)
fit_contrast_Control_18h_vs_OXA_18h <- eBayes(fit_contrast_Control_18h_vs_OXA_18h)
table_Control_18h_OXA_18h <- topTable(fit_contrast_Control_18h_vs_OXA_18h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "OXA_18h - Control_18h")


contrast_Control_18h_vs_CIS_18h <- makeContrasts(CIS_18h_Control_18h = CIS_18h - Control_18h, levels = dsgn)
fit_contrast_Control_18h_vs_CIS_18h <- contrasts.fit(fit_dea, contrast_Control_18h_vs_CIS_18h)
fit_contrast_Control_18h_vs_CIS_18h <- eBayes(fit_contrast_Control_18h_vs_CIS_18h)
table_Control_18h_CIS_18h <- topTable(fit_contrast_Control_18h_vs_CIS_18h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "CIS_18h - Control_18h")

Foxp1_table_stats_comparison_18h <- rbind(table_MTX_18h_OXA_18h, table_CIS_18h_OXA_18h, table_MTX_18h_CIS_18h, table_Control_18h_MTX_18h, table_Control_18h_OXA_18h, table_Control_18h_CIS_18h)






# 24h
Foxp1_expression_24h <- object_for_cytokine_expression %>% filter(rownames(.) == "Foxp1") %>% dplyr::select(contains("24h"))



contrast_MTX_24h_vs_OXA_24h <- makeContrasts(OXA_MTX_24h = OXA_24h - MTX_24h, levels = dsgn)
fit_contrast_MTX_24h_vs_OXA_24h <- contrasts.fit(fit_dea, contrast_MTX_24h_vs_OXA_24h)
fit_contrast_MTX_24h_vs_OXA_24h <- eBayes(fit_contrast_MTX_24h_vs_OXA_24h)
table_MTX_24h_OXA_24h <- topTable(fit_contrast_MTX_24h_vs_OXA_24h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "OXA_24h - MTX_24h")


contrast_CIS_24h_vs_OXA_24h <- makeContrasts(OXA_CIS_24h = OXA_24h - CIS_24h, levels = dsgn)
fit_contrast_CIS_24h_vs_OXA_24h <- contrasts.fit(fit_dea, contrast_CIS_24h_vs_OXA_24h)
fit_contrast_CIS_24h_vs_OXA_24h <- eBayes(fit_contrast_CIS_24h_vs_OXA_24h)
table_CIS_24h_OXA_24h <- topTable(fit_contrast_CIS_24h_vs_OXA_24h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "OXA_24h - CIS_24h")


contrast_MTX_24h_vs_CIS_24h <- makeContrasts(CIS_MTX_24h = CIS_24h - MTX_24h, levels = dsgn)
fit_contrast_MTX_24h_vs_CIS_24h <- contrasts.fit(fit_dea, contrast_MTX_24h_vs_CIS_24h)
fit_contrast_MTX_24h_vs_CIS_24h <- eBayes(fit_contrast_MTX_24h_vs_CIS_24h)
table_MTX_24h_CIS_24h <- topTable(fit_contrast_MTX_24h_vs_CIS_24h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "CIS_24h - MTX_24h")


contrast_Control_24h_vs_MTX_24h <- makeContrasts(MTX_24h_Control_24h = MTX_24h - Control_24h, levels = dsgn)
fit_contrast_Control_24h_vs_MTX_24h <- contrasts.fit(fit_dea, contrast_Control_24h_vs_MTX_24h)
fit_contrast_Control_24h_vs_MTX_24h <- eBayes(fit_contrast_Control_24h_vs_MTX_24h)
table_Control_24h_MTX_24h <- topTable(fit_contrast_Control_24h_vs_MTX_24h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "MTX_24h - Control_24h")


contrast_Control_24h_vs_OXA_24h <- makeContrasts(OXA_24h_Control_24h = OXA_24h - Control_24h, levels = dsgn)
fit_contrast_Control_24h_vs_OXA_24h <- contrasts.fit(fit_dea, contrast_Control_24h_vs_OXA_24h)
fit_contrast_Control_24h_vs_OXA_24h <- eBayes(fit_contrast_Control_24h_vs_OXA_24h)
table_Control_24h_OXA_24h <- topTable(fit_contrast_Control_24h_vs_OXA_24h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "OXA_24h - Control_24h")


contrast_Control_24h_vs_CIS_24h <- makeContrasts(CIS_24h_Control_24h = CIS_24h - Control_24h, levels = dsgn)
fit_contrast_Control_24h_vs_CIS_24h <- contrasts.fit(fit_dea, contrast_Control_24h_vs_CIS_24h)
fit_contrast_Control_24h_vs_CIS_24h <- eBayes(fit_contrast_Control_24h_vs_CIS_24h)
table_Control_24h_CIS_24h <- topTable(fit_contrast_Control_24h_vs_CIS_24h, sort.by = "P", adjust.method = "BH", number = Inf) %>% filter(genes == "Foxp1") %>% dplyr::mutate("contrast" = "CIS_24h - Control_24h")

Foxp1_table_stats_comparison_24h <- rbind(table_MTX_24h_OXA_24h, table_CIS_24h_OXA_24h, table_MTX_24h_CIS_24h, table_Control_24h_MTX_24h, table_Control_24h_OXA_24h, table_Control_24h_CIS_24h)



Foxp1_table_stats_comparison_all_timepoint <- rbind(Foxp1_table_stats_comparison_3h, Foxp1_table_stats_comparison_6h, Foxp1_table_stats_comparison_12h, Foxp1_table_stats_comparison_18h, Foxp1_table_stats_comparison_24h) %>% remove_rownames()
write.csv(Foxp1_table_stats_comparison_all_timepoint, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Foxp1_table_stats_comparisons.csv", col.names = TRUE, quote = FALSE, row.names = FALSE) 


```




### Ccl5 (in MTX)
```{r}

counts_in_vitro_df_Ccl5_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl5") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Ccl5_MTX <- counts_in_vitro_df_Ccl5_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl5_MTX$name <- rep("Ccl5",5)



df_tf_Ccl5 <- data.frame()
object_for_cytokine_expression_Ccl5 <- object_for_cytokine_expression %>% filter(rownames(.) %in% tf_genes_Ccl5$TF.Name) %>% dplyr::select(contains("MTX"))
for (i in 1:nrow(object_for_cytokine_expression_Ccl5)){
  
  counts_in_vitro_df_tf_Ccl5_MTX <- object_for_cytokine_expression_Ccl5 %>% dplyr::slice(i)
  counts_in_vitro_df_tf_Ccl5_MTX <- counts_in_vitro_df_tf_Ccl5_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>% dplyr::rename("Mean_Expression" = object_for_cytokine_expression_Ccl5 %>% dplyr::slice(i) %>% rownames()) %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
  counts_in_vitro_df_tf_Ccl5_MTX$name <- object_for_cytokine_expression_Ccl5 %>% dplyr::slice(i) %>% rownames()
  counts_in_vitro_df_tf_Ccl5_MTX$TF.Function <- tf_genes_Ccl5 %>% filter(TF.Name == object_for_cytokine_expression_Ccl5 %>% dplyr::slice(i) %>% rownames()) %>% dplyr::pull(TF.Function)
  df_tf_Ccl5 <- rbind(df_tf_Ccl5, counts_in_vitro_df_tf_Ccl5_MTX)
}
saveRDS(df_tf_Ccl5, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tf_Ccl5_for_visualization_expression.rds")



# 1 to 4 TFs
tfs_Ccl5_1_to_4 <- ggplot(df_tf_Ccl5[1:20,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Ccl5_MTX, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Ccl5_MTX, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Ccl5_MTX, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Ccl5 in MTX-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Ccl5_longitudinal_expression_MTX_1_to_4.png")

# 5 to 8 TFs
tfs_Ccl5_5_to_8 <- ggplot(df_tf_Ccl5[21:40,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Ccl5_MTX, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Ccl5_MTX, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Ccl5_MTX, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Ccl5 in MTX-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Ccl5_longitudinal_expression_MTX_5_to_8.png")


# 9 to 12 TFs
tfs_Ccl5_9_to_12 <- ggplot(df_tf_Ccl5[41:60,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Ccl5_MTX, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Ccl5_MTX, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Ccl5_MTX, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Ccl5 in MTX-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Ccl5_longitudinal_expression_MTX_9_to_12.png")

# 13 to 17 TFs
tfs_Ccl5_13_to_16 <- ggplot(df_tf_Ccl5[61:85,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Ccl5_MTX, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Ccl5_MTX, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Ccl5_MTX, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Ccl5 in MTX-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Ccl5_longitudinal_expression_MTX_13_to_17.png")

```





### Ccl5 (in OXA)
```{r}

counts_in_vitro_df_Ccl5_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl5") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Ccl5_OXA <- counts_in_vitro_df_Ccl5_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl5_OXA$name <- rep("Ccl5",5)




df_tf_Ccl5 <- data.frame()
object_for_cytokine_expression_Ccl5 <- object_for_cytokine_expression %>% filter(rownames(.) %in% tf_genes_Ccl5$TF.Name) %>% dplyr::select(contains("OXA"))
for (i in 1:nrow(object_for_cytokine_expression_Ccl5)){
  
  counts_in_vitro_df_tf_Ccl5_OXA <- object_for_cytokine_expression_Ccl5 %>% dplyr::slice(i)
  counts_in_vitro_df_tf_Ccl5_OXA <- counts_in_vitro_df_tf_Ccl5_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>% dplyr::rename("Mean_Expression" = object_for_cytokine_expression_Ccl5 %>% dplyr::slice(i) %>% rownames()) %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
  counts_in_vitro_df_tf_Ccl5_OXA$name <- object_for_cytokine_expression_Ccl5 %>% dplyr::slice(i) %>% rownames()
  counts_in_vitro_df_tf_Ccl5_OXA$TF.Function <- tf_genes_Ccl5 %>% filter(TF.Name == object_for_cytokine_expression_Ccl5 %>% dplyr::slice(i) %>% rownames()) %>% dplyr::pull(TF.Function)
  df_tf_Ccl5 <- rbind(df_tf_Ccl5, counts_in_vitro_df_tf_Ccl5_OXA)
}
saveRDS(df_tf_Ccl5, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tf_Ccl5_for_visualization_expression.rds")



# 1 to 4 TFs
tfs_Ccl5_1_to_4 <- ggplot(df_tf_Ccl5[1:20,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Ccl5_OXA, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Ccl5_OXA, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Ccl5_OXA, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Ccl5 in OXA-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Ccl5_longitudinal_expression_OXA_1_to_4.png")

# 5 to 8 TFs
tfs_Ccl5_5_to_8 <- ggplot(df_tf_Ccl5[21:40,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Ccl5_OXA, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Ccl5_OXA, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Ccl5_OXA, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Ccl5 in OXA-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Ccl5_longitudinal_expression_OXA_5_to_8.png")


# 9 to 12 TFs
tfs_Ccl5_9_to_12 <- ggplot(df_tf_Ccl5[41:60,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Ccl5_OXA, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Ccl5_OXA, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Ccl5_OXA, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Ccl5 in OXA-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Ccl5_longitudinal_expression_OXA_9_to_12.png")

# 13 to 17 TFs
tfs_Ccl5_13_to_16 <- ggplot(df_tf_Ccl5[61:85,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Ccl5_OXA, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Ccl5_OXA, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Ccl5_OXA, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Ccl5 in OXA-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Ccl5_longitudinal_expression_OXA_13_to_17.png")

```


### Ccl5 (in CIS)
```{r}

counts_in_vitro_df_Ccl5_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl5") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Ccl5_CIS <- counts_in_vitro_df_Ccl5_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl5_CIS$name <- rep("Ccl5",5)



df_tf_Ccl5 <- data.frame()
object_for_cytokine_expression_Ccl5 <- object_for_cytokine_expression %>% filter(rownames(.) %in% tf_genes_Ccl5$TF.Name) %>% dplyr::select(contains("CIS"))
for (i in 1:nrow(object_for_cytokine_expression_Ccl5)){
  
  counts_in_vitro_df_tf_Ccl5_CIS <- object_for_cytokine_expression_Ccl5 %>% dplyr::slice(i)
  counts_in_vitro_df_tf_Ccl5_CIS <- counts_in_vitro_df_tf_Ccl5_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>% dplyr::rename("Mean_Expression" = object_for_cytokine_expression_Ccl5 %>% dplyr::slice(i) %>% rownames()) %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3))) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
  counts_in_vitro_df_tf_Ccl5_CIS$name <- object_for_cytokine_expression_Ccl5 %>% dplyr::slice(i) %>% rownames()
  counts_in_vitro_df_tf_Ccl5_CIS$TF.Function <- tf_genes_Ccl5 %>% filter(TF.Name == object_for_cytokine_expression_Ccl5 %>% dplyr::slice(i) %>% rownames()) %>% dplyr::pull(TF.Function)
  df_tf_Ccl5 <- rbind(df_tf_Ccl5, counts_in_vitro_df_tf_Ccl5_CIS)
}
saveRDS(df_tf_Ccl5, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tf_Ccl5_for_visualization_expression.rds")



# 1 to 4 TFs
tfs_Ccl5_1_to_4 <- ggplot(df_tf_Ccl5[1:20,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Ccl5_CIS, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Ccl5_CIS, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Ccl5_CIS, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Ccl5 in CIS-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Ccl5_longitudinal_expression_CIS_1_to_4.png")

# 5 to 8 TFs
tfs_Ccl5_5_to_8 <- ggplot(df_tf_Ccl5[21:40,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Ccl5_CIS, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Ccl5_CIS, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Ccl5_CIS, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Ccl5 in CIS-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Ccl5_longitudinal_expression_CIS_5_to_8.png")


# 9 to 12 TFs
tfs_Ccl5_9_to_12 <- ggplot(df_tf_Ccl5[41:60,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Ccl5_CIS, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Ccl5_CIS, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Ccl5_CIS, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Ccl5 in CIS-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Ccl5_longitudinal_expression_CIS_9_to_12.png")

# 13 to 17 TFs
tfs_Ccl5_13_to_16 <- ggplot(df_tf_Ccl5[61:85,], aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size=2, shape=21, aes(fill=TF.Function)) +
  geom_point(data=counts_in_vitro_df_Ccl5_CIS, color="tomato", size=2, shape=21, fill="tomato") +
  ggrepel::geom_label_repel(data=counts_in_vitro_df_Ccl5_CIS, aes(label=name), fill="tomato", label.padding = 0.10, label.size=0.15)+
  ggrepel::geom_label_repel(aes(label = name, fill=TF.Function), label.size = 0.15, label.padding = 0.10) +   
  geom_line(aes(color=TF.Function, group=name)) +
  geom_line(data=counts_in_vitro_df_Ccl5_CIS, aes(group=name), color="tomato") +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Function") +
  ggtitle("Longitudinal expression of the TFs (Cytreg_v2 + Trust_v2) of Ccl5 in CIS-treated tumors") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/tfs_Ccl5_longitudinal_expression_CIS_13_to_17.png")

```
















### Enrichment (at 24h)

#### GO


#### up
```{r}
get_go_results_up_genes <- function(diff_genes, timepoint){
  diff_genes_up <- diff_genes %>% dplyr::filter(group == "up")
  diff_genes_up_id <- bitr(diff_genes_up$genes, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = "org.Mm.eg.db")
  diff_genes_up_list <- list(genes = diff_genes_up_id$ENTREZID)
  go_analysis_diff_genes_up_list <- enrichGO(diff_genes_up_list$genes, ont="BP", OrgDb = "org.Mm.eg.db", readable = TRUE)
  go_analysis_up <- go_analysis_diff_genes_up_list %>% dplyr::mutate(prop_overlap  = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")) * 100,
                                                     Biological_Processes = Description)
  ordered_go_analysis_up <- go_analysis_up[order(go_analysis_up$prop_overlap, decreasing = TRUE),]
  write.csv(ordered_go_analysis_up, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/",timepoint,"/enriched_go_terms_up_reg_genes.csv"))
  
png(filename = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS", timepoint,"/enrich_plot_up_reg_genes.png"))
enrich_plot_go(ordered_go_analysis_up)  
dev.off()
  
}
```

#### down
```{r}
get_go_results_down_genes <- function(diff_genes, timepoint){
  diff_genes_down <- diff_genes %>% dplyr::filter(grodown == "down")
  diff_genes_down_id <- bitr(diff_genes_down$genes, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = "org.Mm.eg.db")
  diff_genes_down_list <- list(genes = diff_genes_down_id$ENTREZID)
  go_analysis_diff_genes_down_list <- enrichGO(diff_genes_down_list$genes, ont="BP", OrgDb = "org.Mm.eg.db", readable = TRUE)
  go_analysis_down <- go_analysis_diff_genes_down_list %>% dplyr::mutate(prop_overlap  = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")) * 100,
                                                     Biological_Processes = Description)
  ordered_go_analysis_down <- go_analysis_down[order(go_analysis_down$prop_overlap, decreasing = TRUE),]
  write.csv(ordered_go_analysis_down, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/",timepoint,"/enriched_go_terms_down_reg_genes.csv"))
  
png(filename = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS", timepoint,"/enrich_plot_down_reg_genes.png"))
enrich_plot_go(ordered_go_analysis_down)  
dev.off()
  
}
```


#### all
```{r}
get_go_results_all_genes <- function(diff_genes, timepoint){
  diff_genes_all_id <- bitr(diff_genes$genes, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = "org.Mm.eg.db")
  diff_genes_all_list <- list(genes = diff_genes_all_id$ENTREZID)
  go_analysis_diff_genes_all_list <- enrichGO(diff_genes_all_list$genes, ont="BP", OrgDb = "org.Mm.eg.db", readable = TRUE)
  go_analysis_all <- go_analysis_diff_genes_all_list %>% dplyr::mutate(prop_overlap  = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")) * 100,
                                                     Biological_Processes = Description)
  go_analysis_all_not_redundant <- simplify(go_analysis_all, cutoff=0.7, by="p.adjust", select_fun=min)
  ordered_go_analysis_all <- go_analysis_all_not_redundant[order(go_analysis_all_not_redundant$prop_overlap, decreasing = TRUE),]
  png(filename = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS",timepoint,"/enrich_plot_all_reg_genes.png"))
  enrich_plot_go(ordered_go_analysis_all)  
  dev.off()
  
}
```




#### Reactome

##### up 
```{r}
reactome_analysis_up <- enrichPathway(diff_genes_24h_up_list$genes, organism="mouse")
reactome_analysis_up <- reactome_analysis_up %>%
                                              as.data.frame() %>% 
                                              mutate(prop_overlap = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),                                                   Reactome_Pathway = Description) %>% mutate(prop_overlap = prop_overlap * 100) 


ordered_reactome_analysis_up <- reactome_analysis_up[order(reactome_analysis_up$prop_overlap, decreasing = TRUE),] 
write.csv(ordered_reactome_analysis_up, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/24h/enriched_reactome_pathways_up_reg_genes.csv")
png(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/24h/reactome_enrich_plot_up_reg_genes.png")
enrich_plot_reactome(ordered_reactome_analysis_up)
dev.off()
```


##### down
```{r}
reactome_analysis_down <- enrichPathway(diff_genes_24h_down_list$genes, organism="mouse")
reactome_analysis_down <- reactome_analysis_down %>%
                                              as.data.frame() %>% 
                                              mutate(prop_overlap = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),                                                   Reactome_Pathway = Description) %>% mutate(prop_overlap = prop_overlap * 100) 


ordered_reactome_analysis_down <- reactome_analysis_down[order(reactome_analysis_down$prop_overlap, decreasing = TRUE),] 
write.csv(ordered_reactome_analysis_down, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/24h/enriched_reactome_pathways_down_reg_genes.csv")
png(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/24h/reactome_enrich_plot_down_reg_genes.png")
enrich_plot_reactome(ordered_reactome_analysis_down)
dev.off()
```


##### all
```{r}
reactome_analysis_all <- enrichPathway(diff_genes_24h_all_list$genes, organism="mouse")
reactome_analysis_all <- reactome_analysis_all %>%
                                              as.data.frame() %>% 
                                              mutate(prop_overlap = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),                                                   Reactome_Pathway = Description) %>% mutate(prop_overlap = prop_overlap * 100) 


ordered_reactome_analysis_all <- reactome_analysis_all[order(reactome_analysis_all$prop_overlap, decreasing = TRUE),] 
write.csv(ordered_reactome_analysis_all, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/24h/enriched_reactome_pathways_all_reg_genes.csv")
png(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_OXA_vs_CIS/24h/reactome_enrich_plot_all_reg_genes.png")
enrich_plot_reactome(ordered_reactome_analysis_all)
dev.off()
```


## **OXA_vs_MTX**

```{r get_contrasts}
contrasts_dea_OXA_vs_MTX_3h <- makeContrasts(MTX_3h_vs_OXA_3h = OXA_3h - MTX_3h, levels=dsgn)
fit_contrast_dea_OXA_vs_MTX_3h <- contrasts.fit(fit_dea, contrasts_dea_OXA_vs_MTX_3h)
fit_contrast_dea_OXA_vs_MTX_3h <- eBayes(fit_contrast_dea_OXA_vs_MTX_3h)

contrasts_dea_OXA_vs_MTX_6h <- makeContrasts(MTX_6h_vs_OXA_6h = OXA_6h - MTX_6h, levels=dsgn)
fit_contrast_dea_OXA_vs_MTX_6h <- contrasts.fit(fit_dea, contrasts_dea_OXA_vs_MTX_6h)
fit_contrast_dea_OXA_vs_MTX_6h <- eBayes(fit_contrast_dea_OXA_vs_MTX_6h)

contrasts_dea_OXA_vs_MTX_12h <- makeContrasts(MTX_12h_vs_OXA_12h = OXA_12h - MTX_12h, levels=dsgn)
fit_contrast_dea_OXA_vs_MTX_12h <- contrasts.fit(fit_dea, contrasts_dea_OXA_vs_MTX_12h)
fit_contrast_dea_OXA_vs_MTX_12h <- eBayes(fit_contrast_dea_OXA_vs_MTX_12h)

contrasts_dea_OXA_vs_MTX_18h <- makeContrasts(MTX_18h_vs_OXA_18h = OXA_18h - MTX_18h, levels=dsgn)
fit_contrast_dea_OXA_vs_MTX_18h <- contrasts.fit(fit_dea, contrasts_dea_OXA_vs_MTX_18h)
fit_contrast_dea_OXA_vs_MTX_18h <- eBayes(fit_contrast_dea_OXA_vs_MTX_18h)

contrasts_dea_OXA_vs_MTX_24h <- makeContrasts(MTX_24h_vs_OXA_24h = OXA_24h - MTX_24h, levels=dsgn)
fit_contrast_dea_OXA_vs_MTX_24h <- contrasts.fit(fit_dea, contrasts_dea_OXA_vs_MTX_24h)
fit_contrast_dea_OXA_vs_MTX_24h <- eBayes(fit_contrast_dea_OXA_vs_MTX_24h)
```

```{r}
get_dea_results_2 <- function(timepoint, fit_contrast_dea){
  
  all_genes <- topTable(fit_contrast_dea, sort.by= "P", adjust.method = "BH", number = Inf)
  all_genes <- all_genes %>% dplyr::rename("gene_name" = "genes") %>% inner_join(counts_in_vitro_df[,c("gene_type", "gene_name","gene_id")], by="gene_name", relationship="many-to-many") %>% relocate(gene_id, .after = gene_name)
  all_genes$contrast <- rep(paste("OXA_",timepoint,"vs","MTX_",timepoint,sep=""))
  write.csv(all_genes,  paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_MTX/", timepoint, "/all_genes.csv"))
  
  diff_genes <- all_genes %>% dplyr::filter(adj.P.Val < 0.05 & abs(logFC)> 0) %>% mutate(group = if_else(logFC < 0, "down", "up"))
  rownames(diff_genes) <- NULL
  write.csv(diff_genes, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_MTX/", timepoint, "/diff_genes.csv"))
  
  all_cytokines <- topTable(fit_contrast_dea, sort.by= "P", adjust.method = "BH", number = Inf) %>%  
      filter(genes %in% stringr::str_to_title(cytokines_mouse$Cytokine.Name))
  
  all_cytokines <- all_cytokines %>% dplyr::rename("gene_name" = "genes") %>% inner_join(counts_in_vitro_df[,c("gene_type", "gene_name","gene_id")], by="gene_name", relationship="many-to-many") %>% relocate(gene_id, .after = gene_name)
  all_cytokines$contrast <- rep(paste("MTX",timepoint,"vs","OXA",timepoint,sep="_"))
  write.csv(all_cytokines,  paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_MTX/", timepoint, "/all_cytokines.csv"))
  
  diff_cytokines <- all_cytokines %>% dplyr::filter(adj.P.Val < 0.05 & abs(logFC)> 0) %>% mutate(group = if_else(logFC < 0, "down", "up"))
  rownames(diff_cytokines) <- NULL
  write.csv(diff_cytokines, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_MTX/", timepoint, "/diff_cytokines.csv"))
  
  
}
```

```{r}
get_cytokines_results <- function(fit_contrast_interest, filename, timepoint){
  
  top_table_interest <- topTable(fit_contrast_interest, sort.by = "P", adjust.method = "BH", number=Inf) %>% filter(genes %in% stringr::str_to_title(cytokines_mouse$Cytokine.Name))
  cytokines_interest <- ggplot(top_table_interest, mapping = aes(x=logFC, y=-log10(adj.P.Val), label=genes)) +
    geom_point(data=filter(top_table_interest, logFC > 1 & adj.P.Val <= 0.05), color="red", size=3,shape=21, fill="red") + 
    geom_point(data=filter(top_table_interest, logFC < 1 & logFC > -1 & adj.P.Val > 0.05), color="grey", size=3,shape=21, fill="grey") + geom_point(data=filter(top_table_interest, logFC < 1 & logFC > -1 & adj.P.Val <= 0.05), color="green", size=3,shape=21, fill="green") + 
    geom_point(data=filter(top_table_interest, logFC < -1 & adj.P.Val <= 0.05), color="blue", size=3,shape=21, fill="blue") + geom_point(data=filter(top_table_interest, logFC < -1 & adj.P.Val <= 0.05), color="blue", size=3,shape=21, fill="blue") + 
    ggrepel::geom_label_repel(data=filter(top_table_interest, logFC > 1 & adj.P.Val <= 0.05),aes(label = genes) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) + 
    ggrepel::geom_label_repel(data=filter(top_table_interest, logFC < -1 & adj.P.Val <= 0.05),aes(label = genes) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
    ggrepel::geom_label_repel(data=filter(top_table_interest, logFC > -1 & logFC < 1),aes(label = genes) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) + geom_hline(yintercept = -log10(0.05), colour = "black", linetype ="dashed") + geom_vline(xintercept = c(-1,1), colour="black", linetype ="dashed") + 
    ggtitle(paste("All_cytokines_OXA",timepoint,"vs_MTX",timepoint,sep="_")) + 
    theme(plot.title = element_text(hjust=0.5,face="bold")) +
    theme(axis.title = element_text(face="bold")) + 
    theme(axis.text = element_text(face="bold"))
                                                                                                                    
                                                                                                      ggsave(filename)
                                                                                                                    
}
                                                                                        
```



### 3h
```{r}
get_dea_results_2("3h", fit_contrast_dea_OXA_vs_MTX_3h)
get_cytokines_results(fit_contrast_dea_OXA_vs_MTX_3h, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_MTX/3h/ 
                      volcano_cytokines.png", "3h")

```

### 6h
```{r}
get_dea_results_2("6h", fit_contrast_dea_OXA_vs_MTX_6h)
get_cytokines_results(fit_contrast_dea_OXA_vs_MTX_6h, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_MTX/6h/volcano_cytokines.png", "6h")
```

### 12h
```{r}
get_dea_results_2("12h", fit_contrast_dea_OXA_vs_MTX_12h)
get_cytokines_results(fit_contrast_dea_OXA_vs_MTX_12h, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_MTX/12h/ 
                      volcano_cytokines.png", "12h")
```

### 18h
```{r}
get_dea_results_2("18h", fit_contrast_dea_OXA_vs_MTX_18h)
get_cytokines_results(fit_contrast_dea_OXA_vs_MTX_18h, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_MTX/18h/ 
                      volcano_cytokines.png", "18h")
```

### 24h
```{r}
get_dea_results_2("24h", fit_contrast_dea_OXA_vs_MTX_24h)
get_cytokines_results(fit_contrast_dea_OXA_vs_MTX_24h, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_MTX/24h/volcano_cytokines.png", "24h")
```




## **MTX vs Control/OXA vs Control/CIS vs Control**

### **MTX vs Control**
```{r get_contrasts}
# MTX vs Control
contrasts_dea_MTX_Control_3h <- makeContrasts(MTX_3h_Control_3h = MTX_3h - Control_3h, levels=dsgn)
fit_contrast_dea_MTX_Control_3h <- contrasts.fit(fit_dea, contrasts_dea_MTX_Control_3h)
fit_contrast_dea_MTX_Control_3h <- eBayes(fit_contrast_dea_MTX_Control_3h)

contrasts_dea_MTX_Control_6h <- makeContrasts(MTX_6h_Control_6h = MTX_6h - Control_6h, levels=dsgn)
fit_contrast_dea_MTX_Control_6h <- contrasts.fit(fit_dea, contrasts_dea_MTX_Control_6h)
fit_contrast_dea_MTX_Control_6h <- eBayes(fit_contrast_dea_MTX_Control_6h)

contrasts_dea_MTX_Control_12h <- makeContrasts(MTX_12h_Control_12h = MTX_12h - Control_12h, levels=dsgn)
fit_contrast_dea_MTX_Control_12h <- contrasts.fit(fit_dea, contrasts_dea_MTX_Control_12h)
fit_contrast_dea_MTX_Control_12h <- eBayes(fit_contrast_dea_MTX_Control_12h)

contrasts_dea_MTX_Control_18h <- makeContrasts(MTX_18h_Control_18h = MTX_18h - Control_18h, levels=dsgn)
fit_contrast_dea_MTX_Control_18h <- contrasts.fit(fit_dea, contrasts_dea_MTX_Control_18h)
fit_contrast_dea_MTX_Control_18h <- eBayes(fit_contrast_dea_MTX_Control_18h)

contrasts_dea_MTX_Control_24h <- makeContrasts(MTX_24h_Control_24h = MTX_24h - Control_24h, levels=dsgn)
fit_contrast_dea_MTX_Control_24h <- contrasts.fit(fit_dea, contrasts_dea_MTX_Control_24h)
fit_contrast_dea_MTX_Control_24h <- eBayes(fit_contrast_dea_MTX_Control_24h)
```

```{r save_dea_results}
get_dea_results_MTX_Control <- function(timepoint, fit_contrast_dea){
  
  all_genes <- topTable(fit_contrast_dea, sort.by= "P", adjust.method = "BH", number = Inf)
  all_genes <- all_genes %>% dplyr::rename("gene_name" = "genes") %>% inner_join(counts_in_vitro_df[,c("gene_type", "gene_name","gene_id")], by="gene_name", relationship="many-to-many") %>% relocate(gene_id, .after = gene_name)
  all_genes$contrast <- rep(paste("MTX_",timepoint,"_vs_","Control_",timepoint,sep=""))
  write.csv(all_genes,  paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_Control/", timepoint, "/all_genes.csv"))
  
  diff_genes <- all_genes %>% dplyr::filter(adj.P.Val < 0.05 & abs(logFC)> 0) %>% mutate(group = if_else(logFC < 0, "down", "up"))
  rownames(diff_genes) <- NULL
  write.csv(diff_genes, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_Control/",timepoint, "/diff_genes.csv"))
}
```

```{r plot_dea_results_all_genes_cytokines}
plot_genes_and_cytokines_dea_MTX_Control <- function(timepoint){
  
  all_genes <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_Control/", timepoint,"/all_genes.csv"))

genes_cytokines <- all_genes %>% dplyr::filter(gene_name %in% cytokines_mouse$Cytokine.Name)
write.csv(genes_cytokines, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_Control/",timepoint,"/all_cytokines.csv"))

diff_genes_cytokines <- genes_cytokines %>% dplyr::filter(adj.P.Val < 0.05, abs(logFC)>1) %>% mutate(group = if_else(logFC < 0, "down", "up"))

up_reg_cytokines <- diff_genes_cytokines %>% filter(group=="up") %>% write.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_Control/",timepoint,"/up_reg_cytokines.csv"))

down_reg_cytokines <- diff_genes_cytokines %>% filter(group=="down") %>% write.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_Control/",timepoint,"/down_reg_cytokines.csv"))

volcano_all_genes <- all_genes %>% 
  ggplot(mapping=aes(x=logFC, y =-log10(adj.P.Val), label=gene_name)) + 
  geom_point(color="grey") +
  geom_point(data = filter(all_genes,logFC > 1 & adj.P.Val < 0.05), color="red") + 
  geom_point(data = filter(all_genes,logFC < -1 & adj.P.Val < 0.05), color="blue") + 
  geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") + 
  geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") + 
  ylab("-log10(adj.P.value)") + 
  xlab("log2(FoldChange)") + 
  theme_linedraw() + 
  ggtitle(paste("MTX_",timepoint,"+","_vs_","Control_",timepoint,": all_genes",sep="")) + 
  theme(plot.title=element_text(hjust=0.5, face="bold"))
  
ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_Control/",timepoint,"/volcano_all_cytokines.png"))  

volcano_all_genes_plotly <- plotly::ggplotly(volcano_all_genes)
htmlwidgets::saveWidget(
                widget = volcano_all_genes_plotly,
                file = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_Control/",timepoint,"/volcano_all_genes.html"))


volcano_all_cytokines <- genes_cytokines %>% 
  ggplot(mapping=aes(x=logFC, y =-log10(adj.P.Val), label=gene_name)) + 
  geom_point(color="grey") +
  geom_point(data = filter(genes_cytokines,logFC > 1 & adj.P.Val < 0.05), color="red") + 
  geom_point(data = filter(genes_cytokines,logFC < -1 & adj.P.Val < 0.05), color="blue") + 
  geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") + 
  geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") + 
  ylab("-log10(adj.P.value)") + 
  xlab("log2(FoldChange)") + 
  theme_linedraw() + 
  ggtitle(paste("MTX_",timepoint,"_vs_","Control_",timepoint,": all_cytokines",sep="")) + 
  theme(plot.title=element_text(hjust=0.5, face="bold"))

ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_Control/",timepoint,"/volcano_all_cytokines.png"))

volcano_all_cytokines_plotly <- plotly::ggplotly(volcano_all_cytokines)
htmlwidgets::saveWidget(
                widget = volcano_all_cytokines_plotly,
                file = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_Control/",timepoint,"/volcano_all_cytokines.html"))


# all cytokines (with labels)
volcano_cytokines_with_labels <- genes_cytokines %>% 
  ggplot(mapping = aes(x=logFC, y=-log10(adj.P.Val), 
                       label=gene_name)) +
  
  geom_point(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 
                           0.05), 
             color="red", size=3,shape=21, fill="red") +
  
  geom_point(data=filter(genes_cytokines, logFC < 1 & logFC > -1 & 
                           adj.P.Val > 0.05), color="grey", 
             size=3,shape=21, fill="grey") +
  
  geom_point(data=filter(genes_cytokines, logFC < 1 & logFC > -1 & 
                                                      adj.P.Val <= 
                           0.05), color="green", size=3,shape=21, 
             fill="green") +
  
                               
  geom_point(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 0.05), color="red", size=3,shape=21, fill="red") +
  
                              
  geom_point(data=filter(genes_cytokines, logFC < -1 & adj.P.Val <= 0.05), color="blue", size=3,shape=21, fill="blue") +
                             
                      
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 0.05),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
                               
                      
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC < -1 & adj.P.Val <= 0.05),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
                             
                               
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC > -1 & logFC < 1),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
  
  geom_hline(yintercept = -log10(0.05), colour = "black", linetype 
             ="dashed") +
  
  geom_vline(xintercept = c(-1,1), colour="black", linetype 
             ="dashed") +
  
  ggtitle(paste("MTX_",timepoint,"_vs_","Control_",timepoint,": all_cytokines",sep="")) +
  
  theme(plot.title = element_text(hjust=0.5,face="bold")) +
  
  theme(axis.title = element_text(face="bold")) +
                           
  theme(axis.text = element_text(face="bold")) 

ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_Control/",timepoint,"/volcano_all_cytokines_with_labels.png"), width = 17, height = 10)

}

```


#### 3h
```{r}
get_dea_results_MTX_Control("3h", fit_contrast_dea_MTX_Control_3h)
plot_genes_and_cytokines_dea_MTX_Control("3h")
```

#### 6h
```{r}
get_dea_results_MTX_Control("6h", fit_contrast_dea_MTX_Control_6h)
plot_genes_and_cytokines_dea_MTX_Control("6h")
```

#### 12h
```{r}
get_dea_results_MTX_Control("12h", fit_contrast_dea_MTX_Control_12h)
plot_genes_and_cytokines_dea_MTX_Control("12h")
```

#### 18h
```{r}
get_dea_results_MTX_Control("18h", fit_contrast_dea_MTX_Control_18h)
plot_genes_and_cytokines_dea_MTX_Control("18h")
```

#### 24h
```{r}
get_dea_results_MTX_Control("24h", fit_contrast_dea_MTX_Control_24h)
plot_genes_and_cytokines_dea_MTX_Control("24h")
```



### **OXA vs Control**
```{r get_contrasts}
# OXA vs Control
contrasts_dea_OXA_Control_3h <- makeContrasts(OXA_3h_Control_3h = OXA_3h - Control_3h, levels=dsgn)
fit_contrast_dea_OXA_Control_3h <- contrasts.fit(fit_dea, contrasts_dea_OXA_Control_3h)
fit_contrast_dea_OXA_Control_3h <- eBayes(fit_contrast_dea_OXA_Control_3h)

contrasts_dea_OXA_Control_6h <- makeContrasts(OXA_6h_Control_6h = OXA_6h - Control_6h, levels=dsgn)
fit_contrast_dea_OXA_Control_6h <- contrasts.fit(fit_dea, contrasts_dea_OXA_Control_6h)
fit_contrast_dea_OXA_Control_6h <- eBayes(fit_contrast_dea_OXA_Control_6h)

contrasts_dea_OXA_Control_12h <- makeContrasts(OXA_12h_Control_12h = OXA_12h - Control_12h, levels=dsgn)
fit_contrast_dea_OXA_Control_12h <- contrasts.fit(fit_dea, contrasts_dea_OXA_Control_12h)
fit_contrast_dea_OXA_Control_12h <- eBayes(fit_contrast_dea_OXA_Control_12h)

contrasts_dea_OXA_Control_18h <- makeContrasts(OXA_18h_Control_18h = OXA_18h - Control_18h, levels=dsgn)
fit_contrast_dea_OXA_Control_18h <- contrasts.fit(fit_dea, contrasts_dea_OXA_Control_18h)
fit_contrast_dea_OXA_Control_18h <- eBayes(fit_contrast_dea_OXA_Control_18h)

contrasts_dea_OXA_Control_24h <- makeContrasts(OXA_24h_Control_24h = OXA_24h - Control_24h, levels=dsgn)
fit_contrast_dea_OXA_Control_24h <- contrasts.fit(fit_dea, contrasts_dea_OXA_Control_24h)
fit_contrast_dea_OXA_Control_24h <- eBayes(fit_contrast_dea_OXA_Control_24h)
```

```{r save_dea_results}
get_dea_results_OXA_Control <- function(timepoint, fit_contrast_dea){
  
  all_genes <- topTable(fit_contrast_dea, sort.by= "P", adjust.method = "BH", number = Inf)
  all_genes <- all_genes %>% dplyr::rename("gene_name" = "genes") %>% inner_join(counts_in_vitro_df[,c("gene_type", "gene_name","gene_id")], by="gene_name", relationship="many-to-many") %>% relocate(gene_id, .after = gene_name)
  all_genes$contrast <- rep(paste("OXA_",timepoint,"_vs_","Control",timepoint,sep=""))
  write.csv(all_genes,  paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_Control/", timepoint, "/all_genes.csv"))
  
  diff_genes <- all_genes %>% dplyr::filter(adj.P.Val < 0.05 & abs(logFC)> 0) %>% mutate(group = if_else(logFC < 0, "down", "up"))
  rownames(diff_genes) <- NULL
  write.csv(diff_genes, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_Control/",timepoint, "/diff_genes.csv"))
}
```

```{r plot_dea_results_all_genes_cytokines}
plot_genes_and_cytokines_dea_OXA_Control <- function(timepoint){
  
  all_genes <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_Control/", timepoint,"/all_genes.csv"))

genes_cytokines <- all_genes %>% dplyr::filter(gene_name %in% cytokines_mouse$Cytokine.Name)
write.csv(genes_cytokines, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_Control/",timepoint,"/all_cytokines.csv"))

diff_genes_cytokines <- genes_cytokines %>% dplyr::filter(adj.P.Val < 0.05, abs(logFC)>1) %>% mutate(group = if_else(logFC < 0, "down", "up"))

up_reg_cytokines <- diff_genes_cytokines %>% filter(group=="up") %>% write.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_Control/",timepoint,"/up_reg_cytokines.csv"))

down_reg_cytokines <- diff_genes_cytokines %>% filter(group=="down") %>% write.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_Control/",timepoint,"/down_reg_cytokines.csv"))

volcano_all_genes <- all_genes %>% 
  ggplot(mapping=aes(x=logFC, y =-log10(adj.P.Val), label=gene_name)) + 
  geom_point(color="grey") +
  geom_point(data = filter(all_genes,logFC > 1 & adj.P.Val < 0.05), color="red") + 
  geom_point(data = filter(all_genes,logFC < -1 & adj.P.Val < 0.05), color="blue") + 
  geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") + 
  geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") + 
  ylab("-log10(adj.P.value)") + 
  xlab("log2(FoldChange)") + 
  theme_linedraw() + 
  ggtitle(paste("OXA_",timepoint,"+","_vs_","Control_",timepoint,": all_genes",sep="")) + 
  theme(plot.title=element_text(hjust=0.5, face="bold"))
  
ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_Control/",timepoint,"/volcano_all_cytokines.png"))  

volcano_all_genes_plotly <- plotly::ggplotly(volcano_all_genes)
htmlwidgets::saveWidget(
                widget = volcano_all_genes_plotly,
                file = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_Control/",timepoint,"/volcano_all_genes.html"))


volcano_all_cytokines <- genes_cytokines %>% 
  ggplot(mapping=aes(x=logFC, y =-log10(adj.P.Val), label=gene_name)) + 
  geom_point(color="grey") +
  geom_point(data = filter(genes_cytokines,logFC > 1 & adj.P.Val < 0.05), color="red") + 
  geom_point(data = filter(genes_cytokines,logFC < -1 & adj.P.Val < 0.05), color="blue") + 
  geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") + 
  geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") + 
  ylab("-log10(adj.P.value)") + 
  xlab("log2(FoldChange)") + 
  theme_linedraw() + 
  ggtitle(paste("OXA_",timepoint,"_vs_","Control_",timepoint,": all_cytokines",sep="")) + 
  theme(plot.title=element_text(hjust=0.5, face="bold"))

ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_Control/",timepoint,"/volcano_all_cytokines.png"))

volcano_all_cytokines_plotly <- plotly::ggplotly(volcano_all_cytokines)
htmlwidgets::saveWidget(
                widget = volcano_all_cytokines_plotly,
                file = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_Control/",timepoint,"/volcano_all_cytokines.html"))


# all cytokines (with labels)
volcano_cytokines_with_labels <- genes_cytokines %>% 
  ggplot(mapping = aes(x=logFC, y=-log10(adj.P.Val), 
                       label=gene_name)) +
  
  geom_point(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 
                           0.05), 
             color="red", size=3,shape=21, fill="red") +
  
  geom_point(data=filter(genes_cytokines, logFC < 1 & logFC > -1 & 
                           adj.P.Val > 0.05), color="grey", 
             size=3,shape=21, fill="grey") +
  
  geom_point(data=filter(genes_cytokines, logFC < 1 & logFC > -1 & 
                                                      adj.P.Val <= 
                           0.05), color="green", size=3,shape=21, 
             fill="green") +
  
                               
  geom_point(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 0.05), color="red", size=3,shape=21, fill="red") +
  
                              
  geom_point(data=filter(genes_cytokines, logFC < -1 & adj.P.Val <= 0.05), color="blue", size=3,shape=21, fill="blue") +
                             
                      
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 0.05),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
                               
                      
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC < -1 & adj.P.Val <= 0.05),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
                             
                               
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC > -1 & logFC < 1),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
  
  geom_hline(yintercept = -log10(0.05), colour = "black", linetype 
             ="dashed") +
  
  geom_vline(xintercept = c(-1,1), colour="black", linetype 
             ="dashed") +
  
  ggtitle(paste("OXA_",timepoint,"_vs_","Control_",timepoint,": all_cytokines",sep="")) +
  
  theme(plot.title = element_text(hjust=0.5,face="bold")) +
  
  theme(axis.title = element_text(face="bold")) +
                           
  theme(axis.text = element_text(face="bold")) 

ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_Control/",timepoint,"/volcano_all_cytokines_with_labels.png"), width = 17, height = 10)

}

```


#### 3h
```{r}
get_dea_results_OXA_Control("3h", fit_contrast_dea_OXA_Control_3h)
plot_genes_and_cytokines_dea_OXA_Control("3h")
```

#### 6h
```{r}
get_dea_results_OXA_Control("6h", fit_contrast_dea_OXA_Control_6h)
plot_genes_and_cytokines_dea_OXA_Control("6h")
```

#### 12h
```{r}
get_dea_results_OXA_Control("12h", fit_contrast_dea_OXA_Control_12h)
plot_genes_and_cytokines_dea_OXA_Control("12h")
```

#### 18h
```{r}
get_dea_results_OXA_Control("18h", fit_contrast_dea_OXA_Control_18h)
plot_genes_and_cytokines_dea_OXA_Control("18h")
```

#### 24h
```{r}
get_dea_results_OXA_Control("24h", fit_contrast_dea_OXA_Control_24h)
plot_genes_and_cytokines_dea_OXA_Control("24h")
```



### **CIS vs Control**
```{r get_contrasts}
# CIS vs Control
contrasts_dea_CIS_Control_3h <- makeContrasts(CIS_3h_Control_3h = CIS_3h - Control_3h, levels=dsgn)
fit_contrast_dea_CIS_Control_3h <- contrasts.fit(fit_dea, contrasts_dea_CIS_Control_3h)
fit_contrast_dea_CIS_Control_3h <- eBayes(fit_contrast_dea_CIS_Control_3h)

contrasts_dea_CIS_Control_6h <- makeContrasts(CIS_6h_Control_6h = CIS_6h - Control_6h, levels=dsgn)
fit_contrast_dea_CIS_Control_6h <- contrasts.fit(fit_dea, contrasts_dea_CIS_Control_6h)
fit_contrast_dea_CIS_Control_6h <- eBayes(fit_contrast_dea_CIS_Control_6h)

contrasts_dea_CIS_Control_12h <- makeContrasts(CIS_12h_Control_12h = CIS_12h - Control_12h, levels=dsgn)
fit_contrast_dea_CIS_Control_12h <- contrasts.fit(fit_dea, contrasts_dea_CIS_Control_12h)
fit_contrast_dea_CIS_Control_12h <- eBayes(fit_contrast_dea_CIS_Control_12h)

contrasts_dea_CIS_Control_18h <- makeContrasts(CIS_18h_Control_18h = CIS_18h - Control_18h, levels=dsgn)
fit_contrast_dea_CIS_Control_18h <- contrasts.fit(fit_dea, contrasts_dea_CIS_Control_18h)
fit_contrast_dea_CIS_Control_18h <- eBayes(fit_contrast_dea_CIS_Control_18h)

contrasts_dea_CIS_Control_24h <- makeContrasts(CIS_24h_Control_24h = CIS_24h - Control_24h, levels=dsgn)
fit_contrast_dea_CIS_Control_24h <- contrasts.fit(fit_dea, contrasts_dea_CIS_Control_24h)
fit_contrast_dea_CIS_Control_24h <- eBayes(fit_contrast_dea_CIS_Control_24h)
```

```{r save_dea_results}
get_dea_results_CIS_Control <- function(timepoint, fit_contrast_dea){
  
  all_genes <- topTable(fit_contrast_dea, sort.by= "P", adjust.method = "BH", number = Inf)
  all_genes <- all_genes %>% dplyr::rename("gene_name" = "genes") %>% inner_join(counts_in_vitro_df[,c("gene_type", "gene_name","gene_id")], by="gene_name", relationship="many-to-many") %>% relocate(gene_id, .after = gene_name)
  all_genes$contrast <- rep(paste("CIS_",timepoint,"_vs_","Control_",timepoint,sep=""))
  write.csv(all_genes,  paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/", timepoint, "/all_genes.csv"))
  
  diff_genes <- all_genes %>% dplyr::filter(adj.P.Val < 0.05 & abs(logFC)> 0) %>% mutate(group = if_else(logFC < 0, "down", "up"))
  rownames(diff_genes) <- NULL
  write.csv(diff_genes, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/",timepoint, "/diff_genes.csv"))
}
```

```{r plot_dea_results_all_genes_cytokines}
plot_genes_and_cytokines_dea_CIS_Control <- function(timepoint){
  
  all_genes <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/", timepoint,"/all_genes.csv"))

genes_cytokines <- all_genes %>% dplyr::filter(gene_name %in% cytokines_mouse$Cytokine.Name)
write.csv(genes_cytokines, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/",timepoint,"/all_cytokines.csv"))

diff_genes_cytokines <- genes_cytokines %>% dplyr::filter(adj.P.Val < 0.05, abs(logFC)>1) %>% mutate(group = if_else(logFC < 0, "down", "up"))

up_reg_cytokines <- diff_genes_cytokines %>% filter(group=="up") %>% write.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/",timepoint,"/up_reg_cytokines.csv"))

down_reg_cytokines <- diff_genes_cytokines %>% filter(group=="down") %>% write.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/",timepoint,"/down_reg_cytokines.csv"))

volcano_all_genes <- all_genes %>% 
  ggplot(mapping=aes(x=logFC, y =-log10(adj.P.Val), label=gene_name)) + 
  geom_point(color="grey") +
  geom_point(data = filter(all_genes,logFC > 1 & adj.P.Val < 0.05), color="red") + 
  geom_point(data = filter(all_genes,logFC < -1 & adj.P.Val < 0.05), color="blue") + 
  geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") + 
  geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") + 
  ylab("-log10(adj.P.value)") + 
  xlab("log2(FoldChange)") + 
  theme_linedraw() + 
  ggtitle(paste("CIS_",timepoint,"+","_vs_","Control_",timepoint,": all_genes",sep="")) + 
  theme(plot.title=element_text(hjust=0.5, face="bold"))
  
ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/",timepoint,"/volcano_all_cytokines.png"))  

volcano_all_genes_plotly <- plotly::ggplotly(volcano_all_genes)
htmlwidgets::saveWidget(
                widget = volcano_all_genes_plotly,
                file = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/",timepoint,"/volcano_all_genes.html"))


volcano_all_cytokines <- genes_cytokines %>% 
  ggplot(mapping=aes(x=logFC, y =-log10(adj.P.Val), label=gene_name)) + 
  geom_point(color="grey") +
  geom_point(data = filter(genes_cytokines,logFC > 1 & adj.P.Val < 0.05), color="red") + 
  geom_point(data = filter(genes_cytokines,logFC < -1 & adj.P.Val < 0.05), color="blue") + 
  geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") + 
  geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") + 
  ylab("-log10(adj.P.value)") + 
  xlab("log2(FoldChange)") + 
  theme_linedraw() + 
  ggtitle(paste("CIS_",timepoint,"_vs_","Control_",timepoint,": all_cytokines",sep="")) + 
  theme(plot.title=element_text(hjust=0.5, face="bold"))

ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/",timepoint,"/volcano_all_cytokines.png"))

volcano_all_cytokines_plotly <- plotly::ggplotly(volcano_all_cytokines)
htmlwidgets::saveWidget(
                widget = volcano_all_cytokines_plotly,
                file = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/",timepoint,"/volcano_all_cytokines.html"))


# all cytokines (with labels)
volcano_cytokines_with_labels <- genes_cytokines %>% 
  ggplot(mapping = aes(x=logFC, y=-log10(adj.P.Val), 
                       label=gene_name)) +
  
  geom_point(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 
                           0.05), 
             color="red", size=3,shape=21, fill="red") +
  
  geom_point(data=filter(genes_cytokines, logFC < 1 & logFC > -1 & 
                           adj.P.Val > 0.05), color="grey", 
             size=3,shape=21, fill="grey") +
  
  geom_point(data=filter(genes_cytokines, logFC < 1 & logFC > -1 & 
                                                      adj.P.Val <= 
                           0.05), color="green", size=3,shape=21, 
             fill="green") +
  
                               
  geom_point(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 0.05), color="red", size=3,shape=21, fill="red") +
  
                              
  geom_point(data=filter(genes_cytokines, logFC < -1 & adj.P.Val <= 0.05), color="blue", size=3,shape=21, fill="blue") +
                             
                      
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 0.05),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
                               
                      
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC < -1 & adj.P.Val <= 0.05),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
                             
                               
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC > -1 & logFC < 1),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
  
  geom_hline(yintercept = -log10(0.05), colour = "black", linetype 
             ="dashed") +
  
  geom_vline(xintercept = c(-1,1), colour="black", linetype 
             ="dashed") +
  
  ggtitle(paste("CIS_",timepoint,"_vs_","Control_",timepoint,": all_cytokines",sep="")) +
  
  theme(plot.title = element_text(hjust=0.5,face="bold")) +
  
  theme(axis.title = element_text(face="bold")) +
                           
  theme(axis.text = element_text(face="bold")) 

ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/",timepoint,"/volcano_all_cytokines_with_labels.png"), width = 17, height = 10)

}

```


#### 3h
```{r}
get_dea_results_CIS_Control("3h", fit_contrast_dea_CIS_Control_3h)
plot_genes_and_cytokines_dea_CIS_Control("3h")
```

#### 6h
```{r}
get_dea_results_CIS_Control("6h", fit_contrast_dea_CIS_Control_6h)
plot_genes_and_cytokines_dea_CIS_Control("6h")
```

#### 12h
```{r}
get_dea_results_CIS_Control("12h", fit_contrast_dea_CIS_Control_12h)
plot_genes_and_cytokines_dea_CIS_Control("12h")
```

#### 18h
```{r}
get_dea_results_CIS_Control("18h", fit_contrast_dea_CIS_Control_18h)
plot_genes_and_cytokines_dea_CIS_Control("18h")
```

#### 24h
```{r}
get_dea_results_CIS_Control("24h", fit_contrast_dea_CIS_Control_24h)
plot_genes_and_cytokines_dea_CIS_Control("24h")
```



### **Control vs CIS**
```{r get_contrasts}
# Control vs CIS
contrasts_dea_Control_CIS_3h <- makeContrasts(Control_3h_Cis_3h = Control_3h - CIS_3h, levels=dsgn)
fit_contrast_dea_Control_CIS_3h <- contrasts.fit(fit_dea, contrasts_dea_Control_CIS_3h)
fit_contrast_dea_Control_CIS_3h <- eBayes(fit_contrast_dea_Control_CIS_3h)

contrasts_dea_Control_CIS_6h <- makeContrasts(Control_6h_Cis_6h = Control_6h - CIS_6h, levels=dsgn)
fit_contrast_dea_Control_CIS_6h <- contrasts.fit(fit_dea, contrasts_dea_Control_CIS_6h)
fit_contrast_dea_Control_CIS_6h <- eBayes(fit_contrast_dea_Control_CIS_6h)


contrasts_dea_Control_CIS_12h <- makeContrasts(Control_12h_Cis_12h = Control_12h - CIS_12h, levels=dsgn)
fit_contrast_dea_Control_CIS_12h <- contrasts.fit(fit_dea, contrasts_dea_Control_CIS_12h)
fit_contrast_dea_Control_CIS_12h <- eBayes(fit_contrast_dea_Control_CIS_12h)


contrasts_dea_Control_CIS_18h <- makeContrasts(Control_18h_Cis_18h = Control_18h - CIS_18h, levels=dsgn)
fit_contrast_dea_Control_CIS_18h <- contrasts.fit(fit_dea, contrasts_dea_Control_CIS_18h)
fit_contrast_dea_Control_CIS_18h <- eBayes(fit_contrast_dea_Control_CIS_18h)


contrasts_dea_Control_CIS_24h <- makeContrasts(Control_24h_Cis_24h = Control_24h - CIS_24h, levels=dsgn)
fit_contrast_dea_Control_CIS_24h <- contrasts.fit(fit_dea, contrasts_dea_Control_CIS_24h)
fit_contrast_dea_Control_CIS_24h <- eBayes(fit_contrast_dea_Control_CIS_24h)
```

```{r save_dea_results}
get_dea_results_Control_CIS <- function(timepoint, fit_contrast_dea){
  
  all_genes <- topTable(fit_contrast_dea, sort.by= "P", adjust.method = "BH", number = Inf)
  all_genes <- all_genes %>% dplyr::rename("gene_name" = "genes") %>% inner_join(counts_in_vitro_df[,c("gene_type", "gene_name","gene_id")], by="gene_name", relationship="many-to-many") %>% relocate(gene_id, .after = gene_name)
  all_genes$contrast <- rep(paste("CIS_",timepoint,"_vs_","Control_",timepoint,sep=""))
  write.csv(all_genes,  paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_CIS/", timepoint, "/all_genes.csv"))
  
  diff_genes <- all_genes %>% dplyr::filter(adj.P.Val < 0.05 & abs(logFC)> 0) %>% mutate(group = if_else(logFC < 0, "down", "up"))
  rownames(diff_genes) <- NULL
  write.csv(diff_genes, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_CIS/",timepoint, "/diff_genes.csv"))
}
```



### **Control vs MTX**
```{r get_contrasts}
# Control vs MTX
contrasts_dea_Control_MTX_3h <- makeContrasts(Control_3h_MTX_3h = Control_3h - MTX_3h, levels=dsgn)
fit_contrast_dea_Control_MTX_3h <- contrasts.fit(fit_dea, contrasts_dea_Control_MTX_3h)
fit_contrast_dea_Control_MTX_3h <- eBayes(fit_contrast_dea_Control_MTX_3h)

contrasts_dea_Control_MTX_6h <- makeContrasts(Control_6h_MTX_6h = Control_6h - MTX_6h, levels=dsgn)
fit_contrast_dea_Control_MTX_6h <- contrasts.fit(fit_dea, contrasts_dea_Control_MTX_6h)
fit_contrast_dea_Control_MTX_6h <- eBayes(fit_contrast_dea_Control_MTX_6h)


contrasts_dea_Control_MTX_12h <- makeContrasts(Control_12h_MTX_12h = Control_12h - MTX_12h, levels=dsgn)
fit_contrast_dea_Control_MTX_12h <- contrasts.fit(fit_dea, contrasts_dea_Control_MTX_12h)
fit_contrast_dea_Control_MTX_12h <- eBayes(fit_contrast_dea_Control_MTX_12h)


contrasts_dea_Control_MTX_18h <- makeContrasts(Control_18h_MTX_18h = Control_18h - MTX_18h, levels=dsgn)
fit_contrast_dea_Control_MTX_18h <- contrasts.fit(fit_dea, contrasts_dea_Control_MTX_18h)
fit_contrast_dea_Control_MTX_18h <- eBayes(fit_contrast_dea_Control_MTX_18h)


contrasts_dea_Control_MTX_24h <- makeContrasts(Control_24h_MTX_24h = Control_24h - MTX_24h, levels=dsgn)
fit_contrast_dea_Control_MTX_24h <- contrasts.fit(fit_dea, contrasts_dea_Control_MTX_24h)
fit_contrast_dea_Control_MTX_24h <- eBayes(fit_contrast_dea_Control_MTX_24h)
```

```{r save_dea_results}
get_dea_results_Control_MTX <- function(timepoint, fit_contrast_dea){
  
  all_genes <- topTable(fit_contrast_dea, sort.by= "P", adjust.method = "BH", number = Inf)
  all_genes <- all_genes %>% dplyr::rename("gene_name" = "genes") %>% inner_join(counts_in_vitro_df[,c("gene_type", "gene_name","gene_id")], by="gene_name", relationship="many-to-many") %>% relocate(gene_id, .after = gene_name)
  all_genes$contrast <- rep(paste("Control_",timepoint,"_vs_","MTX_",timepoint,sep=""))
  write.csv(all_genes,  paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_MTX/", timepoint, "/all_genes.csv"))
  
  diff_genes <- all_genes %>% dplyr::filter(adj.P.Val < 0.05 & abs(logFC)> 0) %>% mutate(group = if_else(logFC < 0, "down", "up"))
  rownames(diff_genes) <- NULL
  write.csv(diff_genes, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_MTX/",timepoint, "/diff_genes.csv"))
}
```


#### 3h
```{r}
get_dea_results_Control_MTX("3h", fit_contrast_dea_Control_MTX_3h)
```

#### 6h
```{r}
get_dea_results_Control_MTX("6h", fit_contrast_dea_Control_MTX_6h)
```

#### 12h
```{r}
get_dea_results_Control_MTX("12h", fit_contrast_dea_Control_MTX_12h)
```

#### 18h
```{r}
get_dea_results_Control_MTX("18h", fit_contrast_dea_Control_MTX_18h)
```

#### 24h
```{r}
get_dea_results_Control_MTX("24h", fit_contrast_dea_Control_MTX_24h)
```




```{r plot_dea_results_all_genes_cytokines}
plot_genes_and_cytokines_dea_Control_CIS <- function(timepoint){
  
  all_genes <- read.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_CIS/", timepoint,"/all_genes.csv"))

genes_cytokines <- all_genes %>% dplyr::filter(gene_name %in% cytokines_mouse$Cytokine.Name)
write.csv(genes_cytokines, paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_CIS/",timepoint,"/all_cytokines.csv"))

diff_genes_cytokines <- genes_cytokines %>% dplyr::filter(adj.P.Val < 0.05, abs(logFC)>1) %>% mutate(group = if_else(logFC < 0, "down", "up"))

up_reg_cytokines <- diff_genes_cytokines %>% filter(group=="up") %>% write.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_CIS/",timepoint,"/up_reg_cytokines.csv"))

down_reg_cytokines <- diff_genes_cytokines %>% filter(group=="down") %>% write.csv(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_CIS/",timepoint,"/down_reg_cytokines.csv"))

volcano_all_genes <- all_genes %>% 
  ggplot(mapping=aes(x=logFC, y =-log10(adj.P.Val), label=gene_name)) + 
  geom_point(color="grey") +
  geom_point(data = filter(all_genes,logFC > 1 & adj.P.Val < 0.05), color="red") + 
  geom_point(data = filter(all_genes,logFC < -1 & adj.P.Val < 0.05), color="blue") + 
  geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") + 
  geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") + 
  ylab("-log10(adj.P.value)") + 
  xlab("log2(FoldChange)") + 
  theme_linedraw() + 
  ggtitle(paste("CIS_",timepoint,"+","_vs_","Control_",timepoint,": all_genes",sep="")) + 
  theme(plot.title=element_text(hjust=0.5, face="bold"))
  
ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_CIS/",timepoint,"/volcano_all_cytokines.png"))  

volcano_all_genes_plotly <- plotly::ggplotly(volcano_all_genes)
htmlwidgets::saveWidget(
                widget = volcano_all_genes_plotly,
                file = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_CIS/",timepoint,"/volcano_all_genes.html"))


volcano_all_cytokines <- genes_cytokines %>% 
  ggplot(mapping=aes(x=logFC, y =-log10(adj.P.Val), label=gene_name)) + 
  geom_point(color="grey") +
  geom_point(data = filter(genes_cytokines,logFC > 1 & adj.P.Val < 0.05), color="red") + 
  geom_point(data = filter(genes_cytokines,logFC < -1 & adj.P.Val < 0.05), color="blue") + 
  geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") + 
  geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") + 
  ylab("-log10(adj.P.value)") + 
  xlab("log2(FoldChange)") + 
  theme_linedraw() + 
  ggtitle(paste("CIS_",timepoint,"_vs_","Control_",timepoint,": all_cytokines",sep="")) + 
  theme(plot.title=element_text(hjust=0.5, face="bold"))

ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_CIS/",timepoint,"/volcano_all_cytokines.png"))

volcano_all_cytokines_plotly <- plotly::ggplotly(volcano_all_cytokines)
htmlwidgets::saveWidget(
                widget = volcano_all_cytokines_plotly,
                file = paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_CIS/",timepoint,"/volcano_all_cytokines.html"))


# all cytokines (with labels)
volcano_cytokines_with_labels <- genes_cytokines %>% 
  ggplot(mapping = aes(x=logFC, y=-log10(adj.P.Val), 
                       label=gene_name)) +
  
  geom_point(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 
                           0.05), 
             color="red", size=3,shape=21, fill="red") +
  
  geom_point(data=filter(genes_cytokines, logFC < 1 & logFC > -1 & 
                           adj.P.Val > 0.05), color="grey", 
             size=3,shape=21, fill="grey") +
  
  geom_point(data=filter(genes_cytokines, logFC < 1 & logFC > -1 & 
                                                      adj.P.Val <= 
                           0.05), color="green", size=3,shape=21, 
             fill="green") +
  
                               
  geom_point(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 0.05), color="red", size=3,shape=21, fill="red") +
  
                              
  geom_point(data=filter(genes_cytokines, logFC < -1 & adj.P.Val <= 0.05), color="blue", size=3,shape=21, fill="blue") +
                             
                      
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC > 1 & adj.P.Val <= 0.05),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
                               
                      
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC < -1 & adj.P.Val <= 0.05),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
                             
                               
  ggrepel::geom_label_repel(data=filter(genes_cytokines, logFC > -1 & logFC < 1),aes(label = gene_name) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
  
  geom_hline(yintercept = -log10(0.05), colour = "black", linetype 
             ="dashed") +
  
  geom_vline(xintercept = c(-1,1), colour="black", linetype 
             ="dashed") +
  
  ggtitle(paste("CIS_",timepoint,"_vs_","Control_",timepoint,": all_cytokines",sep="")) +
  
  theme(plot.title = element_text(hjust=0.5,face="bold")) +
  
  theme(axis.title = element_text(face="bold")) +
                           
  theme(axis.text = element_text(face="bold")) 

ggsave(paste0("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_CIS/",timepoint,"/volcano_all_cytokines_with_labels.png"), width = 17, height = 10)

}

```


#### 3h
```{r}
get_dea_results_Control_CIS("3h", fit_contrast_dea_Control_CIS_3h)
plot_genes_and_cytokines_dea_Control_CIS("3h")
```

#### 6h
```{r}
get_dea_results_Control_CIS("6h", fit_contrast_dea_Control_CIS_6h)
plot_genes_and_cytokines_dea_Control_CIS("6h")
```

#### 12h
```{r}
get_dea_results_Control_CIS("12h", fit_contrast_dea_Control_CIS_12h)
plot_genes_and_cytokines_dea_Control_CIS("12h")
```

#### 18h
```{r}
get_dea_results_Control_CIS("18h", fit_contrast_dea_Control_CIS_18h)
plot_genes_and_cytokines_dea_Control_CIS("18h")
```

#### 24h
```{r}
get_dea_results_Control_CIS("24h", fit_contrast_dea_Control_CIS_24h)
plot_genes_and_cytokines_dea_Control_CIS("24h")
```


















# Cytokines more expressed in MTX and/or OXA than in CIS


```{r}
# Get the cytokines more expressed in MTX than in CIS (while being up relative to control)
up_reg_cytokines_CIS_vs_Control_24h <- read_csv("~/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/24h/all_cytokines.csv") %>% filter(adj.P.Val <= 0.05 & logFC > 0)


# Get the cytokines more expressed in MTX than in CIS (while being down relative to control)
down_reg_cytokines_CIS_vs_Control_24h <- read_csv("~/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/24h/all_cytokines.csv") %>% filter(adj.P.Val <= 0.05 & logFC < 0)


up_reg_cytokines_MTX_vs_Cis_24h <- read_csv("~/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/24h/all_cytokines.csv") %>% filter(adj.P.Val <= 0.05 & logFC > 0)

cytokines_MTX_CIS_up <- intersect(up_reg_cytokines_CIS_vs_Control_24h$gene_name, up_reg_cytokines_MTX_vs_Cis_24h$gene_name)


cytokines_MTX_CIS_down <- intersect(down_reg_cytokines_CIS_vs_Control_24h$gene_name, up_reg_cytokines_MTX_vs_Cis_24h$gene_name)

```


## Up in MTX relative to CIS (+ up in CIS relative to control)


### Cxcl1
```{r}
counts_in_vitro_df_Cxcl1_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl1") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Cxcl1_CIS <- counts_in_vitro_df_Cxcl1_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl1_CIS$name <- rep("Cxcl1",5)
counts_in_vitro_df_Cxcl1_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Cxcl1_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl1") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Cxcl1_MTX <- counts_in_vitro_df_Cxcl1_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl1_MTX$name <- rep("Cxcl1",5)
counts_in_vitro_df_Cxcl1_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Cxcl1_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl1") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Cxcl1_OXA <- counts_in_vitro_df_Cxcl1_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl1_OXA$name <- rep("Cxcl1",5)
counts_in_vitro_df_Cxcl1_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Cxcl1_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl1") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Cxcl1_Control <- counts_in_vitro_df_Cxcl1_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl1_Control$name <- rep("Cxcl1",5)
counts_in_vitro_df_Cxcl1_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Cxcl1_all <- rbind(counts_in_vitro_df_Cxcl1_MTX, counts_in_vitro_df_Cxcl1_OXA, counts_in_vitro_df_Cxcl1_CIS, counts_in_vitro_df_Cxcl1_Control)


Cxcl1_expression <- ggplot(counts_in_vitro_df_Cxcl1_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Cxcl1") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/Longitudinal_Expression_Cxcl1.png")

```



### Ccl5
```{r}
counts_in_vitro_df_Ccl5_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl5") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Ccl5_CIS <- counts_in_vitro_df_Ccl5_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl5_CIS$name <- rep("Ccl5",5)
counts_in_vitro_df_Ccl5_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Ccl5_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl5") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Ccl5_MTX <- counts_in_vitro_df_Ccl5_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl5_MTX$name <- rep("Ccl5",5)
counts_in_vitro_df_Ccl5_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Ccl5_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl5") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Ccl5_OXA <- counts_in_vitro_df_Ccl5_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl5_OXA$name <- rep("Ccl5",5)
counts_in_vitro_df_Ccl5_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Ccl5_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl5") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Ccl5_Control <- counts_in_vitro_df_Ccl5_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl5_Control$name <- rep("Ccl5",5)
counts_in_vitro_df_Ccl5_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Ccl5_all <- rbind(counts_in_vitro_df_Ccl5_MTX, counts_in_vitro_df_Ccl5_OXA, counts_in_vitro_df_Ccl5_CIS, counts_in_vitro_df_Ccl5_Control)


Ccl5_expression <- ggplot(counts_in_vitro_df_Ccl5_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Ccl5") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/Longitudinal_Expression_Ccl5.png")

```



### Lif
```{r}
counts_in_vitro_df_Lif_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Lif") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Lif_CIS <- counts_in_vitro_df_Lif_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Lif") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Lif",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Lif_CIS$name <- rep("Lif",5)
counts_in_vitro_df_Lif_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Lif_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Lif") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Lif_MTX <- counts_in_vitro_df_Lif_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Lif") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Lif",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Lif_MTX$name <- rep("Lif",5)
counts_in_vitro_df_Lif_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Lif_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Lif") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Lif_OXA <- counts_in_vitro_df_Lif_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Lif") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Lif",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Lif_OXA$name <- rep("Lif",5)
counts_in_vitro_df_Lif_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Lif_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Lif") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Lif_Control <- counts_in_vitro_df_Lif_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Lif") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Lif",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Lif_Control$name <- rep("Lif",5)
counts_in_vitro_df_Lif_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Lif_all <- rbind(counts_in_vitro_df_Lif_MTX, counts_in_vitro_df_Lif_OXA, counts_in_vitro_df_Lif_CIS, counts_in_vitro_df_Lif_Control)


Lif_expression <- ggplot(counts_in_vitro_df_Lif_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Lif") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Lif.png")

```

## Up in MTX relative to CIS (+ down in CIS relative to control)

### Csf1
```{r}
counts_in_vitro_df_Csf1_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Csf1") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Csf1_CIS <- counts_in_vitro_df_Csf1_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Csf1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Csf1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Csf1_CIS$name <- rep("Csf1",5)
counts_in_vitro_df_Csf1_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Csf1_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Csf1") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Csf1_MTX <- counts_in_vitro_df_Csf1_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Csf1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Csf1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Csf1_MTX$name <- rep("Csf1",5)
counts_in_vitro_df_Csf1_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Csf1_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Csf1") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Csf1_OXA <- counts_in_vitro_df_Csf1_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Csf1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Csf1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Csf1_OXA$name <- rep("Csf1",5)
counts_in_vitro_df_Csf1_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Csf1_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Csf1") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Csf1_Control <- counts_in_vitro_df_Csf1_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Csf1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Csf1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Csf1_Control$name <- rep("Csf1",5)
counts_in_vitro_df_Csf1_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Csf1_all <- rbind(counts_in_vitro_df_Csf1_MTX, counts_in_vitro_df_Csf1_OXA, counts_in_vitro_df_Csf1_CIS, counts_in_vitro_df_Csf1_Control)


Csf1_expression <- ggplot(counts_in_vitro_df_Csf1_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Csf1") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Csf1.png")
```

### Ccl2
```{r}
counts_in_vitro_df_Ccl2_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl2") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Ccl2_CIS <- counts_in_vitro_df_Ccl2_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl2_CIS$name <- rep("Ccl2",5)
counts_in_vitro_df_Ccl2_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Ccl2_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl2") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Ccl2_MTX <- counts_in_vitro_df_Ccl2_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl2_MTX$name <- rep("Ccl2",5)
counts_in_vitro_df_Ccl2_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Ccl2_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl2") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Ccl2_OXA <- counts_in_vitro_df_Ccl2_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl2_OXA$name <- rep("Ccl2",5)
counts_in_vitro_df_Ccl2_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Ccl2_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl2") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Ccl2_Control <- counts_in_vitro_df_Ccl2_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl2_Control$name <- rep("Ccl2",5)
counts_in_vitro_df_Ccl2_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Ccl2_all <- rbind(counts_in_vitro_df_Ccl2_MTX, counts_in_vitro_df_Ccl2_OXA, counts_in_vitro_df_Ccl2_CIS, counts_in_vitro_df_Ccl2_Control)


Ccl2_expression <- ggplot(counts_in_vitro_df_Ccl2_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Ccl2") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Ccl2.png")
```


### Cxcl12
```{r}
counts_in_vitro_df_Cxcl12_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl12") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Cxcl12_CIS <- counts_in_vitro_df_Cxcl12_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl12") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl12",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl12_CIS$name <- rep("Cxcl12",5)
counts_in_vitro_df_Cxcl12_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Cxcl12_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl12") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Cxcl12_MTX <- counts_in_vitro_df_Cxcl12_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl12") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl12",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl12_MTX$name <- rep("Cxcl12",5)
counts_in_vitro_df_Cxcl12_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Cxcl12_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl12") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Cxcl12_OXA <- counts_in_vitro_df_Cxcl12_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl12") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl12",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl12_OXA$name <- rep("Cxcl12",5)
counts_in_vitro_df_Cxcl12_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Cxcl12_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl12") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Cxcl12_Control <- counts_in_vitro_df_Cxcl12_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl12") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl12",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl12_Control$name <- rep("Cxcl12",5)
counts_in_vitro_df_Cxcl12_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Cxcl12_all <- rbind(counts_in_vitro_df_Cxcl12_MTX, counts_in_vitro_df_Cxcl12_OXA, counts_in_vitro_df_Cxcl12_CIS, counts_in_vitro_df_Cxcl12_Control)


Cxcl12_expression <- ggplot(counts_in_vitro_df_Cxcl12_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Cxcl12") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Cxcl12.png")
```



### Il34
```{r}
counts_in_vitro_df_Il34_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Il34") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Il34_CIS <- counts_in_vitro_df_Il34_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il34") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il34",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il34_CIS$name <- rep("Il34",5)
counts_in_vitro_df_Il34_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Il34_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Il34") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Il34_MTX <- counts_in_vitro_df_Il34_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il34") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il34",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il34_MTX$name <- rep("Il34",5)
counts_in_vitro_df_Il34_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Il34_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Il34") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Il34_OXA <- counts_in_vitro_df_Il34_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il34") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il34",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il34_OXA$name <- rep("Il34",5)
counts_in_vitro_df_Il34_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Il34_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Il34") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Il34_Control <- counts_in_vitro_df_Il34_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il34") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il34",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il34_Control$name <- rep("Il34",5)
counts_in_vitro_df_Il34_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Il34_all <- rbind(counts_in_vitro_df_Il34_MTX, counts_in_vitro_df_Il34_OXA, counts_in_vitro_df_Il34_CIS, counts_in_vitro_df_Il34_Control)


Il34_expression <- ggplot(counts_in_vitro_df_Il34_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Il34") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Il34.png")
```

### Ccl17
```{r}
counts_in_vitro_df_Ccl17_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl17") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Ccl17_CIS <- counts_in_vitro_df_Ccl17_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl17") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl17",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl17_CIS$name <- rep("Ccl17",5)
counts_in_vitro_df_Ccl17_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Ccl17_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl17") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Ccl17_MTX <- counts_in_vitro_df_Ccl17_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl17") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl17",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl17_MTX$name <- rep("Ccl17",5)
counts_in_vitro_df_Ccl17_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Ccl17_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl17") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Ccl17_OXA <- counts_in_vitro_df_Ccl17_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl17") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl17",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl17_OXA$name <- rep("Ccl17",5)
counts_in_vitro_df_Ccl17_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Ccl17_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl17") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Ccl17_Control <- counts_in_vitro_df_Ccl17_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl17") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl17",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl17_Control$name <- rep("Ccl17",5)
counts_in_vitro_df_Ccl17_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Ccl17_all <- rbind(counts_in_vitro_df_Ccl17_MTX, counts_in_vitro_df_Ccl17_OXA, counts_in_vitro_df_Ccl17_CIS, counts_in_vitro_df_Ccl17_Control)


Ccl17_expression <- ggplot(counts_in_vitro_df_Ccl17_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Ccl17") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression") 
  
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Ccl17.png")
```

### Tgfb2
```{r}
counts_in_vitro_df_Tgfb2_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Tgfb2") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Tgfb2_CIS <- counts_in_vitro_df_Tgfb2_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tgfb2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tgfb2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tgfb2_CIS$name <- rep("Tgfb2",5)
counts_in_vitro_df_Tgfb2_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Tgfb2_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Tgfb2") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Tgfb2_MTX <- counts_in_vitro_df_Tgfb2_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tgfb2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tgfb2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tgfb2_MTX$name <- rep("Tgfb2",5)
counts_in_vitro_df_Tgfb2_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Tgfb2_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Tgfb2") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Tgfb2_OXA <- counts_in_vitro_df_Tgfb2_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tgfb2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tgfb2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tgfb2_OXA$name <- rep("Tgfb2",5)
counts_in_vitro_df_Tgfb2_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Tgfb2_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Tgfb2") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Tgfb2_Control <- counts_in_vitro_df_Tgfb2_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tgfb2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tgfb2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tgfb2_Control$name <- rep("Tgfb2",5)
counts_in_vitro_df_Tgfb2_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Tgfb2_all <- rbind(counts_in_vitro_df_Tgfb2_MTX, counts_in_vitro_df_Tgfb2_OXA, counts_in_vitro_df_Tgfb2_CIS, counts_in_vitro_df_Tgfb2_Control)


Tgfb2_expression <- ggplot(counts_in_vitro_df_Tgfb2_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Tgfb2") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression") 
  
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Tgfb2.png")
```


### Ccl9
```{r}
counts_in_vitro_df_Ccl9_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl9") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Ccl9_CIS <- counts_in_vitro_df_Ccl9_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl9") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl9",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl9_CIS$name <- rep("Ccl9",5)
counts_in_vitro_df_Ccl9_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Ccl9_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl9") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Ccl9_MTX <- counts_in_vitro_df_Ccl9_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl9") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl9",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl9_MTX$name <- rep("Ccl9",5)
counts_in_vitro_df_Ccl9_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Ccl9_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl9") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Ccl9_OXA <- counts_in_vitro_df_Ccl9_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl9") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl9",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl9_OXA$name <- rep("Ccl9",5)
counts_in_vitro_df_Ccl9_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Ccl9_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl9") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Ccl9_Control <- counts_in_vitro_df_Ccl9_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl9") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl9",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl9_Control$name <- rep("Ccl9",5)
counts_in_vitro_df_Ccl9_Control$treatment <- rep("Control",5)


counts_in_vitro_df_Ccl9_all <- rbind(counts_in_vitro_df_Ccl9_MTX, counts_in_vitro_df_Ccl9_OXA, counts_in_vitro_df_Ccl9_CIS, counts_in_vitro_df_Ccl9_Control)


Ccl9_expression <- ggplot(counts_in_vitro_df_Ccl9_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Ccl9") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression") 
  
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Ccl9.png")
```


### Tgfb1
```{r}
counts_in_vitro_df_Tgfb1_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Tgfb1") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Tgfb1_CIS <- counts_in_vitro_df_Tgfb1_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tgfb1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tgfb1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tgfb1_CIS$name <- rep("Tgfb1",5)
counts_in_vitro_df_Tgfb1_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Tgfb1_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Tgfb1") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Tgfb1_MTX <- counts_in_vitro_df_Tgfb1_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tgfb1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tgfb1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tgfb1_MTX$name <- rep("Tgfb1",5)
counts_in_vitro_df_Tgfb1_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Tgfb1_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Tgfb1") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Tgfb1_OXA <- counts_in_vitro_df_Tgfb1_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tgfb1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tgfb1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tgfb1_OXA$name <- rep("Tgfb1",5)
counts_in_vitro_df_Tgfb1_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Tgfb1_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Tgfb1") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Tgfb1_Control <- counts_in_vitro_df_Tgfb1_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tgfb1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tgfb1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tgfb1_Control$name <- rep("Tgfb1",5)
counts_in_vitro_df_Tgfb1_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Tgfb1_all <- rbind(counts_in_vitro_df_Tgfb1_MTX, counts_in_vitro_df_Tgfb1_OXA, counts_in_vitro_df_Tgfb1_CIS, counts_in_vitro_df_Tgfb1_Control)


Tgfb1_expression <- ggplot(counts_in_vitro_df_Tgfb1_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Tgfb1") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression") 
  
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Tgfb1.png")
```

### Il15
```{r}
counts_in_vitro_df_Il15_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Il15") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Il15_CIS <- counts_in_vitro_df_Il15_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il15") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il15",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il15_CIS$name <- rep("Il15",5)
counts_in_vitro_df_Il15_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Il15_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Il15") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Il15_MTX <- counts_in_vitro_df_Il15_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il15") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il15",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il15_MTX$name <- rep("Il15",5)
counts_in_vitro_df_Il15_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Il15_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Il15") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Il15_OXA <- counts_in_vitro_df_Il15_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il15") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il15",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il15_OXA$name <- rep("Il15",5)
counts_in_vitro_df_Il15_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Il15_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Il15") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Il15_Control <- counts_in_vitro_df_Il15_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il15") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il15",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il15_Control$name <- rep("Il15",5)
counts_in_vitro_df_Il15_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Il15_all <- rbind(counts_in_vitro_df_Il15_MTX, counts_in_vitro_df_Il15_OXA, counts_in_vitro_df_Il15_CIS, counts_in_vitro_df_Il15_Control)


Il15_expression <- ggplot(counts_in_vitro_df_Il15_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Il15") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression") 
  
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Il15.png")
```


### Il1a
```{r}
counts_in_vitro_df_Il1a_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Il1a") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Il1a_CIS <- counts_in_vitro_df_Il1a_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il1a") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il1a",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il1a_CIS$name <- rep("Il1a",5)
counts_in_vitro_df_Il1a_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Il1a_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Il1a") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Il1a_MTX <- counts_in_vitro_df_Il1a_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il1a") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il1a",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il1a_MTX$name <- rep("Il1a",5)
counts_in_vitro_df_Il1a_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Il1a_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Il1a") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Il1a_OXA <- counts_in_vitro_df_Il1a_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il1a") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il1a",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il1a_OXA$name <- rep("Il1a",5)
counts_in_vitro_df_Il1a_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Il1a_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Il1a") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Il1a_Control <- counts_in_vitro_df_Il1a_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il1a") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il1a",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il1a_Control$name <- rep("Il1a",5)
counts_in_vitro_df_Il1a_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Il1a_all <- rbind(counts_in_vitro_df_Il1a_MTX, counts_in_vitro_df_Il1a_OXA, counts_in_vitro_df_Il1a_CIS, counts_in_vitro_df_Il1a_Control)


Il1a_expression <- ggplot(counts_in_vitro_df_Il1a_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Il1a") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression") 
  
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Il1a.png")
```

### Cxcl5
```{r}
counts_in_vitro_df_Cxcl5_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl5") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Cxcl5_CIS <- counts_in_vitro_df_Cxcl5_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl5_CIS$name <- rep("Cxcl5",5)
counts_in_vitro_df_Cxcl5_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Cxcl5_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl5") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Cxcl5_MTX <- counts_in_vitro_df_Cxcl5_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl5_MTX$name <- rep("Cxcl5",5)
counts_in_vitro_df_Cxcl5_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Cxcl5_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl5") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Cxcl5_OXA <- counts_in_vitro_df_Cxcl5_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl5_OXA$name <- rep("Cxcl5",5)
counts_in_vitro_df_Cxcl5_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Cxcl5_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl5") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Cxcl5_Control <- counts_in_vitro_df_Cxcl5_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl5_Control$name <- rep("Cxcl5",5)
counts_in_vitro_df_Cxcl5_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Cxcl5_all <- rbind(counts_in_vitro_df_Cxcl5_MTX, counts_in_vitro_df_Cxcl5_OXA, counts_in_vitro_df_Cxcl5_CIS, counts_in_vitro_df_Cxcl5_Control)


Cxcl5_expression <- ggplot(counts_in_vitro_df_Cxcl5_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Cxcl5") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression") 
  
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Cxcl5.png")
```

### Il24
```{r}
counts_in_vitro_df_Il24_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Il24") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Il24_CIS <- counts_in_vitro_df_Il24_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il24") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il24",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il24_CIS$name <- rep("Il24",5)
counts_in_vitro_df_Il24_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Il24_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Il24") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Il24_MTX <- counts_in_vitro_df_Il24_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il24") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il24",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il24_MTX$name <- rep("Il24",5)
counts_in_vitro_df_Il24_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Il24_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Il24") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Il24_OXA <- counts_in_vitro_df_Il24_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il24") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il24",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il24_OXA$name <- rep("Il24",5)
counts_in_vitro_df_Il24_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Il24_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Il24") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Il24_Control <- counts_in_vitro_df_Il24_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il24") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il24",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il24_Control$name <- rep("Il24",5)
counts_in_vitro_df_Il24_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Il24_all <- rbind(counts_in_vitro_df_Il24_MTX, counts_in_vitro_df_Il24_OXA, counts_in_vitro_df_Il24_CIS, counts_in_vitro_df_Il24_Control)


Il24_expression <- ggplot(counts_in_vitro_df_Il24_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Il24") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression") 
  
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Il24.png")
```



### Ccl20
```{r}
counts_in_vitro_df_Ccl20_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl20") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Ccl20_CIS <- counts_in_vitro_df_Ccl20_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl20") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl20",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl20_CIS$name <- rep("Ccl20",5)
counts_in_vitro_df_Ccl20_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Ccl20_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl20") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Ccl20_MTX <- counts_in_vitro_df_Ccl20_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl20") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl20",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl20_MTX$name <- rep("Ccl20",5)
counts_in_vitro_df_Ccl20_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Ccl20_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl20") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Ccl20_OXA <- counts_in_vitro_df_Ccl20_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl20") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl20",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl20_OXA$name <- rep("Ccl20",5)
counts_in_vitro_df_Ccl20_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Ccl20_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl20") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Ccl20_Control <- counts_in_vitro_df_Ccl20_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl20") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl20",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl20_Control$name <- rep("Ccl20",5)
counts_in_vitro_df_Ccl20_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Ccl20_all <- rbind(counts_in_vitro_df_Ccl20_MTX, counts_in_vitro_df_Ccl20_OXA, counts_in_vitro_df_Ccl20_CIS, counts_in_vitro_df_Ccl20_Control)


Ccl20_expression <- ggplot(counts_in_vitro_df_Ccl20_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Ccl20") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression") 
  
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Ccl20.png")
```



### Hoxc9
```{r}
counts_in_vitro_df_Hoxc9_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Hoxc9") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Hoxc9_CIS <- counts_in_vitro_df_Hoxc9_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Hoxc9") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Hoxc9",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Hoxc9_CIS$name <- rep("Hoxc9",5)
counts_in_vitro_df_Hoxc9_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Hoxc9_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Hoxc9") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Hoxc9_MTX <- counts_in_vitro_df_Hoxc9_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Hoxc9") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Hoxc9",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Hoxc9_MTX$name <- rep("Hoxc9",5)
counts_in_vitro_df_Hoxc9_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Hoxc9_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Hoxc9") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Hoxc9_OXA <- counts_in_vitro_df_Hoxc9_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Hoxc9") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Hoxc9",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Hoxc9_OXA$name <- rep("Hoxc9",5)
counts_in_vitro_df_Hoxc9_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Hoxc9_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Hoxc9") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Hoxc9_Control <- counts_in_vitro_df_Hoxc9_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Hoxc9") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Hoxc9",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Hoxc9_Control$name <- rep("Hoxc9",5)
counts_in_vitro_df_Hoxc9_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Hoxc9_all <- rbind(counts_in_vitro_df_Hoxc9_MTX, counts_in_vitro_df_Hoxc9_OXA, counts_in_vitro_df_Hoxc9_CIS, counts_in_vitro_df_Hoxc9_Control)


Hoxc9_expression <- ggplot(counts_in_vitro_df_Hoxc9_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Hoxc9") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression") 
  
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Hoxc9.png")
```




### Tead2
```{r}
counts_in_vitro_df_Tead2_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Tead2") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Tead2_CIS <- counts_in_vitro_df_Tead2_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tead2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tead2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tead2_CIS$name <- rep("Tead2",5)
counts_in_vitro_df_Tead2_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Tead2_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Tead2") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Tead2_MTX <- counts_in_vitro_df_Tead2_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tead2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tead2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tead2_MTX$name <- rep("Tead2",5)
counts_in_vitro_df_Tead2_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Tead2_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Tead2") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Tead2_OXA <- counts_in_vitro_df_Tead2_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tead2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tead2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tead2_OXA$name <- rep("Tead2",5)
counts_in_vitro_df_Tead2_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Tead2_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Tead2") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Tead2_Control <- counts_in_vitro_df_Tead2_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tead2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tead2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tead2_Control$name <- rep("Tead2",5)
counts_in_vitro_df_Tead2_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Tead2_all <- rbind(counts_in_vitro_df_Tead2_MTX, counts_in_vitro_df_Tead2_OXA, counts_in_vitro_df_Tead2_CIS, counts_in_vitro_df_Tead2_Control)


Tead2_expression <- ggplot(counts_in_vitro_df_Tead2_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Tead2") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression") 
  
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Tead2.png")
```




### Dlx1
```{r}
counts_in_vitro_df_Dlx1_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Dlx1") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Dlx1_CIS <- counts_in_vitro_df_Dlx1_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Dlx1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Dlx1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Dlx1_CIS$name <- rep("Dlx1",5)
counts_in_vitro_df_Dlx1_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Dlx1_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Dlx1") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Dlx1_MTX <- counts_in_vitro_df_Dlx1_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Dlx1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Dlx1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Dlx1_MTX$name <- rep("Dlx1",5)
counts_in_vitro_df_Dlx1_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Dlx1_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Dlx1") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Dlx1_OXA <- counts_in_vitro_df_Dlx1_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Dlx1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Dlx1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Dlx1_OXA$name <- rep("Dlx1",5)
counts_in_vitro_df_Dlx1_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Dlx1_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Dlx1") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Dlx1_Control <- counts_in_vitro_df_Dlx1_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Dlx1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Dlx1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Dlx1_Control$name <- rep("Dlx1",5)
counts_in_vitro_df_Dlx1_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Dlx1_all <- rbind(counts_in_vitro_df_Dlx1_MTX, counts_in_vitro_df_Dlx1_OXA, counts_in_vitro_df_Dlx1_CIS, counts_in_vitro_df_Dlx1_Control)


Dlx1_expression <- ggplot(counts_in_vitro_df_Dlx1_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Dlx1") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression") 
  
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Dlx1.png")
```






### Dlx1
```{r}
counts_in_vitro_df_Dlx1_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Dlx1") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Dlx1_CIS <- counts_in_vitro_df_Dlx1_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Dlx1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Dlx1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Dlx1_CIS$name <- rep("Dlx1",5)
counts_in_vitro_df_Dlx1_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Dlx1_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Dlx1") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Dlx1_MTX <- counts_in_vitro_df_Dlx1_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Dlx1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Dlx1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Dlx1_MTX$name <- rep("Dlx1",5)
counts_in_vitro_df_Dlx1_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Dlx1_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Dlx1") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Dlx1_OXA <- counts_in_vitro_df_Dlx1_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Dlx1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Dlx1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Dlx1_OXA$name <- rep("Dlx1",5)
counts_in_vitro_df_Dlx1_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Dlx1_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Dlx1") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Dlx1_Control <- counts_in_vitro_df_Dlx1_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Dlx1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Dlx1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Dlx1_Control$name <- rep("Dlx1",5)
counts_in_vitro_df_Dlx1_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Dlx1_all <- rbind(counts_in_vitro_df_Dlx1_MTX, counts_in_vitro_df_Dlx1_OXA, counts_in_vitro_df_Dlx1_CIS, counts_in_vitro_df_Dlx1_Control)


Dlx1_expression <- ggplot(counts_in_vitro_df_Dlx1_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Dlx1") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression") 
  
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Dlx1.png")
```

## Up in OXA relative to CIS (+ up in CIS relative to control)

```{r}
# Get the cytokines more expressed in OXA than in CIS (while being up and down relative to control)
up_reg_cytokines_OXA_vs_Cis_24h <- read_csv("~/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/24h/all_cytokines.csv") %>% filter(adj.P.Val <= 0.05 & logFC > 0)

cytokines_OXA_CIS_up <- intersect(up_reg_cytokines_CIS_vs_Control_24h$gene_name, up_reg_cytokines_OXA_vs_Cis_24h$gene_name)
cytokines_OXA_CIS_down <- intersect(down_reg_cytokines_CIS_vs_Control_24h$gene_name, up_reg_cytokines_OXA_vs_Cis_24h$gene_name)



all_cytokines_interest_up <- intersect(cytokines_MTX_CIS_up, cytokines_OXA_CIS_up)
all_cytokines_interest_down <- intersect(cytokines_MTX_CIS_down, cytokines_OXA_CIS_down)
```

### Ccl25
```{r}
counts_in_vitro_df_Ccl25_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl25") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Ccl25_CIS <- counts_in_vitro_df_Ccl25_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl25") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl25",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl25_CIS$name <- rep("Ccl25",5)
counts_in_vitro_df_Ccl25_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Ccl25_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl25") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Ccl25_MTX <- counts_in_vitro_df_Ccl25_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl25") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl25",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl25_MTX$name <- rep("Ccl25",5)
counts_in_vitro_df_Ccl25_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Ccl25_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl25") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Ccl25_OXA <- counts_in_vitro_df_Ccl25_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl25") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl25",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl25_OXA$name <- rep("Ccl25",5)
counts_in_vitro_df_Ccl25_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Ccl25_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl25") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Ccl25_Control <- counts_in_vitro_df_Ccl25_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl25") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl25",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl25_Control$name <- rep("Ccl25",5)
counts_in_vitro_df_Ccl25_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Ccl25_all <- rbind(counts_in_vitro_df_Ccl25_MTX, counts_in_vitro_df_Ccl25_OXA, counts_in_vitro_df_Ccl25_CIS, counts_in_vitro_df_Ccl25_Control)



Ccl25_expression <- ggplot(counts_in_vitro_df_Ccl25_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment, size=1.1)) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Ccl25") +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme_bw() +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/Longitudinal_Expression_Ccl25.png")

```

### Il11
```{r}
counts_in_vitro_df_Il11_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Il11") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Il11_CIS <- counts_in_vitro_df_Il11_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il11") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il11",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il11_CIS$name <- rep("Il11",5)
counts_in_vitro_df_Il11_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Il11_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Il11") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Il11_MTX <- counts_in_vitro_df_Il11_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il11") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il11",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il11_MTX$name <- rep("Il11",5)
counts_in_vitro_df_Il11_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Il11_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Il11") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Il11_OXA <- counts_in_vitro_df_Il11_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il11") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il11",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il11_OXA$name <- rep("Il11",5)
counts_in_vitro_df_Il11_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Il11_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Il11") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Il11_Control <- counts_in_vitro_df_Il11_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il11") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il11",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il11_Control$name <- rep("Il11",5)
counts_in_vitro_df_Il11_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Il11_all <- rbind(counts_in_vitro_df_Il11_MTX, counts_in_vitro_df_Il11_OXA, counts_in_vitro_df_Il11_CIS, counts_in_vitro_df_Il11_Control)


Il11_expression <- ggplot(counts_in_vitro_df_Il11_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Il11") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/Longitudinal_Expression_Il11.png")
```


### Ccl5
```{r}
counts_in_vitro_df_Ccl5_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl5") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Ccl5_CIS <- counts_in_vitro_df_Ccl5_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl5_CIS$name <- rep("Ccl5",5)
counts_in_vitro_df_Ccl5_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Ccl5_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl5") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Ccl5_MTX <- counts_in_vitro_df_Ccl5_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl5_MTX$name <- rep("Ccl5",5)
counts_in_vitro_df_Ccl5_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Ccl5_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl5") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Ccl5_OXA <- counts_in_vitro_df_Ccl5_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl5_OXA$name <- rep("Ccl5",5)
counts_in_vitro_df_Ccl5_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Ccl5_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl5") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Ccl5_Control <- counts_in_vitro_df_Ccl5_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl5_Control$name <- rep("Ccl5",5)
counts_in_vitro_df_Ccl5_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Ccl5_all <- rbind(counts_in_vitro_df_Ccl5_MTX, counts_in_vitro_df_Ccl5_OXA, counts_in_vitro_df_Ccl5_CIS, counts_in_vitro_df_Ccl5_Control)


Ccl5_expression <- ggplot(counts_in_vitro_df_Ccl5_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Ccl5") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/Longitudinal_Expression_Ccl5.png")
```


## Up in OXA relative to CIS (+ down in CIS relative to control)


### Tgfb2
```{r}
counts_in_vitro_df_Tgfb2_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Tgfb2") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Tgfb2_CIS <- counts_in_vitro_df_Tgfb2_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tgfb2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tgfb2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tgfb2_CIS$name <- rep("Tgfb2",5)
counts_in_vitro_df_Tgfb2_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Tgfb2_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Tgfb2") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Tgfb2_MTX <- counts_in_vitro_df_Tgfb2_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tgfb2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tgfb2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tgfb2_MTX$name <- rep("Tgfb2",5)
counts_in_vitro_df_Tgfb2_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Tgfb2_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Tgfb2") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Tgfb2_OXA <- counts_in_vitro_df_Tgfb2_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tgfb2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tgfb2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tgfb2_OXA$name <- rep("Tgfb2",5)
counts_in_vitro_df_Tgfb2_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Tgfb2_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Tgfb2") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Tgfb2_Control <- counts_in_vitro_df_Tgfb2_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tgfb2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tgfb2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tgfb2_Control$name <- rep("Tgfb2",5)
counts_in_vitro_df_Tgfb2_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Tgfb2_all <- rbind(counts_in_vitro_df_Tgfb2_MTX, counts_in_vitro_df_Tgfb2_OXA, counts_in_vitro_df_Tgfb2_CIS, counts_in_vitro_df_Tgfb2_Control)



Tgfb2_expression <- ggplot(counts_in_vitro_df_Tgfb2_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Tgfb2") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/Longitudinal_Expression_Tgfb2.png")
```


### Il34
```{r}
counts_in_vitro_df_Il34_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Il34") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Il34_CIS <- counts_in_vitro_df_Il34_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il34") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il34",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il34_CIS$name <- rep("Il34",5)
counts_in_vitro_df_Il34_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Il34_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Il34") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Il34_MTX <- counts_in_vitro_df_Il34_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il34") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il34",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il34_MTX$name <- rep("Il34",5)
counts_in_vitro_df_Il34_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Il34_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Il34") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Il34_OXA <- counts_in_vitro_df_Il34_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il34") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il34",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il34_OXA$name <- rep("Il34",5)
counts_in_vitro_df_Il34_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Il34_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Il34") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Il34_Control <- counts_in_vitro_df_Il34_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il34") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il34",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il34_Control$name <- rep("Il34",5)
counts_in_vitro_df_Il34_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Il34_all <- rbind(counts_in_vitro_df_Il34_MTX, counts_in_vitro_df_Il34_OXA, counts_in_vitro_df_Il34_CIS, counts_in_vitro_df_Il34_Control)


Il34_expression <- ggplot(counts_in_vitro_df_Il34_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Il34") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/Longitudinal_Expression_Il34.png")
```

### Csf1
```{r}
counts_in_vitro_df_Csf1_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Csf1") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Csf1_CIS <- counts_in_vitro_df_Csf1_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Csf1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Csf1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Csf1_CIS$name <- rep("Csf1",5)
counts_in_vitro_df_Csf1_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Csf1_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Csf1") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Csf1_MTX <- counts_in_vitro_df_Csf1_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Csf1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Csf1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Csf1_MTX$name <- rep("Csf1",5)
counts_in_vitro_df_Csf1_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Csf1_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Csf1") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Csf1_OXA <- counts_in_vitro_df_Csf1_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Csf1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Csf1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Csf1_OXA$name <- rep("Csf1",5)
counts_in_vitro_df_Csf1_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Csf1_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Csf1") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Csf1_Control <- counts_in_vitro_df_Csf1_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Csf1") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Csf1",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Csf1_Control$name <- rep("Csf1",5)
counts_in_vitro_df_Csf1_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Csf1_all <- rbind(counts_in_vitro_df_Csf1_MTX, counts_in_vitro_df_Csf1_OXA, counts_in_vitro_df_Csf1_CIS, counts_in_vitro_df_Csf1_Control)


Csf1_expression <- ggplot(counts_in_vitro_df_Csf1_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Csf1") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/Longitudinal_Expression_Csf1.png")
```

### Ccl9
```{r}
counts_in_vitro_df_Ccl9_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl9") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Ccl9_CIS <- counts_in_vitro_df_Ccl9_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl9") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl9",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl9_CIS$name <- rep("Ccl9",5)
counts_in_vitro_df_Ccl9_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Ccl9_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl9") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Ccl9_MTX <- counts_in_vitro_df_Ccl9_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl9") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl9",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl9_MTX$name <- rep("Ccl9",5)
counts_in_vitro_df_Ccl9_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Ccl9_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl9") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Ccl9_OXA <- counts_in_vitro_df_Ccl9_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl9") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl9",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl9_OXA$name <- rep("Ccl9",5)
counts_in_vitro_df_Ccl9_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Ccl9_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl9") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Ccl9_Control <- counts_in_vitro_df_Ccl9_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl9") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl9",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl9_Control$name <- rep("Ccl9",5)
counts_in_vitro_df_Ccl9_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Ccl9_all <- rbind(counts_in_vitro_df_Ccl9_MTX, counts_in_vitro_df_Ccl9_OXA, counts_in_vitro_df_Ccl9_CIS, counts_in_vitro_df_Ccl9_Control)


Ccl9_expression <- ggplot(counts_in_vitro_df_Ccl9_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Ccl9") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/Longitudinal_Expression_Ccl9.png")
```





# Cytokines more expressed in CIS than in MTX and/or OXA


```{r}
# Get the cytokines more expressed in CIS than in MTX (while being up and down relative to control)
up_reg_cytokines_MTX_vs_Control_24h <- read_csv("~/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_Control/24h/all_cytokines.csv") %>% filter(logFC > 0 & adj.P.Val <= 0.05)

down_reg_cytokines_MTX_vs_Control_24h <- read_csv("~/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_Control/24h/all_cytokines.csv") %>% filter(logFC < 0 & adj.P.Val <= 0.05)

down_reg_cytokines_MTX_vs_Cis_24h <- read_csv("~/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/24h/all_cytokines.csv") %>% filter(adj.P.Val <= 0.05 & logFC < 0) %>% dplyr::arrange(logFC)

cytokines_CIS_MTX_up <- intersect(up_reg_cytokines_MTX_vs_Control_24h$gene_name, down_reg_cytokines_MTX_vs_Cis_24h$gene_name)

cytokines_CIS_MTX_down <- intersect(down_reg_cytokines_MTX_vs_Control_24h$gene_name, down_reg_cytokines_MTX_vs_Cis_24h$gene_name)


# Get the cytokines more expressed in CIS than in OXA (while being up and down relative to control)
up_reg_cytokines_OXA_vs_Control_24h <- read_csv("~/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_Control/24h/all_cytokines.csv") %>% filter(logFC > 0 & adj.P.Val <= 0.05)

down_reg_cytokines_OXA_vs_Control_24h <- read_csv("~/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_Control/24h/all_cytokines.csv") %>% filter(logFC < 0 & adj.P.Val <= 0.05)

down_reg_cytokines_OXA_vs_Cis_24h <- read_csv("~/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/24h/all_cytokines.csv") %>% filter(adj.P.Val <= 0.05 & logFC < 0) %>% dplyr::arrange(logFC)

cytokines_CIS_OXA_up <- intersect(up_reg_cytokines_OXA_vs_Control_24h$gene_name, down_reg_cytokines_OXA_vs_Cis_24h$gene_name)

cytokines_CIS_OXA_down <- intersect(down_reg_cytokines_OXA_vs_Control_24h$gene_name, down_reg_cytokines_OXA_vs_Cis_24h$gene_name)

all_cytokines_interest_up <- intersect(cytokines_CIS_MTX_up, cytokines_CIS_OXA_up)
all_cytokines_interest_down <- intersect(cytokines_CIS_MTX_down, cytokines_CIS_OXA_down)


```


## Up in CIS relative to MTX (+ up in MTX relative to control)

### Ccl25


### Csf3
```{r}
counts_in_vitro_df_Csf3_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Csf3") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Csf3_CIS <- counts_in_vitro_df_Csf3_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Csf3") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Csf3",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Csf3_CIS$name <- rep("Csf3",5)
counts_in_vitro_df_Csf3_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Csf3_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Csf3") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Csf3_MTX <- counts_in_vitro_df_Csf3_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Csf3") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Csf3",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Csf3_MTX$name <- rep("Csf3",5)
counts_in_vitro_df_Csf3_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Csf3_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Csf3") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Csf3_OXA <- counts_in_vitro_df_Csf3_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Csf3") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Csf3",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Csf3_OXA$name <- rep("Csf3",5)
counts_in_vitro_df_Csf3_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Csf3_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Csf3") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Csf3_Control <- counts_in_vitro_df_Csf3_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Csf3") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Csf3",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Csf3_Control$name <- rep("Csf3",5)
counts_in_vitro_df_Csf3_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Csf3_all <- rbind(counts_in_vitro_df_Csf3_MTX, counts_in_vitro_df_Csf3_OXA, counts_in_vitro_df_Csf3_CIS, counts_in_vitro_df_Csf3_Control)


Csf3_expression <- ggplot(counts_in_vitro_df_Csf3_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Csf3") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Csf3.png")
```


### Il6
```{r}
counts_in_vitro_df_Il6_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Il6") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Il6_CIS <- counts_in_vitro_df_Il6_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il6") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il6",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il6_CIS$name <- rep("Il6",5)
counts_in_vitro_df_Il6_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Il6_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Il6") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Il6_MTX <- counts_in_vitro_df_Il6_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il6") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il6",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il6_MTX$name <- rep("Il6",5)
counts_in_vitro_df_Il6_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Il6_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Il6") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Il6_OXA <- counts_in_vitro_df_Il6_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il6") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il6",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il6_OXA$name <- rep("Il6",5)
counts_in_vitro_df_Il6_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Il6_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Il6") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Il6_Control <- counts_in_vitro_df_Il6_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il6") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il6",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il6_Control$name <- rep("Il6",5)
counts_in_vitro_df_Il6_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Il6_all <- rbind(counts_in_vitro_df_Il6_MTX, counts_in_vitro_df_Il6_OXA, counts_in_vitro_df_Il6_CIS, counts_in_vitro_df_Il6_Control)


Il6_expression <- ggplot(counts_in_vitro_df_Il6_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Il6") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Il6.png")
```


### Ccl4
```{r}
counts_in_vitro_df_Ccl4_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl4") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Ccl4_CIS <- counts_in_vitro_df_Ccl4_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl4") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl4",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl4_CIS$name <- rep("Ccl4",5)
counts_in_vitro_df_Ccl4_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Ccl4_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl4") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Ccl4_MTX <- counts_in_vitro_df_Ccl4_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl4") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl4",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl4_MTX$name <- rep("Ccl4",5)
counts_in_vitro_df_Ccl4_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Ccl4_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl4") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Ccl4_OXA <- counts_in_vitro_df_Ccl4_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl4") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl4",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl4_OXA$name <- rep("Ccl4",5)
counts_in_vitro_df_Ccl4_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Ccl4_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl4") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Ccl4_Control <- counts_in_vitro_df_Ccl4_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl4") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl4",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl4_Control$name <- rep("Ccl4",5)
counts_in_vitro_df_Ccl4_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Ccl4_all <- rbind(counts_in_vitro_df_Ccl4_MTX, counts_in_vitro_df_Ccl4_OXA, counts_in_vitro_df_Ccl4_CIS, counts_in_vitro_df_Ccl4_Control)


Ccl4_expression <- ggplot(counts_in_vitro_df_Ccl4_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Ccl4") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Ccl4.png")
```



### Il11


### Il17f
```{r}
counts_in_vitro_df_Il17f_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Il17f") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Il17f_CIS <- counts_in_vitro_df_Il17f_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il17f") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il17f",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il17f_CIS$name <- rep("Il17f",5)
counts_in_vitro_df_Il17f_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Il17f_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Il17f") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Il17f_MTX <- counts_in_vitro_df_Il17f_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il17f") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il17f",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il17f_MTX$name <- rep("Il17f",5)
counts_in_vitro_df_Il17f_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Il17f_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Il17f") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Il17f_OXA <- counts_in_vitro_df_Il17f_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il17f") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il17f",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il17f_OXA$name <- rep("Il17f",5)
counts_in_vitro_df_Il17f_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Il17f_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Il17f") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Il17f_Control <- counts_in_vitro_df_Il17f_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il17f") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il17f",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il17f_Control$name <- rep("Il17f",5)
counts_in_vitro_df_Il17f_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Il17f_all <- rbind(counts_in_vitro_df_Il17f_MTX, counts_in_vitro_df_Il17f_OXA, counts_in_vitro_df_Il17f_CIS, counts_in_vitro_df_Il17f_Control)


Il17f_expression <- ggplot(counts_in_vitro_df_Il17f_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Il17f") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Il17f.png")
```

### Il23a
```{r}
counts_in_vitro_df_Il23a_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Il23a") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Il23a_CIS <- counts_in_vitro_df_Il23a_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il23a") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il23a",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il23a_CIS$name <- rep("Il23a",5)
counts_in_vitro_df_Il23a_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Il23a_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Il23a") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Il23a_MTX <- counts_in_vitro_df_Il23a_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il23a") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il23a",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il23a_MTX$name <- rep("Il23a",5)
counts_in_vitro_df_Il23a_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Il23a_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Il23a") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Il23a_OXA <- counts_in_vitro_df_Il23a_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il23a") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il23a",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il23a_OXA$name <- rep("Il23a",5)
counts_in_vitro_df_Il23a_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Il23a_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Il23a") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Il23a_Control <- counts_in_vitro_df_Il23a_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il23a") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il23a",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il23a_Control$name <- rep("Il23a",5)
counts_in_vitro_df_Il23a_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Il23a_all <- rbind(counts_in_vitro_df_Il23a_MTX, counts_in_vitro_df_Il23a_OXA, counts_in_vitro_df_Il23a_CIS, counts_in_vitro_df_Il23a_Control)


Il23a_expression <- ggplot(counts_in_vitro_df_Il23a_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Il23a") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Il23a.png")
```


### Tnfsf13b
```{r}
counts_in_vitro_df_Tnfsf13b_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Tnfsf13b") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Tnfsf13b_CIS <- counts_in_vitro_df_Tnfsf13b_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tnfsf13b") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tnfsf13b",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tnfsf13b_CIS$name <- rep("Tnfsf13b",5)
counts_in_vitro_df_Tnfsf13b_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Tnfsf13b_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Tnfsf13b") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Tnfsf13b_MTX <- counts_in_vitro_df_Tnfsf13b_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tnfsf13b") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tnfsf13b",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tnfsf13b_MTX$name <- rep("Tnfsf13b",5)
counts_in_vitro_df_Tnfsf13b_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Tnfsf13b_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Tnfsf13b") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Tnfsf13b_OXA <- counts_in_vitro_df_Tnfsf13b_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tnfsf13b") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tnfsf13b",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tnfsf13b_OXA$name <- rep("Tnfsf13b",5)
counts_in_vitro_df_Tnfsf13b_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Tnfsf13b_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Tnfsf13b") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Tnfsf13b_Control <- counts_in_vitro_df_Tnfsf13b_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tnfsf13b") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tnfsf13b",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tnfsf13b_Control$name <- rep("Tnfsf13b",5)
counts_in_vitro_df_Tnfsf13b_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Tnfsf13b_all <- rbind(counts_in_vitro_df_Tnfsf13b_MTX, counts_in_vitro_df_Tnfsf13b_OXA, counts_in_vitro_df_Tnfsf13b_CIS, counts_in_vitro_df_Tnfsf13b_Control)


Tnfsf13b_expression <- ggplot(counts_in_vitro_df_Tnfsf13b_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Tnfsf13b") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Tnfsf13b.png")
```


### Cxcl2
```{r}
counts_in_vitro_df_Cxcl2_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl2") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Cxcl2_CIS <- counts_in_vitro_df_Cxcl2_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl2_CIS$name <- rep("Cxcl2",5)
counts_in_vitro_df_Cxcl2_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Cxcl2_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl2") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Cxcl2_MTX <- counts_in_vitro_df_Cxcl2_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl2_MTX$name <- rep("Cxcl2",5)
counts_in_vitro_df_Cxcl2_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Cxcl2_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl2") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Cxcl2_OXA <- counts_in_vitro_df_Cxcl2_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl2_OXA$name <- rep("Cxcl2",5)
counts_in_vitro_df_Cxcl2_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Cxcl2_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl2") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Cxcl2_Control <- counts_in_vitro_df_Cxcl2_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl2") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl2",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl2_Control$name <- rep("Cxcl2",5)
counts_in_vitro_df_Cxcl2_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Cxcl2_all <- rbind(counts_in_vitro_df_Cxcl2_MTX, counts_in_vitro_df_Cxcl2_OXA, counts_in_vitro_df_Cxcl2_CIS, counts_in_vitro_df_Cxcl2_Control)


Cxcl2_expression <- ggplot(counts_in_vitro_df_Cxcl2_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Cxcl2") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Cxcl2.png")
```


## Up in CIS relative to MTX (+ down in MTX relative to control)


### Tgfb3
```{r}
counts_in_vitro_df_Tgfb3_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Tgfb3") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Tgfb3_CIS <- counts_in_vitro_df_Tgfb3_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tgfb3") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tgfb3",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tgfb3_CIS$name <- rep("Tgfb3",5)
counts_in_vitro_df_Tgfb3_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Tgfb3_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Tgfb3") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Tgfb3_MTX <- counts_in_vitro_df_Tgfb3_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tgfb3") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tgfb3",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tgfb3_MTX$name <- rep("Tgfb3",5)
counts_in_vitro_df_Tgfb3_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Tgfb3_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Tgfb3") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Tgfb3_OXA <- counts_in_vitro_df_Tgfb3_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tgfb3") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tgfb3",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tgfb3_OXA$name <- rep("Tgfb3",5)
counts_in_vitro_df_Tgfb3_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Tgfb3_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Tgfb3") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Tgfb3_Control <- counts_in_vitro_df_Tgfb3_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Tgfb3") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Tgfb3",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Tgfb3_Control$name <- rep("Tgfb3",5)
counts_in_vitro_df_Tgfb3_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Tgfb3_all <- rbind(counts_in_vitro_df_Tgfb3_MTX, counts_in_vitro_df_Tgfb3_OXA, counts_in_vitro_df_Tgfb3_CIS, counts_in_vitro_df_Tgfb3_Control)


Tgfb3_expression <- ggplot(counts_in_vitro_df_Tgfb3_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Tgfb3") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Tgfb3.png")
```


### Il5
```{r}
counts_in_vitro_df_Il5_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Il5") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Il5_CIS <- counts_in_vitro_df_Il5_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il5_CIS$name <- rep("Il5",5)
counts_in_vitro_df_Il5_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Il5_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Il5") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Il5_MTX <- counts_in_vitro_df_Il5_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il5_MTX$name <- rep("Il5",5)
counts_in_vitro_df_Il5_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Il5_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Il5") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Il5_OXA <- counts_in_vitro_df_Il5_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il5_OXA$name <- rep("Il5",5)
counts_in_vitro_df_Il5_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Il5_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Il5") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Il5_Control <- counts_in_vitro_df_Il5_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Il5_Control$name <- rep("Il5",5)
counts_in_vitro_df_Il5_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Il5_all <- rbind(counts_in_vitro_df_Il5_MTX, counts_in_vitro_df_Il5_OXA, counts_in_vitro_df_Il5_CIS, counts_in_vitro_df_Il5_Control)



Il5_expression <- ggplot(counts_in_vitro_df_Il5_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Il5") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Il5.png")
```


### Il5 (raw counts)
```{r}
raw_counts_Il5 <- counts_in_vitro_df %>% dplyr::filter(gene_name == "Il5") %>% column_to_rownames(var = "gene_name") %>% dplyr::select(-c("gene_id","gene_type"))
raw_counts_in_vitro_df_Il5_CIS <- raw_counts_Il5 %>% filter(rownames(.) == "Il5") %>% dplyr::select(contains("CIS"))
raw_counts_in_vitro_df_Il5_CIS <- raw_counts_in_vitro_df_Il5_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
raw_counts_in_vitro_df_Il5_CIS$name <- rep("Il5",5)
raw_counts_in_vitro_df_Il5_CIS$treatment <- rep("CIS",5)


raw_counts_in_vitro_df_Il5_MTX <- raw_counts_Il5 %>% filter(rownames(.) == "Il5") %>% dplyr::select(contains("MTX"))
raw_counts_in_vitro_df_Il5_MTX <- raw_counts_in_vitro_df_Il5_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
raw_counts_in_vitro_df_Il5_MTX$name <- rep("Il5",5)
raw_counts_in_vitro_df_Il5_MTX$treatment <- rep("MTX",5)

raw_counts_in_vitro_df_Il5_OXA <- raw_counts_Il5 %>% filter(rownames(.) == "Il5") %>% dplyr::select(contains("OXA"))
raw_counts_in_vitro_df_Il5_OXA <- raw_counts_in_vitro_df_Il5_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
raw_counts_in_vitro_df_Il5_OXA$name <- rep("Il5",5)
raw_counts_in_vitro_df_Il5_OXA$treatment <- rep("OXA",5)

raw_counts_in_vitro_df_Il5_Control <- raw_counts_Il5 %>% filter(rownames(.) == "Il5") %>% dplyr::select(contains("Control"))
raw_counts_in_vitro_df_Il5_Control <- raw_counts_in_vitro_df_Il5_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Il5") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Il5",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
raw_counts_in_vitro_df_Il5_Control$name <- rep("Il5",5)
raw_counts_in_vitro_df_Il5_Control$treatment <- rep("Control",5)

raw_counts_in_vitro_df_Il5_all <- rbind(raw_counts_in_vitro_df_Il5_MTX, raw_counts_in_vitro_df_Il5_OXA, raw_counts_in_vitro_df_Il5_CIS, raw_counts_in_vitro_df_Il5_Control)

# Il5
Il5_raw_expression <- ggplot(raw_counts_in_vitro_df_Il5_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal raw expression of Il5") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_raw_expression")

ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Il5_raw_counts.png")
```


## Up in CIS relative to OXA (+ up in OXA relative to control)

### Il5

### Csf3

### Cxcl10 

```{r}
counts_in_vitro_df_Cxcl10_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl10") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Cxcl10_CIS <- counts_in_vitro_df_Cxcl10_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl10") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl10",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl10_CIS$name <- rep("Cxcl10",5)
counts_in_vitro_df_Cxcl10_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Cxcl10_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl10") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Cxcl10_MTX <- counts_in_vitro_df_Cxcl10_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl10") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl10",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl10_MTX$name <- rep("Cxcl10",5)
counts_in_vitro_df_Cxcl10_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Cxcl10_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl10") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Cxcl10_OXA <- counts_in_vitro_df_Cxcl10_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl10") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl10",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl10_OXA$name <- rep("Cxcl10",5)
counts_in_vitro_df_Cxcl10_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Cxcl10_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl10") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Cxcl10_Control <- counts_in_vitro_df_Cxcl10_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl10") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl10",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl10_Control$name <- rep("Cxcl10",5)
counts_in_vitro_df_Cxcl10_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Cxcl10_all <- rbind(counts_in_vitro_df_Cxcl10_MTX, counts_in_vitro_df_Cxcl10_OXA, counts_in_vitro_df_Cxcl10_CIS, counts_in_vitro_df_Cxcl10_Control)


Cxcl10_expression <- ggplot(counts_in_vitro_df_Cxcl10_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Cxcl10") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Cxcl10.png")
```


### Ccl4

### Cxcl11
```{r}
counts_in_vitro_df_Cxcl11_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl11") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Cxcl11_CIS <- counts_in_vitro_df_Cxcl11_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl11") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl11",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl11_CIS$name <- rep("Cxcl11",5)
counts_in_vitro_df_Cxcl11_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Cxcl11_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl11") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Cxcl11_MTX <- counts_in_vitro_df_Cxcl11_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl11") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl11",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl11_MTX$name <- rep("Cxcl11",5)
counts_in_vitro_df_Cxcl11_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Cxcl11_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl11") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Cxcl11_OXA <- counts_in_vitro_df_Cxcl11_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl11") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl11",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl11_OXA$name <- rep("Cxcl11",5)
counts_in_vitro_df_Cxcl11_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Cxcl11_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Cxcl11") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Cxcl11_Control <- counts_in_vitro_df_Cxcl11_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Cxcl11") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Cxcl11",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Cxcl11_Control$name <- rep("Cxcl11",5)
counts_in_vitro_df_Cxcl11_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Cxcl11_all <- rbind(counts_in_vitro_df_Cxcl11_MTX, counts_in_vitro_df_Cxcl11_OXA, counts_in_vitro_df_Cxcl11_CIS, counts_in_vitro_df_Cxcl11_Control)


Cxcl11_expression <- ggplot(counts_in_vitro_df_Cxcl11_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Cxcl11") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Cxcl11.png")
```


### Il6


## Up in CIS relative to OXA (+ down in OXA relative to control)


### Ccl7


```{r}
counts_in_vitro_df_Ccl7_CIS <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl7") %>% dplyr::select(contains("CIS"))
counts_in_vitro_df_Ccl7_CIS <- counts_in_vitro_df_Ccl7_CIS[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl7") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl7",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl7_CIS$name <- rep("Ccl7",5)
counts_in_vitro_df_Ccl7_CIS$treatment <- rep("CIS",5)


counts_in_vitro_df_Ccl7_MTX <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl7") %>% dplyr::select(contains("MTX"))
counts_in_vitro_df_Ccl7_MTX <- counts_in_vitro_df_Ccl7_MTX[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl7") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl7",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl7_MTX$name <- rep("Ccl7",5)
counts_in_vitro_df_Ccl7_MTX$treatment <- rep("MTX",5)

counts_in_vitro_df_Ccl7_OXA <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl7") %>% dplyr::select(contains("OXA"))
counts_in_vitro_df_Ccl7_OXA <- counts_in_vitro_df_Ccl7_OXA[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl7") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl7",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl7_OXA$name <- rep("Ccl7",5)
counts_in_vitro_df_Ccl7_OXA$treatment <- rep("OXA",5)

counts_in_vitro_df_Ccl7_Control <- object_for_cytokine_expression %>% filter(rownames(.) == "Ccl7") %>% dplyr::select(contains("Control"))
counts_in_vitro_df_Ccl7_Control <- counts_in_vitro_df_Ccl7_Control[,c(1:3,7:9,13:15,4:6,10:12)] %>% as.data.frame() %>% t() %>% as.data.frame() %>%  dplyr::rename("Mean_Expression" = "Ccl7") %>% dplyr::mutate(timepoint = c(rep(3,3),rep(6,3),rep(12,3),rep(18,3),rep(24,3)), rep("Ccl7",15)) %>% group_by(timepoint) %>% summarise(Mean_Expression = mean(Mean_Expression)) %>% as.data.frame()
counts_in_vitro_df_Ccl7_Control$name <- rep("Ccl7",5)
counts_in_vitro_df_Ccl7_Control$treatment <- rep("Control",5)

counts_in_vitro_df_Ccl7_all <- rbind(counts_in_vitro_df_Ccl7_MTX, counts_in_vitro_df_Ccl7_OXA, counts_in_vitro_df_Ccl7_CIS, counts_in_vitro_df_Ccl7_Control)


Ccl7_expression <- ggplot(counts_in_vitro_df_Ccl7_all, mapping = aes(x = factor(timepoint, levels=c("3","6","12","18","24")), y = Mean_Expression)) +
  geom_point(size = 2, shape=21, aes(color = treatment, fill=treatment)) +
  #ggrepel::geom_label_repel(aes(label=name, fill=treatment), label.size = 0.15, label.padding = 0.10) +
  geom_line(aes(color=treatment, group=treatment), size=1.1) +
  scale_fill_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  scale_color_brewer(palette = "Set2", guide = guide_legend(override.aes = aes(label = "")), name = "Treatment") +
  ggtitle("Longitudinal expression of Ccl7") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5, face="bold")) +
  theme(axis.title = element_text(face="bold")) +
  theme(axis.text = element_text(face="bold")) +
  labs(x = "Timepoint", y = "Mean_Expression")
ggsave("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/Longitudinal_Expression_Ccl7.png")
```


### Tgfb1


### Tgfb3


### Cxcl1


### Lif





# Transcription factor activity inference

## DecoupleR

### Ccl5


```{r}
# Import table of counts
counts_in_vitro_df <- readRDS("Bulk_RNA_in_vitro/preprocessing_in_vitro_RNA/counts_in_vitro_for_analysis.rds") %>% as.data.frame()
rownames(counts_in_vitro_df) <- make.names(counts_in_vitro_df$gene_name, unique=TRUE)
counts_in_vitro_df <- counts_in_vitro_df %>% dplyr::select(-c("gene_id", "gene_type","gene_name"))

# Import collectri and tfs which target Ccl5
collectri_df <- get_collectri(organism="mouse", split_complexes = FALSE) %>% as.data.frame()
collectri_df_Ccl5 <- collectri_df %>% dplyr::group_by(source) %>% dplyr::summarise(target_Ccl5 = any(target == "Ccl5")) %>% as.data.frame() %>% filter(target_Ccl5 == "TRUE")
collectri_df_for_Ccl5 <- collectri_df %>% dplyr::filter(source %in% collectri_df_Ccl5$source)

```



#### MTX vs CIS
```{r}
# Get t-values for MTX_24h vs CIS_24h
get_t_values_Ccl5_MTX_CIS_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Ccl5_MTX_CIS_24h) <- make.names(get_t_values_Ccl5_MTX_CIS_24h$gene_name, unique=TRUE)
get_t_values_Ccl5_MTX_CIS_24h <- get_t_values_Ccl5_MTX_CIS_24h %>% dplyr::select(-"gene_name")


# Run decoupleR for MTX_24h vs CIS_24h
Ccl5_activity_MTX_24h_vs_CIS_24h <- run_ulm(mat=get_t_values_Ccl5_MTX_CIS_24h, net=collectri_df_for_Ccl5, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing the activity of the 38 tfs
tf_Ccl5_activity_MTX_24h_vs_CIS_24h <- Ccl5_activity_MTX_24h_vs_CIS_24h %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl5_activity_MTX_24h_vs_CIS_24h$score > 0 & p-value <= 0.05

tf_Ccl5_activity_MTX_24h_vs_CIS_24h[msk, 'rnk'] <- rank(-tf_Ccl5_activity_MTX_24h_vs_CIS_24h[msk, 'score'])

tf_Ccl5_activity_MTX_24h_vs_CIS_24h[!msk, 'rnk'] <- rank(-abs(tf_Ccl5_activity_MTX_24h_vs_CIS_24h[!msk, 'score']))

tf_Ccl5_activity_MTX_24h_vs_CIS_24h <- tf_Ccl5_activity_MTX_24h_vs_CIS_24h %>% dplyr::arrange(rnk)

# Plot
ggplot(tf_Ccl5_activity_MTX_24h_vs_CIS_24h, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```



#### OXA vs CIS
```{r}
# Get t-values for OXA_24h vs CIS_24h
get_t_values_Ccl5_OXA_CIS_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Ccl5_OXA_CIS_24h) <- make.names(get_t_values_Ccl5_OXA_CIS_24h$gene_name, unique=TRUE)
get_t_values_Ccl5_OXA_CIS_24h <- get_t_values_Ccl5_OXA_CIS_24h %>% dplyr::select(-"gene_name")


# Run decoupleR for OXA_24h vs CIS_24h
Ccl5_activity_OXA_24h_vs_CIS_24h <- run_ulm(mat=get_t_values_Ccl5_OXA_CIS_24h, net=collectri_df_for_Ccl5, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing the activity of the 38 tfs
tf_Ccl5_activity_OXA_24h_vs_CIS_24h <- Ccl5_activity_OXA_24h_vs_CIS_24h %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl5_activity_OXA_24h_vs_CIS_24h$score > 0 & p-value <= 0.05

tf_Ccl5_activity_OXA_24h_vs_CIS_24h[msk, 'rnk'] <- rank(-tf_Ccl5_activity_OXA_24h_vs_CIS_24h[msk, 'score'])

tf_Ccl5_activity_OXA_24h_vs_CIS_24h[!msk, 'rnk'] <- rank(-abs(tf_Ccl5_activity_OXA_24h_vs_CIS_24h[!msk, 'score']))

tf_Ccl5_activity_OXA_24h_vs_CIS_24h <- tf_Ccl5_activity_OXA_24h_vs_CIS_24h %>% dplyr::arrange(rnk)

# Plot
ggplot(tf_Ccl5_activity_OXA_24h_vs_CIS_24h, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```



#### MTX vs Control
```{r}
# Get t-values for MTX_24h vs Control_24h
get_t_values_Ccl5_MTX_Control_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_Control/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Ccl5_MTX_Control_24h) <- make.names(get_t_values_Ccl5_MTX_Control_24h$gene_name, unique=TRUE)
get_t_values_Ccl5_MTX_Control_24h <- get_t_values_Ccl5_MTX_Control_24h %>% dplyr::select(-"gene_name")


# Run decoupleR for MTX_24h vs Control_24h
Ccl5_activity_MTX_24h_vs_Control_24h <- run_ulm(mat=get_t_values_Ccl5_MTX_Control_24h, net=collectri_df_for_Ccl5, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing the activity of the 38 tfs
tf_Ccl5_activity_MTX_24h_vs_Control_24h <- Ccl5_activity_MTX_24h_vs_Control_24h %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl5_activity_MTX_24h_vs_Control_24h$score > 0 & p-value <= 0.05

tf_Ccl5_activity_MTX_24h_vs_Control_24h[msk, 'rnk'] <- rank(-tf_Ccl5_activity_MTX_24h_vs_Control_24h[msk, 'score'])

tf_Ccl5_activity_MTX_24h_vs_Control_24h[!msk, 'rnk'] <- rank(-abs(tf_Ccl5_activity_MTX_24h_vs_Control_24h[!msk, 'score']))

tf_Ccl5_activity_MTX_24h_vs_Control_24h <- tf_Ccl5_activity_MTX_24h_vs_Control_24h %>% dplyr::arrange(rnk)

# Plot
ggplot(tf_Ccl5_activity_MTX_24h_vs_Control_24h, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```



#### OXA vs Control
```{r}
# Get t-values for OXA_24h vs Control_24h
get_t_values_Ccl5_OXA_Control_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_Control/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Ccl5_OXA_Control_24h) <- make.names(get_t_values_Ccl5_OXA_Control_24h$gene_name, unique=TRUE)
get_t_values_Ccl5_OXA_Control_24h <- get_t_values_Ccl5_OXA_Control_24h %>% dplyr::select(-"gene_name")


# Run decoupleR for OXA_24h vs Control_24h
Ccl5_activity_OXA_24h_vs_Control_24h <- run_ulm(mat=get_t_values_Ccl5_OXA_Control_24h, net=collectri_df_for_Ccl5, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing the activity of the 38 tfs
tf_Ccl5_activity_OXA_24h_vs_Control_24h <- Ccl5_activity_OXA_24h_vs_Control_24h %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl5_activity_OXA_24h_vs_Control_24h$score > 0 & p-value <= 0.05

tf_Ccl5_activity_OXA_24h_vs_Control_24h[msk, 'rnk'] <- rank(-tf_Ccl5_activity_OXA_24h_vs_Control_24h[msk, 'score'])

tf_Ccl5_activity_OXA_24h_vs_Control_24h[!msk, 'rnk'] <- rank(-abs(tf_Ccl5_activity_OXA_24h_vs_Control_24h[!msk, 'score']))

tf_Ccl5_activity_OXA_24h_vs_Control_24h <- tf_Ccl5_activity_OXA_24h_vs_Control_24h %>% dplyr::arrange(rnk)

# Plot
ggplot(tf_Ccl5_activity_OXA_24h_vs_Control_24h, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```



#### All samples
```{r}
voom_for_decoupleR <- voom$E %>% bind_cols(voom$genes) %>% as.data.frame()
rownames(voom_for_decoupleR) <- make.names(voom_for_decoupleR$genes, unique=TRUE)
voom_for_decoupleR_final <- voom_for_decoupleR %>% select(-"genes") %>% select(contains("24h"))
run_decoupleR_all_samples <- run_ulm(mat = voom_for_decoupleR_final, net = collectri_df_for_Ccl5, .source = "source", .target = "target", .mor="mor", minsize = 5) 


run_decoupleR_all_samples_mat <- run_decoupleR_all_samples %>%
  pivot_wider(id_cols = 'condition', names_from = 'source',
              values_from = 'score') %>%
  column_to_rownames('condition') %>%
  as.matrix()

run_decoupleR_all_samples_mat_scaled <- scale(run_decoupleR_all_samples_mat)

palette_length = 100
my_color = colorRampPalette(c("Darkblue", "white","red"))(palette_length)

my_breaks <- c(seq(-3, 0, length.out=ceiling(palette_length/2) + 1),
               seq(0.05, 3, length.out=floor(palette_length/2)))

# Plot
library(pheatmap)
pheatmap(t(run_decoupleR_all_samples_mat_scaled), border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE) 

run_decoupleR_all_samples_mat_scaled_tf_interest_Ccl5 <- run_decoupleR_all_samples_mat_scaled %>% as.data.frame() %>% dplyr::select(all_of(intersect_MTX_OXA_CIS_Control_Ccl5_not_filtered))
  
new_df <- data.frame(sample = rep(c("MTX","OXA","CIS","Control"), c(3,3,3,3)))
rownames(new_df) <- colnames(t(run_decoupleR_all_samples_mat_scaled_tf_interest_Ccl5))

pheatmap_Ccl5 <- pheatmap(t(run_decoupleR_all_samples_mat_scaled_tf_interest_Ccl5) , border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, annotation_col = new_df, show_colnames = F) 

```






### Get TFs of Ccl5 with greater activity in MTX and in OXA than in CIS (without filter on p-value)
```{r}
# greater activity in MTX and OXA than in CIS
tf_Ccl5_higher_activity_in_MTX_24h_than_in_CIS_24h_not_filtered <- tf_Ccl5_activity_MTX_24h_vs_CIS_24h %>% filter(score > 0 & p-value <= 0.05) %>% arrange(rnk)


tf_Ccl5_higher_activity_in_OXA_24h_than_in_CIS_24h_not_filtered <- tf_Ccl5_activity_OXA_24h_vs_CIS_24h %>% filter(score > 0 & p-value <= 0.05) %>% arrange(rnk)

# Intersection
intersect_MTX_OXA_vs_CIS_Ccl5_not_filtered <- intersect(tf_Ccl5_higher_activity_in_MTX_24h_than_in_CIS_24h_not_filtered$source, tf_Ccl5_higher_activity_in_OXA_24h_than_in_CIS_24h_not_filtered$source)

```

### Get TFs of Ccl5 with greater activity in MTX and in OXA than in CIS (with filter on p-value)
```{r}
# greater activity in MTX and OXA than in CIS
tf_Ccl5_higher_activity_in_MTX_24h_than_in_CIS_24h_filtered <- tf_Ccl5_activity_MTX_24h_vs_CIS_24h %>% filter(score > 0 & p-value <= 0.05 & p_value <= 0.05) %>% arrange(rnk)


tf_Ccl5_higher_activity_in_OXA_24h_than_in_CIS_24h_filtered <- tf_Ccl5_activity_OXA_24h_vs_CIS_24h %>% filter(score > 0 & p-value <= 0.05 & p_value <= 0.05) %>% arrange(rnk)

# Intersection
intersect_MTX_OXA_vs_CIS_Ccl5_filtered <- intersect(tf_Ccl5_higher_activity_in_MTX_24h_than_in_CIS_24h_filtered$source, tf_Ccl5_higher_activity_in_OXA_24h_than_in_CIS_24h_filtered$source)
collectri_df_for_Ccl5 %>% filter(source %in% intersect_MTX_OXA_vs_CIS & target == "Ccl5")
```


### Get TFs with greater activity in MTX and OXA than in Control (without filter on p-value)
```{r}
tf_Ccl5_higher_activity_in_MTX_24h_than_in_Control_24h_not_filtered <- tf_Ccl5_activity_MTX_24h_vs_Control_24h %>% filter(score > 0 & p-value <= 0.05) %>% arrange(rnk)

tf_Ccl5_higher_activity_in_OXA_24h_than_in_Control_24h_not_filtered <- tf_Ccl5_activity_OXA_24h_vs_Control_24h %>% filter(score > 0 & p-value <= 0.05) %>% arrange(rnk)

intersect_MTX_OXA_vs_Control_Ccl5_not_filtered <- intersect(tf_Ccl5_higher_activity_in_MTX_24h_than_in_Control_24h_not_filtered$source, tf_Ccl5_higher_activity_in_OXA_24h_than_in_Control_24h_not_filtered$source)
```


### Get TFs with greater activity in MTX and OXA than in Control (with filter on p-value)
```{r}
tf_Ccl5_higher_activity_in_MTX_24h_than_in_Control_24h_filtered <- tf_Ccl5_activity_MTX_24h_vs_Control_24h %>% filter(score > 0 & p-value <= 0.05 & p_value <= 0.05) %>% arrange(rnk)

tf_Ccl5_higher_activity_in_OXA_24h_than_in_Control_24h_filtered <- tf_Ccl5_activity_OXA_24h_vs_Control_24h %>% filter(score > 0 & p-value <= 0.05 & p_value <= 0.05) %>% arrange(rnk)

intersect_MTX_OXA_vs_Control_Ccl5_filtered <- intersect(tf_Ccl5_higher_activity_in_MTX_24h_than_in_Control_24h_filtered$source, tf_Ccl5_higher_activity_in_OXA_24h_than_in_Control_24h_filtered$source)
```


### Get the TFs of Ccl5 with greater activity in MTX and OXA than in CIS and Control (not filtered on p-value)
```{r}

intersect_MTX_OXA_CIS_Control_Ccl5_not_filtered <- intersect(intersect_MTX_OXA_vs_CIS_Ccl5_not_filtered, intersect_MTX_OXA_vs_Control_Ccl5_not_filtered)

```

### Get the TFs of Ccl5 with greater activity in MTX and OXA than in CIS and Control (filtered on p-value)

```{r}
intersect_MTX_OXA_CIS_Control_Ccl5_filtered <- intersect(intersect_MTX_OXA_vs_CIS_Ccl5_filtered, intersect_MTX_OXA_vs_Control_Ccl5_filtered)

```






### Get the genes with expression concordant with TF activity


#### Junb
```{r}
get_t_values_Ccl5_MTX_CIS_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/24h/diff_genes.csv") %>% select(c("t","gene_name", "logFC", "adj.P.Val")) 
rownames(get_t_values_Ccl5_MTX_CIS_24h) <- make.names(get_t_values_Ccl5_MTX_CIS_24h$gene_name, unique = TRUE)
get_t_values_Ccl5_MTX_CIS_24h <- get_t_values_Ccl5_MTX_CIS_24h %>% dplyr::select(-"gene_name")

get_t_values_Ccl5_OXA_CIS_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/24h/diff_genes.csv") %>% select(c("t","gene_name", "logFC", "adj.P.Val"))
rownames(get_t_values_Ccl5_OXA_CIS_24h) <- make.names(get_t_values_Ccl5_OXA_CIS_24h$gene_name, unique = TRUE)
get_t_values_Ccl5_OXA_CIS_24h <- get_t_values_Ccl5_OXA_CIS_24h %>% dplyr::select(-"gene_name")

tf <- "Junb"
df_Junb_Ccl5 <- collectri_df_for_Ccl5 %>%
  filter(source == tf) %>%
  arrange(target) %>%
  mutate(ID = target, color = "3") %>% 
  column_to_rownames('target')


inter_Junb_MTX_CIS_24h <- sort(intersect(rownames(get_t_values_Ccl5_MTX_CIS_24h), rownames(df_Junb_Ccl5)))
df_Junb_Ccl5_MTX <- df_Junb_Ccl5[inter_Junb_MTX_CIS_24h,]
df_Junb_Ccl5_MTX[,c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Ccl5_MTX_CIS_24h[inter_Junb_MTX_CIS_24h, ]
df_Junb_Ccl5_MTX <- df_Junb_Ccl5_MTX %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Junb_MTX_CIS_24h <- ggplot(df_Junb_Ccl5_MTX, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)


inter_Junb_OXA_CIS_24h <- sort(intersect(rownames(get_t_values_Ccl5_OXA_CIS_24h), rownames(df_Junb_Ccl5)))
df_Junb_Ccl5_OXA <- df_Junb_Ccl5[inter_Junb_OXA_CIS_24h,]
df_Junb_Ccl5_OXA[,c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Ccl5_OXA_CIS_24h[inter_Junb_OXA_CIS_24h, ]
df_Junb_Ccl5_OXA <- df_Junb_Ccl5_OXA %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Junb_OXA_CIS_24h <- ggplot(df_Junb_Ccl5_OXA, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)
```


#### Esr1
```{r}
tf <- "Esr1"
df_Esr1_Ccl5 <- collectri_df_for_Ccl5 %>%
  filter(source == tf) %>%
  arrange(target) %>%
  mutate(ID = target, color = "3") %>% 
  column_to_rownames('target')


inter_Esr1_MTX_CIS_24h <- sort(intersect(rownames(get_t_values_Ccl5_MTX_CIS_24h), rownames(df_Esr1_Ccl5)))
df_Esr1_Ccl5_MTX <- df_Esr1_Ccl5[inter_Esr1_MTX_CIS_24h,]
df_Esr1_Ccl5_MTX[,c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Ccl5_MTX_CIS_24h[inter_Esr1_MTX_CIS_24h, ]
df_Esr1_Ccl5_MTX <- df_Esr1_Ccl5_MTX %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Esr1_MTX_CIS_24h <- ggplot(df_Esr1_Ccl5_MTX, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)


inter_Esr1_OXA_CIS_24h <- sort(intersect(rownames(get_t_values_Ccl5_OXA_CIS_24h), rownames(df_Esr1_Ccl5)))
df_Esr1_Ccl5_OXA <- df_Esr1_Ccl5[inter_Esr1_OXA_CIS_24h,]
df_Esr1_Ccl5_OXA[,c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Ccl5_OXA_CIS_24h[inter_Esr1_OXA_CIS_24h, ]
df_Esr1_Ccl5_OXA <- df_Esr1_Ccl5_OXA %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Esr1_OXA_CIS_24h <- ggplot(df_Esr1_Ccl5_OXA, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)
```


#### Nfkb1
```{r}
tf <- "Nfkb1"
df_Nfkb1_Ccl5 <- collectri_df_for_Ccl5 %>%
  filter(source == tf) %>%
  arrange(target) %>%
  mutate(ID = target, color = "3") %>% 
  column_to_rownames('target')


inter_Nfkb1_MTX_CIS_24h <- sort(intersect(rownames(get_t_values_Ccl5_MTX_CIS_24h), rownames(df_Nfkb1_Ccl5)))
df_Nfkb1_Ccl5_MTX <- df_Nfkb1_Ccl5[inter_Nfkb1_MTX_CIS_24h,]
df_Nfkb1_Ccl5_MTX[,c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Ccl5_MTX_CIS_24h[inter_Nfkb1_MTX_CIS_24h, ]
df_Nfkb1_Ccl5_MTX <- df_Nfkb1_Ccl5_MTX %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Nfkb1_MTX_CIS_24h <- ggplot(df_Nfkb1_Ccl5_MTX, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)


inter_Nfkb1_OXA_CIS_24h <- sort(intersect(rownames(get_t_values_Ccl5_OXA_CIS_24h), rownames(df_Nfkb1_Ccl5)))
df_Nfkb1_Ccl5_OXA <- df_Nfkb1_Ccl5[inter_Nfkb1_OXA_CIS_24h,]
df_Nfkb1_Ccl5_OXA[,c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Ccl5_OXA_CIS_24h[inter_Nfkb1_OXA_CIS_24h, ]
df_Nfkb1_Ccl5_OXA <- df_Nfkb1_Ccl5_OXA %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Nfkb1_OXA_CIS_24h <- ggplot(df_Nfkb1_Ccl5_OXA, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)
```



```{r}
# greater activity in MTX and OXA than in Control
#tf_higher_activity_in_MTX_24h_than_in_Control_24h <- f_Ccl5_activity_MTX_24h_vs_Control_24h %>% filter(score > 0 & p-value <= 0.05)
#tf_higher_activity_in_OXA_24h_than_in_Control_24h <- f_Ccl5_activity_OXA_24h_vs_Control_24h %>% filter(score > 0 & p-value <= 0.05)

# Intersection
#intersect(tf_higher_activity_in_MTX_24h_than_in_Control_24h$source, tf_higher_activity_in_OXA_24h_than_in_Control_24h$source)


#intersect(intersect(tf_higher_activity_in_MTX_24h_than_in_CIS_24h$source, tf_higher_activity_in_OXA_24h_than_in_CIS_24h$source), intersect(tf_higher_activity_in_MTX_24h_than_in_Control_24h$source, tf_higher_activity_in_OXA_24h_than_in_Control_24h$source))
```



# function tf_cytokines
```{r}

tf_cytokines_interest_activators <- function(target_interest, t_values_CIS_MTX, t_values_CIS_OXA, t_values_CIS_Control, activators_target_ulm_more_active_in_CIS_than_in_MTX_filename, activators_target_mlm_more_active_in_CIS_than_in_MTX_filename, activators_target_corr_wsum_more_active_in_CIS_than_in_MTX_filename, activators_target_more_active_in_CIS_than_MTX_all_methods_filename, activators_target_ulm_more_active_in_CIS_than_in_OXA_filename, activators_target_mlm_more_active_in_CIS_than_in_OXA_filename, activators_target_corr_wsum_more_active_in_CIS_than_in_OXA_filename, activators_target_more_active_in_CIS_than_OXA_all_methods_filename, activators_target_ulm_more_active_in_CIS_than_in_Control_filename, activators_target_mlm_more_active_in_CIS_than_in_Control_filename, activators_target_corr_wsum_more_active_in_CIS_than_in_Control_filename, activators_target_more_active_in_CIS_than_Control_all_methods_filename, activators_target_more_active_in_CIS_than_in_MTX_OXA_Control_ulm_filename, activators_target_more_active_in_CIS_than_in_MTX_OXA_Control_mlm_filename, activators_target_more_active_in_CIS_than_in_MTX_OXA_Control_corr_wsum_filename, activators_target_more_active_in_CIS_than_in_MTX_OXA_Control_all_filename){
  
  library(decoupleR)
  library(tidyverse)
  collectri_df <- get_collectri(organism="mouse", split_complexes = FALSE) %>% as.data.frame()
  
  # Get tfs which target our target of interest
  collectri_df_target_interest <- collectri_df %>% dplyr::group_by(source) %>% dplyr::summarise(target_interest = any(target == target_interest)) %>% as.data.frame() %>% filter(target_interest == "TRUE")
  
  
  collectri_df_target_interest <- collectri_df %>% dplyr::filter(source %in% collectri_df_target_interest$source)
  
  
  # Get t-values for CIS_24h vs MTX_24h
  get_t_values_CIS_MTX_24h <- read.csv(t_values_CIS_MTX) %>% select(c("t","gene_name"))
  
  rownames(get_t_values_CIS_MTX_24h) <- make.names(get_t_values_CIS_MTX_24h$gene_name, unique=TRUE)
  
  get_t_values_CIS_MTX_24h <- get_t_values_CIS_MTX_24h %>% dplyr::select(-"gene_name")
  
  
  # Get t-values for CIS_24h vs OXA_24h
  get_t_values_CIS_OXA_24h <- read.csv(t_values_CIS_OXA) %>% select(c("t","gene_name"))
  
  rownames(get_t_values_CIS_OXA_24h) <- make.names(get_t_values_CIS_OXA_24h$gene_name, unique=TRUE)
  
  get_t_values_CIS_OXA_24h <- get_t_values_CIS_OXA_24h %>% dplyr::select(-"gene_name")
  
  
  # Get t-values for CIS_24h vs Control_24h
  get_t_values_CIS_Control_24h <- read.csv(t_values_CIS_Control) %>% select(c("t","gene_name"))
  
  rownames(get_t_values_CIS_Control_24h) <- make.names(get_t_values_CIS_Control_24h$gene_name, unique=TRUE)
  
  get_t_values_CIS_Control_24h <- get_t_values_CIS_Control_24h %>% dplyr::select(-"gene_name")
  
  
  # Get activators of target
  activators_for_target_interest <- collectri_df_target_interest %>% filter(target == target_interest & mor == 1)
  collectri_df_activators_target_interest <- collectri_df_target_interest %>% filter(source %in% activators_for_target_interest$source)

  
  
  
  # Run decoupleR for CIS_24h vs MTX_24h (with activators of target)
  target_activity_CIS_24h_vs_MTX_24h_activators_target <- decouple(mat=get_t_values_CIS_MTX_24h, net=collectri_df_activators_target_interest, .source='source', .target='target', minsize = 5)
  
  # Run decoupleR for CIS_24h vs OXA_24h (with activators of target)
  target_activity_CIS_24h_vs_OXA_24h_activators_target <- decouple(mat=get_t_values_CIS_OXA_24h, net=collectri_df_activators_target_interest, .source='source', .target='target', minsize = 5)
  
  # Run decoupleR for CIS_24h vs Control_24h (with activators of target)
  target_activity_CIS_24h_vs_Control_24h_activators_target <- decouple(mat=get_t_values_CIS_Control_24h, net=collectri_df_activators_target_interest, .source='source', .target='target', minsize = 5)
  

  
  # Get activators of target more active in CIS than in MTX (ulm)
  tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_ulm_not_filtered <- target_activity_CIS_24h_vs_MTX_24h_activators_target %>% filter(statistic == "ulm") %>% filter(score > 0) %>% arrange(desc(score))
  write.csv(tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_ulm_not_filtered, activators_target_ulm_more_active_in_CIS_than_in_MTX_filename, row.names=FALSE, col.names=TRUE)
  
  
   # Get activators of target more active in CIS than in MTX (mlm)
  tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_mlm_not_filtered <-
    target_activity_CIS_24h_vs_MTX_24h_activators_target %>% filter(statistic == "mlm") %>% filter(score > 0) %>% arrange(desc(score))
  write.csv(tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_mlm_not_filtered, activators_target_mlm_more_active_in_CIS_than_in_MTX_filename, row.names=FALSE, col.names=TRUE)
  
  
  # Get activators of target more active in CIS than in MTX (corr_wsum)
  tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_corr_wsum_not_filtered <- target_activity_CIS_24h_vs_MTX_24h_activators_target %>% filter(statistic == "corr_wsum") %>% filter(statistic == "corr_wsum") %>% filter(score > 0) %>% arrange(desc(score))
  write.csv(tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_corr_wsum_not_filtered, activators_target_corr_wsum_more_active_in_CIS_than_in_MTX_filename, row.names=FALSE, col.names=TRUE)
  
  
  # Overlap across statistics (ulm, mlm, wsum) 
  get_intersection_activators_target_CIS_24h_MTX_24h <- intersect(tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_ulm_not_filtered$source, tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_mlm_not_filtered$source)
  
  get_all_intersection_activators_target_CIS_24h_MTX_24h <-intersect(get_intersection_activators_target_CIS_24h_MTX_24h, tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_corr_wsum_not_filtered$source)
  
  
  write.csv(get_all_intersection_activators_target_CIS_24h_MTX_24h, activators_target_more_active_in_CIS_than_MTX_all_methods_filename, row.names=FALSE, col.names=TRUE)
  
  
  

 
  # Get activators of target more active in CIS than in OXA (ulm)
  tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_ulm_not_filtered <-
    target_activity_CIS_24h_vs_OXA_24h_activators_target %>% filter(score > 0) %>% filter(statistic == "ulm") %>% arrange(desc(score))
  write.csv(tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_ulm_not_filtered, activators_target_ulm_more_active_in_CIS_than_in_OXA_filename, row.names=FALSE, col.names=TRUE)
  
  
  # Get activators of target more active in CIS than in OXA (mlm)
  tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_mlm_not_filtered <-
    target_activity_CIS_24h_vs_OXA_24h_activators_target %>% filter(statistic == "mlm") %>% arrange(desc(score))
  write.csv(tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_mlm_not_filtered, activators_target_mlm_more_active_in_CIS_than_in_OXA_filename, row.names=FALSE, col.names=TRUE)
  
  
  # Get activators of target more active in CIS than in OXA (corr_wsum)
  tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_corr_wsum_not_filtered <- target_activity_CIS_24h_vs_OXA_24h_activators_target %>% filter(statistic == "corr_wsum") %>% arrange(desc(score))
  write.csv(tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_corr_wsum_not_filtered, activators_target_corr_wsum_more_active_in_CIS_than_in_OXA_filename, row.names=FALSE, col.names=TRUE)
  
  
   # Overlap across statistics (ulm, mlm, wsum) 
  get_intersection_activators_target_CIS_24h_OXA_24h <- intersect(tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_ulm_not_filtered$source, tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_mlm_not_filtered$source)
  
  get_all_intersection_activators_target_CIS_24h_OXA_24h <-intersect(get_intersection_activators_target_CIS_24h_OXA_24h, tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_corr_wsum_not_filtered$source)
  
  
   write.csv(get_all_intersection_activators_target_CIS_24h_OXA_24h, activators_target_more_active_in_CIS_than_OXA_all_methods_filename, row.names=FALSE, col.names=TRUE)
  
  
  # Get activators of target more active in CIS than in Control (ulm)
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm_not_filtered <-
    target_activity_CIS_24h_vs_Control_24h_activators_target %>% filter(score > 0) %>% filter(statistic == "ulm") %>% arrange(desc(score))
  write.csv(tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm_not_filtered, activators_target_ulm_more_active_in_CIS_than_in_Control_filename, row.names=FALSE, col.names=TRUE)
  
  
  # Get activators of target more active in CIS than in Control (mlm)
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm_not_filtered <-
    target_activity_CIS_24h_vs_Control_24h_activators_target %>% filter(statistic == "mlm") %>% arrange(desc(score))
  write.csv(tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm_not_filtered, activators_target_mlm_more_active_in_CIS_than_in_Control_filename, row.names=FALSE, col.names=TRUE)
  
  
  # Get activators of target more active in CIS than in Control (corr_wsum)
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum_not_filtered <- target_activity_CIS_24h_vs_Control_24h_activators_target %>% filter(statistic == "corr_wsum") %>% arrange(desc(score))
  write.csv(tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum_not_filtered, activators_target_corr_wsum_more_active_in_CIS_than_in_Control_filename, row.names=FALSE, col.names=TRUE)
  
  
  # Overlap across statistics (ulm, mlm, wsum) 
  get_intersection_activators_target_CIS_24h_Control_24h <- intersect(tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm_not_filtered$source, tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm_not_filtered$source)
  
  get_all_intersection_activators_target_CIS_24h_Control_24h <- intersect(get_intersection_activators_target_CIS_24h_Control_24h, tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum_not_filtered$source)
  
  
   write.csv(get_all_intersection_activators_target_CIS_24h_Control_24h, activators_target_more_active_in_CIS_than_Control_all_methods_filename, row.names=FALSE, col.names=TRUE)
  
  
  

  # Get activators of target more active in CIS than in MTX, OXA, Control (ulm)
  
  intersect_CIS_MTX_OXA_ulm <- intersect(tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_ulm_not_filtered$source, tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_ulm_not_filtered$source)


  intersect_CIS_MTX_OXA_Control_ulm <- intersect(intersect_CIS_MTX_OXA_ulm, tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm_not_filtered$source)
  
  write.csv(intersect_CIS_MTX_OXA_Control_ulm, activators_target_more_active_in_CIS_than_in_MTX_OXA_Control_ulm_filename)
  
  
  # Get activators of target more active in CIS than in MTX, OXA, Control (mlm)
  
  intersect_CIS_MTX_OXA_mlm <- intersect(tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_mlm_not_filtered$source, tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_mlm_not_filtered$source)
  
  
  intersect_CIS_MTX_OXA_Control_mlm <- intersect(intersect_CIS_MTX_OXA_mlm, tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm_not_filtered$source)
  
  write.csv(intersect_CIS_MTX_OXA_Control_mlm, activators_target_more_active_in_CIS_than_in_MTX_OXA_Control_mlm_filename)
  
  
  
  
  
  # Get activators of target more active in CIS than in MTX, OXA, Control (corr_wsum)
  
  intersect_CIS_MTX_OXA_corr_wsum <- intersect(tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_corr_wsum_not_filtered$source, tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_corr_wsum_not_filtered$source)
  
  
  intersect_CIS_MTX_OXA_Control_corr_wsum <- intersect(intersect_CIS_MTX_OXA_corr_wsum, tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum_not_filtered$source)
  
  write.csv(intersect_CIS_MTX_OXA_Control_corr_wsum, activators_target_more_active_in_CIS_than_in_MTX_OXA_Control_corr_wsum_filename)
  
  
  # Get activators of target more active in CIS than in MTX, OXA, Control (all methods)
  
  intersect_CIS_MTX_OXA_all <- intersect(get_all_intersection_activators_target_CIS_24h_MTX_24h, get_all_intersection_activators_target_CIS_24h_OXA_24h)
  intersect_CIS_MTX_OXA_Control_all <- intersect(intersect_CIS_MTX_OXA_all, get_all_intersection_activators_target_CIS_24h_Control_24h)
  
  write.csv(intersect_CIS_MTX_OXA_Control_all, activators_target_more_active_in_CIS_than_in_MTX_OXA_Control_all_filename)
  
}
```



```{r}
tf_cytokines_interest_activators("Il6", "Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_MTX/24h/diff_genes.csv",  "Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_OXA/24h/diff_genes.csv",  "Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/24h/diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Il6/activators_Il6_ulm_more_active_in_CIS_than_in_MTX.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Il6/activators_Il6_mlm_more_active_in_CIS_than_in_MTX.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Il6/activators_Il6_corr_wsum_more_active_in_CIS_than_in_MTX.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Il6/activators_Il6_all_methods_more_active_in_CIS_than_in_MTX.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Il6/activators_Il6_ulm_more_active_in_CIS_than_in_OXA.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Il6/activators_Il6_mlm_more_active_in_CIS_than_in_OXA.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Il6/activators_Il6_corr_wsum_more_active_in_CIS_than_in_OXA.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Il6/activators_Il6_more_active_in_CIS_than_OXA_all_methods.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Il6/activators_Il6_ulm_more_active_in_CIS_than_in_Control.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Il6/activators_Il6_mlm_more_active_in_CIS_than_in_Control.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Il6/activators_Il6_corr_wsum_more_active_in_CIS_than_in_Control.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Il6/activators_Il6_more_active_in_CIS_than_Control_all_methods.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Il6/activators_Il6_more_active_in_CIS_than_in_MTX_OXA_Control_ulm.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Il6/activators_Il6_more_active_in_CIS_than_in_MTX_OXA_Control_mlm.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Il6/activators_Il6_more_active_in_CIS_than_in_MTX_OXA_Control_corr_wsum.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Il6/activators_Il6_more_active_in_CIS_than_in_MTX_OXA_Control_all.csv")




tf_cytokines_interest_activators("Ccl4", "Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_MTX/24h/diff_genes.csv",  "Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_OXA/24h/diff_genes.csv",  "Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/24h/diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Ccl4/activators_Ccl4_ulm_more_active_in_CIS_than_in_MTX.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Ccl4/activators_Ccl4_mlm_more_active_in_CIS_than_in_MTX.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Ccl4/activators_Ccl4_corr_wsum_more_active_in_CIS_than_in_MTX.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Ccl4/activators_Ccl4_all_methods_more_active_in_CIS_than_in_MTX.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Ccl4/activators_Ccl4_ulm_more_active_in_CIS_than_in_OXA.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Ccl4/activators_Ccl4_mlm_more_active_in_CIS_than_in_OXA.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Ccl4/activators_Ccl4_corr_wsum_more_active_in_CIS_than_in_OXA.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Ccl4/activators_Ccl4_more_active_in_CIS_than_OXA_all_methods.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Ccl4/activators_Ccl4_ulm_more_active_in_CIS_than_in_Control.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Ccl4/activators_Ccl4_mlm_more_active_in_CIS_than_in_Control.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Ccl4/activators_Ccl4_corr_wsum_more_active_in_CIS_than_in_Control.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Ccl4/activators_Ccl4_more_active_in_CIS_than_Control_all_methods.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Ccl4/activators_Ccl4_more_active_in_CIS_than_in_MTX_OXA_Control_ulm.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Ccl4/activators_Ccl4_more_active_in_CIS_than_in_MTX_OXA_Control_mlm.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Ccl4/activators_Ccl4_more_active_in_CIS_than_in_MTX_OXA_Control_corr_wsum.csv", "Bulk_RNA_in_vitro/in_vitro_results/tf_results/Ccl4/activators_Ccl4_more_active_in_CIS_than_in_MTX_OXA_Control_all.csv")



```






```{r}


tf_cytokines_interest <- function(target_interest, activators_target_CIS_24h_vs_MTX_24h_ulm_filename, inhibitors_target_CIS_24h_vs_MTX_24h_ulm_filename, activators_target_CIS_24h_vs_OXA_24h_ulm_filename, inhibitors_target_CIS_24h_vs_OXA_24h_ulm_filename, activators_target_CIS_24h_vs_Control_24h_ulm_filename, inhibitors_target_CIS_24h_vs_Control_24h_ulm_filename, activators_target_CIS_24h_vs_MTX_24h_mlm_filename, inhibitors_target_CIS_24h_vs_MTX_24h_mlm_filename, activators_target_CIS_24h_vs_OXA_24h_mlm_filename, inhibitors_target_CIS_24h_vs_OXA_24h_mlm_filename, activators_target_CIS_24h_vs_Control_24h_mlm_filename, inhibitors_target_CIS_24h_vs_Control_24h_mlm_filename)

  # ULM results
  
  
  # CIS/MTX
  
  
  # Get barplots showing activity of activators and inhibitors of target (CIS/MTX)
  tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_ulm <- target_activity_CIS_24h_vs_MTX_24h_activators_target %>% filter(statistic == "ulm") %>% dplyr::mutate(rnk = NA)
  msk <- tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_ulm$score > 0
  
  
  tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_ulm <- target_activity_CIS_24h_vs_MTX_24h_activators_target %>% filter(statistic == "ulm") %>%  dplyr::mutate(rnk = NA)
  msk <- tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_ulm$score > 0
  
  
  # Create rank
  tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_ulm[msk, 'rnk'] <- rank(-tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_ulm[msk, 'score'])
  tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_ulm[!msk, 'rnk'] <- rank(-abs(tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_ulm[!msk, 'score']))
  
  
  tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_ulm <- tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_ulm %>% dplyr::arrange(rnk)
  
  
  tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_ulm[msk, 'rnk'] <- rank(-tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_ulm[msk, 'score'])
  
  
  tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_ulm[!msk, 'rnk'] <- rank(-abs(tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_ulm[!msk, 'score']))
  
  
  tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_ulm <- tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_ulm %>% dplyr::arrange(rnk)
  
  # Plot (activators of target in CIS vs MTX)
  png(activators_target_CIS_24h_vs_MTX_24h_ulm_filename)
  ggplot(tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_ulm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12), axis.text.x = element_text(angle = 45, hjust = 1, size =10, face= "bold"),  axis.text.y = element_text(size =10, face= "bold"), panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
    xlab("TFs")
  
  dev.off()
  
  # Plot (inhibitors of target in MTX vs CIS)
  png(inhibitors_target_CIS_24h_vs_MTX_24h_ulm_filename)
  ggplot(tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_ulm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12), axis.text.x = element_text(angle = 45, hjust = 1, size =10, face= "bold"), axis.text.y = element_text(size =10, face= "bold"), panel.grid.major = element_blank(), panel.grid.minor = element_blank()) +
    xlab("TFs")
  
  dev.off()
  
  
  # CIS/OXA
  
  
  # Get barplots showing activity of activators and inhibitors of target (CIS/OXA)
  tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_ulm <- target_activity_CIS_24h_vs_OXA_24h_activators_target %>% filter(statistic == "ulm") %>% dplyr::mutate(rnk = NA)
  msk <- tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_ulm$score > 0



  tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_ulm <-
    target_activity_CIS_24h_vs_OXA_24h_activators_target %>% filter(statistic == "ulm") %>%  dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_ulm$score > 0
  
  
  # Create rank
  tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_ulm[msk, 'rnk'] <-
    rank(-tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_ulm[msk, 'score'])
  tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_ulm[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_ulm[!msk, 'score']
    ))
  
  tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_ulm <-
    tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_ulm %>% dplyr::arrange(rnk)
  
  
  tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_ulm[msk, 'rnk'] <-
    rank(-tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_ulm[msk, 'score'])
  tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_ulm[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_ulm[!msk, 'score']
    ))
  
  tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_ulm <-
    tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_ulm %>% dplyr::arrange(rnk)
  
  
  # Plot (activators of target in CIS vs OXA)
  png(activators_target_CIS_24h_vs_MTX_24h_ulm_filename)
  ggplot(
    tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_ulm,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x = element_text(
        angle = 45,
        hjust = 1,
        size = 10,
        face = "bold"
      ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  dev.off()
  
  
  # Plot (inhibitors of target in OXA vs CIS)
  png(inhibitors_target_CIS_24h_vs_OXA_24h_ulm_filename)
  ggplot(
    tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_ulm,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  dev.off()
  
  
  
  # Get t-values for CIS_24h vs Control_24h
  get_t_values_CIS_Control_24h <-
    read.csv(
      "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/24h/diff_genes.csv"
    ) %>% select(c("t", "gene_name"))
  
  rownames(get_t_values_CIS_Control_24h) <-
    make.names(get_t_values_CIS_Control_24h$gene_name, unique = TRUE)
  
  get_t_values_CIS_Control_24h <-
    get_t_values_CIS_Control_24h %>% dplyr::select(-"gene_name")
  
  # Get t-values for Control_24h vs CIS_24h
  get_t_values_Control_CIS_24h <-
    read.csv(
      "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_CIS/24h/diff_genes.csv"
    ) %>% select(c("t", "gene_name"))
  rownames(get_t_values_Control_CIS_24h) <-
    make.names(get_t_values_Control_CIS_24h$gene_name, unique = TRUE)
  get_t_values_Control_CIS_24h <-
    get_t_values_Control_CIS_24h %>% dplyr::select(-"gene_name")
  
  
  
  # Run decoupleR for CIS_24h vs Control_24h (with activators of target)
  target_activity_CIS_24h_vs_Control_24h_activators_target_ulm <-
    run_ulm(
      mat = get_t_values_CIS_Control_24h,
      net = collectri_df_activators_target_interest,
      .source = 'source',
      .target = 'target',
      .mor = 'mor',
      minsize = 5
    )
  
  # Run decoupleR for Control_24h vs CIS_24h (with inhibitors of target)
  target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm <-
    run_ulm(
      mat = get_t_values_Control_CIS_24h,
      net = collectri_df_activators_target_interest,
      .source = 'source',
      .target = 'target',
      .mor = 'mor',
      minsize = 5
    )
  
  
  # Get barplot showing tf activity of activators of target
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm <-
    target_activity_CIS_24h_vs_Control_24h_activators_target_ulm %>% dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm$score > 0
  
  
  # Get barplot showing tf activity of inhibitors of target
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm <-
    target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm %>% dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm$score > 0
  
  
  # Create rank
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm[msk, 'rnk'] <-
    rank(-tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm[msk, 'score'])
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm[!msk, 'score']
    ))
  
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm <-
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm %>% dplyr::arrange(rnk)
  
  
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm[msk, 'rnk'] <-
    rank(-tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm[msk, 'score'])
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm[!msk, 'score']
    ))
  
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm <-
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm %>% dplyr::arrange(rnk)
  
  
  # Plot (activators of target in CIS vs Control)
  png(activators_target_CIS_24h_vs_Control_24h_ulm_filename)
  ggplot(
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  dev.off()
  
  
  # Plot (inhibitors of target in Control vs CIS)
  png(inhibitors_target_CIS_24h_vs_Control_24h_ulm_filename)
  ggplot(
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  dev.off()
  
  
  # Run decoupleR for CIS_24h vs Control_24h (with activators of target)
  target_activity_CIS_24h_vs_Control_24h_activators_target_ulm <-
    run_ulm(
      mat = get_t_values_CIS_Control_24h,
      net = collectri_df_activators_target_interest,
      .source = 'source',
      .target = 'target',
      .mor = 'mor',
      minsize = 5
    )
  
  # Run decoupleR for Control_24h vs CIS_24h (with inhibitors of target)
  target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm <-
    run_ulm(
      mat = get_t_values_Control_CIS_24h,
      net = collectri_df_activators_target_interest,
      .source = 'source',
      .target = 'target',
      .mor = 'mor',
      minsize = 5
    )
  
  
  # Get barplot showing tf activity of activators of target
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm <-
    target_activity_CIS_24h_vs_Control_24h_activators_target_ulm %>% dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm$score > 0
  
  
  # Get barplot showing tf activity of inhibitors of target
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm <-
    target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm %>% dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm$score > 0
  
  
  # Create rank
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm[msk, 'rnk'] <-
    rank(-tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm[msk, 'score'])
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm[!msk, 'score']
    ))
  
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm <-
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm %>% dplyr::arrange(rnk)
  
  
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm[msk, 'rnk'] <-
    rank(-tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm[msk, 'score'])
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm[!msk, 'score']
    ))
  
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm <-
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm %>% dplyr::arrange(rnk)
  
  
  # Plot (activators of target in CIS vs Control)
  ggplot(
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_ulm,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  
  
  # Plot (inhibitors of target in Control vs CIS)
  ggplot(
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_ulm,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  
  
  
  
  # mlm results
  
  
  # CIS/MTX
  
  # Get barplots showing activity of activators and inhibitors of target (CIS/MTX)
  tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_mlm <-
    target_activity_CIS_24h_vs_MTX_24h_activators_target %>% filter(statistic == "mlm") %>% dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_mlm$score > 0
  
  
  
  tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_mlm <-
    target_activity_CIS_24h_vs_MTX_24h_activators_target %>% filter(statistic == "mlm") %>%  dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_mlm$score > 0
  
  
  # Create rank
  tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_mlm[msk, 'rnk'] <-
    rank(-tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_mlm[msk, 'score'])
  tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_mlm[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_mlm[!msk, 'score']
    ))
  
  tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_mlm <-
    tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_mlm %>% dplyr::arrange(rnk)
  
  
  tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_mlm[msk, 'rnk'] <-
    rank(-tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_mlm[msk, 'score'])
  tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_mlm[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_mlm[!msk, 'score']
    ))
  
  tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_mlm <-
    tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_mlm %>% dplyr::arrange(rnk)
  
  
  # Plot (activators of target in CIS vs MTX)
  ggplot(
    tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_mlm,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  
  
  # Plot (inhibitors of target in MTX vs CIS)
  ggplot(
    tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_mlm,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  # CIS/OXA
  
  # Get barplots showing activity of activators and inhibitors of target (CIS/OXA)
  tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_mlm <-
    target_activity_CIS_24h_vs_OXA_24h_activators_target %>% filter(statistic == "mlm") %>% dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_mlm$score > 0
  
  
  
  tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_mlm <-
    target_activity_CIS_24h_vs_OXA_24h_activators_target %>% filter(statistic == "mlm") %>%  dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_mlm$score > 0
  
  
  # Create rank
  tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_mlm[msk, 'rnk'] <-
    rank(-tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_mlm[msk, 'score'])
  tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_mlm[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_mlm[!msk, 'score']
    ))
  
  tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_mlm <-
    tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_mlm %>% dplyr::arrange(rnk)
  
  
  tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_mlm[msk, 'rnk'] <-
    rank(-tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_mlm[msk, 'score'])
  tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_mlm[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_mlm[!msk, 'score']
    ))
  
  tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_mlm <-
    tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_mlm %>% dplyr::arrange(rnk)
  
  
  # Plot (activators of target in CIS vs OXA)
  png(activators_)
  ggplot(
    tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_mlm,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  
  
  # Plot (inhibitors of target in OXA vs CIS)
  ggplot(
    tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_mlm,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  
  # Get t-values for CIS_24h vs Control_24h
  get_t_values_CIS_Control_24h <-
    read.csv(
      "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/24h/diff_genes.csv"
    ) %>% select(c("t", "gene_name"))
  
  rownames(get_t_values_CIS_Control_24h) <-
    make.names(get_t_values_CIS_Control_24h$gene_name, unique = TRUE)
  
  get_t_values_CIS_Control_24h <-
    get_t_values_CIS_Control_24h %>% dplyr::select(-"gene_name")
  
  # Get t-values for Control_24h vs CIS_24h
  get_t_values_Control_CIS_24h <-
    read.csv(
      "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_CIS/24h/diff_genes.csv"
    ) %>% select(c("t", "gene_name"))
  rownames(get_t_values_Control_CIS_24h) <-
    make.names(get_t_values_Control_CIS_24h$gene_name, unique = TRUE)
  get_t_values_Control_CIS_24h <-
    get_t_values_Control_CIS_24h %>% dplyr::select(-"gene_name")
  
  
  
  # Run decoupleR for CIS_24h vs Control_24h (with activators of target)
  target_activity_CIS_24h_vs_Control_24h_activators_target_mlm <-
    run_mlm(
      mat = get_t_values_CIS_Control_24h,
      net = collectri_df_activators_target_interest,
      .source = 'source',
      .target = 'target',
      .mor = 'mor',
      minsize = 5
    )
  
  # Run decoupleR for Control_24h vs CIS_24h (with inhibitors of target)
  target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm <-
    run_mlm(
      mat = get_t_values_Control_CIS_24h,
      net = collectri_df_activators_target_interest,
      .source = 'source',
      .target = 'target',
      .mor = 'mor',
      minsize = 5
    )
  
  
  # Get barplot showing tf activity of activators of target
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm <-
    target_activity_CIS_24h_vs_Control_24h_activators_target_mlm %>% dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm$score > 0
  
  
  # Get barplot showing tf activity of inhibitors of target
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm <-
    target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm %>% dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm$score > 0
  
  
  # Create rank
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm[msk, 'rnk'] <-
    rank(-tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm[msk, 'score'])
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm[!msk, 'score']
    ))
  
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm <-
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm %>% dplyr::arrange(rnk)
  
  
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm[msk, 'rnk'] <-
    rank(-tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm[msk, 'score'])
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm[!msk, 'score']
    ))
  
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm <-
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm %>% dplyr::arrange(rnk)
  
  
  
  # Plot (activators of target in CIS vs Control)
  ggplot(
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  
  
  # Plot (inhibitors of target in Control vs CIS)
  ggplot(
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  
  
  # Run decoupleR for CIS_24h vs Control_24h (with activators of target)
  target_activity_CIS_24h_vs_Control_24h_activators_target_mlm <-
    run_mlm(
      mat = get_t_values_CIS_Control_24h,
      net = collectri_df_activators_target_interest,
      .source = 'source',
      .target = 'target',
      .mor = 'mor',
      minsize = 5
    )
  
  # Run decoupleR for Control_24h vs CIS_24h (with inhibitors of target)
  target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm <-
    run_mlm(
      mat = get_t_values_Control_CIS_24h,
      net = collectri_df_activators_target_interest,
      .source = 'source',
      .target = 'target',
      .mor = 'mor',
      minsize = 5
    )
  
  
  # Get barplot showing tf activity of activators of target
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm <-
    target_activity_CIS_24h_vs_Control_24h_activators_target_mlm %>% dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm$score > 0
  
  
  # Get barplot showing tf activity of inhibitors of target
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm <-
    target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm %>% dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm$score > 0
  
  
  # Create rank
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm[msk, 'rnk'] <-
    rank(-tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm[msk, 'score'])
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm[!msk, 'score']
    ))
  
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm <-
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm %>% dplyr::arrange(rnk)
  
  
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm[msk, 'rnk'] <-
    rank(-tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm[msk, 'score'])
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm[!msk, 'score']
    ))
  
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm <-
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm %>% dplyr::arrange(rnk)
  
  
  # Plot (activators of target in CIS vs Control)
  ggplot(
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_mlm,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  
  
  # Plot (inhibitors of target in Control vs CIS)
  ggplot(
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_mlm,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  
  
  # corr_wsum results
  
  
  # CIS/MTX
  
  # Get barplots showing activity of activators and inhibitors of target (CIS/MTX)
  tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_corr_wsum <-
    target_activity_CIS_24h_vs_MTX_24h_activators_target %>% filter(statistic == "corr_wsum") %>% dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_corr_wsum$score > 0
  
  
  
  tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_corr_wsum <-
    target_activity_CIS_24h_vs_MTX_24h_activators_target %>% filter(statistic == "corr_wsum") %>%  dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_corr_wsum$score > 0
  
  
  # Create rank
  tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_corr_wsum[msk, 'rnk'] <-
    rank(-tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_corr_wsum[msk, 'score'])
  tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_corr_wsum[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_corr_wsum[!msk, 'score']
    ))
  
  tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_corr_wsum <-
    tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_corr_wsum %>% dplyr::arrange(rnk)
  
  
  tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_corr_wsum[msk, 'rnk'] <-
    rank(-tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_corr_wsum[msk, 'score'])
  tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_corr_wsum[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_corr_wsum[!msk, 'score']
    ))
  
  tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_corr_wsum <-
    tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_corr_wsum %>% dplyr::arrange(rnk)
  
  
  # Plot (activators of target in CIS vs MTX)
  ggplot(
    tf_target_activity_CIS_24h_vs_MTX_24h_activators_target_corr_wsum,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  
  
  # Plot (inhibitors of target in MTX vs CIS)
  ggplot(
    tf_target_activity_MTX_24h_vs_CIS_24h_inhibitors_target_corr_wsum,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  # CIS/OXA
  
  # Get barplots showing activity of activators and inhibitors of target (CIS/OXA)
  tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_corr_wsum <-
    target_activity_CIS_24h_vs_OXA_24h_activators_target %>% filter(statistic == "corr_wsum") %>% dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_corr_wsum$score > 0
  
  
  
  tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_corr_wsum <-
    target_activity_CIS_24h_vs_OXA_24h_activators_target %>% filter(statistic == "corr_wsum") %>%  dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_corr_wsum$score > 0
  
  
  # Create rank
  tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_corr_wsum[msk, 'rnk'] <-
    rank(-tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_corr_wsum[msk, 'score'])
  tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_corr_wsum[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_corr_wsum[!msk, 'score']
    ))
  
  tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_corr_wsum <-
    tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_corr_wsum %>% dplyr::arrange(rnk)
  
  
  tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_corr_wsum[msk, 'rnk'] <-
    rank(-tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_corr_wsum[msk, 'score'])
  tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_corr_wsum[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_corr_wsum[!msk, 'score']
    ))
  
  tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_corr_wsum <-
    tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_corr_wsum %>% dplyr::arrange(rnk)
  
  
  # Plot (activators of target in CIS vs OXA)
  ggplot(
    tf_target_activity_CIS_24h_vs_OXA_24h_activators_target_corr_wsum,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  
  
  # Plot (inhibitors of target in OXA vs CIS)
  ggplot(
    tf_target_activity_OXA_24h_vs_CIS_24h_inhibitors_target_corr_wsum,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  
  # Get t-values for CIS_24h vs Control_24h
  get_t_values_CIS_Control_24h <-
    read.csv(
      "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/24h/diff_genes.csv"
    ) %>% select(c("t", "gene_name"))
  
  rownames(get_t_values_CIS_Control_24h) <-
    make.names(get_t_values_CIS_Control_24h$gene_name, unique = TRUE)
  
  get_t_values_CIS_Control_24h <-
    get_t_values_CIS_Control_24h %>% dplyr::select(-"gene_name")
  
  # Get t-values for Control_24h vs CIS_24h
  get_t_values_Control_CIS_24h <-
    read.csv(
      "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_CIS/24h/diff_genes.csv"
    ) %>% select(c("t", "gene_name"))
  rownames(get_t_values_Control_CIS_24h) <-
    make.names(get_t_values_Control_CIS_24h$gene_name, unique = TRUE)
  get_t_values_Control_CIS_24h <-
    get_t_values_Control_CIS_24h %>% dplyr::select(-"gene_name")
  
  
  
  # Run decoupleR for CIS_24h vs Control_24h (with activators of target)
  target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum <-
    run_corr_wsum(
      mat = get_t_values_CIS_Control_24h,
      net = collectri_df_activators_target_interest,
      .source = 'source',
      .target = 'target',
      .mor = 'mor',
      minsize = 5
    )
  
  # Run decoupleR for Control_24h vs CIS_24h (with inhibitors of target)
  target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum <-
    run_corr_wsum(
      mat = get_t_values_Control_CIS_24h,
      net = collectri_df_activators_target_interest,
      .source = 'source',
      .target = 'target',
      .mor = 'mor',
      minsize = 5
    )
  
  
  # Get barplot showing tf activity of activators of target
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum <-
    target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum %>% dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum$score > 0
  
  
  # Get barplot showing tf activity of inhibitors of target
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum <-
    target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum %>% dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum$score > 0
  
  
  # Create rank
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum[msk, 'rnk'] <-
    rank(-tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum[msk, 'score'])
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum[!msk, 'score']
    ))
  
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum <-
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum %>% dplyr::arrange(rnk)
  
  
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum[msk, 'rnk'] <-
    rank(-tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum[msk, 'score'])
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum[!msk, 'score']
    ))
  
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum <-
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum %>% dplyr::arrange(rnk)
  
  
  # Plot (activators of target in CIS vs Control)
  ggplot(
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  
  
  # Plot (inhibitors of target in Control vs CIS)
  ggplot(
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  
  
  # Run decoupleR for CIS_24h vs Control_24h (with activators of target)
  target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum <-
    run_corr_wsum(
      mat = get_t_values_CIS_Control_24h,
      net = collectri_df_activators_target_interest,
      .source = 'source',
      .target = 'target',
      .mor = 'mor',
      minsize = 5
    )
  
  # Run decoupleR for Control_24h vs CIS_24h (with inhibitors of target)
  target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum <-
    run_corr_wsum(
      mat = get_t_values_Control_CIS_24h,
      net = collectri_df_activators_target_interest,
      .source = 'source',
      .target = 'target',
      .mor = 'mor',
      minsize = 5
    )
  
  
  # Get barplot showing tf activity of activators of target
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum <-
    target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum %>% dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum$score > 0
  
  
  # Get barplot showing tf activity of inhibitors of target
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum <-
    target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum %>% dplyr::mutate(rnk = NA)
  msk <-
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum$score > 0
  
  
  # Create rank
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum[msk, 'rnk'] <-
    rank(-tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum[msk, 'score'])
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum[!msk, 'score']
    ))
  
  tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum <-
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum %>% dplyr::arrange(rnk)
  
  
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum[msk, 'rnk'] <-
    rank(-tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum[msk, 'score'])
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum[!msk, 'rnk'] <-
    rank(-abs(
      tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum[!msk, 'score']
    ))
  
  tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum <-
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum %>% dplyr::arrange(rnk)
  
  
  # Plot (activators of target in CIS vs Control)
  ggplot(
    tf_target_activity_CIS_24h_vs_Control_24h_activators_target_corr_wsum,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  
  
  # Plot (inhibitors of target in Control vs CIS)
  ggplot(
    tf_target_activity_Control_24h_vs_CIS_24h_inhibitors_target_corr_wsum,
    aes(x = reorder(source, score), y = score)
  ) +
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(
      low = "darkblue",
      high = "indianred",
      mid = "whitesmoke",
      midpoint = 0
    ) +
    theme_minimal() +
    theme(
      axis.title = element_text(face = "bold", size = 12),
      axis.text.x =
        element_text(
          angle = 45,
          hjust = 1,
          size = 10,
          face = "bold"
        ),
      axis.text.y = element_text(size = 10, face = "bold"),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    xlab("TFs")
  
  
  
  
```






### Il6



```{r}
# Get tfs which target Il6
collectri_df_Il6 <- collectri_df %>% dplyr::group_by(source) %>% dplyr::summarise(target_Il6 = any(target == "Il6")) %>% as.data.frame() %>% filter(target_Il6 == "TRUE")
collectri_df_for_Il6 <- collectri_df %>% dplyr::filter(source %in% collectri_df_Il6$source)


# Get t-values for CIS_24h vs MTX_24h
get_t_values_CIS_MTX_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_MTX/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_CIS_MTX_24h) <- make.names(get_t_values_CIS_MTX_24h$gene_name, unique=TRUE)
get_t_values_CIS_MTX_24h <- get_t_values_CIS_MTX_24h %>% dplyr::select(-"gene_name")



# Get t-values for MTX_24h vs CIS_24h
get_t_values_MTX_CIS_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_MTX_CIS_24h) <- make.names(get_t_values_MTX_CIS_24h$gene_name, unique=TRUE)
get_t_values_MTX_CIS_24h <- get_t_values_MTX_CIS_24h %>% dplyr::select(-"gene_name")



activators_for_Il6 <- collectri_df_for_Il6 %>% filter(target == "Il6" & mor == 1)
inhibitors_for_Il6 <- collectri_df_for_Il6 %>% filter(target == "Il6" & mor == -1)
collectri_df_activators_Il6 <- collectri_df_for_Il6 %>% filter(source %in% activators_for_Il6$source)
collectri_df_inhibitors_Il6 <- collectri_df_for_Il6 %>% filter(source %in% activators_for_Il6$source)


# Run decoupleR for CIS_24h vs MTX_24h (with activators of Il6)
Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm <- run_ulm(mat=get_t_values_Il6_CIS_MTX_24h, net=collectri_df_activators_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Il6
tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm <- Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm$score > 0 & p-value 

tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm[msk, 'rnk'] <- rank(-tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm[msk, 'score'])
tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm[!msk, 'score']))

tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm <- tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")


# Plot (enhancers of Il6 of interest)
ggplot(tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm %>% filter(source %in% c("Nkx2-1", "Otx2", "Hsf2","Gata1","Bcl3" ,"Pou2f1", "Pou3f1", "E2f3", "Rorc", "Hoxd13", "Nkx6-1", "Creb1", "Jund", "Stat2")), aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")







# Run decoupleR for MTX_24h vs CIS_24h (with inhibitors of Il6)
Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm <- run_ulm(mat=get_t_values_Il6_MTX_CIS_24h, net=collectri_df_inhibitors_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Il6
tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm <- Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm$score > 0

tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm[msk, 'rnk'] <- rank(-tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm[msk, 'score'])
tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm[!msk, 'score']))

tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm <- tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")


```




#### All samples
```{r}
voom_for_decoupleR <- voom$E %>% bind_cols(voom$genes) %>% as.data.frame()
rownames(voom_for_decoupleR) <- make.names(voom_for_decoupleR$genes, unique=TRUE)
voom_for_decoupleR_final <- voom_for_decoupleR %>% select(-"genes") %>% select(contains("24h"))


run_decoupleR_all_samples <- decouple(mat = voom_for_decoupleR_final, net = collectri_df_for_Il6, .source = "source", .target = "target") 


# Get ulm results
run_decoupleR_all_samples_ulm <- run_decoupleR_all_samples %>% filter(statistic == "ulm")
run_decoupleR_all_samples_ulm_mat <- run_decoupleR_all_samples_ulm %>%
  pivot_wider(id_cols = 'condition', names_from = 'source',
              values_from = 'score') %>%
  column_to_rownames('condition') %>%
  as.matrix()

run_decoupleR_all_samples_ulm_mat_scaled <- scale(run_decoupleR_all_samples_ulm_mat)



# Get mlm results
run_decoupleR_all_samples_mlm <- run_decoupleR_all_samples %>% filter(statistic == "mlm")
run_decoupleR_all_samples_mlm_mat <- run_decoupleR_all_samples_mlm %>%
  pivot_wider(id_cols = 'condition', names_from = 'source',
              values_from = 'score') %>%
  column_to_rownames('condition') %>%
  as.matrix()

run_decoupleR_all_samples_mlm_mat_scaled <- scale(run_decoupleR_all_samples_mlm_mat)



# Get corr_wsum results
run_decoupleR_all_samples_corr_wsum <- run_decoupleR_all_samples %>% filter(statistic == "corr_wsum")
run_decoupleR_all_samples_corr_wsum_mat <- run_decoupleR_all_samples_corr_wsum %>%
  pivot_wider(id_cols = 'condition', names_from = 'source',
              values_from = 'score') %>%
  column_to_rownames('condition') %>%
  as.matrix()

run_decoupleR_all_samples_corr_wsum_mat_scaled <- scale(run_decoupleR_all_samples_corr_wsum_mat)


activators_Il6 <- collectri_df_for_Il6 %>% filter(target == "Il6" & mor == 1)
inhibitors_Il6 <- collectri_df_for_Il6 %>% filter(target == "Il6" & mor == -1)
collectri_df_activators_Il6 <- collectri_df_for_Il6 %>% filter(source %in% activators_Il6$source)
collectri_df_inhibitors_Il6 <- collectri_df_for_Il6 %>% filter(source %in% inhibitors_Il6$source)



palette_length = 100
my_color = colorRampPalette(c("Darkblue", "white","red"))(palette_length)

my_breaks <- c(seq(-3, 0, length.out=ceiling(palette_length/2) + 1),
               seq(0.05, 3, length.out=floor(palette_length/2)))



# Get pheatmaps (activators of Il6)

# ulm
pheatmap(t(run_decoupleR_all_samples_ulm_mat_scaled)[intersect_CIS_MTX_OXA_Control,], breaks = my_breaks, color = my_color, cluster_rows = TRUE, cluster_cols = FALSE, border_color = NA, main="Enhancers of Il6 more active in CIS than in the others (ulm)")


# mlm
pheatmap(t(run_decoupleR_all_samples_mlm_mat_scaled)[intersect_CIS_MTX_OXA_Control,], breaks = my_breaks, color = my_color, cluster_rows = TRUE, cluster_cols = FALSE, border_color = NA, main="Enhancers of Il6 more active in CIS than in the others (mlm)")


# corr_wsum
pheatmap(t(run_decoupleR_all_samples_corr_wsum_mat_scaled)[intersect_CIS_MTX_OXA_Control,], breaks = my_breaks, color = my_color, cluster_rows = TRUE, cluster_cols = FALSE, border_color = NA, main="Enhancers of Il6 more active in CIS than in the others (corr_wsum)")



# Get pheatmaps (activators of Il6)

pheatmap(t(run_decoupleR_all_samples_ulm_mat_scaled) %>% as.data.frame() %>% filter(rownames(.) %in% activators_Il6$source), border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Activators of Il6 (ulm)") 


pheatmap(t(run_decoupleR_all_samples_mlm_mat_scaled) %>% as.data.frame() %>% filter(rownames(.) %in% activators_Il6$source), border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Activators of Il6 (mlm)") 


pheatmap(t(run_decoupleR_all_samples_corr_wsum_mat_scaled) %>% as.data.frame() %>% filter(rownames(.) %in% activators_Il6$source), border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Activators of Il6 (corr_wsum)") 



# Get pheatmaps (inhibitors of Il6)


pheatmap(t(run_decoupleR_all_samples_ulm_mat_scaled) %>% as.data.frame() %>% filter(rownames(.) %in% inhibitors_Il6$source), border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Inhibitors of Il6 (ulm)") 

pheatmap(t(run_decoupleR_all_samples_mlm_mat_scaled) %>% as.data.frame() %>% filter(rownames(.) %in% inhibitors_Il6$source), border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Inhibitors of Il6 (mlm)") 


pheatmap(t(run_decoupleR_all_samples_corr_wsum_mat_scaled) %>% as.data.frame() %>% filter(rownames(.) %in% inhibitors_Il6$source), border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Inhibitors of Il6 (corr_wsum)") 



pheatmap(t(run_decoupleR_all_samples_ulm_mat_scaled)[c("Cebpb", "Atf4", "Egr1", "Hey1", "Junb", "Twis3h", "Nfe2l2", "Hic1", "Nfat5", "Prdm1"),], border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Inhibitors of Il6 more active in Control, MTX, OXA, than in CIS (ulm)") 


pheatmap(t(run_decoupleR_all_samples_mlm_mat_scaled)[c("Cebpb", "Atf4", "Egr1", "Hey1", "Junb", "Twis3h", "Nfe2l2", "Hic1", "Nfat5", "Prdm1"),], border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Inhibitors of Il6 more active in Control, MTX, OXA, than in CIS (mlm)") 


pheatmap(t(run_decoupleR_all_samples_corr_wsum_mat_scaled)[c("Cebpb", "Atf4", "Egr1", "Hey1", "Junb", "Twis3h", "Nfe2l2", "Hic1", "Nfat5", "Prdm1"),], border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Inhibitors of Il6 more active in Control, MTX, OXA, than in CIS (corr_wsum)") 

```

#### Ulm method


##### CIS vs MTX (and MTX vs CIS)
```{r}
# Get t-values for CIS_24h vs MTX_24h
get_t_values_Il6_CIS_MTX_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_MTX/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Il6_CIS_MTX_24h) <- make.names(get_t_values_Il6_CIS_MTX_24h$gene_name, unique=TRUE)
get_t_values_Il6_CIS_MTX_24h <- get_t_values_Il6_CIS_MTX_24h %>% dplyr::select(-"gene_name")



# Get t-values for MTX_24h vs CIS_24h
get_t_values_Il6_MTX_CIS_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Il6_MTX_CIS_24h) <- make.names(get_t_values_Il6_MTX_CIS_24h$gene_name, unique=TRUE)
get_t_values_Il6_MTX_CIS_24h <- get_t_values_Il6_MTX_CIS_24h %>% dplyr::select(-"gene_name")





# Run decoupleR for CIS_24h vs MTX_24h (with activators of Il6)
Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm <- run_ulm(mat=get_t_values_Il6_CIS_MTX_24h, net=collectri_df_activators_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Il6
tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm <- Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm$score > 0

tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm[msk, 'rnk'] <- rank(-tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm[msk, 'score'])
tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm[!msk, 'score']))

tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm <- tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")


# Plot (enhancers of Il6 of interest)
ggplot(tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm %>% filter(source %in% c("Nkx2-1", "Otx2", "Hsf2","Gata1","Bcl3" ,"Pou2f1", "Pou3f1", "E2f3", "Rorc", "Hoxd13", "Nkx6-1", "Creb1", "Jund", "Stat2")), aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")







# Run decoupleR for MTX_24h vs CIS_24h (with inhibitors of Il6)
Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm <- run_ulm(mat=get_t_values_Il6_MTX_CIS_24h, net=collectri_df_inhibitors_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Il6
tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm <- Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm$score > 0

tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm[msk, 'rnk'] <- rank(-tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm[msk, 'score'])
tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm[!msk, 'score']))

tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm <- tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")


```



##### CIS vs OXA (and OXA vs CIS)
```{r}
# Get t-values for CIS_24h vs OXA_24h
get_t_values_Il6_CIS_OXA_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_OXA/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Il6_CIS_OXA_24h) <- make.names(get_t_values_Il6_CIS_OXA_24h$gene_name, unique=TRUE)
get_t_values_Il6_CIS_OXA_24h <- get_t_values_Il6_CIS_OXA_24h %>% dplyr::select(-"gene_name")



# Get t-values for OXA_24h vs CIS_24h
get_t_values_Il6_OXA_CIS_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Il6_OXA_CIS_24h) <- make.names(get_t_values_Il6_OXA_CIS_24h$gene_name, unique=TRUE)
get_t_values_Il6_OXA_CIS_24h <- get_t_values_Il6_OXA_CIS_24h %>% dplyr::select(-"gene_name")




# Run decoupleR for CIS_24h vs OXA_24h (with activators of Il6)
Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_ulm <- run_ulm(mat=get_t_values_Il6_CIS_OXA_24h, net=collectri_df_activators_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Il6
tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_ulm <- Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_ulm %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_ulm$score > 0 

tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_ulm[msk, 'rnk'] <- rank(-tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_ulm[msk, 'score'])
tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_ulm[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_ulm[!msk, 'score']))

tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_ulm <- tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_ulm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_ulm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")



# Run decoupleR for OXA_24h vs CIS_24h (with inhibitors of Il6)
Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_ulm <- run_ulm(mat=get_t_values_Il6_OXA_CIS_24h, net=collectri_df_inhibitors_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Il6
tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_ulm <- Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_ulm %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_ulm$score > 0 

tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_ulm[msk, 'rnk'] <- rank(-tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_ulm[msk, 'score'])
tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_ulm[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_ulm[!msk, 'score']))

tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_ulm <- tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_ulm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_ulm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")


```

##### CIS vs Control (and Control vs CIS)
```{r}
# Get t-values for CIS_24h vs Control_24h
get_t_values_Il6_CIS_Control_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Il6_CIS_Control_24h) <- make.names(get_t_values_Il6_CIS_Control_24h$gene_name, unique=TRUE)
get_t_values_Il6_CIS_Control_24h <- get_t_values_Il6_CIS_Control_24h %>% dplyr::select(-"gene_name")



# Get t-values for Control_24h vs CIS_24h
get_t_values_Il6_Control_CIS_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_CIS/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Il6_Control_CIS_24h) <- make.names(get_t_values_Il6_Control_CIS_24h$gene_name, unique=TRUE)
get_t_values_Il6_Control_CIS_24h <- get_t_values_Il6_Control_CIS_24h %>% dplyr::select(-"gene_name")



# Run decoupleR for CIS_24h vs Control_24h (with activators of Il6)
Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_ulm <- run_ulm(mat=get_t_values_Il6_CIS_Control_24h, net=collectri_df_activators_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Il6
tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_ulm <- Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_ulm %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_ulm$score > 0

tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_ulm[msk, 'rnk'] <- rank(-tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_ulm[msk, 'score'])
tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_ulm[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_ulm[!msk, 'score']))

tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_ulm <- tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_ulm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_ulm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")



# Run decoupleR for Control_24h vs CIS_24h (with inhibitors of Il6)
Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_ulm <- run_ulm(mat=get_t_values_Il6_Control_CIS_24h, net=collectri_df_inhibitors_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Il6
tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_ulm <- Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_ulm %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_ulm$score > 0

tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_ulm[msk, 'rnk'] <- rank(-tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_ulm[msk, 'score'])
tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_ulm[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_ulm[!msk, 'score']))

tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_ulm <- tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_ulm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_ulm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```



#### Get TFs of Il6 with greater activity in CIS than in MTX, OXA and Control (without filter on p-value)
```{r}

tf_Il6_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Il6_ulm_not_filtered <- tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm %>% filter(score > 0) %>% arrange(rnk)


tf_Il6_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Il6_ulm_not_filtered <- tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_ulm %>% filter(score > 0) %>% arrange(rnk)


tf_Il6_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Il6_ulm_not_filtered <- tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_ulm %>% filter(score > 0) %>% arrange(rnk)





tf_Il6_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Il6_ulm_not_filtered <- tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm %>% filter(score > 0) %>% arrange(rnk)


tf_Il6_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Il6_ulm_not_filtered <- tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_ulm %>% filter(score > 0) %>% arrange(rnk)


tf_Il6_higher_activity_in_Control_24h_than_in_CIS_24h_inhibitors_Il6_ulm_not_filtered <- tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_ulm %>% filter(score > 0) %>% arrange(rnk)


```

#### Get TFs of Il6 with greater activity in CIS than in MTX and in OXA (with filter on p-value)
```{r}
tf_Il6_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Il6_ulm_filtered <- tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_ulm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Il6_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Il6_ulm_filtered <- tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_ulm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Il6_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Il6_ulm_filtered <- tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_ulm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)





tf_Il6_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Il6_ulm_filtered <- tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_ulm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Il6_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Il6_ulm_filtered <- tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_ulm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Il6_higher_activity_in_Control_24h_than_in_Cis_24h_inhibitors_Il6_ulm_filtered <- tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_ulm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)
```








#### Mlm method




##### CIS vs MTX (and MTX vs CIS)
```{r}

# Run decoupleR for CIS_24h vs MTX_24h (with activators of Il6)
Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_mlm <- run_mlm(mat=get_t_values_Il6_CIS_MTX_24h, net=collectri_df_activators_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Il6
tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_mlm <- Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_mlm %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_mlm$score > 0

tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_mlm[msk, 'rnk'] <- rank(-tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_mlm[msk, 'score'])
tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_mlm[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_mlm[!msk, 'score']))

tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_mlm <- tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_mlm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_mlm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")


# Plot (enhancers of Il6 of interest)
ggplot(tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_mlm %>% filter(source %in% c("Nkx2-1", "Otx2", "Hsf2","Gata1","Bcl3" ,"Pou2f1", "Pou3f1", "E2f3", "Rorc", "Hoxd13", "Nkx6-1", "Creb1", "Jund", "Stat2")), aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")





# Run decoupleR for MTX_24h vs CIS_24h (with inhibitors of Il6)
Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_mlm <- run_mlm(mat=get_t_values_Il6_MTX_CIS_24h, net=collectri_df_inhibitors_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Il6
tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_mlm <- Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_mlm %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_mlm$score > 0

tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_mlm[msk, 'rnk'] <- rank(-tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_mlm[msk, 'score'])
tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_mlm[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_mlm[!msk, 'score']))

tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_mlm <- tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_mlm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_mlm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```



##### CIS vs OXA (and OXA vs CIS)
```{r}

# Run decoupleR for CIS_24h vs OXA_24h (with activators of Il6)
Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_mlm <- run_mlm(mat=get_t_values_Il6_CIS_OXA_24h, net=collectri_df_activators_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Il6
tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_mlm <- Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_mlm %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_mlm$score > 0 

tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_mlm[msk, 'rnk'] <- rank(-tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_mlm[msk, 'score'])
tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_mlm[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_mlm[!msk, 'score']))

tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_mlm <- tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_mlm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_mlm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")



# Run decoupleR for OXA_24h vs CIS_24h (with inhibitors of Il6)
Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_mlm <- run_mlm(mat=get_t_values_Il6_OXA_CIS_24h, net=collectri_df_inhibitors_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Il6
tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_mlm <- Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_mlm %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_mlm$score > 0

tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_mlm[msk, 'rnk'] <- rank(-tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_mlm[msk, 'score'])
tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_mlm[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_mlm[!msk, 'score']))

tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_mlm <- tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_mlm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_mlm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")


```

##### CIS vs Control (and Control vs CIS)
```{r}

# Run decoupleR for CIS_24h vs Control_24h (with activators of Il6)
Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_mlm <- run_mlm(mat=get_t_values_Il6_CIS_Control_24h, net=collectri_df_activators_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Il6
tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_mlm <- Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_mlm %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_mlm$score > 0 

tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_mlm[msk, 'rnk'] <- rank(-tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_mlm[msk, 'score'])
tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_mlm[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_mlm[!msk, 'score']))

tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_mlm <- tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_mlm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_mlm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")



# Run decoupleR for Control_24h vs CIS_24h (with inhibitors of Il6)
Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_mlm <- run_mlm(mat=get_t_values_Il6_Control_CIS_24h, net=collectri_df_inhibitors_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Il6
tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_mlm <- Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_mlm %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_mlm$score > 0

tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_mlm[msk, 'rnk'] <- rank(-tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_mlm[msk, 'score'])
tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_mlm[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_mlm[!msk, 'score']))

tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_mlm <- tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_mlm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_mlm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```




#### Get TFs of Il6 with greater activity in CIS than in MTX, OXA and Control (without filter on p-value)
```{r}
tf_Il6_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Il6_mlm_not_filtered <- tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_mlm %>% filter(score > 0) %>% arrange(rnk)


tf_Il6_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Il6_mlm_not_filtered <- tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_mlm %>% filter(score > 0) %>% arrange(rnk)


tf_Il6_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Il6_mlm_not_filtered <- tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_mlm %>% filter(score > 0) %>% arrange(rnk)





tf_Il6_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Il6_mlm_not_filtered <- tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_mlm %>% filter(score > 0) %>% arrange(rnk)


tf_Il6_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Il6_mlm_not_filtered <- tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_mlm %>% filter(score > 0) %>% arrange(rnk)


tf_Il6_higher_activity_in_Control_24h_than_in_CIS_24h_inhibitors_Il6_mlm_not_filtered <- tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_mlm %>% filter(score > 0) %>% arrange(rnk)


```

#### Get TFs of Il6 with greater activity in CIS than in MTX and in OXA (with filter on p-value)
```{r}
tf_Il6_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Il6_mlm_filtered <- tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_mlm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Il6_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Il6_mlm_filtered <- tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_mlm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Il6_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Il6_mlm_filtered <- tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_mlm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)





tf_Il6_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Il6_mlm_filtered <- tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_mlm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Il6_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Il6_mlm_filtered <- tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_mlm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Il6_higher_activity_in_Control_24h_than_in_Cis_24h_inhibitors_Il6_mlm_filtered <- tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_mlm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)

```





#### Wsum method




##### CIS vs MTX (and MTX vs CIS)
```{r}
# Get t-values for CIS_24h vs MTX_24h
get_t_values_Il6_CIS_MTX_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_MTX/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Il6_CIS_MTX_24h) <- make.names(get_t_values_Il6_CIS_MTX_24h$gene_name, unique=TRUE)
get_t_values_Il6_CIS_MTX_24h <- get_t_values_Il6_CIS_MTX_24h %>% dplyr::select(-"gene_name")




# Run decoupleR for CIS_24h vs MTX_24h (with activators of Il6)
Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_wsum <- run_wsum(mat=get_t_values_Il6_CIS_MTX_24h, net=collectri_df_activators_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Il6
tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_wsum <- Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_wsum %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_wsum$score > 0

tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_wsum[msk, 'rnk'] <- rank(-tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_wsum[msk, 'score'])
tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_wsum[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_wsum[!msk, 'score']))

tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_wsum <- tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_wsum %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_wsum, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")



# Plot (enhancers of Il6 of interest)
ggplot(tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_wsum %>% filter(source %in% c("Nkx2-1", "Otx2", "Hsf2","Gata1","Bcl3" ,"Pou2f1", "Pou3f1", "E2f3", "Rorc", "Hoxd13", "Nkx6-1", "Creb1", "Jund", "Stat2")), aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")


# Run decoupleR for MTX_24h vs CIS_24h (with inhibitors of Il6)
Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_wsum <- run_wsum(mat=get_t_values_Il6_MTX_CIS_24h, net=collectri_df_inhibitors_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Il6
tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_wsum <- Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_wsum %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_wsum$score > 0

tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_wsum[msk, 'rnk'] <- rank(-tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_wsum[msk, 'score'])
tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_wsum[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_wsum[!msk, 'score']))

tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_wsum <- tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_wsum %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_wsum, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```



##### CIS vs OXA (OXA vs CIS)
```{r}
# Get t-values for CIS_24h vs OXA_24h
get_t_values_Il6_CIS_OXA_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_OXA/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Il6_CIS_OXA_24h) <- make.names(get_t_values_Il6_CIS_OXA_24h$gene_name, unique=TRUE)
get_t_values_Il6_CIS_OXA_24h <- get_t_values_Il6_CIS_OXA_24h %>% dplyr::select(-"gene_name")




# Run decoupleR for CIS_24h vs OXA_24h (with activators of Il6)
Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_wsum <- run_wsum(mat=get_t_values_Il6_CIS_OXA_24h, net=collectri_df_activators_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Il6
tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_wsum <- Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_wsum %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_wsum$score > 0

tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_wsum[msk, 'rnk'] <- rank(-tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_wsum[msk, 'score'])
tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_wsum[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_wsum[!msk, 'score']))

tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_wsum <- tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_wsum %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_wsum, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")



# Run decoupleR for OXA_24h vs CIS_24h (with inhibitors of Il6)
Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_wsum <- run_wsum(mat=get_t_values_Il6_OXA_CIS_24h, net=collectri_df_inhibitors_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Il6
tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_wsum <- Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_wsum %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_wsum$score > 0 

tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_wsum[msk, 'rnk'] <- rank(-tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_wsum[msk, 'score'])
tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_wsum[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_wsum[!msk, 'score']))

tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_wsum <- tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_wsum %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_wsum, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```

##### CIS vs Control (and Control vs CIS)
```{r}
# Get t-values for CIS_24h vs Control_24h
get_t_values_Il6_CIS_Control_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Il6_CIS_Control_24h) <- make.names(get_t_values_Il6_CIS_Control_24h$gene_name, unique=TRUE)
get_t_values_Il6_CIS_Control_24h <- get_t_values_Il6_CIS_Control_24h %>% dplyr::select(-"gene_name")




# Run decoupleR for CIS_24h vs Control_24h (with activators of Il6)
Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_wsum <- run_wsum(mat=get_t_values_Il6_CIS_Control_24h, net=collectri_df_activators_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Il6
tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_wsum <- Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_wsum %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_wsum$score > 0

tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_wsum[msk, 'rnk'] <- rank(-tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_wsum[msk, 'score'])
tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_wsum[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_wsum[!msk, 'score']))

tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_wsum <- tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_wsum %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_wsum, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")



# Run decoupleR for Control_24h vs CIS_24h (with inhibitors of Il6)
Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_wsum <- run_wsum(mat=get_t_values_Il6_Control_CIS_24h, net=collectri_df_inhibitors_Il6, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Il6
tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_wsum <- Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_wsum %>% dplyr::mutate(rnk = NA)
msk <- tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_wsum$score > 0 

tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_wsum[msk, 'rnk'] <- rank(-tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_wsum[msk, 'score'])
tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_wsum[!msk, 'rnk'] <- rank(-abs(tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_wsum[!msk, 'score']))

tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_wsum <- tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_wsum %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_wsum, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")


```




#### Get TFs of Il6 with greater activity in CIS than in MTX, OXA and Control (without filter on p-value)
```{r}
# greater activity in CIS than in MTX and OXA
tf_Il6_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Il6_wsum_not_filtered <- tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_wsum %>% filter(score > 0) %>% arrange(rnk)


tf_Il6_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Il6_wsum_not_filtered <- tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_wsum %>% filter(score > 0) %>% arrange(rnk)


tf_Il6_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Il6_wsum_not_filtered <- tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_wsum %>% filter(score > 0) %>% arrange(rnk)




tf_Il6_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Il6_wsum_not_filtered <- tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_wsum %>% filter(score > 0) %>% arrange(rnk)


tf_Il6_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Il6_wsum_not_filtered <- tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_wsum %>% filter(score > 0) %>% arrange(rnk)


tf_Il6_higher_activity_in_Control_24h_than_in_CIS_24h_inhibitors_Il6_wsum_not_filtered <- tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_wsum %>% filter(score > 0) %>% arrange(rnk)



```

#### Get TFs of Il6 with greater activity in CIS than in MTX and in OXA (with filter on p-value)
```{r}
tf_Il6_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Il6_wsum_filtered <- tf_Il6_activity_CIS_24h_vs_MTX_24h_activators_Il6_wsum %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Il6_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Il6_wsum_filtered <- tf_Il6_activity_CIS_24h_vs_OXA_24h_activators_Il6_wsum %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Il6_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Il6_wsum_filtered <- tf_Il6_activity_CIS_24h_vs_Control_24h_activators_Il6_wsum %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)





tf_Il6_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Il6_wsum_filtered <- tf_Il6_activity_MTX_24h_vs_CIS_24h_inhibitors_Il6_wsum %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Il6_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Il6_wsum_filtered <- tf_Il6_activity_OXA_24h_vs_CIS_24h_inhibitors_Il6_wsum %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Il6_higher_activity_in_Control_24h_than_in_CIS_24h_inhibitors_Il6_wsum_filtered <- tf_Il6_activity_Control_24h_vs_CIS_24h_inhibitors_Il6_wsum %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


```


```{r}
# CIS vs MTX
get_intersection_activators_Il6_CIS_MTX <- intersect(tf_Il6_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Il6_ulm_not_filtered$source, tf_Il6_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Il6_mlm_not_filtered$source)

get_all_intersection_activators_Il6_CIS_MTX <- intersect(get_intersection_activators_Il6_CIS_MTX, tf_Il6_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Il6_wsum_not_filtered$source)


# CIS vs MTX (filtered)
get_intersection_activators_Il6_CIS_MTX_filtered <- intersect(tf_Il6_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Il6_ulm_filtered$source, tf_Il6_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Il6_mlm_filtered$source)

get_all_intersection_activators_Il6_CIS_MTX_filtered <- intersect(get_intersection_activators_Il6_CIS_MTX_filtered, tf_Il6_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Il6_wsum_filtered$source)



# CIS vs OXA
get_intersection_activators_Il6_CIS_OXA <- intersect(tf_Il6_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Il6_ulm_not_filtered$source, tf_Il6_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Il6_mlm_not_filtered$source)

get_all_intersection_activators_Il6_CIS_OXA <- intersect(get_intersection_activators_Il6_CIS_OXA, tf_Il6_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Il6_wsum_not_filtered$source)


# CIS vs OXA (filtered)
get_intersection_activators_Il6_CIS_OXA_filtered <- intersect(tf_Il6_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Il6_ulm_filtered$source, tf_Il6_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Il6_mlm_filtered$source)

get_all_intersection_activators_Il6_CIS_OXA_filtered <- intersect(get_intersection_activators_Il6_CIS_OXA_filtered, tf_Il6_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Il6_wsum_filtered$source)



# CIS vs Control
get_intersection_activators_Il6_CIS_Control <- intersect(tf_Il6_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Il6_ulm_not_filtered$source, tf_Il6_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Il6_mlm_not_filtered$source)

get_all_intersection_activators_Il6_CIS_Control <- intersect(get_intersection_activators_Il6_CIS_Control, tf_Il6_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Il6_wsum_not_filtered$source)


# CIS vs Control (filtered)
get_intersection_activators_Il6_CIS_Control_filtered <- intersect(tf_Il6_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Il6_ulm_filtered$source, tf_Il6_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Il6_mlm_filtered$source)

get_all_intersection_activators_Il6_CIS_Control_filtered <- intersect(get_intersection_activators_Il6_CIS_Control_filtered, tf_Il6_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Il6_wsum_filtered$source)


# All intersection (activators of Il6)

intersect_CIS_MTX_OXA <- intersect(get_all_intersection_activators_Il6_CIS_MTX, get_all_intersection_activators_Il6_CIS_OXA)
intersect_CIS_MTX_OXA_Control <- intersect(intersect_CIS_MTX_OXA, get_all_intersection_activators_Il6_CIS_Control)


# All intersection (activators of Il6) - filtered

intersect_CIS_MTX_OXA_filtered <- intersect(get_all_intersection_activators_Il6_CIS_MTX_filtered, get_all_intersection_activators_Il6_CIS_OXA_filtered)
intersect_CIS_MTX_OXA_Control_filtered <- intersect(intersect_CIS_MTX_OXA_filtered, get_all_intersection_activators_Il6_CIS_Control_filtered)









# MTX vs CIS
get_intersection_inhibitors_Il6_MTX_CIS <- intersect(tf_Il6_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Il6_ulm_not_filtered$source, tf_Il6_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Il6_mlm_not_filtered$source)

get_all_intersection_inhibitors_Il6_MTX_CIS <- intersect(get_intersection_inhibitors_Il6_MTX_CIS, tf_Il6_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Il6_corr_wsum_not_filtered$source)



# OXA vs CIS
get_intersection_inhibitors_Il6_OXA_CIS <- intersect(tf_Il6_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Il6_ulm_not_filtered$source, tf_Il6_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Il6_mlm_not_filtered$source)

get_all_intersection_inhibitors_Il6_OXA_CIS <- intersect(get_intersection_inhibitors_Il6_OXA_CIS, tf_Il6_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Il6_corr_wsum_not_filtered$source)



# Control vs CIS
get_intersection_inhibitors_Il6_Control_CIS <- intersect(tf_Il6_higher_activity_in_Control_24h_than_in_CIS_24h_inhibitors_Il6_ulm_not_filtered$source, tf_Il6_higher_activity_in_Control_24h_than_in_CIS_24h_inhibitors_Il6_mlm_not_filtered$source)

get_all_intersection_inhibitors_Il6_Control_CIS <- intersect(get_intersection_inhibitors_Il6_Control_CIS, tf_Il6_higher_activity_in_Control_24h_than_in_CIS_24h_inhibitors_Il6_corr_wsum_not_filtered$source)


# All intersection (inhibitors of Il6)
intersect_MTX_OXA_CIS <- intersect(get_all_intersection_inhibitors_Il6_MTX_CIS, get_all_intersection_inhibitors_Il6_OXA_CIS)
intersect_MTX_OXA_Control_CIS <- intersect(intersect_MTX_OXA_CIS, get_all_intersection_inhibitors_Il6_Control_CIS)
```






### Ccl4

#### Ulm method

```{r}
# Get tfs which target Ccl4
collectri_df_Ccl4 <- collectri_df %>% dplyr::group_by(source) %>% dplyr::summarise(target_Ccl4 = any(target == "Ccl4")) %>% as.data.frame() %>% filter(target_Ccl4 == "TRUE")
collectri_df_for_Ccl4 <- collectri_df %>% dplyr::filter(source %in% collectri_df_Ccl4$source)

```




##### All samples
```{r}
voom_for_decoupleR <- voom$E %>% bind_cols(voom$genes) %>% as.data.frame()
rownames(voom_for_decoupleR) <- make.names(voom_for_decoupleR$genes, unique=TRUE)
voom_for_decoupleR_final <- voom_for_decoupleR %>% select(-"genes") %>% select(contains("24h"))


run_decoupleR_all_samples <- decouple(mat = voom_for_decoupleR_final, net = collectri_df_for_Ccl4, .source = "source", .target = "target") 


# Get ulm results
run_decoupleR_all_samples_ulm <- run_decoupleR_all_samples %>% filter(statistic == "ulm")
run_decoupleR_all_samples_ulm_mat <- run_decoupleR_all_samples_ulm %>%
  pivot_wider(id_cols = 'condition', names_from = 'source',
              values_from = 'score') %>%
  column_to_rownames('condition') %>%
  as.matrix()

run_decoupleR_all_samples_ulm_mat_scaled <- scale(run_decoupleR_all_samples_ulm_mat)



# Get mlm results
run_decoupleR_all_samples_mlm <- run_decoupleR_all_samples %>% filter(statistic == "mlm")
run_decoupleR_all_samples_mlm_mat <- run_decoupleR_all_samples_mlm %>%
  pivot_wider(id_cols = 'condition', names_from = 'source',
              values_from = 'score') %>%
  column_to_rownames('condition') %>%
  as.matrix()

run_decoupleR_all_samples_mlm_mat_scaled <- scale(run_decoupleR_all_samples_mlm_mat)



# Get corr_wsum results
run_decoupleR_all_samples_corr_wsum <- run_decoupleR_all_samples %>% filter(statistic == "corr_wsum")
run_decoupleR_all_samples_corr_wsum_mat <- run_decoupleR_all_samples_corr_wsum %>%
  pivot_wider(id_cols = 'condition', names_from = 'source',
              values_from = 'score') %>%
  column_to_rownames('condition') %>%
  as.matrix()

run_decoupleR_all_samples_corr_wsum_mat_scaled <- scale(run_decoupleR_all_samples_corr_wsum_mat)


activators_Ccl4 <- collectri_df_for_Ccl4 %>% filter(target == "Ccl4" & mor == 1)
inhibitors_Ccl4 <- collectri_df_for_Ccl4 %>% filter(target == "Ccl4" & mor == -1)
collectri_df_activators_Ccl4 <- collectri_df_for_Ccl4 %>% filter(source %in% activators_Ccl4$source)
collectri_df_inhibitors_Ccl4 <- collectri_df_for_Ccl4 %>% filter(source %in% inhibitors_Ccl4$source)



palette_length = 100
my_color = colorRampPalette(c("Darkblue", "white","red"))(palette_length)

my_breaks <- c(seq(-3, 0, length.out=ceiling(palette_length/2) + 1),
               seq(0.05, 3, length.out=floor(palette_length/2)))



# Get pheatmaps (activators of Ccl4)

# ulm
pheatmap(t(run_decoupleR_all_samples_ulm_mat_scaled)[intersect_CIS_MTX_OXA_Control,], breaks = my_breaks, color = my_color, cluster_rows = TRUE, cluster_cols = FALSE, border_color = NA, main="Enhancers of Ccl4 more active in CIS than in the others (ulm)")


# mlm
pheatmap(t(run_decoupleR_all_samples_mlm_mat_scaled)[intersect_CIS_MTX_OXA_Control,], breaks = my_breaks, color = my_color, cluster_rows = TRUE, cluster_cols = FALSE, border_color = NA, main="Enhancers of Ccl4 more active in CIS than in the others (mlm)")


# corr_wsum
pheatmap(t(run_decoupleR_all_samples_corr_wsum_mat_scaled)[intersect_CIS_MTX_OXA_Control,], breaks = my_breaks, color = my_color, cluster_rows = TRUE, cluster_cols = FALSE, border_color = NA, main="Enhancers of Ccl4 more active in CIS than in the others (corr_wsum)")



pheatmap(t(run_decoupleR_all_samples_ulm_mat_scaled) %>% as.data.frame() %>% filter(rownames(.) %in% activators_Ccl4$source), border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Activators of Ccl4 (ulm)") 


pheatmap(t(run_decoupleR_all_samples_mlm_mat_scaled) %>% as.data.frame() %>% filter(rownames(.) %in% activators_Ccl4$source), border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Activators of Ccl4 (mlm)") 


pheatmap(t(run_decoupleR_all_samples_corr_wsum_mat_scaled) %>% as.data.frame() %>% filter(rownames(.) %in% activators_Ccl4$source), border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Activators of Ccl4 (corr_wsum)") 



# Get pheatmaps (inhibitors of Ccl4)


pheatmap(t(run_decoupleR_all_samples_ulm_mat_scaled) %>% as.data.frame() %>% filter(rownames(.) %in% inhibitors_Ccl4$source), border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Inhibitors of Ccl4 (ulm)") 

pheatmap(t(run_decoupleR_all_samples_mlm_mat_scaled) %>% as.data.frame() %>% filter(rownames(.) %in% inhibitors_Ccl4$source), border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Inhibitors of Ccl4 (mlm)") 


pheatmap(t(run_decoupleR_all_samples_corr_wsum_mat_scaled) %>% as.data.frame() %>% filter(rownames(.) %in% inhibitors_Ccl4$source), border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Inhibitors of Ccl4 (corr_wsum)") 



pheatmap(t(run_decoupleR_all_samples_ulm_mat_scaled), border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Inhibitors of Ccl4 more active in Control, MTX, OXA, than in CIS (ulm)") 


pheatmap(t(run_decoupleR_all_samples_mlm_mat_scaled)[c("Cebpb", "Atf4", "Egr1", "Hey1", "Junb", "Twis3h", "Nfe2l2", "Hic1", "Nfat5", "Prdm1"),], border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Inhibitors of Ccl4 more active in Control, MTX, OXA, than in CIS (mlm)") 


pheatmap(t(run_decoupleR_all_samples_corr_wsum_mat_scaled)[c("Cebpb", "Atf4", "Egr1", "Hey1", "Junb", "Twis3h", "Nfe2l2", "Hic1", "Nfat5", "Prdm1"),], border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main = "Inhibitors of Ccl4 more active in Control, MTX, OXA, than in CIS (corr_wsum)") 

```




##### CIS vs MTX (and MTX vs CIS)
```{r}
# Get t-values for CIS_24h vs MTX_24h
get_t_values_Ccl4_CIS_MTX_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_MTX/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Ccl4_CIS_MTX_24h) <- make.names(get_t_values_Ccl4_CIS_MTX_24h$gene_name, unique=TRUE)
get_t_values_Ccl4_CIS_MTX_24h <- get_t_values_Ccl4_CIS_MTX_24h %>% dplyr::select(-"gene_name")



# Get t-values for MTX_24h vs CIS_24h
get_t_values_Ccl4_MTX_CIS_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_MTX_vs_CIS/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Ccl4_MTX_CIS_24h) <- make.names(get_t_values_Ccl4_MTX_CIS_24h$gene_name, unique=TRUE)
get_t_values_Ccl4_MTX_CIS_24h <- get_t_values_Ccl4_MTX_CIS_24h %>% dplyr::select(-"gene_name")





# Run decoupleR for CIS_24h vs MTX_24h (with activators of Ccl4)
Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_ulm <- run_ulm(mat=get_t_values_Ccl4_CIS_MTX_24h, net=collectri_df_activators_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Ccl4
tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_ulm <- Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_ulm %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_ulm$score > 0

tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_ulm[msk, 'rnk'] <- rank(-tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_ulm[msk, 'score'])
tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_ulm[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_ulm[!msk, 'score']))

tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_ulm <- tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_ulm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_ulm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")


# Plot (enhancers of Ccl4 of interest)
ggplot(tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_ulm %>% filter(source %in% c("Nkx2-1", "Otx2", "Hsf2","Gata1","Bcl3" ,"Pou2f1", "Pou3f1", "E2f3", "Rorc", "Hoxd13", "Nkx6-1", "Creb1", "Jund", "Stat2")), aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")







# Run decoupleR for MTX_24h vs CIS_24h (with inhibitors of Ccl4)
Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_ulm <- run_ulm(mat=get_t_values_Ccl4_MTX_CIS_24h, net=collectri_df_inhibitors_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Ccl4
tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_ulm <- Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_ulm %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_ulm$score > 0

tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_ulm[msk, 'rnk'] <- rank(-tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_ulm[msk, 'score'])
tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_ulm[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_ulm[!msk, 'score']))

tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_ulm <- tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_ulm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_ulm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")


```



##### CIS vs OXA (and OXA vs CIS)
```{r}
# Get t-values for CIS_24h vs OXA_24h
get_t_values_Ccl4_CIS_OXA_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_OXA/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Ccl4_CIS_OXA_24h) <- make.names(get_t_values_Ccl4_CIS_OXA_24h$gene_name, unique=TRUE)
get_t_values_Ccl4_CIS_OXA_24h <- get_t_values_Ccl4_CIS_OXA_24h %>% dplyr::select(-"gene_name")



# Get t-values for OXA_24h vs CIS_24h
get_t_values_Ccl4_OXA_CIS_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_OXA_vs_CIS/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Ccl4_OXA_CIS_24h) <- make.names(get_t_values_Ccl4_OXA_CIS_24h$gene_name, unique=TRUE)
get_t_values_Ccl4_OXA_CIS_24h <- get_t_values_Ccl4_OXA_CIS_24h %>% dplyr::select(-"gene_name")




# Run decoupleR for CIS_24h vs OXA_24h (with activators of Ccl4)
Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_ulm <- run_ulm(mat=get_t_values_Ccl4_CIS_OXA_24h, net=collectri_df_activators_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Ccl4
tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_ulm <- Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_ulm %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_ulm$score > 0

tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_ulm[msk, 'rnk'] <- rank(-tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_ulm[msk, 'score'])
tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_ulm[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_ulm[!msk, 'score']))

tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_ulm <- tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_ulm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_ulm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")



# Run decoupleR for OXA_24h vs CIS_24h (with inhibitors of Ccl4)
Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_ulm <- run_ulm(mat=get_t_values_Ccl4_OXA_CIS_24h, net=collectri_df_inhibitors_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Ccl4
tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_ulm <- Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_ulm %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_ulm$score > 0

tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_ulm[msk, 'rnk'] <- rank(-tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_ulm[msk, 'score'])
tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_ulm[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_ulm[!msk, 'score']))

tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_ulm <- tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_ulm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_ulm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")


```

##### CIS vs Control (and Control vs CIS)
```{r}
# Get t-values for CIS_24h vs Control_24h
get_t_values_Ccl4_CIS_Control_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Ccl4_CIS_Control_24h) <- make.names(get_t_values_Ccl4_CIS_Control_24h$gene_name, unique=TRUE)
get_t_values_Ccl4_CIS_Control_24h <- get_t_values_Ccl4_CIS_Control_24h %>% dplyr::select(-"gene_name")



# Get t-values for Control_24h vs CIS_24h
get_t_values_Ccl4_Control_CIS_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_Control_vs_CIS/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Ccl4_Control_CIS_24h) <- make.names(get_t_values_Ccl4_Control_CIS_24h$gene_name, unique=TRUE)
get_t_values_Ccl4_Control_CIS_24h <- get_t_values_Ccl4_Control_CIS_24h %>% dplyr::select(-"gene_name")



# Run decoupleR for CIS_24h vs Control_24h (with activators of Ccl4)
Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_ulm <- run_ulm(mat=get_t_values_Ccl4_CIS_Control_24h, net=collectri_df_activators_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Ccl4
tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_ulm <- Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_ulm %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_ulm$score > 0 

tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_ulm[msk, 'rnk'] <- rank(-tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_ulm[msk, 'score'])
tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_ulm[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_ulm[!msk, 'score']))

tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_ulm <- tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_ulm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_ulm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")



# Run decoupleR for Control_24h vs CIS_24h (with inhibitors of Ccl4)
Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_ulm <- run_ulm(mat=get_t_values_Ccl4_Control_CIS_24h, net=collectri_df_inhibitors_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Ccl4
tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_ulm <- Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_ulm %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_ulm$score > 0

tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_ulm[msk, 'rnk'] <- rank(-tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_ulm[msk, 'score'])
tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_ulm[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_ulm[!msk, 'score']))

tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_ulm <- tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_ulm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_ulm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```



#### Get TFs of Ccl4 with greater activity in CIS than in MTX, OXA and Control (without filter on p-value)
```{r}

tf_Ccl4_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Ccl4_ulm_not_filtered <- tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_ulm %>% filter(score > 0) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Ccl4_ulm_not_filtered <- tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_ulm %>% filter(score > 0) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Ccl4_ulm_not_filtered <- tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_ulm %>% filter(score > 0) %>% arrange(rnk)





tf_Ccl4_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Ccl4_ulm_not_filtered <- tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_ulm %>% filter(score > 0) %>% arrange(rnk)


tf_Ccl4_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Ccl4_ulm_not_filtered <- tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_ulm %>% filter(score > 0) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_Control_24h_than_in_CIS_24h_inhibitors_Ccl4_ulm_not_filtered <- tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_ulm %>% filter(score > 0) %>% arrange(rnk)


```

#### Get TFs of Ccl4 with greater activity in CIS than in MTX, OXA , and Control (with filter on p-value)
```{r}
tf_Ccl4_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Ccl4_ulm_filtered <- tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_ulm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Ccl4_ulm_filtered <- tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_ulm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Ccl4_ulm_filtered <- tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_ulm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)





tf_Ccl4_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Ccl4_ulm_filtered <- tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_ulm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Ccl4_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Ccl4_ulm_filtered <- tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_ulm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_Control_24h_than_in_Cis_24h_inhibitors_Ccl4_ulm_filtered <- tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_ulm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)
```








#### Mlm method




##### CIS vs MTX (and MTX vs CIS)
```{r}

# Run decoupleR for CIS_24h vs MTX_24h (with activators of Ccl4)
Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_mlm <- run_mlm(mat=get_t_values_Ccl4_CIS_MTX_24h, net=collectri_df_activators_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Ccl4
tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_mlm <- Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_mlm %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_mlm$score > 0

tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_mlm[msk, 'rnk'] <- rank(-tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_mlm[msk, 'score'])
tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_mlm[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_mlm[!msk, 'score']))

tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_mlm <- tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_mlm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_mlm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")


# Plot (enhancers of Ccl4 of interest)
ggplot(tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_mlm %>% filter(source %in% c("Nkx2-1", "Otx2", "Hsf2","Gata1","Bcl3" ,"Pou2f1", "Pou3f1", "E2f3", "Rorc", "Hoxd13", "Nkx6-1", "Creb1", "Jund", "Stat2")), aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")





# Run decoupleR for MTX_24h vs CIS_24h (with inhibitors of Ccl4)
Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_mlm <- run_mlm(mat=get_t_values_Ccl4_MTX_CIS_24h, net=collectri_df_inhibitors_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Ccl4
tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_mlm <- Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_mlm %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_mlm$score > 0

tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_mlm[msk, 'rnk'] <- rank(-tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_mlm[msk, 'score'])
tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_mlm[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_mlm[!msk, 'score']))

tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_mlm <- tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_mlm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_mlm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```



##### CIS vs OXA (and OXA vs CIS)
```{r}

# Run decoupleR for CIS_24h vs OXA_24h (with activators of Ccl4)
Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_mlm <- run_mlm(mat=get_t_values_Ccl4_CIS_OXA_24h, net=collectri_df_activators_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Ccl4
tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_mlm <- Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_mlm %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_mlm$score > 0

tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_mlm[msk, 'rnk'] <- rank(-tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_mlm[msk, 'score'])
tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_mlm[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_mlm[!msk, 'score']))

tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_mlm <- tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_mlm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_mlm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")



# Run decoupleR for OXA_24h vs CIS_24h (with inhibitors of Ccl4)
Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_mlm <- run_mlm(mat=get_t_values_Ccl4_OXA_CIS_24h, net=collectri_df_inhibitors_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Ccl4
tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_mlm <- Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_mlm %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_mlm$score > 0

tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_mlm[msk, 'rnk'] <- rank(-tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_mlm[msk, 'score'])
tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_mlm[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_mlm[!msk, 'score']))

tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_mlm <- tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_mlm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_mlm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")


```

##### CIS vs Control (and Control vs CIS)
```{r}

# Run decoupleR for CIS_24h vs Control_24h (with activators of Ccl4)
Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_mlm <- run_mlm(mat=get_t_values_Ccl4_CIS_Control_24h, net=collectri_df_activators_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Ccl4
tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_mlm <- Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_mlm %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_mlm$score > 0 
tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_mlm[msk, 'rnk'] <- rank(-tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_mlm[msk, 'score'])
tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_mlm[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_mlm[!msk, 'score']))

tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_mlm <- tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_mlm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_mlm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")



# Run decoupleR for Control_24h vs CIS_24h (with inhibitors of Ccl4)
Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_mlm <- run_mlm(mat=get_t_values_Ccl4_Control_CIS_24h, net=collectri_df_inhibitors_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Ccl4
tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_mlm <- Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_mlm %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_mlm$score > 0

tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_mlm[msk, 'rnk'] <- rank(-tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_mlm[msk, 'score'])
tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_mlm[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_mlm[!msk, 'score']))

tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_mlm <- tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_mlm %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_mlm, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```




#### Get TFs of Ccl4 with greater activity in CIS than in MTX, OXA and Control (without filter on p-value)
```{r}
tf_Ccl4_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Ccl4_mlm_not_filtered <- tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_mlm %>% filter(score > 0) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Ccl4_mlm_not_filtered <- tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_mlm %>% filter(score > 0) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Ccl4_mlm_not_filtered <- tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_mlm %>% filter(score > 0) %>% arrange(rnk)





tf_Ccl4_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Ccl4_mlm_not_filtered <- tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_mlm %>% filter(score > 0) %>% arrange(rnk)


tf_Ccl4_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Ccl4_mlm_not_filtered <- tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_mlm %>% filter(score > 0) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_Control_24h_than_in_CIS_24h_inhibitors_Ccl4_mlm_not_filtered <- tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_mlm %>% filter(score > 0) %>% arrange(rnk)


```

#### Get TFs of Ccl4 with greater activity in CIS than in MTX and in OXA (with filter on p-value)
```{r}
tf_Ccl4_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Ccl4_mlm_filtered <- tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_mlm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Ccl4_mlm_filtered <- tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_mlm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Ccl4_mlm_filtered <- tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_mlm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)





tf_Ccl4_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Ccl4_mlm_filtered <- tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_mlm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Ccl4_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Ccl4_mlm_filtered <- tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_mlm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_Control_24h_than_in_Cis_24h_inhibitors_Ccl4_mlm_filtered <- tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_mlm %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)

```





#### Wsum method




##### CIS vs MTX (and MTX vs CIS)
```{r}
# Get t-values for CIS_24h vs MTX_24h
get_t_values_Ccl4_CIS_MTX_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_MTX/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Ccl4_CIS_MTX_24h) <- make.names(get_t_values_Ccl4_CIS_MTX_24h$gene_name, unique=TRUE)
get_t_values_Ccl4_CIS_MTX_24h <- get_t_values_Ccl4_CIS_MTX_24h %>% dplyr::select(-"gene_name")




# Run decoupleR for CIS_24h vs MTX_24h (with activators of Ccl4)
Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_wsum <- run_wsum(mat=get_t_values_Ccl4_CIS_MTX_24h, net=collectri_df_activators_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Ccl4
tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_wsum <- Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_wsum %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_wsum$score > 0

tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_wsum[msk, 'rnk'] <- rank(-tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_wsum[msk, 'score'])
tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_wsum[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_wsum[!msk, 'score']))

tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_wsum <- tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_wsum %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_wsum, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")



# Plot (enhancers of Ccl4 of interest)
ggplot(tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_wsum %>% filter(source %in% c("Nkx2-1", "Otx2", "Hsf2","Gata1","Bcl3" ,"Pou2f1", "Pou3f1", "E2f3", "Rorc", "Hoxd13", "Nkx6-1", "Creb1", "Jund", "Stat2")), aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")


# Run decoupleR for MTX_24h vs CIS_24h (with inhibitors of Ccl4)
Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_wsum <- run_wsum(mat=get_t_values_Ccl4_MTX_CIS_24h, net=collectri_df_inhibitors_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Ccl4
tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_wsum <- Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_wsum %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_wsum$score > 0

tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_wsum[msk, 'rnk'] <- rank(-tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_wsum[msk, 'score'])
tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_wsum[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_wsum[!msk, 'score']))

tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_wsum <- tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_wsum %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_wsum, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```



##### CIS vs OXA (OXA vs CIS)
```{r}
# Get t-values for CIS_24h vs OXA_24h
get_t_values_Ccl4_CIS_OXA_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_OXA/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Ccl4_CIS_OXA_24h) <- make.names(get_t_values_Ccl4_CIS_OXA_24h$gene_name, unique=TRUE)
get_t_values_Ccl4_CIS_OXA_24h <- get_t_values_Ccl4_CIS_OXA_24h %>% dplyr::select(-"gene_name")




# Run decoupleR for CIS_24h vs OXA_24h (with activators of Ccl4)
Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_wsum <- run_wsum(mat=get_t_values_Ccl4_CIS_OXA_24h, net=collectri_df_activators_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Ccl4
tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_wsum <- Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_wsum %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_wsum$score > 0

tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_wsum[msk, 'rnk'] <- rank(-tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_wsum[msk, 'score'])
tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_wsum[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_wsum[!msk, 'score']))

tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_wsum <- tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_wsum %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_wsum, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")



# Run decoupleR for OXA_24h vs CIS_24h (with inhibitors of Ccl4)
Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_wsum <- run_wsum(mat=get_t_values_Ccl4_OXA_CIS_24h, net=collectri_df_inhibitors_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Ccl4
tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_wsum <- Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_wsum %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_wsum$score > 0 

tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_wsum[msk, 'rnk'] <- rank(-tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_wsum[msk, 'score'])
tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_wsum[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_wsum[!msk, 'score']))

tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_wsum <- tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_wsum %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_wsum, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```

##### CIS vs Control (and Control vs CIS)
```{r}
# Get t-values for CIS_24h vs Control_24h
get_t_values_Ccl4_CIS_Control_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Ccl4_CIS_Control_24h) <- make.names(get_t_values_Ccl4_CIS_Control_24h$gene_name, unique=TRUE)
get_t_values_Ccl4_CIS_Control_24h <- get_t_values_Ccl4_CIS_Control_24h %>% dplyr::select(-"gene_name")




# Run decoupleR for CIS_24h vs Control_24h (with activators of Ccl4)
Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_wsum <- run_wsum(mat=get_t_values_Ccl4_CIS_Control_24h, net=collectri_df_activators_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of activators of Ccl4
tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_wsum <- Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_wsum %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_wsum$score > 0

tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_wsum[msk, 'rnk'] <- rank(-tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_wsum[msk, 'score'])
tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_wsum[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_wsum[!msk, 'score']))

tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_wsum <- tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_wsum %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_wsum, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")



# Run decoupleR for Control_24h vs CIS_24h (with inhibitors of Ccl4)
Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_wsum <- run_wsum(mat=get_t_values_Ccl4_Control_CIS_24h, net=collectri_df_inhibitors_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity of inhibitors of Ccl4
tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_wsum <- Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_wsum %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_wsum$score > 0 

tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_wsum[msk, 'rnk'] <- rank(-tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_wsum[msk, 'score'])
tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_wsum[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_wsum[!msk, 'score']))

tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_wsum <- tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_wsum %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_wsum, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")


```




#### Get TFs of Ccl4 with greater activity in CIS than in MTX, OXA and Control (without filter on p-value)
```{r}
# greater activity in CIS than in MTX and OXA
tf_Ccl4_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Ccl4_wsum_not_filtered <- tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_wsum %>% filter(score > 0) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Ccl4_wsum_not_filtered <- tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_wsum %>% filter(score > 0) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Ccl4_wsum_not_filtered <- tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_wsum %>% filter(score > 0) %>% arrange(rnk)




tf_Ccl4_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Ccl4_wsum_not_filtered <- tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_wsum %>% filter(score > 0) %>% arrange(rnk)


tf_Ccl4_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Ccl4_wsum_not_filtered <- tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_wsum %>% filter(score > 0) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_Control_24h_than_in_CIS_24h_inhibitors_Ccl4_wsum_not_filtered <- tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_wsum %>% filter(score > 0) %>% arrange(rnk)



```

#### Get TFs of Ccl4 with greater activity in CIS than in MTX and in OXA (with filter on p-value)
```{r}
tf_Ccl4_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Ccl4_wsum_filtered <- tf_Ccl4_activity_CIS_24h_vs_MTX_24h_activators_Ccl4_wsum %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Ccl4_wsum_filtered <- tf_Ccl4_activity_CIS_24h_vs_OXA_24h_activators_Ccl4_wsum %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Ccl4_wsum_filtered <- tf_Ccl4_activity_CIS_24h_vs_Control_24h_activators_Ccl4_wsum %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)





tf_Ccl4_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Ccl4_wsum_filtered <- tf_Ccl4_activity_MTX_24h_vs_CIS_24h_inhibitors_Ccl4_wsum %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Ccl4_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Ccl4_wsum_filtered <- tf_Ccl4_activity_OXA_24h_vs_CIS_24h_inhibitors_Ccl4_wsum %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_Control_24h_than_in_CIS_24h_inhibitors_Ccl4_wsum_filtered <- tf_Ccl4_activity_Control_24h_vs_CIS_24h_inhibitors_Ccl4_wsum %>% filter(score > 0 & p_value <= 0.05) %>% arrange(rnk)


```


```{r}
# CIS vs MTX
get_intersection_activators_Ccl4_CIS_MTX <- intersect(tf_Ccl4_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Ccl4_ulm_not_filtered$source, tf_Ccl4_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Ccl4_mlm_not_filtered$source)

get_all_intersection_activators_Ccl4_CIS_MTX <- intersect(get_intersection_activators_Ccl4_CIS_MTX, tf_Ccl4_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Ccl4_wsum_not_filtered$source)


# CIS vs MTX (filtered)
get_intersection_activators_Ccl4_CIS_MTX_filtered <- intersect(tf_Ccl4_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Ccl4_ulm_filtered$source, tf_Ccl4_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Ccl4_mlm_filtered$source)

get_all_intersection_activators_Ccl4_CIS_MTX_filtered <- intersect(get_intersection_activators_Ccl4_CIS_MTX_filtered, tf_Ccl4_higher_activity_in_CIS_24h_than_in_MTX_24h_activators_Ccl4_wsum_filtered$source)



# CIS vs OXA
get_intersection_activators_Ccl4_CIS_OXA <- intersect(tf_Ccl4_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Ccl4_ulm_not_filtered$source, tf_Ccl4_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Ccl4_mlm_not_filtered$source)

get_all_intersection_activators_Ccl4_CIS_OXA <- intersect(get_intersection_activators_Ccl4_CIS_OXA, tf_Ccl4_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Ccl4_wsum_not_filtered$source)


# CIS vs OXA (filtered)
get_intersection_activators_Ccl4_CIS_OXA_filtered <- intersect(tf_Ccl4_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Ccl4_ulm_filtered$source, tf_Ccl4_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Ccl4_mlm_filtered$source)

get_all_intersection_activators_Ccl4_CIS_OXA_filtered <- intersect(get_intersection_activators_Ccl4_CIS_OXA_filtered, tf_Ccl4_higher_activity_in_CIS_24h_than_in_OXA_24h_activators_Ccl4_wsum_filtered$source)



# CIS vs Control
get_intersection_activators_Ccl4_CIS_Control <- intersect(tf_Ccl4_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Ccl4_ulm_not_filtered$source, tf_Ccl4_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Ccl4_mlm_not_filtered$source)

get_all_intersection_activators_Ccl4_CIS_Control <- intersect(get_intersection_activators_Ccl4_CIS_Control, tf_Ccl4_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Ccl4_wsum_not_filtered$source)


# CIS vs Control (filtered)
get_intersection_activators_Ccl4_CIS_Control_filtered <- intersect(tf_Ccl4_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Ccl4_ulm_filtered$source, tf_Ccl4_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Ccl4_mlm_filtered$source)

get_all_intersection_activators_Ccl4_CIS_Control_filtered <- intersect(get_intersection_activators_Ccl4_CIS_Control_filtered, tf_Ccl4_higher_activity_in_CIS_24h_than_in_Control_24h_activators_Ccl4_wsum_filtered$source)


# All intersection (activators of Ccl4)

intersect_CIS_MTX_OXA <- intersect(get_all_intersection_activators_Ccl4_CIS_MTX, get_all_intersection_activators_Ccl4_CIS_OXA)
intersect_CIS_MTX_OXA_Control <- intersect(intersect_CIS_MTX_OXA, get_all_intersection_activators_Ccl4_CIS_Control)


# All intersection (activators of Ccl4) - filtered

intersect_CIS_MTX_OXA_filtered <- intersect(get_all_intersection_activators_Ccl4_CIS_MTX_filtered, get_all_intersection_activators_Ccl4_CIS_OXA_filtered)
intersect_CIS_MTX_OXA_Control_filtered <- intersect(intersect_CIS_MTX_OXA_filtered, get_all_intersection_activators_Ccl4_CIS_Control_filtered)









# MTX vs CIS
get_intersection_inhibitors_Ccl4_MTX_CIS <- intersect(tf_Ccl4_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Ccl4_ulm_not_filtered$source, tf_Ccl4_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Ccl4_mlm_not_filtered$source)

get_all_intersection_inhibitors_Ccl4_MTX_CIS <- intersect(get_intersection_inhibitors_Ccl4_MTX_CIS, tf_Ccl4_higher_activity_MTX_24h_than_in_CIS_24h_inhibitors_Ccl4_wsum_not_filtered$source)



# OXA vs CIS
get_intersection_inhibitors_Ccl4_OXA_CIS <- intersect(tf_Ccl4_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Ccl4_ulm_not_filtered$source, tf_Ccl4_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Ccl4_mlm_not_filtered$source)

get_all_intersection_inhibitors_Ccl4_OXA_CIS <- intersect(get_intersection_inhibitors_Ccl4_OXA_CIS, tf_Ccl4_higher_activity_OXA_24h_than_in_CIS_24h_inhibitors_Ccl4_wsum_not_filtered$source)



# Control vs CIS
get_intersection_inhibitors_Ccl4_Control_CIS <- intersect(tf_Ccl4_higher_activity_in_Control_24h_than_in_CIS_24h_inhibitors_Ccl4_ulm_not_filtered$source, tf_Ccl4_higher_activity_in_Control_24h_than_in_CIS_24h_inhibitors_Ccl4_mlm_not_filtered$source)

get_all_intersection_inhibitors_Ccl4_Control_CIS <- intersect(get_intersection_inhibitors_Ccl4_Control_CIS, tf_Ccl4_higher_activity_in_Control_24h_than_in_CIS_24h_inhibitors_Ccl4_wsum_not_filtered$source)


# All intersection (inhibitors of Ccl4)
intersect_MTX_OXA_CIS <- intersect(get_all_intersection_inhibitors_Ccl4_MTX_CIS, get_all_intersection_inhibitors_Ccl4_OXA_CIS)
intersect_MTX_OXA_Control_CIS <- intersect(intersect_MTX_OXA_CIS, get_all_intersection_inhibitors_Ccl4_Control_CIS)
```







```{r}
Ccl5_Il6 <- bind_cols(run_decoupleR_all_samples_mat_scaled_tf_interest_Ccl5, run_decoupleR_all_samples_mat_scaled_tf_interesting_activity_Il6)


tf_Ccl5_Il6 <- data.frame(gene_name = rep(c("Ccl5","Il6"), c(2,6)))
rownames(tf_Ccl5_Il6) <- colnames(Ccl5_Il6)


annot_colors <- list(gene_name=c(Ccl5="green",Il6="#63D7DE"))

png(filename = "/data/users/tlassale/MODICED_link/Heatmap_TFs_Ccl5_Il6.png", wid)
pheatmap_Ccl5_Il6 <- pheatmap(t(Ccl5_Il6) , border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, show_colnames = F, annotation_col = new_df, annotation_row = tf_Il6_Ccl5, fontsize_row = 13, annotation_colors = annot_colors, main = "TFs (activators) of Ccl5 and Il6 with interesting activity")
dev.off()

```



### Il5


```{r}
# Get tfs which target Il5
collectri_df_Il5 <- collectri_df %>% dplyr::group_by(source) %>% dplyr::summarise(target_Il5 = any(target == "Il5")) %>% as.data.frame() %>% filter(target_Il5 == "TRUE")
collectri_df_for_Il5 <- collectri_df %>% dplyr::filter(source %in% collectri_df_Il5$source)

```


#### CIS vs MTX
```{r}
# Get t-values for CIS_24h vs MTX_24h
get_t_values_Il5_CIS_MTX_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_MTX/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Il5_CIS_MTX_24h) <- make.names(get_t_values_Il5_CIS_MTX_24h$gene_name, unique=TRUE)
get_t_values_Il5_CIS_MTX_24h <- get_t_values_Il5_CIS_MTX_24h %>% dplyr::select(-"gene_name")


# Run decoupleR for CIS_24h vs MTX_24h
Il5_activity_CIS_24h_vs_MTX_24h <- run_ulm(mat=get_t_values_Il5_CIS_MTX_24h, net=collectri_df_for_Il5, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity 
tf_Il5_activity_CIS_24h_vs_MTX_24h <- Il5_activity_CIS_24h_vs_MTX_24h %>% dplyr::mutate(rnk = NA)
msk <- tf_Il5_activity_CIS_24h_vs_MTX_24h$score > 0 & p-value <= 0.05

tf_Il5_activity_CIS_24h_vs_MTX_24h[msk, 'rnk'] <- rank(-tf_Il5_activity_CIS_24h_vs_MTX_24h[msk, 'score'])
tf_Il5_activity_CIS_24h_vs_MTX_24h[!msk, 'rnk'] <- rank(-abs(tf_Il5_activity_CIS_24h_vs_MTX_24h[!msk, 'score']))

tf_Il5_activity_CIS_24h_vs_MTX_24h <- tf_Il5_activity_CIS_24h_vs_MTX_24h %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il5_activity_CIS_24h_vs_MTX_24h, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```



#### CIS vs OXA
```{r}
# Get t-values for CIS_24h vs OXA_24h
get_t_values_Il5_CIS_OXA_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_OXA/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Il5_CIS_OXA_24h) <- make.names(get_t_values_Il5_CIS_OXA_24h$gene_name, unique=TRUE)
get_t_values_Il5_CIS_OXA_24h <- get_t_values_Il5_CIS_OXA_24h %>% dplyr::select(-"gene_name")


# Run decoupleR for CIS_24h vs OXA_24h
Il5_activity_CIS_24h_vs_OXA_24h <- run_ulm(mat=get_t_values_Il5_CIS_OXA_24h, net=collectri_df_for_Il5, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity 
tf_Il5_activity_CIS_24h_vs_OXA_24h <- Il5_activity_CIS_24h_vs_OXA_24h %>% dplyr::mutate(rnk = NA)
msk <- tf_Il5_activity_CIS_24h_vs_OXA_24h$score > 0 & p-value <= 0.05

tf_Il5_activity_CIS_24h_vs_OXA_24h[msk, 'rnk'] <- rank(-tf_Il5_activity_CIS_24h_vs_OXA_24h[msk, 'score'])
tf_Il5_activity_CIS_24h_vs_OXA_24h[!msk, 'rnk'] <- rank(-abs(tf_Il5_activity_CIS_24h_vs_OXA_24h[!msk, 'score']))

tf_Il5_activity_CIS_24h_vs_OXA_24h <- tf_Il5_activity_CIS_24h_vs_OXA_24h %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il5_activity_CIS_24h_vs_OXA_24h, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```


#### CIS vs Control
```{r}
# Get t-values for CIS_24h vs Control_24h
get_t_values_Il5_CIS_Control_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Il5_CIS_Control_24h) <- make.names(get_t_values_Il5_CIS_Control_24h$gene_name, unique=TRUE)
get_t_values_Il5_CIS_Control_24h <- get_t_values_Il5_CIS_Control_24h %>% dplyr::select(-"gene_name")


# Run decoupleR for CIS_24h vs Control_24h
Il5_activity_CIS_24h_vs_Control_24h <- run_ulm(mat=get_t_values_Il5_CIS_Control_24h, net=collectri_df_for_Il5, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity 
tf_Il5_activity_CIS_24h_vs_Control_24h <- Il5_activity_CIS_24h_vs_Control_24h %>% dplyr::mutate(rnk = NA)
msk <- tf_Il5_activity_CIS_24h_vs_Control_24h$score > 0 & p-value <= 0.05

tf_Il5_activity_CIS_24h_vs_Control_24h[msk, 'rnk'] <- rank(-tf_Il5_activity_CIS_24h_vs_Control_24h[msk, 'score'])
tf_Il5_activity_CIS_24h_vs_Control_24h[!msk, 'rnk'] <- rank(-abs(tf_Il5_activity_CIS_24h_vs_Control_24h[!msk, 'score']))

tf_Il5_activity_CIS_24h_vs_Control_24h <- tf_Il5_activity_CIS_24h_vs_Control_24h %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Il5_activity_CIS_24h_vs_Control_24h, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```



### Get TFs of Il5 with greater activity in CIS than in MTX and in OXA (without filter on p-value)
```{r}
# greater activity in CIS than in MTX and OXA
tf_Il5_higher_activity_in_CIS_24h_than_in_MTX_24h_not_filtered <- tf_Il5_activity_CIS_24h_vs_MTX_24h %>% filter(score > 0 & p-value <= 0.05) %>% arrange(rnk)


tf_Il5_higher_activity_in_CIS_24h_than_in_OXA_24h_not_filtered <- tf_Il5_activity_CIS_24h_vs_OXA_24h %>% filter(score > 0 & p-value <= 0.05) %>% arrange(rnk)

# Intersection
intersect_MTX_OXA_vs_CIS_Il5_not_filtered <- intersect(tf_Il5_higher_activity_in_CIS_24h_than_in_MTX_24h_not_filtered$source, tf_Il5_higher_activity_in_CIS_24h_than_in_OXA_24h_not_filtered$source)


```

### Get TFs of Il5 with greater activity in CIS than in MTX and in OXA (with filter on p-value)
```{r}
# greater activity in CIS than in MTX and OXA
tf_Il5_higher_activity_in_CIS_24h_than_in_MTX_24h_filtered <- tf_Il5_activity_CIS_24h_vs_MTX_24h %>% filter(score > 0 & p-value <= 0.05 & p_value <= 0.05) %>% arrange(rnk)


tf_Il5_higher_activity_in_CIS_24h_than_in_OXA_24h_filtered <- tf_Il5_activity_CIS_24h_vs_OXA_24h %>% filter(score > 0 & p-value <= 0.05 & p_value <= 0.05) %>% arrange(rnk)

# Intersection
intersect_MTX_OXA_vs_CIS_Il5_filtered <- intersect(tf_Il5_higher_activity_in_CIS_24h_than_in_MTX_24h_filtered$source, tf_Il5_higher_activity_in_CIS_24h_than_in_OXA_24h_filtered$source)

collectri_df_for_Il5 %>% filter(source %in% intersect_MTX_OXA_vs_CIS_Il5 & target == "Il5")

```



### Get TFs of Il5 with greater activity in CIS than in Control (without filter on p-value)

```{r}
# greater activity in CIS than in Control
tf_Il5_higher_activity_in_CIS_24h_than_in_Control_24h_not_filtered <- tf_Il5_activity_CIS_24h_vs_Control_24h %>% filter(score > 0 & p-value <= 0.05) %>% arrange(rnk)

```



### Get TFs of Il5 with greater activity in CIS than in Control (with filter on p-value)

```{r}
# greater activity in CIS than in Control
tf_Il5_higher_activity_in_CIS_24h_than_in_Control_24h_filtered <- tf_Il5_activity_CIS_24h_vs_Control_24h %>% filter(score > 0 & p-value <= 0.05 & p_value <= 0.05) %>% arrange(rnk)
```



### Get the TFs of Il5 with greater activity in CIS than in MTX, OXA, and Control (not filtered on p-value)
```{r}

intersect_CIS_MTX_OXA_Control_Il5_not_filtered <- intersect(intersect_MTX_OXA_vs_CIS_Il5_not_filtered, tf_Il5_higher_activity_in_CIS_24h_than_in_Control_24h_not_filtered$source)


```


### Get the TFs of Il5 with greater activity in CIS than in MTX, OXA, and Control (filtered on p-value)
```{r}

intersect_CIS_MTX_OXA_Control_Il5_filtered <- intersect(intersect_MTX_OXA_vs_CIS_Il5_filtered, tf_Il5_higher_activity_in_CIS_24h_than_in_Control_24h_filtered$source)

```


### All samples
```{r}
voom_for_decoupleR <- voom$E %>% bind_cols(voom$genes) %>% as.data.frame()
rownames(voom_for_decoupleR) <- make.names(voom_for_decoupleR$genes, unique=TRUE)
voom_for_decoupleR_final <- voom_for_decoupleR %>% select(-"genes") %>% select(contains("24h"))
run_decoupleR_all_samples <- run_ulm(mat = voom_for_decoupleR_final, net = collectri_df_for_Ccl4, .source = "source", .target = "target", .mor="mor", minsize = 5) 


run_decoupleR_all_samples_mat <- run_decoupleR_all_samples %>%
  pivot_wider(id_cols = 'condition', names_from = 'source',
              values_from = 'score') %>%
  column_to_rownames('condition') %>%
  as.matrix()

run_decoupleR_all_samples_mat_scaled <- scale(run_decoupleR_all_samples_mat)

palette_length = 100
my_color = colorRampPalette(c("Darkblue", "white","red"))(palette_length)

my_breaks <- c(seq(-3, 0, length.out=ceiling(palette_length/2) + 1),
               seq(0.05, 3, length.out=floor(palette_length/2)))

# Plot
library(pheatmap)
pheatmap(t(run_decoupleR_all_samples_mat_scaled), border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE) 

run_decoupleR_all_samples_mat_scaled_tf_interest <- run_decoupleR_all_samples_mat_scaled %>% as.data.frame() %>% dplyr::select(all_of(intersect_CIS_MTX_OXA_Control_Il5_not_filtered))
  
pheatmap(t(run_decoupleR_all_samples_mat_scaled_tf_interest) , border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE) 


run_decoupleR_all_samples_mat_scaled_tf_interesting_activity_Il5 <- run_decoupleR_all_samples_mat_scaled_tf_interest %>% select(c("Jund","Pou2f1","Hdac4"))


new_df <- data.frame(sample = rep(c("MTX","OXA","CIS","Control"), c(3,3,3,3)))
rownames(new_df) <- colnames(t(run_decoupleR_all_samples_mat_scaled_tf_interesting_activity_Il5))


pheatmap_Il5 <- pheatmap(t(run_decoupleR_all_samples_mat_scaled_tf_interesting_activity_Il5) , border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, show_colnames = F, annotation_col = new_df, main = "TFs (activators) of Il5 with interesting activity") 



```





### Ccl4


```{r}
# Get tfs which target Ccl4
collectri_df_Ccl4 <- collectri_df %>% dplyr::group_by(source) %>% dplyr::summarise(target_Ccl4 = any(target == "Ccl4")) %>% as.data.frame() %>% filter(target_Ccl4 == "TRUE")
collectri_df_for_Ccl4 <- collectri_df %>% dplyr::filter(source %in% collectri_df_Ccl4$source)

```


#### CIS vs MTX
```{r}
# Get t-values for CIS_24h vs MTX_24h
get_t_values_Ccl4_CIS_MTX_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_MTX/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Ccl4_CIS_MTX_24h) <- make.names(get_t_values_Ccl4_CIS_MTX_24h$gene_name, unique=TRUE)
get_t_values_Ccl4_CIS_MTX_24h <- get_t_values_Ccl4_CIS_MTX_24h %>% dplyr::select(-"gene_name")


# Run decoupleR for CIS_24h vs MTX_24h
Ccl4_activity_CIS_24h_vs_MTX_24h <- run_ulm(mat=get_t_values_Ccl4_CIS_MTX_24h, net=collectri_df_for_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity 
tf_Ccl4_activity_CIS_24h_vs_MTX_24h <- Ccl4_activity_CIS_24h_vs_MTX_24h %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_CIS_24h_vs_MTX_24h$score > 0 & p-value <= 0.05

tf_Ccl4_activity_CIS_24h_vs_MTX_24h[msk, 'rnk'] <- rank(-tf_Ccl4_activity_CIS_24h_vs_MTX_24h[msk, 'score'])
tf_Ccl4_activity_CIS_24h_vs_MTX_24h[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_CIS_24h_vs_MTX_24h[!msk, 'score']))

tf_Ccl4_activity_CIS_24h_vs_MTX_24h <- tf_Ccl4_activity_CIS_24h_vs_MTX_24h %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_CIS_24h_vs_MTX_24h, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```



#### CIS vs OXA
```{r}
# Get t-values for CIS_24h vs OXA_24h
get_t_values_Ccl4_CIS_OXA_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_OXA/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Ccl4_CIS_OXA_24h) <- make.names(get_t_values_Ccl4_CIS_OXA_24h$gene_name, unique=TRUE)
get_t_values_Ccl4_CIS_OXA_24h <- get_t_values_Ccl4_CIS_OXA_24h %>% dplyr::select(-"gene_name")


# Run decoupleR for CIS_24h vs OXA_24h
Ccl4_activity_CIS_24h_vs_OXA_24h <- run_ulm(mat=get_t_values_Ccl4_CIS_OXA_24h, net=collectri_df_for_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity 
tf_Ccl4_activity_CIS_24h_vs_OXA_24h <- Ccl4_activity_CIS_24h_vs_OXA_24h %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_CIS_24h_vs_OXA_24h$score > 0 & p-value <= 0.05

tf_Ccl4_activity_CIS_24h_vs_OXA_24h[msk, 'rnk'] <- rank(-tf_Ccl4_activity_CIS_24h_vs_OXA_24h[msk, 'score'])
tf_Ccl4_activity_CIS_24h_vs_OXA_24h[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_CIS_24h_vs_OXA_24h[!msk, 'score']))

tf_Ccl4_activity_CIS_24h_vs_OXA_24h <- tf_Ccl4_activity_CIS_24h_vs_OXA_24h %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_CIS_24h_vs_OXA_24h, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```


#### CIS vs Control
```{r}
# Get t-values for CIS_24h vs Control_24h
get_t_values_Ccl4_CIS_Control_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/24h/diff_genes.csv") %>% select(c("t","gene_name"))
rownames(get_t_values_Ccl4_CIS_Control_24h) <- make.names(get_t_values_Ccl4_CIS_Control_24h$gene_name, unique=TRUE)
get_t_values_Ccl4_CIS_Control_24h <- get_t_values_Ccl4_CIS_Control_24h %>% dplyr::select(-"gene_name")


# Run decoupleR for CIS_24h vs Control_24h
Ccl4_activity_CIS_24h_vs_Control_24h <- run_ulm(mat=get_t_values_Ccl4_CIS_Control_24h, net=collectri_df_for_Ccl4, .source='source', .target='target', .mor='mor', minsize = 5)


# Get barplot showing tf activity 
tf_Ccl4_activity_CIS_24h_vs_Control_24h <- Ccl4_activity_CIS_24h_vs_Control_24h %>% dplyr::mutate(rnk = NA)
msk <- tf_Ccl4_activity_CIS_24h_vs_Control_24h$score > 0 & p-value <= 0.05

tf_Ccl4_activity_CIS_24h_vs_Control_24h[msk, 'rnk'] <- rank(-tf_Ccl4_activity_CIS_24h_vs_Control_24h[msk, 'score'])
tf_Ccl4_activity_CIS_24h_vs_Control_24h[!msk, 'rnk'] <- rank(-abs(tf_Ccl4_activity_CIS_24h_vs_Control_24h[!msk, 'score']))

tf_Ccl4_activity_CIS_24h_vs_Control_24h <- tf_Ccl4_activity_CIS_24h_vs_Control_24h %>% dplyr::arrange(rnk)


# Plot
ggplot(tf_Ccl4_activity_CIS_24h_vs_Control_24h, aes(x = reorder(source, score), y = score)) + 
    geom_bar(aes(fill = score), stat = "identity") +
    scale_fill_gradient2(low = "darkblue", high = "indianred", 
        mid = "whitesmoke", midpoint = 0) + 
    theme_minimal() +
    theme(axis.title = element_text(face = "bold", size = 12),
        axis.text.x = 
            element_text(angle = 45, hjust = 1, size =10, face= "bold"),
        axis.text.y = element_text(size =10, face= "bold"),
        panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) +
    xlab("TFs")

```



### Get TFs of Ccl4 with greater activity in CIS than in MTX and in OXA (without filter on p-value)
```{r}
# greater activity in CIS than in MTX and OXA
tf_Ccl4_higher_activity_in_CIS_24h_than_in_MTX_24h_not_filtered <- tf_Ccl4_activity_CIS_24h_vs_MTX_24h %>% filter(score > 0 & p-value <= 0.05) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_CIS_24h_than_in_OXA_24h_not_filtered <- tf_Ccl4_activity_CIS_24h_vs_OXA_24h %>% filter(score > 0 & p-value <= 0.05) %>% arrange(rnk)

# Intersection
intersect_MTX_OXA_vs_CIS_Ccl4_not_filtered <- intersect(tf_Ccl4_higher_activity_in_CIS_24h_than_in_MTX_24h_not_filtered$source, tf_Ccl4_higher_activity_in_CIS_24h_than_in_OXA_24h_not_filtered$source)


```

### Get TFs of Ccl4 with greater activity in CIS than in MTX and in OXA (with filter on p-value)
```{r}
# greater activity in CIS than in MTX and OXA
tf_Ccl4_higher_activity_in_CIS_24h_than_in_MTX_24h_filtered <- tf_Ccl4_activity_CIS_24h_vs_MTX_24h %>% filter(score > 0 & p-value <= 0.05 & p_value <= 0.05) %>% arrange(rnk)


tf_Ccl4_higher_activity_in_CIS_24h_than_in_OXA_24h_filtered <- tf_Ccl4_activity_CIS_24h_vs_OXA_24h %>% filter(score > 0 & p-value <= 0.05 & p_value <= 0.05) %>% arrange(rnk)

# Intersection
intersect_MTX_OXA_vs_CIS_Ccl4_filtered <- intersect(tf_Ccl4_higher_activity_in_CIS_24h_than_in_MTX_24h_filtered$source, tf_Ccl4_higher_activity_in_CIS_24h_than_in_OXA_24h_filtered$source)

collectri_df_for_Ccl4 %>% filter(source %in% intersect_MTX_OXA_vs_CIS_Ccl4 & target == "Ccl4")

```



### Get TFs of Ccl4 with greater activity in CIS than in Control (without filter on p-value)

```{r}
# greater activity in CIS than in Control
tf_Ccl4_higher_activity_in_CIS_24h_than_in_Control_24h_not_filtered <- tf_Ccl4_activity_CIS_24h_vs_Control_24h %>% filter(score > 0 & p-value <= 0.05) %>% arrange(rnk)

```



### Get TFs of Ccl4 with greater activity in CIS than in Control (with filter on p-value)

```{r}
# greater activity in CIS than in Control
tf_Ccl4_higher_activity_in_CIS_24h_than_in_Control_24h_filtered <- tf_Ccl4_activity_CIS_24h_vs_Control_24h %>% filter(score > 0 & p-value <= 0.05 & p_value <= 0.05) %>% arrange(rnk)
```



### Get the TFs of Ccl4 with greater activity in CIS than in MTX, OXA, and Control (not filtered on p-value)
```{r}

intersect_CIS_MTX_OXA_Control_Ccl4_not_filtered <- intersect(intersect_MTX_OXA_vs_CIS_Ccl4_not_filtered, tf_Ccl4_higher_activity_in_CIS_24h_than_in_Control_24h_not_filtered$source)


```


### Get the TFs of Ccl4 with greater activity in CIS than in MTX, OXA, and Control (filtered on p-value)
```{r}

intersect_CIS_MTX_OXA_Control_Ccl4_filtered <- intersect(intersect_MTX_OXA_vs_CIS_Ccl4_filtered, tf_Ccl4_higher_activity_in_CIS_24h_than_in_Control_24h_filtered$source)

```


### All samples
```{r}
voom_for_decoupleR <- voom$E %>% bind_cols(voom$genes) %>% as.data.frame()
rownames(voom_for_decoupleR) <- make.names(voom_for_decoupleR$genes, unique=TRUE)
voom_for_decoupleR_final <- voom_for_decoupleR %>% select(-"genes") %>% select(contains("24h"))
run_decoupleR_all_samples <- run_ulm(mat = voom_for_decoupleR_final, net = collectri_df_for_Ccl4, .source = "source", .target = "target", .mor="mor", minsize = 5) 


run_decoupleR_all_samples_mat <- run_decoupleR_all_samples %>%
  pivot_wider(id_cols = 'condition', names_from = 'source',
              values_from = 'score') %>%
  column_to_rownames('condition') %>%
  as.matrix()

run_decoupleR_all_samples_mat_scaled <- scale(run_decoupleR_all_samples_mat)

palette_length = 100
my_color = colorRampPalette(c("Darkblue", "white","red"))(palette_length)

my_breaks <- c(seq(-3, 0, length.out=ceiling(palette_length/2) + 1),
               seq(0.05, 3, length.out=floor(palette_length/2)))


new_df <- data.frame(sample = rep(c("MTX","OXA","CIS","Control"), c(3,3,3,3)))
rownames(new_df) <- colnames(t(run_decoupleR_all_samples_mat_scaled))

# Plot
library(pheatmap)
pheatmap(t(run_decoupleR_all_samples_mat_scaled), border_color = NA, color=my_color, breaks = my_breaks, cluster_rows = TRUE, cluster_cols = FALSE, main="TFs of Ccl4", annotation_col = new_df, show_colnames = F) 



```















### Get the genes with expression concordant with TF activity (Il6)


#### Jund
```{r}
get_t_values_Il6_CIS_MTX_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_MTX/24h/diff_genes.csv") %>% select(c("t","gene_name", "logFC", "adj.P.Val"))
rownames(get_t_values_Il6_CIS_MTX_24h) <- make.names(get_t_values_Il6_CIS_MTX_24h$gene_name, unique=TRUE)
get_t_values_Il6_CIS_MTX_24h <- get_t_values_Il6_CIS_MTX_24h %>% dplyr::select(-"gene_name")


get_t_values_Il6_CIS_OXA_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_OXA/24h/diff_genes.csv") %>% select(c("t","gene_name", "logFC", "adj.P.Val"))
rownames(get_t_values_Il6_CIS_OXA_24h) <- make.names(get_t_values_Il6_CIS_OXA_24h$gene_name, unique=TRUE)
get_t_values_Il6_CIS_OXA_24h <- get_t_values_Il6_CIS_OXA_24h %>% dplyr::select(-"gene_name")



get_t_values_Il6_CIS_Control_24h <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Analysis_CIS_vs_Control/24h/diff_genes.csv") %>% select(c("t","gene_name", "logFC", "adj.P.Val"))
rownames(get_t_values_Il6_CIS_Control_24h) <- make.names(get_t_values_Il6_CIS_Control_24h$gene_name, unique=TRUE)
get_t_values_Il6_CIS_Control_24h <- get_t_values_Il6_CIS_Control_24h %>% dplyr::select(-"gene_name")



tf <- "Jund"
df_Jund_Il6 <- collectri_df_for_Il6 %>%
  filter(source == tf) %>%
  arrange(target) %>%
  mutate(ID = target, color = "3") %>% 
  column_to_rownames('target')


inter_Jund_CIS_MTX_24h <- sort(intersect(rownames(get_t_values_Il6_CIS_MTX_24h), rownames(df_Jund_Il6)))
df_Jund_Il6_MTX <- df_Jund_Il6[inter_Jund_CIS_MTX_24h,]
df_Jund_Il6_MTX[, c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Il6_CIS_MTX_24h[inter_Jund_CIS_MTX_24h, ]
df_Jund_Il6_MTX <- df_Jund_Il6_MTX %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Jund_CIS_MTX_24h <- ggplot(df_Jund_Il6_MTX, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)
  
  
  
  
inter_Jund_CIS_OXA_24h <- sort(intersect(rownames(get_t_values_Il6_CIS_OXA_24h), rownames(df_Jund_Il6)))
df_Jund_Il6_OXA <- df_Jund_Il6[inter_Jund_CIS_OXA_24h,]
df_Jund_Il6_OXA[, c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Il6_CIS_OXA_24h[inter_Jund_CIS_OXA_24h, ]
df_Jund_Il6_OXA <- df_Jund_Il6_OXA %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Jund_CIS_OXA_24h <- ggplot(df_Jund_Il6_OXA, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)
  



inter_Jund_CIS_Control_24h <- sort(intersect(rownames(get_t_values_Il6_CIS_Control_24h), rownames(df_Jund_Il6)))
df_Jund_Il6_Control <- df_Jund_Il6[inter_Jund_CIS_Control_24h,]
df_Jund_Il6_Control[, c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Il6_CIS_Control_24h[inter_Jund_CIS_Control_24h, ]
df_Jund_Il6_Control <- df_Jund_Il6_Control %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Jund_CIS_Control_24h <- ggplot(df_Jund_Il6_Control, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)


# logFC > 0
df_Jund_positive_targets_up_CIS_MTX <- df_Jund_Il6_MTX %>% filter(logFC > 0 & mor == 1)
df_Jund_positive_targets_up_CIS_OXA <- df_Jund_Il6_OXA %>% filter(logFC > 0 & mor == 1)
df_Jund_positive_targets_up_CIS_Control <- df_Jund_Il6_Control %>% filter(logFC > 0 & mor == 1)


intersect_positive_targets_up <- intersect(rownames(df_Jund_positive_targets_up_CIS_MTX), rownames(df_Jund_positive_targets_up_CIS_OXA))
intersect(intersect_positive_targets_up, rownames(df_Jund_positive_targets_up_CIS_Control))


# logFC > 1
df_Jund_positive_targets_up_CIS_MTX <- df_Jund_Il6_MTX %>% filter(logFC > 1 & mor == 1)
df_Jund_positive_targets_up_CIS_OXA <- df_Jund_Il6_OXA %>% filter(logFC > 1 & mor == 1)
df_Jund_positive_targets_up_CIS_Control <- df_Jund_Il6_Control %>% filter(logFC > 1 & mor == 1)


intersect_positive_targets_up <- intersect(rownames(df_Jund_positive_targets_up_CIS_MTX), rownames(df_Jund_positive_targets_up_CIS_OXA))
intersect(intersect_positive_targets_up, rownames(df_Jund_positive_targets_up_CIS_Control))






# logFC < 0
df_Jund_negative_targets_down_CIS_MTX <- df_Jund_Il6_MTX %>% filter(logFC < 0 & mor == 1)
df_Jund_negative_targets_down_CIS_OXA <- df_Jund_Il6_OXA %>% filter(logFC < 0 & mor == 1)
df_Jund_negative_targets_down_CIS_Control <- df_Jund_Il6_Control %>% filter(logFC < 0 & mor == 1)


intersect_negative_targets_down <- intersect(rownames(df_Jund_negative_targets_down_CIS_MTX), rownames(df_Jund_negative_targets_down_CIS_OXA))
intersect(intersect_negative_targets_down, rownames(df_Jund_negative_targets_down_CIS_Control))


# logFC < 1
df_Jund_negative_targets_down_CIS_MTX <- df_Jund_Il6_MTX %>% filter(logFC < 1 & mor == 1)
df_Jund_negative_targets_down_CIS_OXA <- df_Jund_Il6_OXA %>% filter(logFC < 1 & mor == 1)
df_Jund_negative_targets_down_CIS_Control <- df_Jund_Il6_Control %>% filter(logFC < 1 & mor == 1)


intersect_negative_targets_down <- intersect(rownames(df_Jund_negative_targets_down_CIS_MTX), rownames(df_Jund_negative_targets_down_CIS_OXA))
intersect(intersect_negative_targets_down, rownames(df_Jund_negative_targets_down_CIS_Control))



```

#### Pou3f1
```{r}
tf <- "Pou3f1"
df_Pou3f1_Il6 <- collectri_df_for_Il6 %>%
  filter(source == tf) %>%
  arrange(target) %>%
  mutate(ID = target, color = "3") %>% 
  column_to_rownames('target')


inter_Pou3f1_CIS_MTX_24h <- sort(intersect(rownames(get_t_values_Il6_CIS_MTX_24h), rownames(df_Pou3f1_Il6)))
df_Pou3f1_Il6_MTX <- df_Pou3f1_Il6[inter_Pou3f1_CIS_MTX_24h,]
df_Pou3f1_Il6_MTX[, c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Il6_CIS_MTX_24h[inter_Pou3f1_CIS_MTX_24h, ]
df_Pou3f1_Il6_MTX <- df_Pou3f1_Il6_MTX %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Pou3f1_CIS_MTX_24h <- ggplot(df_Pou3f1_Il6_MTX, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)
  
  
  
  
inter_Pou3f1_CIS_OXA_24h <- sort(intersect(rownames(get_t_values_Il6_CIS_OXA_24h), rownames(df_Pou3f1_Il6)))
df_Pou3f1_Il6_OXA <- df_Pou3f1_Il6[inter_Pou3f1_CIS_OXA_24h,]
df_Pou3f1_Il6_OXA[, c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Il6_CIS_OXA_24h[inter_Pou3f1_CIS_OXA_24h, ]
df_Pou3f1_Il6_OXA <- df_Pou3f1_Il6_OXA %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Pou3f1_CIS_OXA_24h <- ggplot(df_Pou3f1_Il6_OXA, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)
  



inter_Pou3f1_CIS_Control_24h <- sort(intersect(rownames(get_t_values_Il6_CIS_Control_24h), rownames(df_Pou3f1_Il6)))
df_Pou3f1_Il6_Control <- df_Pou3f1_Il6[inter_Pou3f1_CIS_Control_24h,]
df_Pou3f1_Il6_Control[, c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Il6_CIS_Control_24h[inter_Pou3f1_CIS_Control_24h, ]
df_Pou3f1_Il6_Control <- df_Pou3f1_Il6_Control %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Pou3f1_CIS_Control_24h <- ggplot(df_Pou3f1_Il6_Control, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)


# logFC > 0
df_Pou3f1_positive_targets_up_CIS_MTX <- df_Pou3f1_Il6_MTX %>% filter(logFC > 0 & mor == 1)
df_Pou3f1_positive_targets_up_CIS_OXA <- df_Pou3f1_Il6_OXA %>% filter(logFC > 0 & mor == 1)
df_Pou3f1_positive_targets_up_CIS_Control <- df_Pou3f1_Il6_Control %>% filter(logFC > 0 & mor == 1)


intersect_positive_targets_up <- intersect(rownames(df_Pou3f1_positive_targets_up_CIS_MTX), rownames(df_Pou3f1_positive_targets_up_CIS_OXA))
intersect(intersect_positive_targets_up, rownames(df_Pou3f1_positive_targets_up_CIS_Control))


# logFC > 1
df_Pou3f1_positive_targets_up_CIS_MTX <- df_Pou3f1_Il6_MTX %>% filter(logFC > 1 & mor == 1)
df_Pou3f1_positive_targets_up_CIS_OXA <- df_Pou3f1_Il6_OXA %>% filter(logFC > 1 & mor == 1)
df_Pou3f1_positive_targets_up_CIS_Control <- df_Pou3f1_Il6_Control %>% filter(logFC > 1 & mor == 1)


intersect_positive_targets_up <- intersect(rownames(df_Pou3f1_positive_targets_up_CIS_MTX), rownames(df_Pou3f1_positive_targets_up_CIS_OXA))
intersect(intersect_positive_targets_up, rownames(df_Pou3f1_positive_targets_up_CIS_Control))

```



#### Pou2f1
```{r}
tf <- "Pou2f1"
df_Pou2f1_Il6 <- collectri_df_for_Il6 %>%
  filter(source == tf) %>%
  arrange(target) %>%
  mutate(ID = target, color = "3") %>% 
  column_to_rownames('target')


inter_Pou2f1_CIS_MTX_24h <- sort(intersect(rownames(get_t_values_Il6_CIS_MTX_24h), rownames(df_Pou2f1_Il6)))
df_Pou2f1_Il6_MTX <- df_Pou2f1_Il6[inter_Pou2f1_CIS_MTX_24h,]
df_Pou2f1_Il6_MTX[, c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Il6_CIS_MTX_24h[inter_Pou2f1_CIS_MTX_24h, ]
df_Pou2f1_Il6_MTX <- df_Pou2f1_Il6_MTX %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Pou2f1_CIS_MTX_24h <- ggplot(df_Pou2f1_Il6_MTX, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)
  
  
  
  
inter_Pou2f1_CIS_OXA_24h <- sort(intersect(rownames(get_t_values_Il6_CIS_OXA_24h), rownames(df_Pou2f1_Il6)))
df_Pou2f1_Il6_OXA <- df_Pou2f1_Il6[inter_Pou2f1_CIS_OXA_24h,]
df_Pou2f1_Il6_OXA[, c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Il6_CIS_OXA_24h[inter_Pou2f1_CIS_OXA_24h, ]
df_Pou2f1_Il6_OXA <- df_Pou2f1_Il6_OXA %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Pou2f1_CIS_OXA_24h <- ggplot(df_Pou2f1_Il6_OXA, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)
  



inter_Pou2f1_CIS_Control_24h <- sort(intersect(rownames(get_t_values_Il6_CIS_Control_24h), rownames(df_Pou2f1_Il6)))
df_Pou2f1_Il6_Control <- df_Pou2f1_Il6[inter_Pou2f1_CIS_Control_24h,]
df_Pou2f1_Il6_Control[, c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Il6_CIS_Control_24h[inter_Pou2f1_CIS_Control_24h, ]
df_Pou2f1_Il6_Control <- df_Pou2f1_Il6_Control %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Pou2f1_CIS_Control_24h <- ggplot(df_Pou2f1_Il6_Control, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)


# logFC > 0
df_Pou2f1_positive_targets_up_CIS_MTX <- df_Pou2f1_Il6_MTX %>% filter(logFC > 0 & mor == 1)
df_Pou2f1_positive_targets_up_CIS_OXA <- df_Pou2f1_Il6_OXA %>% filter(logFC > 0 & mor == 1)
df_Pou2f1_positive_targets_up_CIS_Control <- df_Pou2f1_Il6_Control %>% filter(logFC > 0 & mor == 1)


intersect_positive_targets_up <- intersect(rownames(df_Pou2f1_positive_targets_up_CIS_MTX), rownames(df_Pou2f1_positive_targets_up_CIS_OXA))
intersect(intersect_positive_targets_up, rownames(df_Pou2f1_positive_targets_up_CIS_Control))


# logFC > 1
df_Pou2f1_positive_targets_up_CIS_MTX <- df_Pou2f1_Il6_MTX %>% filter(logFC > 1 & mor == 1)
df_Pou2f1_positive_targets_up_CIS_OXA <- df_Pou2f1_Il6_OXA %>% filter(logFC > 1 & mor == 1)
df_Pou2f1_positive_targets_up_CIS_Control <- df_Pou2f1_Il6_Control %>% filter(logFC > 1 & mor == 1)


intersect_positive_targets_up <- intersect(rownames(df_Pou2f1_positive_targets_up_CIS_MTX), rownames(df_Pou2f1_positive_targets_up_CIS_OXA))
intersect(intersect_positive_targets_up, rownames(df_Pou2f1_positive_targets_up_CIS_Control))

```



#### Otx2
```{r}
tf <- "Otx2"
df_Otx2_Il6 <- collectri_df_for_Il6 %>%
  filter(source == tf) %>%
  arrange(target) %>%
  mutate(ID = target, color = "3") %>% 
  column_to_rownames('target')


inter_Otx2_CIS_MTX_24h <- sort(intersect(rownames(get_t_values_Il6_CIS_MTX_24h), rownames(df_Otx2_Il6)))
df_Otx2_Il6_MTX <- df_Otx2_Il6[inter_Otx2_CIS_MTX_24h,]
df_Otx2_Il6_MTX[, c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Il6_CIS_MTX_24h[inter_Otx2_CIS_MTX_24h, ]
df_Otx2_Il6_MTX <- df_Otx2_Il6_MTX %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Otx2_CIS_MTX_24h <- ggplot(df_Otx2_Il6_MTX, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)
  
  
  
  
inter_Otx2_CIS_OXA_24h <- sort(intersect(rownames(get_t_values_Il6_CIS_OXA_24h), rownames(df_Otx2_Il6)))
df_Otx2_Il6_OXA <- df_Otx2_Il6[inter_Otx2_CIS_OXA_24h,]
df_Otx2_Il6_OXA[, c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Il6_CIS_OXA_24h[inter_Otx2_CIS_OXA_24h, ]
df_Otx2_Il6_OXA <- df_Otx2_Il6_OXA %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Otx2_CIS_OXA_24h <- ggplot(df_Otx2_Il6_OXA, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)
  



inter_Otx2_CIS_Control_24h <- sort(intersect(rownames(get_t_values_Il6_CIS_Control_24h), rownames(df_Otx2_Il6)))
df_Otx2_Il6_Control <- df_Otx2_Il6[inter_Otx2_CIS_Control_24h,]
df_Otx2_Il6_Control[, c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Il6_CIS_Control_24h[inter_Otx2_CIS_Control_24h, ]
df_Otx2_Il6_Control <- df_Otx2_Il6_Control %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Otx2_CIS_Control_24h <- ggplot(df_Otx2_Il6_Control, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)


# logFC > 0
df_Otx2_positive_targets_up_CIS_MTX <- df_Otx2_Il6_MTX %>% filter(logFC > 0 & mor == 1)
df_Otx2_positive_targets_up_CIS_OXA <- df_Otx2_Il6_OXA %>% filter(logFC > 0 & mor == 1)
df_Otx2_positive_targets_up_CIS_Control <- df_Otx2_Il6_Control %>% filter(logFC > 0 & mor == 1)


intersect_positive_targets_up <- intersect(rownames(df_Otx2_positive_targets_up_CIS_MTX), rownames(df_Otx2_positive_targets_up_CIS_OXA))
intersect(intersect_positive_targets_up, rownames(df_Otx2_positive_targets_up_CIS_Control))


# logFC > 1
df_Otx2_positive_targets_up_CIS_MTX <- df_Otx2_Il6_MTX %>% filter(logFC > 1 & mor == 1)
df_Otx2_positive_targets_up_CIS_OXA <- df_Otx2_Il6_OXA %>% filter(logFC > 1 & mor == 1)
df_Otx2_positive_targets_up_CIS_Control <- df_Otx2_Il6_Control %>% filter(logFC > 1 & mor == 1)


intersect_positive_targets_up <- intersect(rownames(df_Otx2_positive_targets_up_CIS_MTX), rownames(df_Otx2_positive_targets_up_CIS_OXA))
intersect(intersect_positive_targets_up, rownames(df_Otx2_positive_targets_up_CIS_Control))

```




#### Hsf2
```{r}
tf <- "Hsf2"
df_Hsf2_Il6 <- collectri_df_for_Il6 %>%
  filter(source == tf) %>%
  arrange(target) %>%
  mutate(ID = target, color = "3") %>% 
  column_to_rownames('target')


inter_Hsf2_CIS_MTX_24h <- sort(intersect(rownames(get_t_values_Il6_CIS_MTX_24h), rownames(df_Hsf2_Il6)))
df_Hsf2_Il6_MTX <- df_Hsf2_Il6[inter_Hsf2_CIS_MTX_24h,]
df_Hsf2_Il6_MTX[, c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Il6_CIS_MTX_24h[inter_Hsf2_CIS_MTX_24h, ]
df_Hsf2_Il6_MTX <- df_Hsf2_Il6_MTX %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Hsf2_CIS_MTX_24h <- ggplot(df_Hsf2_Il6_MTX, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)
  
  
  
  
inter_Hsf2_CIS_OXA_24h <- sort(intersect(rownames(get_t_values_Il6_CIS_OXA_24h), rownames(df_Hsf2_Il6)))
df_Hsf2_Il6_OXA <- df_Hsf2_Il6[inter_Hsf2_CIS_OXA_24h,]
df_Hsf2_Il6_OXA[, c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Il6_CIS_OXA_24h[inter_Hsf2_CIS_OXA_24h, ]
df_Hsf2_Il6_OXA <- df_Hsf2_Il6_OXA %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Hsf2_CIS_OXA_24h <- ggplot(df_Hsf2_Il6_OXA, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)
  



inter_Hsf2_CIS_Control_24h <- sort(intersect(rownames(get_t_values_Il6_CIS_Control_24h), rownames(df_Hsf2_Il6)))
df_Hsf2_Il6_Control <- df_Hsf2_Il6[inter_Hsf2_CIS_Control_24h,]
df_Hsf2_Il6_Control[, c('t', 'logFC', 'adj.P.Val')] <- get_t_values_Il6_CIS_Control_24h[inter_Hsf2_CIS_Control_24h, ]
df_Hsf2_Il6_Control <- df_Hsf2_Il6_Control %>%
  mutate(color = if_else(mor > 0 & t > 0, '1', color)) %>%
  mutate(color = if_else(mor > 0 & t < 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t > 0, '2', color)) %>%
  mutate(color = if_else(mor < 0 & t < 0, '1', color))


Hsf2_CIS_Control_24h <- ggplot(df_Hsf2_Il6_Control, aes(x = logFC, y = -log10(adj.P.Val), color = color, size=abs(mor))) +
  geom_point() +
  scale_colour_manual(values = c("red","royalblue3","grey")) +
  geom_label_repel(aes(label = ID, size=1)) + 
  theme_minimal() +
  theme(legend.position = "none") +
  geom_vline(xintercept = c(-1,1), linetype = 'dotted') +
  geom_hline(yintercept = -log10(0.05), linetype = 'dotted') +
  ggtitle(tf)


# logFC > 0
df_Hsf2_positive_targets_up_CIS_MTX <- df_Hsf2_Il6_MTX %>% filter(logFC > 0 & mor == 1)
df_Hsf2_positive_targets_up_CIS_OXA <- df_Hsf2_Il6_OXA %>% filter(logFC > 0 & mor == 1)
df_Hsf2_positive_targets_up_CIS_Control <- df_Hsf2_Il6_Control %>% filter(logFC > 0 & mor == 1)


intersect_positive_targets_up <- intersect(rownames(df_Hsf2_positive_targets_up_CIS_MTX), rownames(df_Hsf2_positive_targets_up_CIS_OXA))
intersect(intersect_positive_targets_up, rownames(df_Hsf2_positive_targets_up_CIS_Control))


# logFC > 1
df_Hsf2_positive_targets_up_CIS_MTX <- df_Hsf2_Il6_MTX %>% filter(logFC > 1 & mor == 1)
df_Hsf2_positive_targets_up_CIS_OXA <- df_Hsf2_Il6_OXA %>% filter(logFC > 1 & mor == 1)
df_Hsf2_positive_targets_up_CIS_Control <- df_Hsf2_Il6_Control %>% filter(logFC > 1 & mor == 1)


intersect_positive_targets_up <- intersect(rownames(df_Hsf2_positive_targets_up_CIS_MTX), rownames(df_Hsf2_positive_targets_up_CIS_OXA))
intersect(intersect_positive_targets_up, rownames(df_Hsf2_positive_targets_up_CIS_Control))

```










```{r}
p_cyto_interest <- c()
n_cyto_interest <- 0
for (i in 1:length(tf_gmt)){
  if ("Ccl5" %in% tf_gmt[[i]]$Genes | "Il6" %in% tf_gmt[[i]]$Genes | "Ccl4" %in% tf_gmt[[i]]$Genes | "Ccl20" %in% tf_gmt[[i]]$Genes | "Ccl9" %in% tf_gmt[[i]]$Genes){
    print(i)
    n_cyto_interest <- n_cyto_interest+1
    p_cyto_interest <- append(p_cyto_interest, tf_gmt[[i]]$Name)
  }
}
print(n_cyto_interest)
print(p_cyto_interest)

```


## ROMA
```{r}

counts_in_vitro_df <- readRDS("~/MODICED_link/Bulk_RNA_in_vitro/preprocessing_in_vitro_RNA/counts_in_vitro_for_analysis.rds") %>% as.data.frame()
counts_in_vitro_df_genes <- counts_in_vitro_df %>% dplyr::select(1:3)
counts_in_vitro_df_samples <- counts_in_vitro_df %>% dplyr::select(-c(1:3))
sample_plan_in_vitro <- readRDS("~/MODICED_link/Bulk_RNA_in_vitro/preprocessing_in_vitro_RNA/sample_plan_in_vitro_for_analysis.rds")
attach(sample_plan_in_vitro)
dlist <- DGEList(counts = counts_in_vitro_df_samples, samples = sample_plan_in_vitro$Sample_Name, genes = counts_in_vitro_df_genes$gene_name)
dsgn <- model.matrix(~ 0 + Treatment_hour, data=dlist$samples)
colnames(dsgn) <- sub("Treatment_hour","",colnames(dsgn))
keep <- filterByExpr(dlist$counts, dsgn)
dlist_filtered <- dlist[keep,]



counts_for_roma <- cbind(dlist_filtered$counts, dlist_filtered$genes)
rownames(counts_for_roma) <- make.names(counts_for_roma$genes, unique=TRUE)
counts_for_roma <- counts_for_roma %>% select(-"genes")
counts_in_vitro_roma_all_timepoints <- cpm(counts_for_roma, log=TRUE) %>% as.data.frame() %>% select(contains('24h'))


tf_gmt <- ReadGMTFile("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/m3.gtrd.v2023.2.Mm.symbols.gmt")
run_roma_tf <- rRoma.R(counts_in_vitro_roma, tf_gmt)
saveRDS(run_roma_tf, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_for_tf_analysis_24h.rds")


```


```{r}
p_Ccl5 <- c()
n_Ccl5 <- 0
for (i in 1:length(tf_gmt)){
  if ("Ccl5" %in% tf_gmt[[i]]$Genes){
    print(i)
    n_Ccl5 <- n_Ccl5+1
    p_Ccl5 <- append(p_Ccl5, tf_gmt[[i]]$Name)
  }
}
print(n_Ccl5)
print(p_Ccl5)


p_Il6 <- c()
n_Il6 <- 0
for (i in 1:length(tf_gmt)){
  if ("Il6" %in% tf_gmt[[i]]$Genes){
    print(i)
    n_Il6 <- n_Il6+1
    p_Il6 <- append(p_Il6, tf_gmt[[i]]$Name)
  }
}
print(n_Il6)
print(p_Il6)


p_Ccl4 <- c()
n_Ccl4 <- 0
for (i in 1:length(tf_gmt)){
  if ("Ccl4" %in% tf_gmt[[i]]$Genes){
    print(i)
    n_Ccl4 <- n_Ccl4+1
    p_Ccl4 <- append(p_Ccl4, tf_gmt[[i]]$Name)
  }
}
print(n_Ccl4)
print(p_Ccl4)


p_Ccl20 <- c()
n_Ccl20 <- 0
for (i in 1:length(tf_gmt)){
  if ("Ccl20" %in% tf_gmt[[i]]$Genes){
    print(i)
    n_Ccl20 <- n_Ccl20+1
    p_Ccl20 <- append(p_Ccl20, tf_gmt[[i]]$Name)
  }
}
print(n_Ccl20)
print(p_Ccl20)



get_roma_results <- readRDS("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_for_tf_analysis_24h.rds")

get_roma_results_module_matrix <- get_roma_results$ModuleMatrix %>% as.data.frame()
get_roma_results_sample_matrix <- get_roma_results$SampleMatrix %>% as.data.frame()


tf_target_Il6_module_matrix <- get_roma_results_module_matrix %>% dplyr::filter(rownames(.) %in% p_Il6)
tf_target_Il6_sample_matrix <- get_roma_results_sample_matrix %>% dplyr::filter(rownames(.) %in% p_Il6)


tf_target_Ccl4_module_matrix <- get_roma_results_module_matrix %>% dplyr::filter(rownames(.) %in% p_Ccl4)
tf_target_Ccl4_sample_matrix <- get_roma_results_sample_matrix %>% dplyr::filter(rownames(.) %in% p_Ccl4)


tf_target_Ccl20_module_matrix <- get_roma_results_module_matrix %>% dplyr::filter(rownames(.) %in% p_Ccl20)
tf_target_Ccl20_sample_matrix <- get_roma_results_sample_matrix %>% dplyr::filter(rownames(.) %in% p_Ccl20)



# Il6
palette_length <- 100 


annotation_columns_roma <- data.frame(treatment = rep(c("MTX","OXA","CIS","Control"),c(3,3,3,3)))
rownames(annotation_columns_roma)[1:3] <- colnames(tf_target_Il6_sample_matrix)[1:3]
rownames(annotation_columns_roma)[4:6] <- colnames(tf_target_Il6_sample_matrix)[4:6]
rownames(annotation_columns_roma)[7:9] <- colnames(tf_target_Il6_sample_matrix)[7:9]
rownames(annotation_columns_roma)[10:12] <- colnames(tf_target_Il6_sample_matrix)[10:12]

annot_colors_roma <- list(treatment=c(MTX="green", OXA="#63D7DE", CIS = "pink2", Control = "yellow1"))



#Plot.Genesets.Samples(get_roma_results, Selected = which(rownames(get_roma_results_module_matrix) %in% rownames(tf_target_Il6_module_matrix)), cluster_cols = TRUE)

rownames(tf_target_Il6_sample_matrix) <- sub("_TARGET_GENES","",rownames(tf_target_Il6_sample_matrix))

tfs_Il6_roma <- ComplexHeatmap::pheatmap(as.matrix(tf_target_Il6_sample_matrix), cluster_rows = TRUE, cluster_cols = TRUE, fontsize_row = 12 , annotation_col = annotation_columns_roma, annotation_colors = annot_colors_roma, main="Activity of TFs of Il6", fontface = 3, show_colnames = FALSE, heatmap_legend_param = list(title = "activity_score", title_gp = gpar(fontsize = 10, fontface="bold"), title_position= "topcenter",legend_height = grid::unit(35,"mm"), grid_width = grid::unit(5,"mm"), labels_gp = gpar(col = "black", font = 2), legend_direction = "horizontal", legend_width = unit(5,"cm")), cellwidth = 30) %>% ComplexHeatmap::draw(heatmap_legend_side = "bottom", annotation_legend_side = "right")





# Ccl4
palette_length <- 100 


annotation_columns_roma <- data.frame(treatment = rep(c("MTX","OXA","CIS","Control"),c(3,3,3,3)))
rownames(annotation_columns_roma)[1:3] <- colnames(tf_target_Ccl4_sample_matrix)[1:3]
rownames(annotation_columns_roma)[4:6] <- colnames(tf_target_Ccl4_sample_matrix)[4:6]
rownames(annotation_columns_roma)[7:9] <- colnames(tf_target_Ccl4_sample_matrix)[7:9]
rownames(annotation_columns_roma)[10:12] <- colnames(tf_target_Ccl4_sample_matrix)[10:12]

annot_colors_roma <- list(treatment=c(MTX="green", OXA="#63D7DE", CIS = "pink2", Control = "yellow1"))



#Plot.Genesets.Samples(get_roma_results, Selected = which(rownames(get_roma_results_module_matrix) %in% rownames(tf_target_Ccl4_module_matrix)), cluster_cols = TRUE)

rownames(tf_target_Ccl4_sample_matrix) <- sub("_TARGET_GENES","",rownames(tf_target_Ccl4_sample_matrix))

tfs_Ccl4_roma <- ComplexHeatmap::pheatmap(as.matrix(tf_target_Ccl4_sample_matrix), cluster_rows = TRUE, cluster_cols = TRUE, fontsize_row = 12 , annotation_col = annotation_columns_roma, annotation_colors = annot_colors_roma, main="Activity of TFs of Ccl4", fontface = 3, show_colnames = FALSE, heatmap_legend_param = list(title = "activity_score", title_gp = gpar(fontsize = 10, fontface="bold"), title_position= "topcenter",legend_height = grid::unit(35,"mm"), grid_width = grid::unit(5,"mm"), labels_gp = gpar(col = "black", font = 2), legend_direction = "horizontal", legend_width = unit(5,"cm")), cellwidth = 30) %>% ComplexHeatmap::draw(heatmap_legend_side = "bottom", annotation_legend_side = "right")



tf_roma_patch <-  patchwork::wrap_plots(list(grid.grabExpr(ComplexHeatmap::draw(tfs_Il6_roma)), grid.grabExpr(ComplexHeatmap::draw(tfs_Ccl4_roma)))) & patchwork::plot_annotation(tag_levels = "A") & theme(plot.tag = element_text(face = "bold", size=13))



#tfs_Il6_Ccl4_for_roma <- rbind(tf_target_Il6_sample_matrix, tf_target_Ccl4_sample_matrix)
annot_row_roma <- data.frame(cytokine_interest = rep(c("Il6","Ccl4"),c(8,1)))
rownames(annot_row_roma)[1:8] <- rownames(tfs_Il6_Ccl4_for_roma)[1:8]
rownames(annot_row_roma)[9] <- rownames(tfs_Il6_Ccl4_for_roma)[9]


annot_colors_roma <- list(treatment=c(MTX="green", OXA="#63D7DE", CIS = "pink2", Control = "yellow1"), cytokine_interest = c(Il6 = "green3", Ccl4 = "purple"))

tfs_Il6_Ccl4_roma <- ComplexHeatmap::pheatmap(as.matrix(tfs_Il6_Ccl4_for_roma), cluster_rows = TRUE, cluster_cols = TRUE, fontsize_row = 12 , annotation_col = annotation_columns_roma, annotation_row = annot_row_roma, annotation_colors = annot_colors_roma, main="Activity of TFs of Il6 and Ccl4 (ROMA)", fontface = 3, show_colnames = FALSE, heatmap_legend_param = list(title = "activity_score", title_gp = gpar(fontsize = 10, fontface="bold"), title_position= "topcenter",legend_height = grid::unit(35,"mm"), grid_width = grid::unit(5,"mm"), labels_gp = gpar(col = "black", font = 2), legend_direction = "horizontal", legend_width = unit(5,"cm")), cellwidth = 30, annotation_names_row = FALSE) %>% ComplexHeatmap::draw(heatmap_legend_side = "bottom", annotation_legend_side = "right")





# Ccl20
palette_length <- 100 


annotation_columns_roma <- data.frame(treatment = rep(c("MTX","OXA","CIS","Control"),c(3,3,3,3)))
rownames(annotation_columns_roma)[1:3] <- colnames(tf_target_Ccl20_sample_matrix)[1:3]
rownames(annotation_columns_roma)[4:6] <- colnames(tf_target_Ccl20_sample_matrix)[4:6]
rownames(annotation_columns_roma)[7:9] <- colnames(tf_target_Ccl20_sample_matrix)[7:9]
rownames(annotation_columns_roma)[10:12] <- colnames(tf_target_Ccl20_sample_matrix)[10:12]

annot_colors_roma <- list(treatment=c(MTX="green", OXA="#63D7DE", CIS = "pink2", Control = "yellow1"))



#Plot.Genesets.Samples(get_roma_results, Selected = which(rownames(get_roma_results_module_matrix) %in% rownames(tf_target_Ccl20_module_matrix)), cluster_cols = TRUE)

rownames(tf_target_Ccl20_sample_matrix) <- sub("_TARGET_GENES","",rownames(tf_target_Ccl20_sample_matrix))

tfs_Ccl20_roma <- ComplexHeatmap::pheatmap(as.matrix(tf_target_Ccl20_sample_matrix), cluster_rows = TRUE, cluster_cols = TRUE, fontsize_row = 12 , annotation_col = annotation_columns_roma, annotation_colors = annot_colors_roma, main="Activity of TFs of Ccl20", fontface = 3, show_colnames = FALSE, heatmap_legend_param = list(title = "activity_score", title_gp = gpar(fontsize = 10, fontface="bold"), title_position= "topcenter",legend_height = grid::unit(35,"mm"), grid_width = grid::unit(5,"mm"), labels_gp = gpar(col = "black", font = 2), legend_direction = "horizontal", legend_width = unit(5,"cm")), cellwidth = 30) %>% ComplexHeatmap::draw(heatmap_legend_side = "bottom", annotation_legend_side = "right")



tf_roma_patch <-  patchwork::wrap_plots(list(grid.grabExpr(ComplexHeatmap::draw(tfs_Il6_roma)), grid.grabExpr(ComplexHeatmap::draw(tfs_Ccl20_roma)))) & patchwork::plot_annotation(tag_levels = "A") & theme(plot.tag = element_text(face = "bold", size=13))



#tfs_Il6_Ccl20_for_roma <- rbind(tf_target_Il6_sample_matrix, tf_target_Ccl20_sample_matrix)
annot_row_roma <- data.frame(cytokine_interest = rep(c("Il6","Ccl20"),c(8,1)))
rownames(annot_row_roma)[1:8] <- rownames(tfs_Il6_Ccl20_for_roma)[1:8]
rownames(annot_row_roma)[9] <- rownames(tfs_Il6_Ccl20_for_roma)[9]


annot_colors_roma <- list(treatment=c(MTX="green", OXA="#63D7DE", CIS = "pink2", Control = "yellow1"), cytokine_interest = c(Il6 = "green3", Ccl20 = "purple"))

tfs_Il6_Ccl20_roma <- ComplexHeatmap::pheatmap(as.matrix(tfs_Il6_Ccl20_for_roma), cluster_rows = TRUE, cluster_cols = TRUE, fontsize_row = 12 , annotation_col = annotation_columns_roma, annotation_row = annot_row_roma, annotation_colors = annot_colors_roma, main="Activity of TFs of Il6 and Ccl20 (ROMA)", fontface = 3, show_colnames = FALSE, heatmap_legend_param = list(title = "activity_score", title_gp = gpar(fontsize = 10, fontface="bold"), title_position= "topcenter",legend_height = grid::unit(35,"mm"), grid_width = grid::unit(5,"mm"), labels_gp = gpar(col = "black", font = 2), legend_direction = "horizontal", legend_width = unit(5,"cm")), cellwidth = 30, annotation_names_row = FALSE) %>% ComplexHeatmap::draw(heatmap_legend_side = "bottom", annotation_legend_side = "right")







PlotGeneWeight(RomaData = get_roma_results, PlotGenes = 200, LogExpression = FALSE, Selected = which(rownames(get_roma_results_module_matrix) == "CEBPG_TARGET_GENES"))


GeneMat_Cebpg <- GetTopContrib(get_roma_results,
                         Selected = which(rownames(get_roma_results_module_matrix) == "CEBPG_TARGET_GENES"),
                         nGenes = 600, OrderType = "Abs", Mode = "Wei", Plot = TRUE)


GeneMat_PROP1 <- GetTopContrib(get_roma_results,
                         Selected = which(rownames(get_roma_results_module_matrix) == "PROP1_TARGET_GENES"),
                         nGenes = 800, OrderType = "Abs", Mode = "Wei", Plot = TRUE)




```


```{r}
dorothea_gmt_rds <- readRDS("~/MODICED_link/dorotheaABC_gmt.rds")

p_Ccl5_dor <- c()
n_Ccl5_dor <- 0
for (i in 1:length(dorothea_gmt_rds)){
  if ("CCL5" %in% dorothea_gmt_rds[[i]]$Genes){
    print(i)
    n_Ccl5_dor <- n_Ccl5_dor+1
    p_Ccl5_dor <- append(p_Ccl5_dor, dorothea_gmt_rds[[i]]$Name)
  }
}
print(n_Ccl5_dor)
print(p_Ccl5_dor)



p_Il6_dor <- c()
n_Il6_dor <- 0
for (i in 1:length(dorothea_gmt_rds)){
  if ("IL6" %in% dorothea_gmt_rds[[i]]$Genes){
    print(i)
    n_Il6_dor <- n_Il6_dor+1
    p_Il6_dor <- append(p_Il6_dor, dorothea_gmt_rds[[i]]$Name)
  }
}
print(n_Il6_dor)
print(p_Il6_dor)



p_Ccl20_dor <- c()
n_Ccl20_dor <- 0
for (i in 1:length(dorothea_gmt_rds)){
  if ("Ccl20" %in% dorothea_gmt_rds[[i]]$Genes){
    print(i)
    n_Ccl20_dor <- n_Ccl20_dor+1
    p_Ccl20_dor <- append(p_Ccl20_dor, dorothea_gmt_rds[[i]]$Name)
  }
}
print(n_Ccl20_dor)
print(p_Ccl20_dor)


```



```{r}
cytokines_mouse_Il6 <- cytokines_mouse %>% dplyr::group_by(TF.Name) %>% dplyr::summarise(target_Il6 = any(Cytokine.Name == "Il6")) %>% as.data.frame() %>% filter(target_Il6 == "TRUE")

cytokines_mouse_tfs_Il6 <- cytokines_mouse %>% dplyr::filter(TF.Name %in% cytokines_mouse_Il6$TF.Name)
cytokines_mouse_tfs_Il6$TF.Name

intersect(cytokines_mouse_Il6$TF.Name, collectri_df_Il6$source)

for (i in 1:length())
Atf3_cyto_Il6 <- cytokines_mouse_tfs_Il6 %>% filter(TF.Name %in% intersect(cytokines_mouse_Il6$TF.Name, collectri_df_Il6$source)) %>% filter(TF.Name == "Atf3")


Atf3_collectri <- collectri_df_for_Il6 %>% filter(source == "Atf3")

Atf3_cyto$Cytokine.Name %in% Atf3_collectri$target


```


```{r}
counts_for_cytokine <- cbind(voom$E, voom$genes)
rownames(counts_for_cytokine) <- make.names(counts_for_cytokine$genes, unique = TRUE)
counts_for_cytokine <- counts_for_cytokine %>% select(-"genes")
cytokines_translation <- read.csv("Bulk_RNA_in_vitro/in_vitro_results/cytokines_translation_genes.csv")

```

```{r}
# MTX vs Control
contrasts_dea_MTX_Control_3h <- makeContrasts(MTX_3h_Control_3h = MTX_3h - Control_3h, levels=dsgn)
fit_contrast_dea_MTX_Control_3h <- contrasts.fit(fit_dea, contrasts_dea_MTX_Control_3h)
fit_contrast_dea_MTX_Control_3h <- eBayes(fit_contrast_dea_MTX_Control_3h)

fit_contrast_dea_MTX_Control_3h_top_table <- topTable(fit_contrast_dea_MTX_Control_3h, coef = "MTX_3h_Control_3h", adjust.method = "BH", sort.by = "P", number = Inf)
fit_contrast_dea_MTX_Control_3h_top_table <- fit_contrast_dea_MTX_Control_3h_top_table %>% mutate(contrast = rep("MTX_3h_vs_Control_3h", dim(.)[1]))


contrasts_dea_MTX_Control_6h <- makeContrasts(MTX_6h_Control_6h = MTX_6h - Control_6h, levels=dsgn)
fit_contrast_dea_MTX_Control_6h <- contrasts.fit(fit_dea, contrasts_dea_MTX_Control_6h)
fit_contrast_dea_MTX_Control_6h <- eBayes(fit_contrast_dea_MTX_Control_6h)

fit_contrast_dea_MTX_Control_6h_top_table <- topTable(fit_contrast_dea_MTX_Control_6h, coef = "MTX_6h_Control_6h", adjust.method = "BH", sort.by = "P", number = Inf)
fit_contrast_dea_MTX_Control_6h_top_table <- fit_contrast_dea_MTX_Control_6h_top_table %>% mutate(contrast = rep("MTX_6h_vs_Control_6h", dim(.)[1]))


contrasts_dea_MTX_Control_12h <- makeContrasts(MTX_12h_Control_12h = MTX_12h - Control_12h, levels=dsgn)
fit_contrast_dea_MTX_Control_12h <- contrasts.fit(fit_dea, contrasts_dea_MTX_Control_12h)
fit_contrast_dea_MTX_Control_12h <- eBayes(fit_contrast_dea_MTX_Control_12h)

fit_contrast_dea_MTX_Control_12h_top_table <- topTable(fit_contrast_dea_MTX_Control_12h, coef = "MTX_12h_Control_12h", adjust.method = "BH", sort.by = "P", number = Inf)
fit_contrast_dea_MTX_Control_12h_top_table <- fit_contrast_dea_MTX_Control_12h_top_table %>% mutate(contrast = rep("MTX_12h_vs_Control_12h", dim(.)[1]))


contrasts_dea_MTX_Control_18h <- makeContrasts(MTX_18h_Control_18h = MTX_18h - Control_18h, levels=dsgn)
fit_contrast_dea_MTX_Control_18h <- contrasts.fit(fit_dea, contrasts_dea_MTX_Control_18h)
fit_contrast_dea_MTX_Control_18h <- eBayes(fit_contrast_dea_MTX_Control_18h)

fit_contrast_dea_MTX_Control_18h_top_table <- topTable(fit_contrast_dea_MTX_Control_18h, coef = "MTX_18h_Control_18h", adjust.method = "BH", sort.by = "P", number = Inf)
fit_contrast_dea_MTX_Control_18h_top_table <- fit_contrast_dea_MTX_Control_18h_top_table %>% mutate(contrast = rep("MTX_18h_vs_Control_18h", dim(.)[1]))


contrasts_dea_MTX_Control_24h <- makeContrasts(MTX_24h_Control_24h = MTX_24h - Control_24h, levels=dsgn)
fit_contrast_dea_MTX_Control_24h <- contrasts.fit(fit_dea, contrasts_dea_MTX_Control_24h)
fit_contrast_dea_MTX_Control_24h <- eBayes(fit_contrast_dea_MTX_Control_24h)

fit_contrast_dea_MTX_Control_24h_top_table <- topTable(fit_contrast_dea_MTX_Control_24h, coef = "MTX_24h_Control_24h", adjust.method = "BH", sort.by = "P", number = Inf)
fit_contrast_dea_MTX_Control_24h_top_table <- fit_contrast_dea_MTX_Control_24h_top_table %>% mutate(contrast = rep("MTX_24h_vs_Control_24h", dim(.)[1]))


topTable_MTX_Control <- rbind(fit_contrast_dea_MTX_Control_3h_top_table, fit_contrast_dea_MTX_Control_6h_top_table, fit_contrast_dea_MTX_Control_12h_top_table, fit_contrast_dea_MTX_Control_18h_top_table, fit_contrast_dea_MTX_Control_24h_top_table)




# OXA vs Control
contrasts_dea_OXA_Control_3h <- makeContrasts(OXA_3h_Control_3h = OXA_3h - Control_3h, levels=dsgn)
fit_contrast_dea_OXA_Control_3h <- contrasts.fit(fit_dea, contrasts_dea_OXA_Control_3h)
fit_contrast_dea_OXA_Control_3h <- eBayes(fit_contrast_dea_OXA_Control_3h)

fit_contrast_dea_OXA_Control_3h_top_table <- topTable(fit_contrast_dea_OXA_Control_3h, coef = "OXA_3h_Control_3h", adjust.method = "BH", sort.by = "P", number = Inf)
fit_contrast_dea_OXA_Control_3h_top_table <- fit_contrast_dea_OXA_Control_3h_top_table %>% mutate(contrast = rep("OXA_3h_vs_Control_3h", dim(.)[1]))


contrasts_dea_OXA_Control_6h <- makeContrasts(OXA_6h_Control_6h = OXA_6h - Control_6h, levels=dsgn)
fit_contrast_dea_OXA_Control_6h <- contrasts.fit(fit_dea, contrasts_dea_OXA_Control_6h)
fit_contrast_dea_OXA_Control_6h <- eBayes(fit_contrast_dea_OXA_Control_6h)

fit_contrast_dea_OXA_Control_6h_top_table <- topTable(fit_contrast_dea_OXA_Control_6h, coef = "OXA_6h_Control_6h", adjust.method = "BH", sort.by = "P", number = Inf)
fit_contrast_dea_OXA_Control_6h_top_table <- fit_contrast_dea_OXA_Control_6h_top_table %>% mutate(contrast = rep("OXA_6h_vs_Control_6h", dim(.)[1]))


contrasts_dea_OXA_Control_12h <- makeContrasts(OXA_12h_Control_12h = OXA_12h - Control_12h, levels=dsgn)
fit_contrast_dea_OXA_Control_12h <- contrasts.fit(fit_dea, contrasts_dea_OXA_Control_12h)
fit_contrast_dea_OXA_Control_12h <- eBayes(fit_contrast_dea_OXA_Control_12h)

fit_contrast_dea_OXA_Control_12h_top_table <- topTable(fit_contrast_dea_OXA_Control_12h, coef = "OXA_12h_Control_12h", adjust.method = "BH", sort.by = "P", number = Inf)
fit_contrast_dea_OXA_Control_12h_top_table <- fit_contrast_dea_OXA_Control_12h_top_table %>% mutate(contrast = rep("OXA_12h_vs_Control_12h", dim(.)[1]))


contrasts_dea_OXA_Control_18h <- makeContrasts(OXA_18h_Control_18h = OXA_18h - Control_18h, levels=dsgn)
fit_contrast_dea_OXA_Control_18h <- contrasts.fit(fit_dea, contrasts_dea_OXA_Control_18h)
fit_contrast_dea_OXA_Control_18h <- eBayes(fit_contrast_dea_OXA_Control_18h)

fit_contrast_dea_OXA_Control_18h_top_table <- topTable(fit_contrast_dea_OXA_Control_18h, coef = "OXA_18h_Control_18h", adjust.method = "BH", sort.by = "P", number = Inf)
fit_contrast_dea_OXA_Control_18h_top_table <- fit_contrast_dea_OXA_Control_18h_top_table %>% mutate(contrast = rep("OXA_18h_vs_Control_18h", dim(.)[1]))


contrasts_dea_OXA_Control_24h <- makeContrasts(OXA_24h_Control_24h = OXA_24h - Control_24h, levels=dsgn)
fit_contrast_dea_OXA_Control_24h <- contrasts.fit(fit_dea, contrasts_dea_OXA_Control_24h)
fit_contrast_dea_OXA_Control_24h <- eBayes(fit_contrast_dea_OXA_Control_24h)

fit_contrast_dea_OXA_Control_24h_top_table <- topTable(fit_contrast_dea_OXA_Control_24h, coef = "OXA_24h_Control_24h", adjust.method = "BH", sort.by = "P", number = Inf)
fit_contrast_dea_OXA_Control_24h_top_table <- fit_contrast_dea_OXA_Control_24h_top_table %>% mutate(contrast = rep("OXA_24h_vs_Control_24h", dim(.)[1]))



topTable_OXA_Control <- rbind(fit_contrast_dea_OXA_Control_3h_top_table, fit_contrast_dea_OXA_Control_6h_top_table, fit_contrast_dea_OXA_Control_12h_top_table, fit_contrast_dea_OXA_Control_18h_top_table, fit_contrast_dea_OXA_Control_24h_top_table)



# CIS vs Control
contrasts_dea_CIS_Control_3h <- makeContrasts(CIS_3h_Control_3h = CIS_3h - Control_3h, levels=dsgn)
fit_contrast_dea_CIS_Control_3h <- contrasts.fit(fit_dea, contrasts_dea_CIS_Control_3h)
fit_contrast_dea_CIS_Control_3h <- eBayes(fit_contrast_dea_CIS_Control_3h)

fit_contrast_dea_CIS_Control_3h_top_table <- topTable(fit_contrast_dea_CIS_Control_3h, coef = "CIS_3h_Control_3h", adjust.method = "BH", sort.by = "P", number = Inf)
fit_contrast_dea_CIS_Control_3h_top_table <- fit_contrast_dea_CIS_Control_3h_top_table %>% mutate(contrast = rep("CIS_3h_vs_Control_3h", dim(.)[1]))


contrasts_dea_CIS_Control_6h <- makeContrasts(CIS_6h_Control_6h = CIS_6h - Control_6h, levels=dsgn)
fit_contrast_dea_CIS_Control_6h <- contrasts.fit(fit_dea, contrasts_dea_CIS_Control_6h)
fit_contrast_dea_CIS_Control_6h <- eBayes(fit_contrast_dea_CIS_Control_6h)

fit_contrast_dea_CIS_Control_6h_top_table <- topTable(fit_contrast_dea_CIS_Control_6h, coef = "CIS_6h_Control_6h", adjust.method = "BH", sort.by = "P", number = Inf)
fit_contrast_dea_CIS_Control_6h_top_table <- fit_contrast_dea_CIS_Control_6h_top_table %>% mutate(contrast = rep("CIS_6h_vs_Control_6h", dim(.)[1]))


contrasts_dea_CIS_Control_12h <- makeContrasts(CIS_12h_Control_12h = CIS_12h - Control_12h, levels=dsgn)
fit_contrast_dea_CIS_Control_12h <- contrasts.fit(fit_dea, contrasts_dea_CIS_Control_12h)
fit_contrast_dea_CIS_Control_12h <- eBayes(fit_contrast_dea_CIS_Control_12h)

fit_contrast_dea_CIS_Control_12h_top_table <- topTable(fit_contrast_dea_CIS_Control_12h, coef = "CIS_12h_Control_12h", adjust.method = "BH", sort.by = "P", number = Inf)
fit_contrast_dea_CIS_Control_12h_top_table <- fit_contrast_dea_CIS_Control_12h_top_table %>% mutate(contrast = rep("CIS_12h_vs_Control_12h", dim(.)[1]))


contrasts_dea_CIS_Control_18h <- makeContrasts(CIS_18h_Control_18h = CIS_18h - Control_18h, levels=dsgn)
fit_contrast_dea_CIS_Control_18h <- contrasts.fit(fit_dea, contrasts_dea_CIS_Control_18h)
fit_contrast_dea_CIS_Control_18h <- eBayes(fit_contrast_dea_CIS_Control_18h)

fit_contrast_dea_CIS_Control_18h_top_table <- topTable(fit_contrast_dea_CIS_Control_18h, coef = "CIS_18h_Control_18h", adjust.method = "BH", sort.by = "P", number = Inf)
fit_contrast_dea_CIS_Control_18h_top_table <- fit_contrast_dea_CIS_Control_18h_top_table %>% mutate(contrast = rep("CIS_18h_vs_Control_18h", dim(.)[1]))


contrasts_dea_CIS_Control_24h <- makeContrasts(CIS_24h_Control_24h = CIS_24h - Control_24h, levels=dsgn)
fit_contrast_dea_CIS_Control_24h <- contrasts.fit(fit_dea, contrasts_dea_CIS_Control_24h)
fit_contrast_dea_CIS_Control_24h <- eBayes(fit_contrast_dea_CIS_Control_24h)

fit_contrast_dea_CIS_Control_24h_top_table <- topTable(fit_contrast_dea_CIS_Control_24h, coef = "CIS_24h_Control_24h", adjust.method = "BH", sort.by = "P", number = Inf)
fit_contrast_dea_CIS_Control_24h_top_table <- fit_contrast_dea_CIS_Control_24h_top_table %>% mutate(contrast = rep("CIS_24h_vs_Control_24h", dim(.)[1]))



topTable_CIS_Control <- rbind(fit_contrast_dea_CIS_Control_3h_top_table, fit_contrast_dea_CIS_Control_6h_top_table, fit_contrast_dea_CIS_Control_12h_top_table, fit_contrast_dea_CIS_Control_18h_top_table, fit_contrast_dea_CIS_Control_24h_top_table)


top_table_drug_control <- rbind(topTable_MTX_Control, topTable_OXA_Control, topTable_CIS_Control)
rownames(top_table_drug_control) <- NULL
#write.csv(top_table_drug_control, "Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", quote=F, col.names = TRUE, row.names = FALSE)
top_table_drug_control_degs_cytokine_genes <- top_table_drug_control %>% filter(genes %in% cytokines_translation$Genes) %>% filter(abs(logFC) > 1.5 & adj.P.Val <= 0.05)
rownames(top_table_drug_control_degs_cytokine_genes) <- NULL
top_table_drug_control_degs_cytokine_genes <- read.csv("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv")

```

```{r}
top_table_in_vivo <- read.csv("Bulk_RNA_in_vitro/in_vitro_results/top_table_in_vivo_for_Andrea.csv") %>% select(-1)
top_table_in_vivo_degs_cyotkines <- top_table_in_vivo %>% filter(gene_name %in% cytokines_translation$Genes) %>% filter(abs(logFC) > 1.5 & adj.P.Val <= 0.05)
rownames(top_table_drug_control_degs_cytokine_genes) <- NULL


top_table_in_vivo_degs_cytokines <- top_table_in_vivo %>% filter(gene_name %in% cytokines_translation$Genes) %>% filter(abs(logFC) > 1.5 & adj.P.Val <= 0.05)
rownames(top_table_drug_control_degs_cytokine_genes) <- NULL
```



```{r}
cyto_degs <- cytokines_translation %>% mutate(Exp_setting_1 = rep("In vitro", dim(cytokines_translation)[1]), Timepoint_1 = rep("3h", dim(cytokines_translation)[1]), MTX_vs_Control_3h = rep("U/D", dim(cytokines_translation)[1]), OXA_vs_Control_3h = rep("U/D", dim(cytokines_translation)[1]), CIS_vs_Control_3h = rep("U/D", dim(cytokines_translation)[1]), Timepoint_2  = rep("6h", dim(cytokines_translation)[1]), MTX_vs_Control_6h = rep("U/D", dim(cytokines_translation)[1]), OXA_vs_Control_6h = rep("U/D", dim(cytokines_translation)[1]), CIS_vs_Control_6h = rep("U/D", dim(cytokines_translation)[1]), Timepoint_3 = rep("12h", dim(cytokines_translation)[1]), MTX_vs_Control_12h = rep("U/D", dim(cytokines_translation)[1]), OXA_vs_Control_12h = rep("U/D", dim(cytokines_translation)[1]), CIS_vs_Control_12h = rep("U/D", dim(cytokines_translation)[1]), Timepoint_4 = rep("18h", dim(cytokines_translation)[1]), MTX_vs_Control_18h = rep("U/D", dim(cytokines_translation)[1]), OXA_vs_Control_18h = rep("U/D", dim(cytokines_translation)[1]), CIS_vs_Control_18h = rep("U/D", dim(cytokines_translation)[1]), Timepoint_5 = rep("24h", dim(cytokines_translation)[1]), MTX_vs_Control_24h = rep("U/D", dim(cytokines_translation)[1]), OXA_vs_Control_24h = rep("U/D", dim(cytokines_translation)[1]), CIS_vs_Control_24h = rep("U/D", dim(cytokines_translation)[1]), Exp_setting_2 = rep("In vivo", dim(cytokines_translation)[1]), T1 = rep("D3", dim(cytokines_translation)[1]), MTX_vs_PBS_D3 = rep("U/D", dim(cytokines_translation)[1]), OXA_vs_PBS_D3 = rep("U/D", dim(cytokines_translation)[1]), CIS_vs_PBS_D3 = rep("U/D", dim(cytokines_translation)[1]), T2 = rep("D10", dim(cytokines_translation)[1]), MTX_vs_PBS_D10 = rep("U/D", dim(cytokines_translation)[1]), OXA_vs_PBS_D10 = rep("U/D", dim(cytokines_translation)[1]), CIS_vs_PBS_D10 = rep("U/D", dim(cytokines_translation)[1]), T3 = rep("D22", dim(cytokines_translation)[1]), MTX_vs_PBS_D22 = rep("U/D", dim(cytokines_translation)[1]), OXA_vs_PBS_D22 = rep("U/D", dim(cytokines_translation)[1]), CIS_vs_PBS_D22 = rep("U/D", dim(cytokines_translation)[1]))



# in vitro
for (drug in c("MTX", "OXA", "CIS")){
  for (timepoint in c("3h","6h","12h","18h","24h")){
    top_table_in_vitro_degs <- top_table_drug_control_degs_cytokine_genes %>% filter(contrast == paste(drug,timepoint,"vs","Control",timepoint,sep="_"))
    top_table_in_vitro_degs_up <- top_table_in_vitro_degs %>% filter(logFC > 0)
    top_table_in_vitro_degs_down <- top_table_in_vitro_degs %>% filter(logFC < 0)
    
    for (i in 1:dim(cyto_degs)[1]){
      if (cyto_degs$Genes[i] %in% top_table_in_vitro_degs_up$genes){
        cyto_degs[i, paste(drug,"vs","Control",timepoint,sep="_")] <- "UP"
      }
      if (cyto_degs$Genes[i] %in% top_table_in_vitro_degs_down$genes){
        cyto_degs[i, paste(drug,"vs","Control",timepoint,sep="_")] <- "DOWN"
      }
      if (!(cyto_degs$Genes[i] %in% top_table_in_vitro_degs$genes)){
        cyto_degs[i, paste(drug,"vs","Control",timepoint,sep="_")] <- ""
      }
    }
  }
}
   
 
# in vivo
for (drug in c("MTX", "OXA", "CIS")){
  for (timepoint in c("D3","D10","D22")){
    top_table_in_vivo_degs <- top_table_in_vivo_degs_cytokines %>% filter(contrast == paste(drug,timepoint,"vs","PBS",timepoint,sep="_"))
    top_table_in_vivo_degs_up <- top_table_in_vivo_degs %>% filter(logFC > 0)
    top_table_in_vivo_degs_down <- top_table_in_vivo_degs %>% filter(logFC < 0)
    for (i in 1:dim(cyto_degs)[1]){
      if (cyto_degs$Genes[i] %in% top_table_in_vivo_degs_up$gene_name){
        cyto_degs[i, paste(drug,"vs","PBS",timepoint,sep="_")] <- "UP"
          }
      if (cyto_degs$Genes[i] %in% top_table_in_vivo_degs_down$gene_name){
        cyto_degs[i, paste(drug,"vs","PBS",timepoint,sep="_")] <- "DOWN"
          }
      if (!(cyto_degs$Genes[i] %in% top_table_in_vivo_degs$gene_name)){
        cyto_degs[i, paste(drug,"vs","PBS",timepoint,sep="_")] <- ""
      }
    }
  }
}
    
  
write.csv(cyto_degs, "Bulk_RNA_in_vitro/in_vitro_results/cytokines_translation_genes_updated.csv", row.names = FALSE, col.names = TRUE, quote=FALSE)
```
  
  
```{r}
excel1 <- read_excel("Bulk_RNA_in_vitro/in_vitro_results/GSM-CYT-4_ICAC-062022.xlsx", sheet ="Data")
excel2 <- read_excel("Bulk_RNA_in_vitro/in_vitro_results/GSM-CYT-5_ICAC-062022.xlsx", sheet = "Data")
excel3 <- read_excel("Bulk_RNA_in_vitro/in_vitro_results/GSM-CYT-6_ICAC-062022.xlsx", sheet = "Data")
excel4 <- read_excel("Bulk_RNA_in_vitro/in_vitro_results/GSM-CYT-7_ICAC-062022.xlsx", sheet = "Data")
excel5 <- read_excel("Bulk_RNA_in_vitro/in_vitro_results/GSM-CYT-8_ICAC-062022.xlsx", sheet = "Data")

excel1_cyto <- c(unique(excel1$...1))
excel2_cyto <- c(unique(excel2$...1))
excel3_cyto <- c(unique(excel3$...1))
excel4_cyto <- c(unique(excel4$...1))
excel5_cyto <- c(unique(excel5$...1))

all_cyto_1 <- data.frame(excel1_cyto) %>% dplyr::slice(-c(1,2,45,46,48,49)) %>% dplyr::rename("Cytokine" = "excel1_cyto")
all_cyto_2 <- data.frame(excel2_cyto) %>% dplyr::slice(-c(1,2,45,46,48,49)) %>% dplyr::rename("Cytokine" = "excel2_cyto")
all_cyto_3 <- data.frame(excel3_cyto) %>% dplyr::slice(-c(1,2,45,46,48,49)) %>% dplyr::rename("Cytokine" = "excel3_cyto")
all_cyto_4 <- data.frame(excel4_cyto) %>% dplyr::slice(-c(1,2,45,46,48,49)) %>% dplyr::rename("Cytokine" = "excel4_cyto")
all_cyto_5 <- data.frame(excel5_cyto) %>% dplyr::slice(-c(1,2,45,46,48,49)) %>% dplyr::rename("Cytokine" = "excel5_cyto")

all_cyto <- rbind(all_cyto_1, all_cyto_2, all_cyto_3, all_cyto_4, all_cyto_5)


cyto_from_cytokine_array_not_in_translation <- all_cyto[!(all_cyto$Cytokine %in% cyto_degs$Cytokines), "Cytokine"]
cyto_from_cytokine_array_not_in_translation <- unique(cyto_from_cytokine_array_not_in_translation)
write.csv(cyto_from_cytokine_array_not_in_translation, "cyto_from_cytokine_array_not_in_translation.csv")
```
  
  
```{r}
#POS1 POS2 AR CD27L CD30T E-selectin IGF-I IL-12p70 IL-1ra IL-2 Ra IL-23 IL-28 MIP-3a OPN OPG P-selectin SDF-1a TPO VEGF POS-Ave CD30L Eotaxin Fas L G-CSF IFNg IL-1a IL-1b IL-12p40 IL-17 MIP-1a MIP-1g PF-4 TCA-3 TNF RII TNFa ACE CT-1 CD40L Dkk-1 Fcg RIIB Flt-3L GITR L HGF R IL-3 Rb MadCAM-1 MIP-3b Pentraxin 3 VEGF R1 VEGF R3 B7-1 BTC CXCL15 IL-7 RŒ± OX40 Ligand Tryptase Œµ 6Ckine ADAMTS1 ANG-3 Gremlin IFN-Œ≥ R1 IL-17B R MIP-1b MMP-10 Shh-N TGFb1 TRANCE TremL1 VEGF-R2    
```
  

```{r}
# Run DTW 
counts_in_vitro_alltimepoints <- readRDS("Bulk_RNA_in_vitro/preprocessing_in_vitro_RNA/counts_in_vitro_for_analysis.rds") %>% as.data.frame()
sample_plan_in_vitro <- readRDS("~/MODICED_link/Bulk_RNA_in_vitro/preprocessing_in_vitro_RNA/sample_plan_in_vitro_for_analysis.rds")
attach(sample_plan_in_vitro)

counts_in_vitro_alltimepoints_genes <- counts_in_vitro_df %>% dplyr::select(1:3)
counts_in_vitro_alltimepoints_samples <- counts_in_vitro_df %>% dplyr::select(-c(1:3))
dlist <- DGEList(counts = counts_in_vitro_alltimepoints_samples, samples = sample_plan_in_vitro$Sample_Name, genes = counts_in_vitro_alltimepoints_genes$gene_name)
dsgn <- model.matrix(~ 0 + Treatment_hour, data=dlist$samples)
colnames(dsgn) <- sub("Treatment_hour","",colnames(dsgn))
keep <- filterByExpr(dlist$counts, dsgn)
dlist_filtered <- dlist[keep,]
counts_in_vitro_alltimepoints <- cbind(dlist_filtered$counts, dlist_filtered$genes)
rownames(counts_in_vitro_alltimepoints) <- make.names(counts_in_vitro_alltimepoints$genes, unique=TRUE)
counts_in_vitro_alltimepoints <- counts_in_vitro_alltimepoints %>% select(-"genes")

counts_in_vitro_alltimepoints <- counts_in_vitro_alltimepoints %>% cpm(log=TRUE) %>% as.data.frame()

```

  
  
```{r}
counts_in_vitro <- readRDS("Bulk_RNA_in_vitro/preprocessing_in_vitro_RNA/counts_in_vitro_for_analysis.rds") %>% as.data.frame()
rownames(counts_in_vitro) <- make.names(counts_in_vitro$gene_name, unique=TRUE)
counts_in_vitro <- counts_in_vitro %>% select(-c(1:3))
write.csv(counts_in_vitro, "Bulk_RNA_in_vitro/in_vitro_results/counts_in_vitro_dtw.csv", row.names=TRUE, col.names=TRUE, quote=FALSE)
counts_in_vitro_control <- counts_in_vitro %>% select(contains("Control") & contains("3h"))

sample_plan_in_vitro_control <- readRDS("Bulk_RNA_in_vitro/preprocessing_in_vitro_RNA/sample_plan_in_vitro_for_analysis.rds") %>% filter(Treatment_hour == "Control_3h")



#fibroblast
counts_fibroblast <- read.csv("~/MODICED_link/Bulk_RNA_in_vitro/preprocessing_in_vitro_RNA/results_pipeline_rna_seq_fibroblast/counts/tablecounts_raw.csv") %>% dplyr::rename("gene_id" = "X")


annot_file <- read.csv("~/MODICED_link/Bulk_RNA_in_vitro/preprocessing_in_vitro_RNA/results_pipeline_rna_seq_fibroblast/counts/tableannot.csv")
counts_fibroblast <- inner_join(counts_fibroblast, annot_file[, c("gene_id","gene_name")], by="gene_id") %>% relocate("gene_name", .before="gene_id")
rownames(counts_fibroblast) <- make.names(counts_fibroblast$gene_name, unique=TRUE)
counts_fibroblast <- counts_fibroblast %>% select(-c("gene_id","gene_name"))


sample_plan_fibroblast <- read.csv("~/MODICED_link/Bulk_RNA_in_vitro/preprocessing_in_vitro_RNA/sample_plan_fibroblast.csv", header=FALSE)
colnames(sample_plan_fibroblast) <- c("Sample_ID", "Sample_Name", "Path_to_R1", "Path_to_R2")
sample_plan_fibroblast[,"Treatment"] <- "Control"
sample_plan_fibroblast[,"Time_Point"] <- "0h"
sample_plan_fibroblast <- sample_plan_fibroblast %>% select(-4)

sampling_tissue <- c("Bone","Lung","Liver","Brown_adipose","Mesentery","Pancreas","Omentum","sLN","Epi_adipose")
for (i in 1:length(sampling_tissue)){
  sample_plan_fibroblast[grepl(sampling_tissue[i],sample_plan_fibroblast$Sample_Name), "Treatment_hour"] <-
    paste("Control","fibroblast",sampling_tissue[i],sep="_")

}



#counts_fibroblast <- counts_fibroblast[,c(2,3,1)]


# Intersect counts in vitro + counts fibroblast
counts_in_vitro_new <- cbind(counts_in_vitro_control, counts_fibroblast)
sample_plan_new <- rbind(sample_plan_in_vitro_control, sample_plan_fibroblast)
rownames(sample_plan_new) <- sample_plan_new$Sample_Name
attach(sample_plan_new)
write.csv(counts_in_vitro_new,"Bulk_RNA_in_vitro/in_vitro_results/counts_control_fibroblast.csv",row.names=TRUE, col.names=TRUE, quote=FALSE)
write.csv(sample_plan_new,"Bulk_RNA_in_vitro/in_vitro_results/sample_plan_control_fibroblast.csv",row.names=TRUE, col.names=TRUE, quote=FALSE)
counts_in_vitro_new <- counts_in_vitro_new[rowSums(counts_in_vitro_new) >= 20,]

for (i in 1:length(sampling_tissue)){
  dlist_fibro <- DGEList(counts = counts_in_vitro_new %>% select(contains("3h") | contains(sampling_tissue[i])), samples = sample_plan_new[sample_plan_new$Sample_Name[which(sample_plan_new$Sample_Name %in% colnames(counts_in_vitro_new %>% select(contains("3h") | contains(sampling_tissue[i]))))],], genes = counts_in_vitro_new %>% select(contains("3h") | contains(sampling_tissue[i])) %>% rownames())
  dsgn_fibro <- model.matrix(~ 0 + Treatment_hour, data=dlist_fibro$samples)
  colnames(dsgn_fibro) <- sub("Treatment_hour","",colnames(dsgn_fibro))
  dlist_fibro <- calcNormFactors(dlist_fibro, method="TMM")
  voom_dlist_fibro <- voomWithQualityWeights(dlist_fibro, dsgn_fibro)
  fit_fibro <- lmFit(voom_dlist_fibro, dsgn_fibro)
  x <- paste(colnames(dsgn_fibro)[1],"-",colnames(dsgn_fibro)[2],sep="")
  contrast_fibro <- makeContrasts(Control_3h_fibro = x, levels=dsgn_fibro)
  contrast_fibro_fit <- contrasts.fit(fit_fibro, contrast_fibro)
  contrast_fibro_fit <- eBayes(contrast_fibro_fit)
 write.csv(topTable(contrast_fibro_fit, sort.by = "P", adjust.method = "BH", coef = x, number = Inf) %>% mutate(sampling_tissue = sampling_tissue[i]) %>% select(-"genes"), paste0("Bulk_RNA_in_vitro/in_vitro_results/all_genes_top_table_fibro_",sampling_tissue[i],".csv"))
 
 write.csv(topTable(contrast_fibro_fit, sort.by = "P", adjust.method = "BH", coef = x, number = Inf) %>% filter(abs(logFC) >= 2 & adj.P.Val <= 0.05) %>% mutate(group = if_else(logFC < 0, "down", "up")) %>% mutate(sampling_tissue = sampling_tissue[i]) %>% select(-"genes"), paste0("Bulk_RNA_in_vitro/in_vitro_results/diff_genes_top_table_fibro_",sampling_tissue[i],".csv"))
}


# all genes
all_genes_fibro <- read.csv(paste0("Bulk_RNA_in_vitro/in_vitro_results/all_genes_top_table_fibro_",sampling_tissue[1],".csv")) %>% dplyr::rename("gene_name" = "X")
for (i in 2:length(sampling_tissue)){
  all_genes_fibro <- rbind(all_genes_fibro,read.csv(paste0("Bulk_RNA_in_vitro/in_vitro_results/all_genes_top_table_fibro_",sampling_tissue[i],".csv")) %>%  dplyr::rename("gene_name" = "X"))
}

write.csv(all_genes_fibro, "Bulk_RNA_in_vitro/in_vitro_results/all_genes_top_table_fibro_concat.csv", row.names=FALSE, col.names=TRUE)




# diff genes
diff_genes_fibro <- read.csv(paste0("Bulk_RNA_in_vitro/in_vitro_results/diff_genes_top_table_fibro_",sampling_tissue[1],".csv")) %>% dplyr::rename("gene_name" = "X")
for (i in 2:length(sampling_tissue)){
  diff_genes_fibro <- rbind(diff_genes_fibro,read.csv(paste0("Bulk_RNA_in_vitro/in_vitro_results/diff_genes_top_table_fibro_",sampling_tissue[i],".csv")) %>%  dplyr::rename("gene_name" = "X"))
}

write.csv(diff_genes_fibro, "Bulk_RNA_in_vitro/in_vitro_results/diff_genes_top_table_fibro_concat.csv", row.names=FALSE, col.names=TRUE)


#diff_genes_venn <- list(brown_adipose = diff_genes_fibro %>% filter(sampling_tissue == "Brown_adipose") %>% select(gene_name), lung = diff_genes_fibro$gene_name %>% filter(sampling_tissue == "Lung") %>% select(gene_name), Epi_adipose = diff_genes_fibro$gene_name %>% filter(sampling_tissue == "Epi_adipose") %>% select(gene_name), Bone = diff_genes_fibro$gene_name %>% filter(sampling_tissue == "Bone") %>% select(gene_name))
#ggvenn(diff_genes_venn)



diff_fibro_up <- diff_genes_fibro %>% filter(group == "up")



diff_fibro_up_bone <- diff_fibro_up %>% filter(sampling_tissue == "Bone") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_concat_up_bone.csv", row.names=FALSE, col.names=TRUE) 

diff_fibro_up_liver <- diff_fibro_up %>% filter(sampling_tissue == "Liver") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_concat_up_liver.csv", row.names=FALSE, col.names=TRUE) 

diff_fibro_up_lung <- diff_fibro_up %>% filter(sampling_tissue == "Lung") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_concat_up_lung.csv", row.names=FALSE, col.names=TRUE)  

diff_fibro_up_ba <- diff_fibro_up %>% filter(sampling_tissue == "Brown_adipose") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_concat_up_ba.csv", row.names=FALSE, col.names=TRUE)
  
diff_fibro_up_mesentery <- diff_fibro_up %>% filter(sampling_tissue == "Mesentery") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_concat_up_mesentery.csv", row.names=FALSE, col.names=TRUE)

diff_fibro_up_omentum <- diff_fibro_up %>% filter(sampling_tissue == "Omentum") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_concat_up_omentum.csv", row.names=FALSE, col.names=TRUE)

diff_fibro_up_pancreas <- diff_fibro_up %>% filter(sampling_tissue == "Pancreas") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_concat_up_pancreas.csv", row.names=FALSE, col.names=TRUE)

diff_fibro_up_epi_adi <- diff_fibro_up %>% filter(sampling_tissue == "Epi_adipose") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_concat_up_epi_adi.csv", row.names=FALSE, col.names=TRUE)

diff_fibro_up_sLN <- diff_fibro_up %>% filter(sampling_tissue == "sLN") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_concat_up_sLN.csv", row.names=FALSE, col.names=TRUE)



diff_fibro_at_least_one_tissue <- unique(c(diff_fibro_up_bone$gene_name, diff_fibro_up_liver$gene_name, diff_fibro_up_ba$gene_name, diff_fibro_up_mesentery$gene_name, diff_fibro_up_epi_adi$gene_name, diff_fibro_up_omentum$gene_name, diff_fibro_up_pancreas$gene_name, diff_fibro_up_sLN$gene_name, diff_fibro_up_lung$gene_name))
write.csv(diff_fibro_at_least_one_tissue, "up_genes_in_MCA205_vs_at_least_one_tissue.csv", row.names=FALSE, col.names=TRUE)



intersect_bone_ba_up <- intersect(diff_fibro_up_bone$gene_name, diff_fibro_up_ba$gene_name)
write.csv(intersect_bone_ba_up, "Bulk_RNA_in_vitro/in_vitro_results/intersect_up_fibro_bone_brown_adipose_tissues.csv")

intersect_bone_ba_edi_up <- intersect(intersect_bone_ba_up, diff_fibro_up_epi_adi$gene_name)
write.csv(intersect_bone_ba_edi_up, "Bulk_RNA_in_vitro/in_vitro_results/intersect_up_fibro_bone_brown_epi_adipose_tissues.csv")

intersect_bone_ba_edi_liver_up <- intersect(intersect_bone_ba_edi_up, diff_fibro_up_liver$gene_name)
write.csv(intersect_bone_ba_edi_liver_up, "Bulk_RNA_in_vitro/in_vitro_results/intersect_up_fibro_bone_brown_epi_adipose_liver_tissues.csv")


intersect_bone_ba_edi_liver_lung_up <- intersect(intersect_bone_ba_edi_liver_up, diff_fibro_up_lung$gene_name)
write.csv(intersect_bone_ba_edi_liver_lung_up, "Bulk_RNA_in_vitro/in_vitro_results/intersect_up_fibro_bone_brown_epi_adipose_liver_lung_tissues.csv")


intersect_bone_ba_edi_liver_lung_mesentery_up <- intersect(intersect_bone_ba_edi_liver_lung_up, diff_fibro_up_mesentery$gene_name)
write.csv(intersect_bone_ba_edi_liver_lung_mesentery_up, "Bulk_RNA_in_vitro/in_vitro_results/intersect_up_fibro_bone_brown_epi_adipose_liver_lung_mesentery_tissues.csv")


intersect_bone_ba_edi_liver_lung_mesentery_omentum_up <- intersect(intersect_bone_ba_edi_liver_lung_mesentery_up, diff_fibro_up_omentum$gene_name)
write.csv(intersect_bone_ba_edi_liver_lung_mesentery_omentum_up, "Bulk_RNA_in_vitro/in_vitro_results/intersect_up_fibro_bone_brown_epi_adipose_liver_lung_mesentery_omentum_tissues.csv")

intersect_bone_ba_edi_liver_lung_mesentery_omentum_pancreas_up <- intersect(intersect_bone_ba_edi_liver_lung_mesentery_omentum_up, diff_fibro_up_pancreas$gene_name)
write.csv(intersect_bone_ba_edi_liver_lung_mesentery_omentum_pancreas_up, "Bulk_RNA_in_vitro/in_vitro_results/intersect_up_fibro_bone_brown_epi_adipose_liver_lung_mesentery_omentum_pancreas_tissues.csv")



intersect_bone_ba_edi_liver_lung_mesentery_omentum_pancreas_sLN_up <- intersect(intersect_bone_ba_edi_liver_lung_mesentery_omentum_pancreas_up, diff_fibro_up_sLN$gene_name)
write.csv(intersect_bone_ba_edi_liver_lung_mesentery_omentum_pancreas_sLN_up, "Bulk_RNA_in_vitro/in_vitro_results/intersect_up_fibro_all_tissues.csv", col.names = TRUE, row.names = FALSE)

























# Get receptors
icellnet_db <- read.csv("icelldb_mapped.csv")
cell_chat_db <- read.csv("CellChatDB_mouse.csv")
cell_chat_db[c("Ligand","R1_R2")] <- str_split_fixed(cell_chat_db$interaction_name_2, "-", 2)
receptors_cell_chat <- read.csv("Bulk_RNA_in_vitro/in_vitro_results/receptors_cellchat.csv") %>% rename("Receptor1" = "X", "Receptor2" = "X.1")


diff_fibro_receptors <- diff_genes_fibro %>% filter(gene_name %in% receptors_cell_chat$Receptor1 | gene_name %in% receptors_cell_chat$Receptor2 | gene_name %in% icellnet_db$Receptor.1 | gene_name %in% icellnet_db$Receptor.2 | gene_name %in% icellnet_db$Receptor.3)

write.csv(diff_fibro_receptors, "Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_receptors_concat.csv", row.names=FALSE, col.names=TRUE)


# receptors up
diff_fibro_receptors_up <- diff_fibro_receptors %>% filter(group == "up")
write.csv(diff_fibro_receptors_up, "Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_receptors_concat_up.csv", row.names=FALSE, col.names=TRUE)

diff_fibro_receptors_up_bone <- diff_fibro_receptors_up %>% filter(sampling_tissue == "Bone") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_receptors_concat_up_bone.csv", row.names=FALSE, col.names=TRUE) 

diff_fibro_receptors_up_liver <- diff_fibro_receptors_up %>% filter(sampling_tissue == "Liver") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_receptors_concat_up_liver.csv", row.names=FALSE, col.names=TRUE) 

diff_fibro_receptors_up_lung <- diff_fibro_receptors_up %>% filter(sampling_tissue == "Lung") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_receptors_concat_up_lung.csv", row.names=FALSE, col.names=TRUE)  

diff_fibro_receptors_up_ba <- diff_fibro_receptors_up %>% filter(sampling_tissue == "Brown_adipose") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_receptors_concat_up_ba.csv", row.names=FALSE, col.names=TRUE)
  
diff_fibro_receptors_up_mesentery <- diff_fibro_receptors_up %>% filter(sampling_tissue == "Mesentery") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_receptors_concat_up_mesentery.csv", row.names=FALSE, col.names=TRUE)

diff_fibro_receptors_up_omentum <- diff_fibro_receptors_up %>% filter(sampling_tissue == "Omentum") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_receptors_concat_up_omentum.csv", row.names=FALSE, col.names=TRUE)

diff_fibro_receptors_up_pancreas <- diff_fibro_receptors_up %>% filter(sampling_tissue == "Pancreas") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_receptors_concat_up_pancreas.csv", row.names=FALSE, col.names=TRUE)

diff_fibro_receptors_up_epi_adi <- diff_fibro_receptors_up %>% filter(sampling_tissue == "Epi_adipose") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_receptors_concat_up_epi_adi.csv", row.names=FALSE, col.names=TRUE)

diff_fibro_receptors_up_sLN <- diff_fibro_receptors_up %>% filter(sampling_tissue == "sLN") %>% arrange(desc(logFC)) %>% write.csv("Bulk_RNA_in_vitro/in_vitro_results/diff_fibro_receptors_concat_up_sLN.csv", row.names=FALSE, col.names=TRUE)


library(ggvenn)
#receptors_up_overlap <- list(bone = diff_fibro_receptors_up_bone$gene_name, lung = diff_fibro_receptors_up_lung$gene_name, liver = diff_fibro_receptors_up_liver$gene_name, brown_adip = diff_fibro_receptors_up_ba$gene_name, mesentery = diff_fibro_receptors_up_mesentery$gene_name)
#ggvenn(receptors_up_overlap)



intersect_bone_ba_up <- intersect(diff_fibro_up_bone$gene_name, diff_fibro_up_ba$gene_name)
write.csv(intersect_bone_ba_up, "Bulk_RNA_in_vitro/in_vitro_results/intersect_up_fibro_bone_brown_adipose_tissues.csv")

intersect_bone_ba_edi_up <- intersect(intersect_bone_ba_up, diff_fibro_up_epi_adi$gene_name)
write.csv(intersect_bone_ba_edi_up, "Bulk_RNA_in_vitro/in_vitro_results/intersect_up_fibro_bone_brown_epi_adipose_tissues.csv")

intersect_bone_ba_edi_liver_up <- intersect(intersect_bone_ba_edi_up, diff_fibro_up_liver$gene_name)
write.csv(intersect_bone_ba_edi_liver_up, "Bulk_RNA_in_vitro/in_vitro_results/intersect_up_fibro_bone_brown_epi_adipose_liver_tissues.csv")


intersect_bone_ba_edi_liver_lung_up <- intersect(intersect_bone_ba_edi_liver_up, diff_fibro_up_lung$gene_name)
write.csv(intersect_bone_ba_edi_liver_lung_up, "Bulk_RNA_in_vitro/in_vitro_results/intersect_up_fibro_bone_brown_epi_adipose_liver_lung_tissues.csv")


intersect_bone_ba_edi_liver_lung_mesentery_up <- intersect(intersect_bone_ba_edi_liver_lung_up, diff_fibro_up_mesentery$gene_name)
write.csv(intersect_bone_ba_edi_liver_lung_mesentery_up, "Bulk_RNA_in_vitro/in_vitro_results/intersect_up_fibro_bone_brown_epi_adipose_liver_lung_mesentery_tissues.csv")


intersect_bone_ba_edi_liver_lung_mesentery_omentum_up <- intersect(intersect_bone_ba_edi_liver_lung_mesentery_up, diff_fibro_up_omentum$gene_name)
write.csv(intersect_bone_ba_edi_liver_lung_mesentery_omentum_up, "Bulk_RNA_in_vitro/in_vitro_results/intersect_up_fibro_bone_brown_epi_adipose_liver_lung_mesentery_omentum_tissues.csv")

intersect_bone_ba_edi_liver_lung_mesentery_omentum_pancreas_up <- intersect(intersect_bone_ba_edi_liver_lung_mesentery_omentum_up, diff_fibro_up_pancreas$gene_name)
write.csv(intersect_bone_ba_edi_liver_lung_mesentery_omentum_pancreas_up, "Bulk_RNA_in_vitro/in_vitro_results/intersect_up_fibro_bone_brown_epi_adipose_liver_lung_mesentery_omentum_pancreas_tissues.csv")



intersect_bone_ba_edi_liver_lung_mesentery_omentum_pancreas_sLN_up <- intersect(intersect_bone_ba_edi_liver_lung_mesentery_omentum_pancreas_up, diff_fibro_up_sLN$gene_name)
write.csv(intersect_bone_ba_edi_liver_lung_mesentery_omentum_pancreas_sLN_up, "Bulk_RNA_in_vitro/in_vitro_results/intersect_up_fibro_all_tissues.csv")




# receptors down
diff_fibro_receptors_down <- diff_fibro_receptors %>% filter(grodown == "down")

diff_fibro_receptors_down_bone <- diff_fibro_receptors_down %>% filter(sampling_tissue == "Bone") %>% arrange(desc(logFC))
diff_fibro_receptors_down_liver <- diff_fibro_receptors_down %>% filter(sampling_tissue == "Liver") %>% arrange(desc(logFC))
diff_fibro_receptors_down_lung <- diff_fibro_receptors_down %>% filter(sampling_tissue == "Lung") %>% arrange(desc(logFC))
diff_fibro_receptors_down_ba <- diff_fibro_receptors_down %>% filter(sampling_tissue == "Brown_adipose") %>% arrange(desc(logFC))
diff_fibro_receptors_down_mesentery <- diff_fibro_receptors_down %>% filter(sampling_tissue == "Mesentery") %>% arrange(desc(logFC))
diff_fibro_receptors_down_omentum <- diff_fibro_receptors_down %>% filter(sampling_tissue == "Omentum") %>% arrange(desc(logFC))
diff_fibro_receptors_down_pancreas <- diff_fibro_receptors_down %>% filter(sampling_tissue == "Pancreas") %>% arrange(desc(logFC))
diff_fibro_receptors_down_epi_adi <- diff_fibro_receptors_down %>% filter(sampling_tissue == "Epi_adipose") %>% arrange(desc(logFC))
diff_fibro_receptors_down_sLN <- diff_fibro_receptors_down %>% filter(sampling_tissue == "sLN") %>% arrange(desc(logFC))


library(ggvenn)
receptors_down_overlap <- list(bone = diff_fibro_receptors_down_bone$gene_name, lung = diff_fibro_receptors_down_lung$gene_name, liver = diff_fibro_receptors_down_liver$gene_name, brown_adip = diff_fibro_receptors_down_ba$gene_name, mesentery = diff_fibro_receptors_down_mesentery$gene_name)
ggvenn(receptors_down_overlap)



intersect_bone_ba_down <- intersect(diff_fibro_receptors_down_bone$gene_name, diff_fibro_receptors_down_ba$gene_name)

intersect_bone_ba_edi_down <- intersect(intersect_bone_ba_down, diff_fibro_receptors_down_epi_adi$gene_name)

intersect_bone_ba_edi_liver_down <- intersect(intersect_bone_ba_edi_down, diff_fibro_receptors_down_liver$gene_name)

intersect_bone_ba_edi_liver_lung_down <- intersect(intersect_bone_ba_edi_liver_down, diff_fibro_receptors_down_lung$gene_name)

intersect_bone_ba_edi_liver_lung_mesentery_down <- intersect(intersect_bone_ba_edi_liver_lung_down, diff_fibro_receptors_down_mesentery$gene_name)

intersect_bone_ba_edi_liver_lung_mesentery_omentum_down <- intersect(intersect_bone_ba_edi_liver_lung_mesentery_down, diff_fibro_receptors_down_omentum$gene_name)

intersect_bone_ba_edi_liver_lung_mesentery_omentum_pancreas_down <- intersect(intersect_bone_ba_edi_liver_lung_mesentery_omentum_down, diff_fibro_receptors_down_pancreas$gene_name)

intersect_bone_ba_edi_liver_lung_mesentery_omentum_pancreas_sLN_down <- intersect(intersect_bone_ba_edi_liver_lung_mesentery_omentum_pancreas_down, diff_fibro_receptors_down_sLN$gene_name)


```


# Overlap enriched terms in vivo/in vitro

## GO

```{r}
overlap_in_vitro_in_vivo_go <- function(enriched_terms_up_in_vitro_filename, 
                                     enriched_terms_up_in_vivo_filename,                               
                                     enriched_terms_up_overlap_in_vitro_in_vivo_filename, 
                                     enriched_terms_up_in_vitro_overlap_filename, 
                                     enriched_terms_up_in_vivo_overlap_filename, 
                                     overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_filename){
  
  
  enriched_terms_up_in_vitro <- read.csv(enriched_terms_up_in_vitro_filename)
  enriched_terms_up_in_vivo <- read.csv(enriched_terms_up_in_vivo_filename)
  
  
  overlap_enriched_terms_in_vitro_vivo <- intersect(enriched_terms_up_in_vitro$Biological_Processes, enriched_terms_up_in_vivo$Biological_Processes)
  
  
  if (length(overlap_enriched_terms_in_vitro_vivo) > 0){
    
    write.csv(overlap_enriched_terms_in_vitro_vivo, enriched_terms_up_overlap_in_vitro_in_vivo_filename)
    
    enriched_terms_in_vitro_overlap <- enriched_terms_up_in_vitro %>% filter(Biological_Processes %in% overlap_enriched_terms_in_vitro_vivo) %>% arrange(desc(Count))
    
    write.csv(enriched_terms_in_vitro_overlap, enriched_terms_up_in_vitro_overlap_filename, row.names = FALSE, col.names = TRUE)
    
    for (i in 1:dim(enriched_terms_in_vitro_overlap)[1]) {
      enriched_terms_in_vitro_overlap$geneID[i] <- str_split(gsub("/"," ", enriched_terms_in_vitro_overlap$geneID[i]), " ") 
}
    
    
    
    enriched_terms_in_vivo_overlap <- enriched_terms_up_in_vivo %>% filter(Biological_Processes %in% overlap_enriched_terms_in_vitro_vivo) %>% arrange(desc(Count))
    
    write.csv(enriched_terms_in_vivo_overlap, enriched_terms_up_in_vivo_overlap_filename, row.names = FALSE, col.names = TRUE)
    
    for (i in 1:dim(enriched_terms_in_vivo_overlap)[1]) {
      enriched_terms_in_vivo_overlap$geneID[i] <- str_split(gsub("/"," ", enriched_terms_in_vivo_overlap$geneID[i]), " ")
      }
    
    enriched_terms_in_vitro_in_vivo_overlap_joined <- inner_join(enriched_terms_in_vitro_overlap, enriched_terms_in_vivo_overlap, by="Biological_Processes")
    
    
    overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo <- as.data.frame(matrix(nrow = 0, ncol = 2))
    colnames(overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo) <- c("overlap_enriched_BP", "overlap_genes")
    for (i in 1:dim(enriched_terms_in_vitro_in_vivo_overlap_joined)[1]){
      if (length(intersect(enriched_terms_in_vitro_in_vivo_overlap_joined$geneID.x[i] %>% unlist(), enriched_terms_in_vitro_in_vivo_overlap_joined$geneID.y[i] %>% unlist())) > 0){
        overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo <-
          rbind(overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo, data.frame(overlap_enriched_BP = enriched_terms_in_vitro_in_vivo_overlap_joined$Biological_Processes[i], overlap_genes = intersect(enriched_terms_in_vitro_in_vivo_overlap_joined$geneID.x[i] %>% unlist(), enriched_terms_in_vitro_in_vivo_overlap_joined$geneID.y[i] %>% unlist())))
      }
    }
    if (dim(overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo)[1] != 0){
      overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo <- overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo %>% group_by(overlap_enriched_BP)%>% dplyr::mutate(overlap_genes = paste0(overlap_genes, collapse = ",")) %>% distinct() %>% as.data.frame()
      write.csv(overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo, overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_filename, col.names = TRUE, row.names = FALSE)
    }
    
    
  }
  
}
```



```{r}

upset_plots_overlap_enriched_terms <- function(filenames, upset_plot_filename){
  
  library(UpSetR)
  list_overlap_enriched_terms <- lapply(filenames, function(x){
    read.csv(x)$Description
  })
  names(list_overlap_enriched_terms) <- names(filenames)
  
  png(upset_plot_filename, width=3000, height=1000)
  print(UpSetR::upset(fromList(list_overlap_enriched_terms),  matrix.color = "gray29", point.size = 5, order.by = "freq", text.scale = 2, sets.bar.color = "gray29", main.bar.color = "gray29", nsets = 8))
  dev.off()
  
}
```



### MTX

```{r}
#### 3h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")



#### 6h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")




#### 12h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")




#### 18h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


```



### OXA
```{r}

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D22) vs PBS(D22)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_3h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D22_df.csv")


#### 6h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D22) vs PBS(D22)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_6h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D22_df.csv")


#### 12h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D22) vs PBS(D22)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_12h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D22_df.csv")



#### 18h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D22) vs PBS(D22)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_18h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D22_df.csv")


#### 24h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D22) vs PBS(D22)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_24h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D22_df.csv")
```


### Cis
```{r}

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")



#### 6h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")




#### 12h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")






#### 18h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")





#### 24h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")
```






```{r}

# MTX

# 24h
upset_plots_overlap_enriched_terms(
  c(MTX_24h_vs_Control_24h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_up_genes.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D3) vs PBS(D3)_up_genes.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D10) vs PBS(D10)_up_genes.csv"),
    upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/Upset plots/upset_MTX_24h_D3_D10.png")


# 18h
upset_plots_overlap_enriched_terms(
  c(MTX_18h_vs_Control_18h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_up_genes.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D3) vs PBS(D3)_up_genes.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/Upset plots/upset_MTX_18h_D3_D10.png")



# 12h
upset_plots_overlap_enriched_terms(
  c(MTX_12h_vs_Control_12h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_up_genes.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D3) vs PBS(D3)_up_genes.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/Upset plots/upset_MTX_12h_D3_D10.png")



# 6h
upset_plots_overlap_enriched_terms(
  c(MTX_6h_vs_Control_6h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_up_genes.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D3) vs PBS(D3)_up_genes.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/Upset plots/upset_MTX_6h_D3_D10.png")


# 3h
upset_plots_overlap_enriched_terms(
  c(MTX_3h_vs_Control_3h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_up_genes.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D3) vs PBS(D3)_up_genes.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_MTX(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/Upset plots/upset_MTX_3h_D3_D10.png")


# Oxa

# 24h
upset_plots_overlap_enriched_terms(
  c(Oxa_24h_vs_Control_24h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_up_genes.csv",
    Oxa_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D3) vs PBS(D3)_up_genes.csv",
    Oxa_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D10) vs PBS(D10)_up_genes.csv"),
    upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/Upset plots/upset_Oxa_24h_D3_D10.png")


# 18h
upset_plots_overlap_enriched_terms(
  c(Oxa_18h_vs_Control_18h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_up_genes.csv",
    Oxa_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D3) vs PBS(D3)_up_genes.csv",
    Oxa_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/Upset plots/upset_Oxa_18h_D3_D10.png")



# 12h
upset_plots_overlap_enriched_terms(
  c(Oxa_12h_vs_Control_12h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_up_genes.csv",
    Oxa_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D3) vs PBS(D3)_up_genes.csv",
    Oxa_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/Upset plots/upset_Oxa_12h_D3_D10.png")



# 6h
upset_plots_overlap_enriched_terms(
  c(Oxa_6h_vs_Control_6h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_up_genes.csv",
    Oxa_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D3) vs PBS(D3)_up_genes.csv",
    Oxa_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/Upset plots/upset_Oxa_6h_D3_D10.png")


# 3h
upset_plots_overlap_enriched_terms(
  c(Oxa_3h_vs_Control_3h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_up_genes.csv",
    Oxa_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D3) vs PBS(D3)_up_genes.csv",
    Oxa_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Oxa(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/Upset plots/upset_Oxa_3h_D3_D10.png")


# Cis

# 24h
upset_plots_overlap_enriched_terms(
  c(Cis_24h_vs_Control_24h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_up_genes.csv",
    Cis_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D3) vs PBS(D3)_up_genes.csv",
    Cis_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D10) vs PBS(D10)_up_genes.csv"),
    upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/Upset plots/upset_Cis_24h_D3_D10.png")


# 18h
upset_plots_overlap_enriched_terms(
  c(Cis_18h_vs_Control_18h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_up_genes.csv",
    Cis_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D3) vs PBS(D3)_up_genes.csv",
    Cis_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/Upset plots/upset_Cis_18h_D3_D10.png")



# 12h
upset_plots_overlap_enriched_terms(
  c(Cis_12h_vs_Control_12h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_up_genes.csv",
    Cis_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D3) vs PBS(D3)_up_genes.csv",
    Cis_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/Upset plots/upset_Cis_12h_D3_D10.png")



# 6h
upset_plots_overlap_enriched_terms(
  c(Cis_6h_vs_Control_6h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_up_genes.csv",
    Cis_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D3) vs PBS(D3)_up_genes.csv",
    Cis_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/Upset plots/upset_Cis_6h_D3_D10.png")


# 3h
upset_plots_overlap_enriched_terms(
  c(Cis_3h_vs_Control_3h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_up_genes.csv",
    Cis_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D3) vs PBS(D3)_up_genes.csv",
    Cis_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_go_terms_Cis(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/Upset plots/upset_Cis_3h_D3_D10.png")

```








## Reactome


```{r}
overlap_in_vitro_in_vivo_reactome <- function(enriched_terms_up_in_vitro_filename, 
                                     enriched_terms_up_in_vivo_filename,                               
                                     enriched_terms_up_overlap_in_vitro_in_vivo_filename, 
                                     enriched_terms_up_in_vitro_overlap_filename, 
                                     enriched_terms_up_in_vivo_overlap_filename, 
                                     overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_filename){
  
  
  enriched_terms_up_in_vitro <- read.csv(enriched_terms_up_in_vitro_filename)
  enriched_terms_up_in_vivo <- read.csv(enriched_terms_up_in_vivo_filename)
  
  
  overlap_enriched_terms_in_vitro_vivo <- intersect(enriched_terms_up_in_vitro$Reactome_Pathway, enriched_terms_up_in_vivo$Reactome_Pathway)
  
  
  if (length(overlap_enriched_terms_in_vitro_vivo) > 0){
    
    write.csv(overlap_enriched_terms_in_vitro_vivo, enriched_terms_up_overlap_in_vitro_in_vivo_filename)
    
    enriched_terms_in_vitro_overlap <- enriched_terms_up_in_vitro %>% filter(Reactome_Pathway %in% overlap_enriched_terms_in_vitro_vivo) %>% arrange(desc(Count))
    
    write.csv(enriched_terms_in_vitro_overlap, enriched_terms_up_in_vitro_overlap_filename, row.names = FALSE, col.names = TRUE)
    
    for (i in 1:dim(enriched_terms_in_vitro_overlap)[1]) {
      enriched_terms_in_vitro_overlap$geneID[i] <- str_split(gsub("/"," ", enriched_terms_in_vitro_overlap$geneID[i]), " ") 
}
    
    
    
    enriched_terms_in_vivo_overlap <- enriched_terms_up_in_vivo %>% filter(Reactome_Pathway %in% overlap_enriched_terms_in_vitro_vivo) %>% arrange(desc(Count))
    
    write.csv(enriched_terms_in_vivo_overlap, enriched_terms_up_in_vivo_overlap_filename, row.names = FALSE, col.names = TRUE)
    
    for (i in 1:dim(enriched_terms_in_vivo_overlap)[1]) {
      enriched_terms_in_vivo_overlap$geneID[i] <- str_split(gsub("/"," ", enriched_terms_in_vivo_overlap$geneID[i]), " ")
      }
    
    enriched_terms_in_vitro_in_vivo_overlap_joined <- inner_join(enriched_terms_in_vitro_overlap, enriched_terms_in_vivo_overlap, by="Reactome_Pathway")
    
    
    overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo <- as.data.frame(matrix(nrow = 0, ncol = 2))
    colnames(overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo) <- c("overlap_enriched_RP", "overlap_genes")
    for (i in 1:dim(enriched_terms_in_vitro_in_vivo_overlap_joined)[1]){
      if (length(intersect(enriched_terms_in_vitro_in_vivo_overlap_joined$geneID.x[i] %>% unlist(), enriched_terms_in_vitro_in_vivo_overlap_joined$geneID.y[i] %>% unlist())) > 0){
        overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo <-
          rbind(overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo, data.frame(overlap_enriched_BP = enriched_terms_in_vitro_in_vivo_overlap_joined$Reactome_Pathway[i], overlap_genes = intersect(enriched_terms_in_vitro_in_vivo_overlap_joined$geneID.x[i] %>% unlist(), enriched_terms_in_vitro_in_vivo_overlap_joined$geneID.y[i] %>% unlist())))
      }
    }
    if (dim(overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo)[1] != 0){
      overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo <- overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo %>% group_by(overlap_enriched_BP)%>% dplyr::mutate(overlap_genes = paste0(overlap_genes, collapse = ",")) %>% distinct() %>% as.data.frame()
      write.csv(overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo, overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_filename, col.names = TRUE, row.names = FALSE)
    }
    
    
  }
  
}
```


### MTX
```{r}

#### 3h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")



#### 6h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")



#### 12h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")



#### 18h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")


#### 24h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")
```



### OXA
```{r}

#### 3h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D22) vs PBS(D22)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D22_df.csv")



#### 6h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D22) vs PBS(D22)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D22_df.csv")


#### 12h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D22) vs PBS(D22)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D22_df.csv")


#### 18h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D22) vs PBS(D22)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D22_df.csv")



#### 24h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D22) vs PBS(D22)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D22_df.csv")
```





### Cis

```{r}
#### 3h
overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")


#### 6h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")


#### 12h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")


#### 18h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")


#### 24h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")

```





```{r}

# MTX

# 24h
upset_plots_overlap_enriched_terms(
  c(MTX_24h_vs_Control_24h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_up_genes.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D3) vs PBS(D3)_up_genes.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D10) vs PBS(D10)_up_genes.csv"),
    upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/Upset plots/upset_MTX_24h_D3_D10.png")


# 18h
upset_plots_overlap_enriched_terms(
  c(MTX_18h_vs_Control_18h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_up_genes.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D3) vs PBS(D3)_up_genes.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/Upset plots/upset_MTX_18h_D3_D10.png")



# 12h
upset_plots_overlap_enriched_terms(
  c(MTX_12h_vs_Control_12h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_up_genes.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D3) vs PBS(D3)_up_genes.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/Upset plots/upset_MTX_12h_D3_D10.png")



# 6h
upset_plots_overlap_enriched_terms(
  c(MTX_6h_vs_Control_6h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_up_genes.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D3) vs PBS(D3)_up_genes.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/Upset plots/upset_MTX_6h_D3_D10.png")


# 3h
upset_plots_overlap_enriched_terms(
  c(MTX_3h_vs_Control_3h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_up_genes.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D3) vs PBS(D3)_up_genes.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_MTX(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/Upset plots/upset_MTX_3h_D3_D10.png")


# Oxa

# 24h
upset_plots_overlap_enriched_terms(
  c(Oxa_24h_vs_Control_24h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_up_genes.csv",
    Oxa_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D3) vs PBS(D3)_up_genes.csv",
    Oxa_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D10) vs PBS(D10)_up_genes.csv",
    Oxa_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D22) vs PBS(D22)_up_genes.csv"),
    upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/Upset plots/upset_Oxa_24h_D3_D10.png")


# 18h
upset_plots_overlap_enriched_terms(
  c(Oxa_18h_vs_Control_18h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_up_genes.csv",
    Oxa_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D3) vs PBS(D3)_up_genes.csv",
    Oxa_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D10) vs PBS(D10)_up_genes.csv",
    Oxa_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D22) vs PBS(D22)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/Upset plots/upset_Oxa_18h_D3_D10.png")



# 12h
upset_plots_overlap_enriched_terms(
  c(Oxa_12h_vs_Control_12h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_up_genes.csv",
    Oxa_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D3) vs PBS(D3)_up_genes.csv",
    Oxa_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D10) vs PBS(D10)_up_genes.csv",
    Oxa_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D22) vs PBS(D22)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/Upset plots/upset_Oxa_12h_D3_D10.png")



# 6h
upset_plots_overlap_enriched_terms(
  c(Oxa_6h_vs_Control_6h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_up_genes.csv",
    Oxa_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D3) vs PBS(D3)_up_genes.csv",
    Oxa_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D10) vs PBS(D10)_up_genes.csv",
    Oxa_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D22) vs PBS(D22)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/Upset plots/upset_Oxa_6h_D3_D10.png")


# 3h
upset_plots_overlap_enriched_terms(
  c(Oxa_3h_vs_Control_3h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_up_genes.csv",
    Oxa_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D3) vs PBS(D3)_up_genes.csv",
    Oxa_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D10) vs PBS(D10)_up_genes.csv",
    Oxa_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Oxa(D22) vs PBS(D22)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/Upset plots/upset_Oxa_3h_D3_D10.png")


# Cis

# 24h
upset_plots_overlap_enriched_terms(
  c(Cis_24h_vs_Control_24h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_up_genes.csv",
    Cis_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D3) vs PBS(D3)_up_genes.csv",
    Cis_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D10) vs PBS(D10)_up_genes.csv"),
    upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/Upset plots/upset_Cis_24h_D3_D10.png")


# 18h
upset_plots_overlap_enriched_terms(
  c(Cis_18h_vs_Control_18h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_up_genes.csv",
    Cis_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D3) vs PBS(D3)_up_genes.csv",
    Cis_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/Upset plots/upset_Cis_18h_D3_D10.png")



# 12h
upset_plots_overlap_enriched_terms(
  c(Cis_12h_vs_Control_12h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_up_genes.csv",
    Cis_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D3) vs PBS(D3)_up_genes.csv",
    Cis_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/Upset plots/upset_Cis_12h_D3_D10.png")



# 6h
upset_plots_overlap_enriched_terms(
  c(Cis_6h_vs_Control_6h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_up_genes.csv",
    Cis_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D3) vs PBS(D3)_up_genes.csv",
    Cis_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/Upset plots/upset_Cis_6h_D3_D10.png")


# 3h
upset_plots_overlap_enriched_terms(
  c(Cis_3h_vs_Control_3h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_up_genes.csv",
    Cis_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D3) vs PBS(D3)_up_genes.csv",
    Cis_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_Reactome_terms_Cis(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/Upset plots/upset_Cis_3h_D3_D10.png")

```









## Kegg


```{r}
overlap_in_vitro_in_vivo_Kegg <- function(enriched_terms_up_in_vitro_filename, 
                                     enriched_terms_up_in_vivo_filename,                               
                                     enriched_terms_up_overlap_in_vitro_in_vivo_filename, 
                                     enriched_terms_up_in_vitro_overlap_filename, 
                                     enriched_terms_up_in_vivo_overlap_filename, 
                                     overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_filename){
  
  
  enriched_terms_up_in_vitro <- read.csv(enriched_terms_up_in_vitro_filename)
  enriched_terms_up_in_vivo <- read.csv(enriched_terms_up_in_vivo_filename)
  
  
  overlap_enriched_terms_in_vitro_vivo <- intersect(enriched_terms_up_in_vitro$Kegg_Pathway, enriched_terms_up_in_vivo$Kegg_Pathway)
  
  
  if (length(overlap_enriched_terms_in_vitro_vivo) > 0){
    
    write.csv(overlap_enriched_terms_in_vitro_vivo, enriched_terms_up_overlap_in_vitro_in_vivo_filename)
    
    enriched_terms_in_vitro_overlap <- enriched_terms_up_in_vitro %>% filter(Kegg_Pathway %in% overlap_enriched_terms_in_vitro_vivo) %>% arrange(desc(Count))
    
    write.csv(enriched_terms_in_vitro_overlap, enriched_terms_up_in_vitro_overlap_filename, row.names = FALSE, col.names = TRUE)
    
    for (i in 1:dim(enriched_terms_in_vitro_overlap)[1]) {
      enriched_terms_in_vitro_overlap$geneID[i] <- str_split(gsub("/"," ", enriched_terms_in_vitro_overlap$geneID[i]), " ") 
}
    
    
    
    enriched_terms_in_vivo_overlap <- enriched_terms_up_in_vivo %>% filter(Kegg_Pathway %in% overlap_enriched_terms_in_vitro_vivo) %>% arrange(desc(Count))
    
    write.csv(enriched_terms_in_vivo_overlap, enriched_terms_up_in_vivo_overlap_filename, row.names = FALSE, col.names = TRUE)
    
    for (i in 1:dim(enriched_terms_in_vivo_overlap)[1]) {
      enriched_terms_in_vivo_overlap$geneID[i] <- str_split(gsub("/"," ", enriched_terms_in_vivo_overlap$geneID[i]), " ")
      }
    
    enriched_terms_in_vitro_in_vivo_overlap_joined <- inner_join(enriched_terms_in_vitro_overlap, enriched_terms_in_vivo_overlap, by="Kegg_Pathway")
    
    
    overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo <- as.data.frame(matrix(nrow = 0, ncol = 2))
    colnames(overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo) <- c("overlap_enriched_RP", "overlap_genes")
    for (i in 1:dim(enriched_terms_in_vitro_in_vivo_overlap_joined)[1]){
      if (length(intersect(enriched_terms_in_vitro_in_vivo_overlap_joined$geneID.x[i] %>% unlist(), enriched_terms_in_vitro_in_vivo_overlap_joined$geneID.y[i] %>% unlist())) > 0){
        overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo <-
          rbind(overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo, data.frame(overlap_enriched_BP = enriched_terms_in_vitro_in_vivo_overlap_joined$Kegg_Pathway[i], overlap_genes = intersect(enriched_terms_in_vitro_in_vivo_overlap_joined$geneID.x[i] %>% unlist(), enriched_terms_in_vitro_in_vivo_overlap_joined$geneID.y[i] %>% unlist())))
      }
    }
    if (dim(overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo)[1] != 0){
      overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo <- overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo %>% group_by(overlap_enriched_BP)%>% dplyr::mutate(overlap_genes = paste0(overlap_genes, collapse = ",")) %>% distinct() %>% as.data.frame()
      write.csv(overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo, overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_filename, col.names = TRUE, row.names = FALSE)
    }
    
    
  }
  
}
```


### MTX
```{r}

#### 3h

overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/3h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/3h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/3h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/3h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/3h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/3h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/3h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/3h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")


#### 6h

overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/6h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/6h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/6h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/6h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/6h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/6h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/6h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/6h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")



#### 12h

overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/12h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/12h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/12h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/12h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/12h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/12h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/12h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/12h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")



#### 18h

overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/18h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/18h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/18h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/18h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/18h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/18h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/18h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/18h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")


#### 24h

overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/24h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/24h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/24h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/24h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/24h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/24h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/24h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/24h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")
```



### OXA
```{r}

#### 3h

overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/3h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/3h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/3h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/3h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/3h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/3h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/3h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/3h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")


#### 6h

overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/6h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/6h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/6h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/6h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/6h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/6h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/6h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/6h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")


#### 12h

overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/12h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/12h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/12h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/12h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/12h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/12h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/12h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/12h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")


#### 18h

overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/18h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/18h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/18h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/18h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/18h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/18h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/18h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/18h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")



#### 24h

overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/24h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/24h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/24h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/24h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/24h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/24h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/24h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/24h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")
```





### Cis

```{r}
#### 3h
overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/3h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/3h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/3h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/3h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/3h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/3h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/3h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/3h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")


#### 6h

overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/6h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/6h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/6h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/6h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/6h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/6h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/6h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/6h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")


#### 12h

overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/12h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/12h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/12h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/12h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/12h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/12h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/12h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/12h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")


#### 18h

overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/18h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/18h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/18h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/18h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/18h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/18h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/18h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/18h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")


#### 24h

overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D3) vs PBS(D3)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/24h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/24h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/24h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/24h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_Kegg("Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_up_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D10) vs PBS(D10)_up_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/24h_vs_D3+D10/enriched_terms_up_overlap_in_vitro_in_vivo_Kegg_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/24h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/24h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/24h_vs_D3+D10/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")

```




```{r}

# MTX

# 24h
upset_plots_overlap_enriched_terms(
  c(MTX_24h_vs_Control_24h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_up_genes.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_genes.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_genes.csv"),
    upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/Upset plots/upset_MTX_24h_D3_D10.png")


# 18h
upset_plots_overlap_enriched_terms(
  c(MTX_18h_vs_Control_18h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_up_genes.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_genes.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/Upset plots/upset_MTX_18h_D3_D10.png")



# 12h
upset_plots_overlap_enriched_terms(
  c(MTX_12h_vs_Control_12h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_up_genes.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_genes.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/Upset plots/upset_MTX_12h_D3_D10.png")



# 6h
upset_plots_overlap_enriched_terms(
  c(MTX_6h_vs_Control_6h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_up_genes.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_genes.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/Upset plots/upset_MTX_6h_D3_D10.png")


# 3h
upset_plots_overlap_enriched_terms(
  c(MTX_3h_vs_Control_3h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_up_genes.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_genes.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/Upset plots/upset_MTX_3h_D3_D10.png")


# Oxa

# 24h
upset_plots_overlap_enriched_terms(
  c(Oxa_24h_vs_Control_24h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_up_genes.csv",
    Oxa_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D3) vs PBS(D3)_up_genes.csv",
    Oxa_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D10) vs PBS(D10)_up_genes.csv",
    Oxa_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D22) vs PBS(D22)_up_genes.csv"),
    upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/Upset plots/upset_Oxa_24h_D3_D10.png")


# 18h
upset_plots_overlap_enriched_terms(
  c(Oxa_18h_vs_Control_18h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_up_genes.csv",
    Oxa_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D3) vs PBS(D3)_up_genes.csv",
    Oxa_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D10) vs PBS(D10)_up_genes.csv",
    Oxa_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D22) vs PBS(D22)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/Upset plots/upset_Oxa_18h_D3_D10.png")



# 12h
upset_plots_overlap_enriched_terms(
  c(Oxa_12h_vs_Control_12h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_up_genes.csv",
    Oxa_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D3) vs PBS(D3)_up_genes.csv",
    Oxa_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D10) vs PBS(D10)_up_genes.csv",
    Oxa_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D22) vs PBS(D22)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/Upset plots/upset_Oxa_12h_D3_D10.png")



# 6h
upset_plots_overlap_enriched_terms(
  c(Oxa_6h_vs_Control_6h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_up_genes.csv",
    Oxa_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D3) vs PBS(D3)_up_genes.csv",
    Oxa_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D10) vs PBS(D10)_up_genes.csv",
    Oxa_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D22) vs PBS(D22)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/Upset plots/upset_Oxa_6h_D3_D10.png")


# 3h
upset_plots_overlap_enriched_terms(
  c(Oxa_3h_vs_Control_3h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_up_genes.csv",
    Oxa_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D3) vs PBS(D3)_up_genes.csv",
    Oxa_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D10) vs PBS(D10)_up_genes.csv",
    Oxa_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Oxa(D22) vs PBS(D22)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/Upset plots/upset_Oxa_3h_D3_D10.png")


# Cis

# 24h
upset_plots_overlap_enriched_terms(
  c(Cis_24h_vs_Control_24h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_up_genes.csv",
    Cis_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D3) vs PBS(D3)_up_genes.csv",
    Cis_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D10) vs PBS(D10)_up_genes.csv"),
    upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/Upset plots/upset_Cis_24h_D3_D10.png")


# 18h
upset_plots_overlap_enriched_terms(
  c(Cis_18h_vs_Control_18h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_up_genes.csv",
    Cis_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D3) vs PBS(D3)_up_genes.csv",
    Cis_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/Upset plots/upset_Cis_18h_D3_D10.png")



# 12h
upset_plots_overlap_enriched_terms(
  c(Cis_12h_vs_Control_12h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_up_genes.csv",
    Cis_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D3) vs PBS(D3)_up_genes.csv",
    Cis_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/Upset plots/upset_Cis_12h_D3_D10.png")



# 6h
upset_plots_overlap_enriched_terms(
  c(Cis_6h_vs_Control_6h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_up_genes.csv",
    Cis_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D3) vs PBS(D3)_up_genes.csv",
    Cis_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/Upset plots/upset_Cis_6h_D3_D10.png")


# 3h
upset_plots_overlap_enriched_terms(
  c(Cis_3h_vs_Control_3h = "Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_up_genes.csv",
    Cis_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D3) vs PBS(D3)_up_genes.csv",
    Cis_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/enriched_kegg_terms_Cis(D10) vs PBS(D10)_up_genes.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/Upset plots/upset_Cis_3h_D3_D10.png")

```







## GSEA (go)

```{r}

# load annot file
library(rtracklayer)
gtf <- import("/data/annotations/pipelines/Mouse/mm10/gtf/gencode.vM22.annotation.gtf")
gtf_annot <- gtf %>% as_tibble() %>% filter(type == "gene") %>%  mutate(gene_id = str_remove(gene_id, "\\..*"))
annot_gene_mod_2 <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/preprocessing_in_vitro_RNA/results_pipeline/counts/tableannot.csv") %>% dplyr::select(gene_id, gene_name) %>% full_join(gtf_annot[, c("gene_id","gene_type")], by="gene_id")


library(clusterProfiler)
top_table_drug_control_in_vitro_MTX_24h_vs_Control_24h <- read.csv("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv") %>% filter(contrast == "MTX_24h_vs_Control_24h") %>% rename("gene_name" = "genes") %>% mutate(rank = sign(logFC) * -log10(adj.P.Val)) %>% arrange(desc(rank))
rownames(top_table_drug_control_in_vitro_MTX_24h_vs_Control_24h) <- make.names(top_table_drug_control_in_vitro_MTX_24h_vs_Control_24h$gene_name, unique=TRUE)
top_table_drug_control_in_vitro_MTX_24h_vs_Control_24h <- top_table_drug_control_in_vitro_MTX_24h_vs_Control_24h %>% select(-"gene_name")




# Retrieve gene list for gseGO
gene_list <- top_table_drug_control_in_vitro_MTX_24h_vs_Control_24h$rank
names(gene_list) <- rownames(top_table_drug_control_in_vitro_MTX_24h_vs_Control_24h)


# Run gseGO
gsea_MTX_24h_vs_Control_24h <- gseGO(gene_list, ont = "BP", OrgDb = "org.Mm.eg.db", keyType = "SYMBOL") 
gsea_MTX_24h_vs_Control_24h <- readRDS("gsea_results_MTX_24_vs_Control_24h.rds")


gsea_MTX_24h_vs_Control_24h_arranged <- gsea_MTX_24h_vs_Control_24h %>% as.data.frame() %>% filter(NES > 0) %>% arrange(desc(NES))


for (i in 1:dim(gsea_MTX_24h_vs_Control_24h_arranged)[1]) {
  gsea_MTX_24h_vs_Control_24h_arranged$core_enrichment[i] <- str_split(gsub("/"," ", gsea_MTX_24h_vs_Control_24h_arranged$core_enrichment[i]), " ")
}


# Intersection between enriched go terms from ORA and GSEA (in vitro - MTX_24h)
enriched_go_terms_MTX_24h_vs_Control_24h <- read.csv("Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_up_genes.csv")
intersect(enriched_go_terms_MTX_24h_vs_Control_24h$Description, gsea_MTX_24h_vs_Control_24h_arranged$Description)


```




```{r}
run_gsea <- function(top_table_filename, contrast_interest, drug_directory, root_interest){
  
  library(clusterProfiler)
  library(tidyverse)
  top_table_contrast_interest <- read.csv(top_table_filename) %>% filter(contrast == contrast_interest) %>% mutate(rank = sign(logFC) * -log10(adj.P.Val)) %>% arrange(desc(rank))
  gene_list_interest <- top_table_contrast_interest$rank
  names(gene_list_interest) <- top_table_contrast_interest$genes
  gsea_contrast_interest <- gseGO(gene_list_interest, ont = "BP", OrgDb = "org.Mm.eg.db", keyType = "SYMBOL", eps=0)
  gsea_contrast_interest_up_reg_pathways <- gsea_contrast_interest %>% as.data.frame() %>% filter(NES > 0 & p.adjust <= 0.05) %>% arrange(desc(NES))
  write.csv(gsea_contrast_interest_up_reg_pathways, paste0(root_interest,drug_directory,"/up_enriched_sets_gsea_",contrast_interest,".csv"), col.names = TRUE, row.names = TRUE)
  
  
  for (i in 1:dim(gsea_contrast_interest_up_reg_pathways)[1]) {
    
    gsea_contrast_interest_up_reg_pathways$core_enrichment[i] <- str_split(gsub("/"," ", gsea_contrast_interest_up_reg_pathways$core_enrichment[i]), " ")
  
    }
  
  
    
  leading_edge_ranked_genes <- data.frame(matrix(nrow = 0, ncol = 2))
  colnames(leading_edge_ranked_genes) <- c("leading_edge_genes_ranking_score", "leading_edge_genes_ranking_order")
   for (i in 1:dim(gsea_contrast_interest_up_reg_pathways)[1]) {
     leading_edge_ranked_genes <- rbind(leading_edge_ranked_genes, gene_list_interest[gsea_contrast_interest_up_reg_pathways$core_enrichment[i] %>% unlist()] %>% as.data.frame(row.names = names(gene_list[gsea_contrast_interest_up_reg_pathways$core_enrichment[i] %>% unlist()])) %>% mutate(leading_edge_genes_ranking_order = c(1:length(gsea_contrast_interest_up_reg_pathways$core_enrichment[i] %>% unlist()))) %>%  dplyr::rename("leading_edge_genes_ranking_score" = ".") %>% mutate("up_pathways" = rep(gsea_contrast_interest_up_reg_pathways$Description[i], length(gsea_contrast_interest_up_reg_pathways$core_enrichment[i]))))
   }
    
    write.csv(leading_edge_ranked_genes, paste0(root_interest,drug_directory,"/leading_edge_genes_up_enriched_sets_gsea_",contrast_interest,".csv"), col.names = TRUE, row.names = TRUE)
    
    }
  
  
  

```



```{r run_gsea_in_vitro_in_vivo}


# in vitro


# MTX vs Control
run_gsea("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_24h_vs_Control_24h", "MTX_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_18h_vs_Control_18h", "MTX_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_12h_vs_Control_12h", "MTX_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_6h_vs_Control_6h", "MTX_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_3h_vs_Control_3h", "MTX_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")


# OXA vs Control
run_gsea("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_24h_vs_Control_24h", "OXA_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_18h_vs_Control_18h", "OXA_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_12h_vs_Control_12h", "OXA_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_6h_vs_Control_6h", "OXA_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_3h_vs_Control_3h", "OXA_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")



# CIS vs Control
run_gsea("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_24h_vs_Control_24h", "CIS_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_18h_vs_Control_18h", "CIS_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_12h_vs_Control_12h", "CIS_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_6h_vs_Control_6h", "CIS_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_3h_vs_Control_3h", "CIS_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")




# in vivo

# MTX vs Control
run_gsea("top_table_in_vivo_for_Andrea.csv", "MTX_D3_vs_PBS_D3", "MTX_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")
run_gsea("top_table_in_vivo_for_Andrea.csv", "MTX_D10_vs_PBS_D10", "MTX_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")
run_gsea("top_table_in_vivo_for_Andrea.csv", "MTX_D22_vs_PBS_D22", "MTX_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")


# OXA vs Control
run_gsea("top_table_in_vivo_for_Andrea.csv", "OXA_D3_vs_PBS_D3", "OXA_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")
run_gsea("top_table_in_vivo_for_Andrea.csv", "OXA_D10_vs_PBS_D10", "OXA_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")
run_gsea("top_table_in_vivo_for_Andrea.csv", "OXA_D22_vs_PBS_D22", "OXA_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")


# CIS vs Control
run_gsea("top_table_in_vivo_for_Andrea.csv", "CIS_D3_vs_PBS_D3", "CIS_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")
run_gsea("top_table_in_vivo_for_Andrea.csv", "CIS_D10_vs_PBS_D10", "CIS_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")
run_gsea("top_table_in_vivo_for_Andrea.csv", "CIS_D22_vs_PBS_D22", "CIS_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")





```











```{r}
overlap_in_vitro_in_vivo_gsea_go <- function(enriched_terms_up_in_vitro_filename, 
                                     enriched_terms_up_in_vivo_filename,                               
                                     enriched_terms_up_overlap_in_vitro_in_vivo_filename, 
                                     enriched_terms_up_in_vitro_overlap_filename, 
                                     enriched_terms_up_in_vivo_overlap_filename, 
                                     overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_filename){
  
  library(tidyverse)
  enriched_terms_up_in_vitro <- read.csv(enriched_terms_up_in_vitro_filename)
  enriched_terms_up_in_vivo <- read.csv(enriched_terms_up_in_vivo_filename)
  
  
  overlap_enriched_terms_in_vitro_vivo <- intersect(enriched_terms_up_in_vitro$Description, enriched_terms_up_in_vivo$Description)
  
  
  if (length(overlap_enriched_terms_in_vitro_vivo) > 0){
    
    write.csv(overlap_enriched_terms_in_vitro_vivo, enriched_terms_up_overlap_in_vitro_in_vivo_filename)
    
    enriched_terms_in_vitro_overlap <- enriched_terms_up_in_vitro %>% filter(Description %in% overlap_enriched_terms_in_vitro_vivo) %>% arrange(desc(NES) & p.adjust <= 0.05)
    
    write.csv(enriched_terms_in_vitro_overlap, enriched_terms_up_in_vitro_overlap_filename, row.names = FALSE, col.names = TRUE)
    
    for (i in 1:dim(enriched_terms_in_vitro_overlap)[1]) {
      enriched_terms_in_vitro_overlap$core_enrichment[i] <- str_split(gsub("/"," ", enriched_terms_in_vitro_overlap$core_enrichment[i]), " ") 
}
    
    
    
    enriched_terms_in_vivo_overlap <- enriched_terms_up_in_vivo %>% filter(Description %in% overlap_enriched_terms_in_vitro_vivo) %>% arrange(desc(NES) & p.adjust <= 0.05)
    
    write.csv(enriched_terms_in_vivo_overlap, enriched_terms_up_in_vivo_overlap_filename, row.names = FALSE, col.names = TRUE)
    
    
    for (i in 1:dim(enriched_terms_in_vivo_overlap)[1]) {
      enriched_terms_in_vivo_overlap$core_enrichment[i] <- str_split(gsub("/"," ", enriched_terms_in_vivo_overlap$core_enrichment[i]), " ")
      }
    
    enriched_terms_in_vitro_in_vivo_overlap_joined <- inner_join(enriched_terms_in_vitro_overlap, enriched_terms_in_vivo_overlap, by="Description")
    
    
    overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo <- as.data.frame(matrix(nrow = 0, ncol = 2))
    colnames(overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo) <- c("overlap_enriched_BP", "overlap_genes")
    for (i in 1:dim(enriched_terms_in_vitro_in_vivo_overlap_joined)[1]){
      if (length(intersect(enriched_terms_in_vitro_in_vivo_overlap_joined$core_enrichment.x[i] %>% unlist(), enriched_terms_in_vitro_in_vivo_overlap_joined$core_enrichment.y[i] %>% unlist())) > 0){
        overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo <-
          rbind(overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo, data.frame(overlap_enriched_BP = enriched_terms_in_vitro_in_vivo_overlap_joined$Description[i], overlap_genes = intersect(enriched_terms_in_vitro_in_vivo_overlap_joined$core_enrichment.x[i] %>% unlist(), enriched_terms_in_vitro_in_vivo_overlap_joined$core_enrichment.y[i] %>% unlist())))
      }
    }
    if (dim(overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo)[1] != 0){
      overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo <- overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo %>% group_by(overlap_enriched_BP)%>% dplyr::mutate(overlap_genes = paste0(overlap_genes, collapse = ",")) %>% distinct() %>% as.data.frame()
      write.csv(overlap_genes_enriched_terms_overlapping_in_vitro_in_vivo, overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_filename, col.names = TRUE, row.names = FALSE)
    }
    

  }
  
}
```











### MTX
```{r}

#### 3h

overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_3h_vs_Control_3h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D3_vs_PBS_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_3h_vs_Control_3h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D10_vs_PBS_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_3h_vs_Control_3h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D22_vs_PBS_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/3h_vs_D3+D22+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_3h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/3h_vs_D3+D22+D22/enriched_terms_up_in_vitro_overlap_3h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/3h_vs_D3+D22+D22/enriched_terms_up_in_vivo_overlap_3h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/3h_vs_D3+D22+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D22_df.csv")


#### 6h

overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_6h_vs_Control_6h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D3_vs_PBS_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_6h_vs_Control_6h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D10_vs_PBS_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_6h_vs_Control_6h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D22_vs_PBS_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/6h_vs_D3+D22+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_6h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/6h_vs_D3+D22+D22/enriched_terms_up_in_vitro_overlap_6h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/6h_vs_D3+D22+D22/enriched_terms_up_in_vivo_overlap_6h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/6h_vs_D3+D22+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D22_df.csv")



#### 12h

overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_12h_vs_Control_12h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D3_vs_PBS_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_12h_vs_Control_12h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D10_vs_PBS_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_12h_vs_Control_12h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D22_vs_PBS_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_12h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D22_df.csv")



#### 18h

overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_18h_vs_Control_18h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D3_vs_PBS_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_18h_vs_Control_18h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D10_vs_PBS_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_18h_vs_Control_18h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D22_vs_PBS_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_18h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D22_df.csv")


#### 24h

overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_24h_vs_Control_24h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D3_vs_PBS_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_24h_vs_Control_24h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D10_vs_PBS_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_24h_vs_Control_24h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D22_vs_PBS_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_24h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D22_df.csv")
```




### OXA
```{r}

#### 3h

overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_3h_vs_Control_3h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D3_vs_PBS_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_3h_vs_Control_3h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D10_vs_PBS_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_3h_vs_Control_3h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D22_vs_PBS_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_3h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D22_df.csv")


#### 6h

overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_6h_vs_Control_6h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D3_vs_PBS_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_6h_vs_Control_6h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D10_vs_PBS_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_6h_vs_Control_6h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D22_vs_PBS_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_6h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D22_df.csv")



#### 12h

overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_12h_vs_Control_12h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D3_vs_PBS_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_12h_vs_Control_12h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D10_vs_PBS_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_12h_vs_Control_12h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D22_vs_PBS_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_12h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D22_df.csv")



#### 18h

overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_18h_vs_Control_18h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D3_vs_PBS_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_18h_vs_Control_18h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D10_vs_PBS_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_18h_vs_Control_18h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D22_vs_PBS_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_18h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D22_df.csv")


#### 24h

overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_24h_vs_Control_24h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D3_vs_PBS_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_24h_vs_Control_24h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D10_vs_PBS_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_24h_vs_Control_24h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D22_vs_PBS_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_24h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D22_df.csv")
```



### CIS
```{r}

#### 3h

overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_3h_vs_Control_3h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D3_vs_PBS_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_3h_vs_Control_3h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D10_vs_PBS_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_3h_vs_Control_3h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D22_vs_PBS_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_3h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D22_df.csv")


#### 6h

overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_6h_vs_Control_6h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D3_vs_PBS_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_6h_vs_Control_6h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D10_vs_PBS_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_6h_vs_Control_6h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D22_vs_PBS_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_6h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D22_df.csv")



#### 12h

overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_12h_vs_Control_12h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D3_vs_PBS_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_12h_vs_Control_12h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D10_vs_PBS_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_12h_vs_Control_12h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D22_vs_PBS_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_12h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D22_df.csv")



#### 18h

overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_18h_vs_Control_18h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D3_vs_PBS_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_18h_vs_Control_18h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D10_vs_PBS_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_18h_vs_Control_18h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D22_vs_PBS_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_18h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D22_df.csv")


#### 24h

overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_24h_vs_Control_24h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D3_vs_PBS_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_24h_vs_Control_24h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D10_vs_PBS_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


overlap_in_vitro_in_vivo_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_24h_vs_Control_24h.csv", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D22_vs_PBS_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_gsea_list_24h_D22.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D22_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D22_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D22_df.csv")
```



```{r}
# MTX

# 24h
upset_plots_overlap_enriched_terms(
  c(MTX_24h_vs_Control_24h = "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_24h_vs_Control_24h.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D3_vs_PBS_D3.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D10_vs_PBS_D10.csv",
    MTX_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D22_vs_PBS_D22.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/Upset plots/upset_MTX_24h_D3_D10_D22.png")


# 18h
upset_plots_overlap_enriched_terms(
  c(MTX_18h_vs_Control_18h = "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_18h_vs_Control_18h.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D3_vs_PBS_D3.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D10_vs_PBS_D10.csv",
    MTX_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D22_vs_PBS_D22.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/Upset plots/upset_MTX_18h_D3_D10_D22.png")



# 12h
upset_plots_overlap_enriched_terms(
  c(MTX_12h_vs_Control_12h = "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_12h_vs_Control_12h.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D3_vs_PBS_D3.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D10_vs_PBS_D10.csv",
    MTX_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D22_vs_PBS_D22.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/Upset plots/upset_MTX_12h_D3_D10_D22.png")



# 6h
upset_plots_overlap_enriched_terms(
  c(MTX_6h_vs_Control_6h = "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_6h_vs_Control_6h.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D3_vs_PBS_D3.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D10_vs_PBS_D10.csv",
    MTX_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D22_vs_PBS_D22.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/Upset plots/upset_MTX_6h_D3_D10_D22.png")



# 3h
upset_plots_overlap_enriched_terms(
  c(MTX_3h_vs_Control_3h = "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_3h_vs_Control_3h.csv",
    MTX_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D3_vs_PBS_D3.csv",
    MTX_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D10_vs_PBS_D10.csv",
    MTX_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/MTX_vs_Control/up_enriched_sets_gsea_MTX_D22_vs_PBS_D22.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GSEA/MTX/Upset plots/upset_MTX_3h_D3_D10_D22.png")





# OXA

# 24h
upset_plots_overlap_enriched_terms(
  c(OXA_24h_vs_Control_24h = "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_24h_vs_Control_24h.csv",
    OXA_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D3_vs_PBS_D3.csv",
    OXA_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D10_vs_PBS_D10.csv",
    OXA_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D22_vs_PBS_D22.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/Upset plots/upset_OXA_24h_D3_D10_D22.png")


# 18h
upset_plots_overlap_enriched_terms(
  c(OXA_18h_vs_Control_18h = "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_18h_vs_Control_18h.csv",
    OXA_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D3_vs_PBS_D3.csv",
    OXA_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D10_vs_PBS_D10.csv",
    OXA_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D22_vs_PBS_D22.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/Upset plots/upset_OXA_18h_D3_D10_D22.png")



# 12h
upset_plots_overlap_enriched_terms(
  c(OXA_12h_vs_Control_12h = "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_12h_vs_Control_12h.csv",
    OXA_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D3_vs_PBS_D3.csv",
    OXA_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D10_vs_PBS_D10.csv",
    OXA_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D22_vs_PBS_D22.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/Upset plots/upset_OXA_12h_D3_D10_D22.png")



# 6h
upset_plots_overlap_enriched_terms(
  c(OXA_6h_vs_Control_6h = "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_6h_vs_Control_6h.csv",
    OXA_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D3_vs_PBS_D3.csv",
    OXA_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D10_vs_PBS_D10.csv",
    OXA_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D22_vs_PBS_D22.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/Upset plots/upset_OXA_6h_D3_D10_D22.png")



# 3h
upset_plots_overlap_enriched_terms(
  c(OXA_3h_vs_Control_3h = "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_3h_vs_Control_3h.csv",
    OXA_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D3_vs_PBS_D3.csv",
    OXA_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D10_vs_PBS_D10.csv",
    OXA_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/OXA_vs_Control/up_enriched_sets_gsea_OXA_D22_vs_PBS_D22.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GSEA/OXA/Upset plots/upset_OXA_3h_D3_D10_D22.png")



# CIS

# 24h
upset_plots_overlap_enriched_terms(
  c(CIS_24h_vs_Control_24h = "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_24h_vs_Control_24h.csv",
    CIS_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D3_vs_PBS_D3.csv",
    CIS_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D10_vs_PBS_D10.csv",
    CIS_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D22_vs_PBS_D22.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/Upset plots/upset_CIS_24h_D3_D10_D22.png")


# 18h
upset_plots_overlap_enriched_terms(
  c(CIS_18h_vs_Control_18h = "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_18h_vs_Control_18h.csv",
    CIS_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D3_vs_PBS_D3.csv",
    CIS_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D10_vs_PBS_D10.csv",
    CIS_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D22_vs_PBS_D22.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/Upset plots/upset_CIS_18h_D3_D10_D22.png")



# 12h
upset_plots_overlap_enriched_terms(
  c(CIS_12h_vs_Control_12h = "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_12h_vs_Control_12h.csv",
    CIS_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D3_vs_PBS_D3.csv",
    CIS_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D10_vs_PBS_D10.csv",
    CIS_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D22_vs_PBS_D22.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/Upset plots/upset_CIS_12h_D3_D10_D22.png")



# 6h
upset_plots_overlap_enriched_terms(
  c(CIS_6h_vs_Control_6h = "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_6h_vs_Control_6h.csv",
    CIS_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D3_vs_PBS_D3.csv",
    CIS_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D10_vs_PBS_D10.csv",
    CIS_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D22_vs_PBS_D22.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/Upset plots/upset_CIS_6h_D3_D10_D22.png")



# 3h
upset_plots_overlap_enriched_terms(
  c(CIS_3h_vs_Control_3h = "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_3h_vs_Control_3h.csv",
    CIS_D3_vs_Control_D3 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D3_vs_PBS_D3.csv",
    CIS_D10_vs_Control_D10 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D10_vs_PBS_D10.csv",
    CIS_D22_vs_Control_D22 = "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/CIS_vs_Control/up_enriched_sets_gsea_CIS_D22_vs_PBS_D22.csv"),
  upset_plot_filename = "Enrichment_overlap_in_vitro_in_vivo/GSEA/CIS/Upset plots/upset_CIS_3h_D3_D10_D22.png")


```





## GSEA (kegg)

```{r}
run_gsea_kegg <- function(top_table_filename, contrast_interest, drug_directory, root_interest){
  
  library(clusterProfiler)
  library(tidyverse)
  top_table_contrast_interest <- read.csv(top_table_filename) %>% filter(contrast == contrast_interest) %>% mutate(rank = sign(logFC) * -log10(adj.P.Val)) %>% arrange(desc(rank))
  gene_list_interest <- top_table_contrast_interest$rank
  names(gene_list_interest) <- top_table_contrast_interest$genes
  gsea_contrast_interest <- gseKEGG(gene_list_interest, ont = "BP", OrgDb = "org.Mm.eg.db", eps=0)
  gsea_contrast_interest_up_reg_pathways <- gsea_contrast_interest %>% as.data.frame() %>% filter(NES > 0 & p.adjust <= 0.05) %>% arrange(desc(NES))
  write.csv(gsea_contrast_interest_up_reg_pathways, paste0(root_interest,drug_directory,"/up_enriched_sets_gsea_kegg",contrast_interest,".csv"), col.names = TRUE, row.names = TRUE)
  
  
  for (i in 1:dim(gsea_contrast_interest_up_reg_pathways)[1]) {
    
    gsea_contrast_interest_up_reg_pathways$core_enrichment[i] <- str_split(gsub("/"," ", gsea_contrast_interest_up_reg_pathways$core_enrichment[i]), " ")
  
    }
  
  
    
  leading_edge_ranked_genes <- data.frame(matrix(nrow = 0, ncol = 2))
  colnames(leading_edge_ranked_genes) <- c("leading_edge_genes_ranking_score", "leading_edge_genes_ranking_order")
   for (i in 1:dim(gsea_contrast_interest_up_reg_pathways)[1]) {
     leading_edge_ranked_genes <- rbind(leading_edge_ranked_genes, gene_list_interest[gsea_contrast_interest_up_reg_pathways$core_enrichment[i] %>% unlist()] %>% as.data.frame(row.names = names(gene_list[gsea_contrast_interest_up_reg_pathways$core_enrichment[i] %>% unlist()])) %>% mutate(leading_edge_genes_ranking_order = c(1:length(gsea_contrast_interest_up_reg_pathways$core_enrichment[i] %>% unlist()))) %>%  dplyr::rename("leading_edge_genes_ranking_score" = ".") %>% mutate("up_pathways" = rep(gsea_contrast_interest_up_reg_pathways$Description[i], length(gsea_contrast_interest_up_reg_pathways$core_enrichment[i]))))
   }
    
    write.csv(leading_edge_ranked_genes, paste0(root_interest,drug_directory,"/leading_edge_genes_up_enriched_sets_gsea_",contrast_interest,".csv"), col.names = TRUE, row.names = TRUE)
    
    }
  
  

```



```{r run_gsea_kegg_in_vitro_in_vivo}


# in vitro


# MTX vs Control
run_gsea_kegg("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_24h_vs_Control_24h", "MTX_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea_kegg("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_18h_vs_Control_18h", "MTX_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea_kegg("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_12h_vs_Control_12h", "MTX_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea_kegg("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_6h_vs_Control_6h", "MTX_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea_kegg("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_3h_vs_Control_3h", "MTX_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")


# OXA vs Control
run_gsea_kegg("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_24h_vs_Control_24h", "OXA_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea_kegg("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_18h_vs_Control_18h", "OXA_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea_kegg("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_12h_vs_Control_12h", "OXA_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea_kegg("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_6h_vs_Control_6h", "OXA_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea_kegg("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_3h_vs_Control_3h", "OXA_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")



# CIS vs Control
run_gsea_kegg("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_24h_vs_Control_24h", "CIS_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea_kegg("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_18h_vs_Control_18h", "CIS_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea_kegg("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_12h_vs_Control_12h", "CIS_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea_kegg("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_6h_vs_Control_6h", "CIS_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")
run_gsea_kegg("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_3h_vs_Control_3h", "CIS_vs_Control", "Bulk_RNA_in_vitro/in_vitro_results/gsea_results/")




# in vivo

# MTX vs Control
run_gsea_kegg("top_table_in_vivo_for_Andrea.csv", "MTX_D3_vs_PBS_D3", "MTX_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")
run_gsea_kegg("top_table_in_vivo_for_Andrea.csv", "MTX_D10_vs_PBS_D10", "MTX_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")
run_gsea_kegg("top_table_in_vivo_for_Andrea.csv", "MTX_D22_vs_PBS_D22", "MTX_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")


# OXA vs Control
run_gsea_kegg("top_table_in_vivo_for_Andrea.csv", "OXA_D3_vs_PBS_D3", "OXA_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")
run_gsea_kegg("top_table_in_vivo_for_Andrea.csv", "OXA_D10_vs_PBS_D10", "OXA_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")
run_gsea_kegg("top_table_in_vivo_for_Andrea.csv", "OXA_D22_vs_PBS_D22", "OXA_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")


# CIS vs Control
run_gsea_kegg("top_table_in_vivo_for_Andrea.csv", "CIS_D3_vs_PBS_D3", "CIS_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")
run_gsea_kegg("top_table_in_vivo_for_Andrea.csv", "CIS_D10_vs_PBS_D10", "CIS_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")
run_gsea_kegg("top_table_in_vivo_for_Andrea.csv", "CIS_D22_vs_PBS_D22", "CIS_vs_Control", "Bulk_RNA_in_vivo/in_vivo_results/gsea_results/")





```












```{r}
gsea_contrast_interest <- gseGO(gene_list_interest, ont = "ALL", OrgDb = "org.Mm.eg.db", keyType = "SYMBOL", eps=0)
  gsea_contrast_interest_BP_arranged <- gsea_contrast_interest %>% filter(ONTOLOGY == "BP" & p.adjust <= 0.05) %>% arrange(desc(abs(NES)))
  dotplot(gsea_contrast_interest_BP_arranged, showCategory=10, split=".sign", orderBy = "GeneRatio") + facet_grid(.~.sign)
  
```


  
  
                                                                                                                          





# In vivo/In vitro - Figures for publication


## Overlap in vitro/in vivo

### GO - BP

```{r}

enrich_plot_go_for_publi <- function(ordered_go_terms_overlap_filename, treatment, timepoint, dotplot_overlap_filename){
  
  
  ordered_go_terms_overlap <- read.csv(ordered_go_terms_overlap_filename)
  
  if(!is.null(ordered_go_terms_overlap)){
    if (nrow(ordered_go_terms_overlap) >= 20){
    ggplot2::ggplot(data = ordered_go_terms_overlap[1:20,], 
           mapping = aes(x = prop_overlap,
                         y = reorder(Biological_Processes,prop_overlap),
                         color = p.adjust,
                         size = prop_overlap)) + 
      geom_point() + 
      scale_color_gradient(low = "red", high = "blue") + 
      theme_bw() +
      xlab("Proportion of Overlap (in %)") +
      ylab("Biological Processes") +
      ggtitle(paste0(treatment," ","(",timepoint,")")) +
      theme(axis.text= element_text(face = "bold")) +
      theme(axis.title.x = element_text(size = 12, face="italic"))  +
      theme(axis.title.y = element_text(size = 12, face="italic"))  +
      theme(plot.title = element_text(size=12, face="bold", hjust = 0.5))
      
      }
    
    else {
    ggplot2::ggplot(data = ordered_go_terms_overlap, 
           mapping = aes(x = prop_overlap,
                         y = reorder(Biological_Processes,prop_overlap),
                         color = p.adjust,
                         size = prop_overlap)
       ) + 
      geom_point() + 
      scale_color_gradient(low = "red", high = "blue") + 
      theme_bw() +
      xlab("Proportion of Overlap (in %)") +
      ylab("Biological Processes") +
      ggtitle(paste0(treatment," ","(",timepoint,")")) +
      theme(axis.text= element_text(face = "bold")) +
      theme(axis.title.x = element_text(size = 12, face = "italic")) +
      theme(axis.title.y = element_text(size = 12, face="italic"))  +
      theme(plot.title = element_text(size=12, face="bold", hjust = 0.5))
    }
  
  ggsave(dotplot_overlap_filename, width=7, height=7, dpi=400)
}

    
  }
```



#### MTX
```{r}

# 24h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_24h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D10_df.csv", "MTX", "24h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_24h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D3+D22/enriched_terms_all_in_vivo_overlap_24h_D3_df.csv", "MTX", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_24h_D3_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D3+D22/enriched_terms_all_in_vitro_overlap_24h_D3_df.csv", "MTX", "24h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_24h_D3_all.pdf")





# 18h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_18h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D10_df.csv", "MTX", "18h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_18h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D3+D22/enriched_terms_all_in_vivo_overlap_18h_D3_df.csv", "MTX", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_18h_D3_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D3+D22/enriched_terms_all_in_vitro_overlap_18h_D3_df.csv", "MTX", "18h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_18h_D3_all.pdf")



# 12h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_12h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D10_df.csv", "MTX", "12h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_12h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D3+D22/enriched_terms_all_in_vivo_overlap_12h_D3_df.csv", "MTX", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_12h_D3_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D3+D22/enriched_terms_all_in_vitro_overlap_12h_D3_df.csv", "MTX", "12h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_12h_D3_all.pdf")



# 6h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_6h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D10_df.csv", "MTX", "6h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_6h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D3+D22/enriched_terms_all_in_vivo_overlap_6h_D3_df.csv", "MTX", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_6h_D3_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D3+D22/enriched_terms_all_in_vitro_overlap_6h_D3_df.csv", "MTX", "6h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_6h_D3_all.pdf")



# 3h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_3h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D10_df.csv", "MTX", "3h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_3h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D3+D22/enriched_terms_all_in_vivo_overlap_3h_D3_df.csv", "MTX", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_3h_D3_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D3+D22/enriched_terms_all_in_vitro_overlap_3h_D3_df.csv", "MTX", "3h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_3h_D3_all.pdf")




```

#### OXA
```{r}
# 3h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv", "Oxa", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_Oxa_3h_D10.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Oxa", "3h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_Oxa_3h_D10.pdf")


# 6h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv", "Oxa", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_Oxa_6h_D10.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Oxa", "6h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_Oxa_6h_D10.pdf")
```


#### CIS
```{r}
# 24h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv", "Cis", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_Cis_24h_D10.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Cis", "24h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_Cis_24h_D10.pdf")


# 18h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv", "Cis", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_Cis_18h_D10.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Cis", "18h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_Cis_18h_D10.pdf")



# 6h

enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv", "Cis", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_Cis_6h_D10.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Cis", "6h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_Cis_6h_D10.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv", "Cis", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_Cis_6h_D3.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Cis", "6h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_Cis_6h_D3.pdf")


```

### Kegg

```{r}
enrich_plot_Kegg_for_publi <- function(ordered_kegg_terms_overlap_filename, treatment, timepoint, dotplot_overlap_filename){
  
  ordered_kegg_terms_overlap <- read.csv(ordered_kegg_terms_overlap_filename)
  
  
  if (nrow(ordered_kegg_terms_overlap) >= 20){
    ggplot2::ggplot(data = ordered_kegg_terms_overlap[1:20,], 
           mapping = aes(x = prop_overlap,
                         y = reorder(Kegg_Pathway,prop_overlap),
                         color = p.adjust,
                         size = prop_overlap)) + 
      geom_point() + 
      scale_color_gradient(low = "red", high = "blue") + 
      theme_bw() +
      xlab("Proportion of Overlap (in %)") +
      ylab("Kegg_Pathway") +
      ggtitle(paste0(treatment," ","(",timepoint,")")) +
      theme(axis.text= element_text(face = "bold")) +
      theme(axis.title.x = element_text(size = 12, face="italic"))  +
      theme(axis.title.y = element_text(size = 12, face="italic"))  +
      theme(plot.title = element_text(size=12, face="bold", hjust = 0.5))
  
  }
  
  else {
    ggplot2::ggplot(data = ordered_kegg_terms_overlap, 
           mapping = aes(x = prop_overlap,
                         y = reorder(Kegg_Pathway,prop_overlap),
                         color = p.adjust,
                         size = prop_overlap)
       ) + 
      geom_point() + 
      scale_color_gradient(low = "red", high = "blue") + 
      theme_bw() +
      xlab("Proportion of Overlap (in %)") +
      ylab("Kegg_Pathway") +
      ggtitle(paste0(treatment," ","(",timepoint,")")) +
      theme(axis.text= element_text(face = "bold")) +
      theme(axis.title.x = element_text(size = 12, face = "italic")) +
      theme(axis.title.y = element_text(size = 12, face="italic"))  +
      theme(plot.title = element_text(size=12, face="bold", hjust = 0.5))
    }
  
  ggsave(dotplot_overlap_filename, width=9.5, height=7, dpi=400)
}
```



#### MTX
```{r}

# 24h
enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/24h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_kegg_in_vivo_overlap_in_vitro_vivo_MTX_24h_D10.pdf")


enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/24h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "MTX", "24h", "figures_for_publication/In_vitro/Dotplot_kegg_in_vitro_overlap_in_vitro_vivo_MTX_24h_D10.pdf")



# 18h
enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/18h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_kegg_in_vivo_overlap_in_vitro_vivo_MTX_18h_D10.pdf")


enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/18h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "MTX", "18h", "figures_for_publication/In_vitro/Dotplot_kegg_in_vitro_overlap_in_vitro_vivo_MTX_18h_D10.pdf")



# 12h
enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/12h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_kegg_in_vivo_overlap_in_vitro_vivo_MTX_12h_D10.pdf")


enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/12h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "MTX", "12h", "figures_for_publication/In_vitro/Dotplot_kegg_in_vitro_overlap_in_vitro_vivo_MTX_12h_D10.pdf")


# 6h
enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/6h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_kegg_in_vivo_overlap_in_vitro_vivo_MTX_6h_D10.pdf")


enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/MTX/6h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "MTX", "6h", "figures_for_publication/In_vitro/Dotplot_kegg_in_vitro_overlap_in_vitro_vivo_MTX_6h_D10.pdf")


```



#### OXA
```{r}

# 24h
enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/24h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv", "Oxa", "D10","figures_for_publication/In_vivo/Dotplot_kegg_in_vivo_overlap_in_vitro_vivo_Oxa_24h_D10.pdf")


enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/24h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Oxa", "24h", "figures_for_publication/In_vitro/Dotplot_kegg_in_vitro_overlap_in_vitro_vivo_Oxa_24h_D10.pdf")



# 18h
enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/18h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv", "Oxa", "D10","figures_for_publication/In_vivo/Dotplot_kegg_in_vivo_overlap_in_vitro_vivo_Oxa_18h_D10.pdf")


enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/18h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Oxa", "18h", "figures_for_publication/In_vitro/Dotplot_kegg_in_vitro_overlap_in_vitro_vivo_Oxa_18h_D10.pdf")



# 12h
enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/12h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv", "Oxa", "D10","figures_for_publication/In_vivo/Dotplot_kegg_in_vivo_overlap_in_vitro_vivo_Oxa_12h_D10.pdf")


enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/12h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Oxa", "12h", "figures_for_publication/In_vitro/Dotplot_kegg_in_vitro_overlap_in_vitro_vivo_Oxa_12h_D10.pdf")


# 6h
enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/6h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv", "Oxa", "D10","figures_for_publication/In_vivo/Dotplot_kegg_in_vivo_overlap_in_vitro_vivo_Oxa_6h_D10.pdf")


enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/6h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Oxa", "6h", "figures_for_publication/In_vitro/Dotplot_kegg_in_vitro_overlap_in_vitro_vivo_Oxa_6h_D10.pdf")


# 3h
enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/3h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv", "Oxa", "D10","figures_for_publication/In_vivo/Dotplot_kegg_in_vivo_overlap_in_vitro_vivo_Oxa_3h_D10.pdf")


enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Oxa/3h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Oxa", "3h", "figures_for_publication/In_vitro/Dotplot_kegg_in_vitro_overlap_in_vitro_vivo_Oxa_3h_D10.pdf")

```


#### CIS
```{r}
# 24h
enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/24h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv", "Cis", "D10","figures_for_publication/In_vivo/Dotplot_kegg_in_vivo_overlap_in_vitro_vivo_Cis_24h_D10.pdf")


enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/24h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Cis", "24h", "figures_for_publication/In_vitro/Dotplot_kegg_in_vitro_overlap_in_vitro_vivo_Cis_24h_D10.pdf")



# 18h
enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/18h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv", "Cis", "D10","figures_for_publication/In_vivo/Dotplot_kegg_in_vivo_overlap_in_vitro_vivo_Cis_18h_D10.pdf")


enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/18h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Cis", "18h", "figures_for_publication/In_vitro/Dotplot_kegg_in_vitro_overlap_in_vitro_vivo_Cis_18h_D10.pdf")



# 12h
enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/12h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv", "Cis", "D10","figures_for_publication/In_vivo/Dotplot_kegg_in_vivo_overlap_in_vitro_vivo_Cis_12h_D10.pdf")


enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/12h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Cis", "12h", "figures_for_publication/In_vitro/Dotplot_kegg_in_vitro_overlap_in_vitro_vivo_Cis_12h_D10.pdf")


# 6h
enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/6h_vs_D3+D10/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv", "Cis", "D10","figures_for_publication/In_vivo/Dotplot_kegg_in_vivo_overlap_in_vitro_vivo_Cis_6h_D10.pdf")


enrich_plot_Kegg_for_publi("Enrichment_overlap_in_vitro_in_vivo/Kegg/Cis/6h_vs_D3+D10/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Cis", "6h", "figures_for_publication/In_vitro/Dotplot_kegg_in_vitro_overlap_in_vitro_vivo_Cis_6h_D10.pdf")

```



### Reactome



```{r}
enrich_plot_Reactome_for_publi <- function(ordered_Reactome_terms_overlap_filename, treatment, timepoint, dotplot_overlap_filename){
  
  ordered_Reactome_terms_overlap <- read.csv(ordered_Reactome_terms_overlap_filename)
  
  
  if (nrow(ordered_Reactome_terms_overlap) >= 20){
    ggplot2::ggplot(data = ordered_Reactome_terms_overlap[1:20,], 
           mapping = aes(x = prop_overlap,
                         y = reorder(Reactome_Pathway,prop_overlap),
                         color = p.adjust,
                         size = prop_overlap)) + 
      geom_point() + 
      scale_color_gradient(low = "red", high = "blue") + 
      theme_bw() +
      xlab("Proportion of Overlap (in %)") +
      ylab("Reactome_Pathway") +
      ggtitle(paste0(treatment," ","(",timepoint,")")) +
      theme(axis.text= element_text(face = "bold")) +
      theme(axis.title.x = element_text(size = 12, face="italic"))  +
      theme(axis.title.y = element_text(size = 12, face="italic"))  +
      theme(plot.title = element_text(size=12, face="bold", hjust = 0.5))
  
  }
  
  else {
    ggplot2::ggplot(data = ordered_Reactome_terms_overlap, 
           mapping = aes(x = prop_overlap,
                         y = reorder(Reactome_Pathway,prop_overlap),
                         color = p.adjust,
                         size = prop_overlap)
       ) + 
      geom_point() + 
      scale_color_gradient(low = "red", high = "blue") + 
      theme_bw() +
      xlab("Proportion of Overlap (in %)") +
      ylab("Reactome_Pathway") +
      ggtitle(paste0(treatment," ","(",timepoint,")")) +
      theme(axis.text= element_text(face = "bold")) +
      theme(axis.title.x = element_text(size = 12, face = "italic")) +
      theme(axis.title.y = element_text(size = 12, face="italic"))  +
      theme(plot.title = element_text(size=12, face="bold", hjust = 0.5))
    }
  
  ggsave(dotplot_overlap_filename, width=8, height=7, dpi=400)
}
```



#### MTX

```{r}

# 18h
enrich_plot_Reactome_for_publi("Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_Reactome_in_vivo_overlap_in_vitro_vivo_MTX_18h_D10.pdf")


enrich_plot_Reactome_for_publi("Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "MTX", "18h", "figures_for_publication/In_vitro/Dotplot_Reactome_in_vitro_overlap_in_vitro_vivo_MTX_18h_D10.pdf")



# 6h
enrich_plot_Reactome_for_publi("Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_Reactome_in_vivo_overlap_in_vitro_vivo_MTX_6h_D10.pdf")


enrich_plot_Reactome_for_publi("Enrichment_overlap_in_vitro_in_vivo/Reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "MTX", "6h", "figures_for_publication/In_vitro/Dotplot_Reactome_in_vitro_overlap_in_vitro_vivo_MTX_6h_D10.pdf")

```




#### OXA

```{r}

# 24h
enrich_plot_Reactome_for_publi("Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv", "Oxa", "D10","figures_for_publication/In_vivo/Dotplot_Reactome_in_vivo_overlap_in_vitro_vivo_Oxa_24h_D10.pdf")


enrich_plot_Reactome_for_publi("Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Oxa", "24h", "figures_for_publication/In_vitro/Dotplot_Reactome_in_vitro_overlap_in_vitro_vivo_Oxa_24h_D10.pdf")



# 18h
enrich_plot_Reactome_for_publi("Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv", "Oxa", "D10","figures_for_publication/In_vivo/Dotplot_Reactome_in_vivo_overlap_in_vitro_vivo_Oxa_18h_D10.pdf")


enrich_plot_Reactome_for_publi("Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Oxa", "18h", "figures_for_publication/In_vitro/Dotplot_Reactome_in_vitro_overlap_in_vitro_vivo_Oxa_18h_D10.pdf")



# 12h
enrich_plot_Reactome_for_publi("Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv", "Oxa", "D10","figures_for_publication/In_vivo/Dotplot_Reactome_in_vivo_overlap_in_vitro_vivo_Oxa_12h_D10.pdf")


enrich_plot_Reactome_for_publi("Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Oxa", "12h", "figures_for_publication/In_vitro/Dotplot_Reactome_in_vitro_overlap_in_vitro_vivo_Oxa_12h_D10.pdf")



# 6h
enrich_plot_Reactome_for_publi("Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv", "Oxa", "D10","figures_for_publication/In_vivo/Dotplot_Reactome_in_vivo_overlap_in_vitro_vivo_Oxa_6h_D10.pdf")


enrich_plot_Reactome_for_publi("Enrichment_overlap_in_vitro_in_vivo/Reactome/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Oxa", "6h", "figures_for_publication/In_vitro/Dotplot_Reactome_in_vitro_overlap_in_vitro_vivo_Oxa_6h_D10.pdf")

```



#### Cis

```{r}

# 6h
enrich_plot_Reactome_for_publi("Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv", "Cis", "D10","figures_for_publication/In_vivo/Dotplot_Reactome_in_vivo_overlap_in_vitro_vivo_Cis_6h_D10.pdf")


enrich_plot_Reactome_for_publi("Enrichment_overlap_in_vitro_in_vivo/Reactome/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Cis", "6h", "figures_for_publication/In_vitro/Dotplot_Reactome_in_vitro_overlap_in_vitro_vivo_Cis_6h_D10.pdf")

```





## Run ORA for publication
```{r}
# Get GO final results (Dotplot)
get_enrichment_results <- function(top_table_filename, contrast_interest, filename_5, filename_6, filename_7, filename_8, filename_9, filename_10, filename_11, filename_12, filename_13){
  
  library(clusterProfiler)
  library(ReactomePA)
  # Get top table of interest
  top_table <- read.csv(top_table_filename)
  top_table_contrast_interest_all_diff <- top_table %>% filter(contrast == contrast_interest) %>% filter(adj.P.Val <= 0.05 & abs(logFC) > 2) %>% mutate(group = ifelse(logFC > 0, "up", "down"))
  top_table_contrast_interest_up_diff <- top_table_contrast_interest_all_diff %>% filter(group == "up") 
  top_table_contrast_interest_down_diff <- top_table_contrast_interest_all_diff %>% filter(group == "down")
  
  # Get gene symbol
  all_genes_symbol <- top_table_contrast_interest_all_diff$genes
  all_up_symbol <- top_table_contrast_interest_up_diff$genes
  all_down_symbol <- top_table_contrast_interest_down_diff$genes
  
  # Retrieve ENSEMBL and ENTREZID
  res_bitr_all <- bitr(all_genes_symbol, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = "org.Mm.eg.db")
  res_bitr_up <- bitr(all_up_symbol, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = "org.Mm.eg.db")
  res_bitr_down <- bitr(all_down_symbol, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = "org.Mm.eg.db")
  
  # Get ENTREZ ID for list 
  res_bitr_all_list <- list(genes = res_bitr_all$ENTREZID)
  res_bitr_up_list <- list(genes = res_bitr_up$ENTREZID)
  res_bitr_down_list <- list(genes = res_bitr_down$ENTREZID)
  

  # Run GO enrichment analysis
  go_analysis_res_bitr_all_df <- enrichGO(res_bitr_all_list$genes, ont="ALL", OrgDb = "org.Mm.eg.db", readable = TRUE)
  go_analysis_res_bitr_up_df <- enrichGO(res_bitr_up_list$genes, ont="ALL", OrgDb = "org.Mm.eg.db", readable = TRUE)
  go_analysis_res_bitr_down_df <- enrichGO(res_bitr_down_list$genes, ont="ALL", OrgDb = "org.Mm.eg.db", readable = TRUE)
  
  
  if (!is.null(go_analysis_res_bitr_all_df)){
    
    # Remove redundant terms
    go_analysis_res_bitr_all_df_not_redundant <- clusterProfiler::simplify(go_analysis_res_bitr_all_df, cutoff=0.7, by="p.adjust", select_fun=min)
  
   # Compute proportion of genes in the GO term that overlaps with the DEGs
   go_analysis_res_bitr_all_df_not_redundant <- go_analysis_res_bitr_all_df_not_redundant %>% dplyr::mutate(prop_overlap  = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),
                                                     Biological_Processes = Description)
  
  # Convert prop overlap in percentage
  go_analysis_res_bitr_all_df_not_redundant <- go_analysis_res_bitr_all_df_not_redundant %>% mutate(prop_overlap = prop_overlap * 100)
  
  
  
  # Rank GO terms by prop of overlap
  ordered_go_analysis_res_bitr_all_df <- go_analysis_res_bitr_all_df_not_redundant[order(go_analysis_res_bitr_all_df_not_redundant$prop_overlap, decreasing = TRUE),]
  write.csv(ordered_go_analysis_res_bitr_all_df, filename_5)
  
  
  }
  
  if (!is.null(go_analysis_res_bitr_up_df)){
    
    # Remove redundant terms
    go_analysis_res_bitr_up_df_not_redundant <- simplify(go_analysis_res_bitr_up_df, cutoff=0.7, by="p.adjust", select_fun=min)
     
    # Compute proportion of genes in the GO term that overlaps with the DEGs
    go_analysis_res_bitr_up_df_not_redundant <- go_analysis_res_bitr_up_df_not_redundant %>% dplyr::mutate(prop_overlap  = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),
                                                     Biological_Processes = Description)
     
    # Convert prop overlap in percentage
    go_analysis_res_bitr_up_df_not_redundant <- go_analysis_res_bitr_up_df_not_redundant %>% mutate(prop_overlap = prop_overlap * 100)
     
     
    # Rank GO terms by prop of overlap
    ordered_go_analysis_res_bitr_up_df <- go_analysis_res_bitr_up_df_not_redundant[order(go_analysis_res_bitr_up_df_not_redundant$prop_overlap, decreasing = TRUE),]
     write.csv(ordered_go_analysis_res_bitr_up_df, filename_6)
  
  
   }
  
  if (!is.null(go_analysis_res_bitr_down_df)){
    
    # Remove redundant terms
    go_analysis_res_bitr_down_df_not_redundant <- simplify(go_analysis_res_bitr_down_df, cutoff=0.7, by="p.adjust", select_fun=min)
    
    # Compute proportion of genes in the GO term that overlaps with the DEGs
    go_analysis_res_bitr_down_df_not_redundant <- go_analysis_res_bitr_down_df_not_redundant %>% dplyr::mutate(prop_overlap  = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),
                                                     Biological_Processes = Description)
  
   # Convert prop overlap in percentage
   go_analysis_res_bitr_down_df_not_redundant <- go_analysis_res_bitr_down_df_not_redundant %>% mutate(prop_overlap = prop_overlap * 100)
  
  
  
  # Rank GO terms by prop of overlap
  ordered_go_analysis_res_bitr_down_df <- go_analysis_res_bitr_down_df_not_redundant[order(go_analysis_res_bitr_down_df_not_redundant$prop_overlap, decreasing = TRUE),]
  write.csv(ordered_go_analysis_res_bitr_down_df, filename_7)
  
  
  }
  
  
  # Run reactome enrichment analysis
  reactome_analysis_res_bitr_all_df <- enrichPathway(res_bitr_all_list$genes, organism="mouse")
  reactome_analysis_res_bitr_up_df <- enrichPathway(res_bitr_up_list$genes, organism="mouse")
  reactome_analysis_res_bitr_down_df <- enrichPathway(res_bitr_down_list$genes, organism="mouse")
  
  
  if (!is.null(reactome_analysis_res_bitr_all_df)){
    
    # Get prop of overlap (+ convert in percentage)
    reactome_analysis_res_bitr_all_df <- reactome_analysis_res_bitr_all_df %>%
                                              as.data.frame() %>% 
                                              mutate(prop_overlap = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),                                                   Reactome_Pathway = Description) %>% mutate(prop_overlap = prop_overlap * 100)
  
  
   # Rank reactome terms by prop of overlap
    ordered_reactome_analysis_res_bitr_all_df <- reactome_analysis_res_bitr_all_df[order(reactome_analysis_res_bitr_all_df$prop_overlap, decreasing = TRUE),]
    write.csv(ordered_reactome_analysis_res_bitr_all_df, filename_8)
    
    
    }
  
  
  if (!is.null(reactome_analysis_res_bitr_up_df)){
    
    reactome_analysis_res_bitr_up_df <- reactome_analysis_res_bitr_up_df %>%
                                              as.data.frame() %>% 
                                              mutate(prop_overlap = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),                                                   Reactome_Pathway = Description) %>% mutate(prop_overlap = prop_overlap * 100)
  
    
    ordered_reactome_analysis_res_bitr_up_df <- reactome_analysis_res_bitr_up_df[order(reactome_analysis_res_bitr_up_df$prop_overlap, decreasing = TRUE),] 
    write.csv(ordered_reactome_analysis_res_bitr_up_df, filename_9)
  
  }
  
  
  if (!is.null(reactome_analysis_res_bitr_down_df)){
    
    reactome_analysis_res_bitr_down_df <- reactome_analysis_res_bitr_down_df %>%
                                              as.data.frame() %>% 
                                              mutate(prop_overlap = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),                                                  Reactome_Pathway = Description) %>% mutate(prop_overlap = prop_overlap * 100)
    
    
    ordered_reactome_analysis_res_bitr_down_df <- reactome_analysis_res_bitr_down_df[order(reactome_analysis_res_bitr_down_df$prop_overlap, decreasing = TRUE),] 
  write.csv(ordered_reactome_analysis_res_bitr_down_df, filename_10)
  
  
}
  
  
  # Run kegg enrichment analysis
  kegg_analysis_res_bitr_all_df <- enrichKEGG(res_bitr_all_list$genes, organism="mmu")
  kegg_analysis_res_bitr_up_df <- enrichKEGG(res_bitr_up_list$genes, organism = "mmu")
  kegg_analysis_res_bitr_down_df <- enrichKEGG(res_bitr_down_list$genes, organism = "mmu")
  
  
  
  
  if (!is.null(kegg_analysis_res_bitr_all_df)){
    
    # Get prop of overlap (+ convert in percentage)
    kegg_analysis_res_bitr_all_df <- kegg_analysis_res_bitr_all_df %>%
                                              as.data.frame() %>% 
                                              mutate(prop_overlap = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),                                                   Kegg_Pathway = Description) %>% mutate(prop_overlap = prop_overlap * 100) 
    
    
    # Rank kegg terms by prop of overlap
    ordered_kegg_analysis_res_bitr_all_df <- kegg_analysis_res_bitr_all_df[order(kegg_analysis_res_bitr_all_df$prop_overlap, decreasing = TRUE),]
  write.csv(ordered_kegg_analysis_res_bitr_all_df, filename_11)
  
  
  }
  
  
  if (!is.null(kegg_analysis_res_bitr_up_df)){
    
    kegg_analysis_res_bitr_up_df <- kegg_analysis_res_bitr_up_df %>%
                                              as.data.frame() %>% 
                                              mutate(prop_overlap = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),                                                   Kegg_Pathway = Description) %>% mutate(prop_overlap = prop_overlap * 100)
    
    
    ordered_kegg_analysis_res_bitr_up_df <- kegg_analysis_res_bitr_up_df[order(kegg_analysis_res_bitr_up_df$prop_overlap, decreasing = TRUE),] 
  write.csv(ordered_kegg_analysis_res_bitr_up_df, filename_12)
  
  }
  
  
  if (!is.null(kegg_analysis_res_bitr_down_df)){
    
    kegg_analysis_res_bitr_down_df <- kegg_analysis_res_bitr_down_df %>%
                                              as.data.frame() %>% 
                                              mutate(prop_overlap = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),                                                   Kegg_Pathway = Description) %>% mutate(prop_overlap = prop_overlap * 100)
    
    
    ordered_kegg_analysis_res_bitr_down_df <- kegg_analysis_res_bitr_down_df[order(kegg_analysis_res_bitr_down_df$prop_overlap, decreasing = TRUE),] 
  write.csv(ordered_kegg_analysis_res_bitr_down_df, filename_13)
    
  }
  
 
  
  
}

```


### In vitro

#### MTX
```{r}

#24h

get_enrichment_results("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_24h_vs_Control_24h", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(24h) vs PBS(24h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(24h) vs PBS(24h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(24h) vs PBS(24h)_down_diff_genes.csv")



#18h

get_enrichment_results("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_18h_vs_Control_18h", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(18h) vs PBS(18h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(18h) vs PBS(18h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(18h) vs PBS(18h)_down_diff_genes.csv")




#12h

get_enrichment_results("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_12h_vs_Control_12h", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(12h) vs PBS(12h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(12h) vs PBS(12h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(12h) vs PBS(12h)_down_diff_genes.csv")


#6h

get_enrichment_results("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_6h_vs_Control_6h", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(6h) vs PBS(6h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(6h) vs PBS(6h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(6h) vs PBS(6h)_down_diff_genes.csv")



#3h

get_enrichment_results("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_3h_vs_Control_3h", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(3h) vs PBS(3h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(3h) vs PBS(3h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(3h) vs PBS(3h)_down_diff_genes.csv")
```




#### OXA
```{r}

#24h

get_enrichment_results("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_24h_vs_Control_24h", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(24h) vs PBS(24h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(24h) vs PBS(24h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(24h) vs PBS(24h)_down_diff_genes.csv")



#18h

get_enrichment_results("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_18h_vs_Control_18h", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(18h) vs PBS(18h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(18h) vs PBS(18h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(18h) vs PBS(18h)_down_diff_genes.csv")




#12h

get_enrichment_results("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_12h_vs_Control_12h", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(12h) vs PBS(12h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(12h) vs PBS(12h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(12h) vs PBS(12h)_down_diff_genes.csv")


#6h

get_enrichment_results("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_6h_vs_Control_6h", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(6h) vs PBS(6h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(6h) vs PBS(6h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(6h) vs PBS(6h)_down_diff_genes.csv")



#3h

get_enrichment_results("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_3h_vs_Control_3h", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(3h) vs PBS(3h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(3h) vs PBS(3h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(3h) vs PBS(3h)_down_diff_genes.csv")
```






#### CIS
```{r}

#24h

get_enrichment_results("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_24h_vs_Control_24h", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(24h) vs PBS(24h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(24h) vs PBS(24h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(24h) vs PBS(24h)_down_diff_genes.csv")



#18h

get_enrichment_results("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_18h_vs_Control_18h", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(18h) vs PBS(18h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(18h) vs PBS(18h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(18h) vs PBS(18h)_down_diff_genes.csv")




#12h

get_enrichment_results("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_12h_vs_Control_12h", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(12h) vs PBS(12h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(12h) vs PBS(12h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(12h) vs PBS(12h)_down_diff_genes.csv")


#6h

get_enrichment_results("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_6h_vs_Control_6h", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(6h) vs PBS(6h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(6h) vs PBS(6h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(6h) vs PBS(6h)_down_diff_genes.csv")



#3h

get_enrichment_results("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_3h_vs_Control_3h", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(3h) vs PBS(3h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(3h) vs PBS(3h)_down_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(3h) vs PBS(3h)_down_diff_genes.csv")
```







### In vivo

#### MTX
```{r}

# D10

get_enrichment_results(top_table_filename = "top_table_in_vivo_for_Andrea.csv", contrast_interest = "MTX_D10_vs_PBS_D10", 
                       filename_5 = "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv", 
                       filename_6 =  "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", 
                       filename_7 = "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D10) vs PBS(D10)_down_diff_genes.csv", 
                       filename_8 = "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv",
                       filename_9 = "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv",
                       filename_10 = "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_down_diff_genes.csv", 
                       filename_11 = "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv", 
                       filename_12 = "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", 
                       filename_13 = "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_down_diff_genes.csv")



# D3

get_enrichment_results("top_table_in_vivo_for_Andrea.csv", "MTX_D3_vs_PBS_D3", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D3) vs PBS(D3)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_down_diff_genes.csv")

```




#### OXA
```{r}

# D10

get_enrichment_results("top_table_in_vivo_for_Andrea.csv", "OXA_D10_vs_PBS_D10", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_down_diff_genes.csv")



# D3

get_enrichment_results("top_table_in_vivo_for_Andrea.csv", "OXA_D3_vs_PBS_D3", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_down_diff_genes.csv")

```





#### CIS
```{r}

# D10

get_enrichment_results("top_table_in_vivo_for_Andrea.csv", "CIS_D10_vs_PBS_D10", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_down_diff_genes.csv")



# D3

get_enrichment_results("top_table_in_vivo_for_Andrea.csv", "CIS_D3_vs_PBS_D3", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_down_diff_genes.csv")

```



## Overlap for publication


## GO 
### All

#### MTX

```{r}
#### 3h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D10_df.csv")


```


```{r}
# 24h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_24h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D10_df.csv", "MTX", "24h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_24h_D10_all.pdf")





# 18h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_18h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D10_df.csv", "MTX", "18h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_18h_D10_all.pdf")




# 12h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_12h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D10_df.csv", "MTX", "12h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_12h_D10_all.pdf")




# 6h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_6h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D10_df.csv", "MTX", "6h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_6h_D10_all.pdf")


```






#### OXA

```{r}


#### 3h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D10_df.csv")




#### 6h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D10_df.csv")


```



```{r}
# 24h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D10_df.csv", "OXA", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_24h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D10_df.csv", "OXA", "24h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_24h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D3_df.csv", "OXA", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_24h_D3_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D10_df.csv", "OXA", "24h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_24h_D10_all.pdf")




# 18h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D10_df.csv", "OXA", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_18h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D10_df.csv", "OXA", "18h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_18h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D3_df.csv", "OXA", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_18h_D3_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D3_df.csv", "OXA", "18h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_18h_D3_all.pdf")





# 12h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D10_df.csv", "OXA", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_12h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D10_df.csv", "OXA", "12h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_12h_D10_all.pdf")



enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D3_df.csv", "OXA", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_12h_D3_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D3_df.csv", "OXA", "12h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_12h_D3_all.pdf")



# 6h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D10_df.csv", "OXA", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_6h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D10_df.csv", "OXA", "6h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_6h_D10_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D3_df.csv", "OXA", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_6h_D3_all.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D3_df.csv", "OXA", "6h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_6h_D3_all.pdf")


```





#### CIS

```{r}
#### 3h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_go_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D10_df.csv")


```



```{r}

# 24h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_24h_D10.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "MTX", "24h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_24h_D10.pdf")



# 18h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_18h_D10.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "MTX", "18h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_18h_D10.pdf")


# 12h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_12h_D10.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "MTX", "12h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_12h_D10.pdf")



# 6h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_6h_D10.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "MTX", "6h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_6h_D10.pdf")

```







### Up

#### MTX

```{r}
#### 3h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


```




```{r}
# 24h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_24h_D10_up.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "MTX", "24h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_24h_D10_up.pdf")



# 18h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_18h_D10_up.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "MTX", "18h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_18h_D10_up.pdf")



# 12h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_12h_D10_up.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "MTX", "12h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_12h_D10_up.pdf")



# 6h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv", "MTX", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_MTX_6h_D10_up.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "MTX", "6h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_MTX_6h_D10_up.pdf")


```





#### OXA

```{r}
#### 3h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")



#### 6h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")







#### 12h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")




#### 18h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")





#### 24h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")

```



```{r}


# 18h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv", "OXA", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_18h_D3_up.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "OXA", "18h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_18h_D3_up.pdf")





# 12h

enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv", "OXA", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_12h_D3_up.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "OXA", "12h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_12h_D3_up.pdf")



# 6h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv", "OXA", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_6h_D10_up.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "OXA", "6h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_6h_D10_up.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv", "OXA", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_6h_D3_up.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "OXA", "6h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_6h_D3_up.pdf")



# 3h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv", "OXA", "D10","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_3h_D10_up.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "OXA", "3h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_3h_D10_up.pdf")

```





#### CIS

```{r}
#### 3h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


```


### Down

#### MTX

```{r}
#### 3h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(3h) vs PBS(3h)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D3) vs PBS(D3)_down_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_down_overlap_in_vitro_in_vivo_go_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_down_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_down_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_down_in_vitro_in_vivo_3h_D3_df.csv")




#### 18h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_MTX(18h) vs PBS(18h)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_MTX(D3) vs PBS(D3)_down_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_down_overlap_in_vitro_in_vivo_go_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_down_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_down_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_down_in_vitro_in_vivo_18h_D3_df.csv")


```




#### OXA

```{r}
#### 3h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(3h) vs PBS(3h)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_down_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_down_overlap_in_vitro_in_vivo_go_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_down_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_down_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_down_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(3h) vs PBS(3h)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_down_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_down_overlap_in_vitro_in_vivo_go_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_down_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_down_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_down_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(6h) vs PBS(6h)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_down_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_down_overlap_in_vitro_in_vivo_go_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_down_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_down_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_down_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(6h) vs PBS(6h)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_down_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_down_overlap_in_vitro_in_vivo_go_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_down_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_down_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_down_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(12h) vs PBS(12h)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_down_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_down_overlap_in_vitro_in_vivo_go_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_down_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_down_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_down_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(12h) vs PBS(12h)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_down_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_down_overlap_in_vitro_in_vivo_go_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_down_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_down_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_down_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(18h) vs PBS(18h)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_down_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_down_overlap_in_vitro_in_vivo_go_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_down_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_down_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_down_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(18h) vs PBS(18h)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_down_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_down_overlap_in_vitro_in_vivo_go_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_down_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_down_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_down_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(24h) vs PBS(24h)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D3) vs PBS(D3)_down_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_down_overlap_in_vitro_in_vivo_go_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_down_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_down_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_down_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_OXA(24h) vs PBS(24h)_down_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_OXA(D10) vs PBS(D10)_down_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_down_overlap_in_vitro_in_vivo_go_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_down_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_down_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_down_in_vitro_in_vivo_24h_D10_df.csv")


```




```{r}


# 24h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_down_in_vivo_overlap_24h_D3_df.csv", "OXA", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_24h_D3_down.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/24h_vs_D3+D10+D22/enriched_terms_down_in_vitro_overlap_24h_D3_df.csv", "OXA", "24h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_24h_D3_down.pdf")



# 18h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_down_in_vivo_overlap_18h_D3_df.csv", "OXA", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_18h_D3_down.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/18h_vs_D3+D10+D22/enriched_terms_down_in_vitro_overlap_18h_D3_df.csv", "OXA", "18h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_18h_D3_down.pdf")





# 12h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_down_in_vivo_overlap_12h_D3_df.csv", "OXA", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_12h_D3_down.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/12h_vs_D3+D10+D22/enriched_terms_down_in_vitro_overlap_12h_D3_df.csv", "OXA", "12h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_12h_D3_down.pdf")





# 6h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_down_in_vivo_overlap_6h_D3_df.csv", "OXA", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_6h_D3_down.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/6h_vs_D3+D10+D22/enriched_terms_down_in_vitro_overlap_6h_D3_df.csv", "OXA", "6h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_6h_D3_down.pdf")



# 3h
enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_down_in_vivo_overlap_3h_D3_df.csv", "OXA", "D3","figures_for_publication/In_vivo/Dotplot_in_vivo_overlap_in_vitro_vivo_OXA_3h_D3_down.pdf")


enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/Oxa/3h_vs_D3+D10+D22/enriched_terms_down_in_vitro_overlap_3h_D3_df.csv", "OXA", "3h", "figures_for_publication/In_vitro/Dotplot_in_vitro_overlap_in_vitro_vivo_OXA_3h_D3_down.pdf")



```








#### CIS

```{r}
#### 3h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_go("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_go_terms_CIS(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_go_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_go_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/GO/Cis/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


```














## Reactome
### All

#### MTX

```{r}
#### 3h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D10_df.csv")


```




#### OXA

```{r}
#### 3h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D10_df.csv")


```




#### CIS

```{r}
#### 3h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_reactome_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D10_df.csv")


```






### Up

#### MTX

```{r}
#### 3h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


```




#### OXA

```{r}
#### 3h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


```




#### CIS

```{r}
#### 3h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


```


### Down

#### MTX

```{r}
#### 3h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_MTX(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


```




#### OXA

```{r}
#### 3h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_OXA(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/OXA/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


```




#### CIS

```{r}
#### 3h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_reactome("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_reactome_terms_CIS(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_reactome_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_reactome_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/reactome/CIS/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


```






## Kegg
### All

#### MTX

```{r}
#### 3h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D10_df.csv")


```




#### OXA

```{r}
#### 3h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D10_df.csv")


```




#### CIS

```{r}
#### 3h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(3h) vs PBS(3h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(6h) vs PBS(6h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(12h) vs PBS(12h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(18h) vs PBS(18h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(24h) vs PBS(24h)_all_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_all_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_all_overlap_in_vitro_in_vivo_kegg_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_all_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_all_in_vitro_in_vivo_24h_D10_df.csv")


```






### Up

#### MTX

```{r}
#### 3h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


```




#### OXA

```{r}
#### 3h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


```




#### CIS

```{r}
#### 3h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


```


### Down

#### MTX

```{r}
#### 3h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_MTX(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_MTX(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/MTX/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


```




#### OXA

```{r}
#### 3h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_OXA(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_OXA(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/OXA/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


```




#### CIS

```{r}
#### 3h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_3h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(3h) vs PBS(3h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_3h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_3h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_3h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/3h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_3h_D10_df.csv")





#### 6h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_6h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(6h) vs PBS(6h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_6h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_6h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_6h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/6h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_6h_D10_df.csv")





#### 12h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_12h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(12h) vs PBS(12h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_12h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_12h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_12h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/12h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_12h_D10_df.csv")





#### 18h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_18h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(18h) vs PBS(18h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_18h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_18h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_18h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/18h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_18h_D10_df.csv")




#### 24h

overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D3) vs PBS(D3)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_24h_D3.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D3_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D3_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D3_df.csv")


overlap_in_vitro_in_vivo_kegg("Bulk_RNA_in_vitro/in_vitro_results/final_enriched_kegg_terms_CIS(24h) vs PBS(24h)_up_diff_genes.csv", "Bulk_RNA_in_vivo/in_vivo_results/final_enriched_kegg_terms_CIS(D10) vs PBS(D10)_up_diff_genes.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_up_overlap_in_vitro_in_vivo_kegg_list_24h_D10.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vitro_overlap_24h_D10_df.csv", "Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/enriched_terms_up_in_vivo_overlap_24h_D10_df.csv",
"Enrichment_overlap_in_vitro_in_vivo/kegg/CIS/24h_vs_D3+D10+D22/overlap_genes_overlapping_enriched_terms_up_in_vitro_in_vivo_24h_D10_df.csv")


```





```{r}
# Get DEA figures in vitro

top_table_in_vitro <- read.csv("~/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv")
top_table_in_vitro_MTX_24h <- top_table_in_vitro %>% filter(contrast == "MTX_24h_vs_Control_24h")
  
  
volcano_plot_MTX_24h <- ggplot(top_table_in_vitro_MTX_24h, mapping = aes(x=logFC, y=-log10(adj.P.Val), 
                       label=genes)) + 
  
  geom_point(data=filter(top_table_in_vitro_MTX_24h, logFC > 2 & adj.P.Val <= 
                           0.05), 
             color="dodgerblue", size=3,shape=21, fill="dodgerblue") +
  
  
  geom_point(data=filter(top_table_in_vitro_MTX_24h, logFC < -2 & 
                           adj.P.Val <= 0.05), color="lightskyblue", 
             size=3,shape=21, fill="lightskyblue") +
  
  
  geom_point(data=filter(top_table_in_vitro_MTX_24h, abs(logFC) < 2 | adj.P.Val > 0.05, color="lightgray", size=3,shape=21, fill="lightgray")) + 
               
  
  ggrepel::geom_label_repel(data=filter(top_table_in_vitro_MTX_24h, abs(logFC) > 2 & adj.P.Val <= 10e-20),aes(label = genes) , label.size = 0.08, label.padding = 0.08, max.overlaps = Inf) +
                               
                      
  geom_hline(yintercept = -log10(0.05), colour = "black", linetype 
             ="dashed") +
  
  geom_vline(xintercept = c(-2,2), colour="black", linetype 
             ="dashed") +
  
  ggtitle("MTX vs CTRL - 24h") +
  
  theme(plot.title = element_text(hjust=0.5,face="bold")) +
  
  theme(axis.title = element_text(face="bold")) +
                           
  theme(axis.text = element_text(face="bold")) +
    
  labs(x = "log2FoldChange", y = "-log10(FDR)")
  


```





# GSEA + ORA for publication

```{r}
run_gsea_go <- function(top_table_filename, contrast_interest, setting, directory_interest){
  
  library(clusterProfiler)
  library(tidyverse)
  top_table_contrast_interest <- read.csv(top_table_filename) %>% filter(contrast == contrast_interest) %>% mutate(rank = sign(logFC) * -log10(adj.P.Val)) %>% arrange(desc(rank))
  gene_list_interest <- top_table_contrast_interest$rank
  names(gene_list_interest) <- top_table_contrast_interest$genes
  gsea_contrast_interest <- gseGO(gene_list_interest, ont = "ALL", OrgDb = "org.Mm.eg.db", keyType = "SYMBOL", eps=0)
  for (i in 1:50){
    
    gseaplot(gsea_contrast_interest, geneSetID = i, by="runningScore", title = gsea_contrast_interest$Description[i]) + theme(plot.title = element_text(face = "bold", hjust=0.5)) + theme(axis.title.x = element_text(face = "")) + theme(axis.title.x = element_text(size = 15, face="italic")) + theme(axis.title.y = element_text(size=15, face="italic"))
    
    
    ggsave(paste0("figures_for_publication","/",setting,"/","GSEA/", directory_interest,"/",gsea_contrast_interest$Description[i],".png"))
    
    
  }
}



```



```{r}

# In vitro 

# MTX

run_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_24h_vs_Control_24h","In_vitro", "MTX vs Control")
run_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_18h_vs_Control_18h","In_vitro", "MTX vs Control")
run_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_12h_vs_Control_12h","In_vitro", "MTX vs Control")
run_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_6h_vs_Control_6h","In_vitro", "MTX vs Control")
run_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_3h_vs_Control_3h","In_vitro", "MTX vs Control")



# OXA

run_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_24h_vs_Control_24h","In_vitro", "OXA vs Control")
run_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_18h_vs_Control_18h","In_vitro", "OXA vs Control")
run_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_12h_vs_Control_12h","In_vitro", "OXA vs Control")
run_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_6h_vs_Control_6h","In_vitro", "OXA vs Control")
run_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "OXA_3h_vs_Control_3h","In_vitro", "OXA vs Control")



# CIS

run_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_24h_vs_Control_24h","In_vitro", "CIS vs Control")
run_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_18h_vs_Control_18h","In_vitro", "CIS vs Control")
run_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_12h_vs_Control_12h","In_vitro", "CIS vs Control")
run_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_6h_vs_Control_6h","In_vitro", "CIS vs Control")
run_gsea_go("Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "CIS_3h_vs_Control_3h","In_vitro", "CIS vs Control")

```


```{r}
# In vivo



# MTX

run_gsea_go("top_table_in_vivo_for_Andrea.csv", "MTX_D3_vs_PBS_D3","In_vivo", "MTX vs Control")
run_gsea_go("top_table_in_vivo_for_Andrea.csv", "MTX_D10_vs_PBS_D10","In_vivo", "MTX vs Control")



# OXA

run_gsea_go("top_table_in_vivo_for_Andrea.csv", "OXA_D3_vs_PBS_D3","In_vivo", "OXA vs Control")
run_gsea_go("top_table_in_vivo_for_Andrea.csv", "OXA_D10_vs_PBS_D10","In_vivo", "OXA vs Control")



# CIS

run_gsea_go("top_table_in_vivo_for_Andrea.csv", "CIS_D3_vs_PBS_D3","In_vivo", "CIS vs Control")
run_gsea_go("top_table_in_vivo_for_Andrea.csv", "CIS_D10_vs_PBS_D10","In_vivo", "CIS vs Control")

```







```{r}
enrich_plot_go_for_publi <- function(ordered_go_terms_overlap_filename, treatment, timepoint_1, timepoint_2, dotplot_overlap_filename, top_table_filename, contrast_interest, setting, dotplot_gsea_filename){
  
  
  library(patchwork)
  library(tidyverse)
  library(clusterProfiler)
  
  ordered_go_terms_overlap <- read.csv(ordered_go_terms_overlap_filename)
  
  ordered_go_terms_by_prop_overlap <- ordered_go_terms_overlap %>% arrange(desc(prop_overlap))
  
  if (!is.null(ordered_go_terms_overlap)){
    
    if (dim(ordered_go_terms_overlap)[1] < 3){
      
      
      dotplot <- ggplot2::ggplot(data = ordered_go_terms_overlap[1:min(20, nrow(ordered_go_terms_overlap)),], 
                        mapping = aes(x = prop_overlap,
                        y = reorder(Biological_Processes,prop_overlap),
                        color = p.adjust,
                        size = prop_overlap)) + 
                        geom_point() + 
                        scale_color_gradient(low = "red", high = "blue") + 
                        theme_bw() +
                        xlab("Proportion of Overlap (in %)") +
                        ylab("GO (BP/MF/CC) ontology") +
                        ggtitle(paste0(treatment," ","(",timepoint_1,")")) +
                        theme(axis.text= element_text(face = "bold")) +
                        theme(axis.title.x = element_text(size = 12, face="italic"))  +
                        theme(axis.title.y = element_text(size = 12, face="italic"))  +
                        theme(plot.title = element_text(size=12, face="bold", hjust = 0.5)) 
      
      ggsave(dotplot_overlap_filename, width=8, height=7, dpi=400)
       
     }
     
     
     else {
       
       top_table_contrast_interest <- read.csv(top_table_filename) %>% filter(contrast == contrast_interest) %>% mutate(rank = sign(logFC) * -log10(adj.P.Val)) %>% arrange(desc(rank))
       gene_list_interest <- top_table_contrast_interest$rank
       names(gene_list_interest) <- top_table_contrast_interest$genes
       gsea_contrast_interest <- gseGO(gene_list_interest, ont = "ALL", OrgDb = "org.Mm.eg.db", keyType = "SYMBOL", eps=0, pvalueCutoff = 1)
       
       dotplot <- ggplot2::ggplot(data = ordered_go_terms_overlap[1:min(20, nrow(ordered_go_terms_overlap)),], 
                        mapping = aes(x = prop_overlap,
                        y = reorder(Biological_Processes,prop_overlap),
                        color = p.adjust,
                        size = prop_overlap)) + 
                        geom_point() + 
                        scale_color_gradient(low = "red", high = "blue") + 
                        theme_bw() +
                        xlab("Proportion of Overlap (in %)") +
                        ylab("GO (BP/MF/CC) ontology") +
                        ggtitle(paste0(treatment," ","(",timepoint_1,")")) +
                        theme(axis.text= element_text(face = "bold")) +
                        theme(axis.title.x = element_text(size = 11, face="italic"))  +
                        theme(axis.title.y = element_text(size = 11, face="italic"))  +
                        theme(plot.title = element_text(size=12, face="bold", hjust = 0.5))
       
       
       
       gse_plots <- lapply(ordered_go_terms_by_prop_overlap$Description[1:3], function(x){ 
       id <- which(gsea_contrast_interest$Description == x)
       gseaplot(gsea_contrast_interest, geneSetID = id, by="runningScore", title = x) + theme(plot.title = element_text(face = "bold", hjust=0.5, size=10)) + theme(axis.title.x = element_text(face = "")) + theme(axis.title.x = element_text(size = 11, face="italic")) + theme(axis.title.y = element_text(size=11, face="italic"))
        })
       
       
       
       wrap_plots(list(dotplot , wrap_plots(gse_plots, ncol = 1)), widths = c(1.5,2)) + plot_annotation(title = paste("EnrichGO: ",treatment,"(",timepoint_1,")", "/", treatment,"(",timepoint_2,")"," ", "-"," ","overlap"," ","(",setting,")", sep=""), theme = theme(plot.title = element_text(face= "bold", hjust=0.5)))
       ggsave(dotplot_gsea_filename, units = "in", width = 13, height = 6.46)
       
     
     }
    
  }
}
  
 

```


## MTX

### In vitro (overlap with in vivo)
```{r}

# 24h

enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D3_df.csv", "MTX", "24h", "D3", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/24h vs D3/dotplot_in_vitro_overlap_in_vitro_in_vivo_MTX_24h_D3_all.df", "Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_24h_vs_Control_24h", "In vitro", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/24h vs D3/dotplot_gsea_in_vitro_MTX_24h_vs_D3.pdf")



enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/24h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_24h_D10_df.csv", "MTX", "24h", "D10", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/24h vs D10/dotplot_in_vitro_overlap_in_vitro_in_vivo_MTX_24h_D10_all.df", "Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_24h_vs_Control_24h", "In vitro", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/24h vs D10/dotplot_gsea_in_vitro_MTX_24h_vs_D10.pdf")



# 18h

enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D3_df.csv", "MTX", "18h", "D3", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/18h vs D3/dotplot_in_vitro_overlap_in_vitro_in_vivo_MTX_18h_D3_all.df", "Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_18h_vs_Control_18h", "In vitro", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/18h vs D3/dotplot_gsea_in_vitro_MTX_18h_vs_D3.pdf")



enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/18h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_18h_D10_df.csv", "MTX", "18h", "D10", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/18h vs D10/dotplot_in_vitro_overlap_in_vitro_in_vivo_MTX_18h_D10_all.df", "Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_18h_vs_Control_18h", "In vitro", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/18h vs D10/dotplot_gsea_in_vitro_MTX_18h_vs_D10.pdf")



# 12h

enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D3_df.csv", "MTX", "12h", "D3", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/12h vs D3/dotplot_in_vitro_overlap_in_vitro_in_vivo_MTX_12h_D3_all.df", "Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_12h_vs_Control_12h", "In vitro", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/12h vs D3/dotplot_gsea_in_vitro_MTX_12h_vs_D3.pdf")



enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/12h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_12h_D10_df.csv", "MTX", "12h", "D10", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/12h vs D10/dotplot_in_vitro_overlap_in_vitro_in_vivo_MTX_12h_D10_all.df", "Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_12h_vs_Control_12h", "In vitro", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/12h vs D10/dotplot_gsea_in_vitro_MTX_12h_vs_D10.pdf")



# 6h

enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D3_df.csv", "MTX", "6h", "D3", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/6h vs D3/dotplot_in_vitro_overlap_in_vitro_in_vivo_MTX_6h_D3_all.df", "Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_6h_vs_Control_6h", "In vitro", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/6h vs D3/dotplot_gsea_in_vitro_MTX_6h_vs_D3.pdf")



enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/6h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_6h_D10_df.csv", "MTX", "6h", "D10", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/6h vs D10/dotplot_in_vitro_overlap_in_vitro_in_vivo_MTX_6h_D10_all.df", "Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_6h_vs_Control_6h", "In vitro", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/6h vs D10/dotplot_gsea_in_vitro_MTX_6h_vs_D10.pdf")



# 3h

enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D3_df.csv", "MTX", "3h", "D3", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/3h vs D3/dotplot_in_vitro_overlap_in_vitro_in_vivo_MTX_3h_D3_all.df", "Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_3h_vs_Control_3h", "In vitro", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/3h vs D3/dotplot_gsea_in_vitro_MTX_3h_vs_D3.pdf")



enrich_plot_go_for_publi("Enrichment_overlap_in_vitro_in_vivo/GO/MTX/3h_vs_D3+D10+D22/enriched_terms_all_in_vitro_overlap_3h_D10_df.csv", "MTX", "3h", "D10", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/3h vs D10/dotplot_in_vitro_overlap_in_vitro_in_vivo_MTX_3h_D10_all.df", "Bulk_RNA_in_vitro/in_vitro_results/top_table_drug_control_in_vitro.csv", "MTX_3h_vs_Control_3h", "In vitro", "figures_for_publication/In_vitro/all_diff_genes (all results)/MTX/3h vs D10/dotplot_gsea_in_vitro_MTX_3h_vs_D10.pdf")

```





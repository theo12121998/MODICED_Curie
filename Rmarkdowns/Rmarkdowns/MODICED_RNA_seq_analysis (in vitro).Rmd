---
author: "Th√©o Lassale"
editor_options: 
  chunk_output_type: console
date: '`r Sys.Date()`'
output:
  html_document:
  theme: flatly
toc: true
toc_float: true
code_folding: hide
---
  
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r}
library(dplyr)
library(ggvenn)
library(tidyverse)
library(rtracklayer)
library(DESeq2)
library(FactoMineR)
library(factoextra)
library(patchwork)
library(edgeR)
library(clusterProfiler)
library(DOSE)
library(enrichplot)
library(org.Mm.eg.db)
library(forcats)
library(reactome.db)
library(ReactomePA)
library(EBSeq)
library(Trendy)
library(edgeR)
library(rRoma)
```


```{r annotation}

gtf <- import("/data/annotations/pipelines/Mouse/mm10/gtf/gencode.vM22.annotation.gtf")
gtf_annot <- gtf %>% as_tibble() %>% filter(type == "gene") %>%  mutate(gene_id = str_remove(gene_id, "\\..*"))

annot_gene_mod_2 <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/preprocessing_in_vitro_RNA/results_pipeline/counts/tableannot.csv") %>% dplyr::select(gene_id, gene_name) %>% full_join(gtf_annot[, c("gene_id","gene_type")], by="gene_id")

```

```{r samplePlan}
sample_plan_mod_2 <- read.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/preprocessing_in_vitro_RNA/samplePlan.csv", header=FALSE)
colnames(sample_plan_mod_2) <- c("Sample_ID", "Sample_Name", "Path_to_R1")
sample_plan_mod_2[grepl("MTX", sample_plan_mod_2$Sample_Name), "Treatment"] <- "MTX"
sample_plan_mod_2[grepl("OXA", sample_plan_mod_2$Sample_Name), "Treatment"] <- "OXA"
sample_plan_mod_2[grepl("CIS", sample_plan_mod_2$Sample_Name), "Treatment"] <- "CIS"
sample_plan_mod_2[grepl("Control", sample_plan_mod_2$Sample_Name), "Treatment"] <- "Control"

sample_plan_mod_2[grepl("3h", sample_plan_mod_2$Sample_Name), "Time_Point"] <- "3h"
sample_plan_mod_2[grepl("6h", sample_plan_mod_2$Sample_Name), "Time_Point"] <- "6h"
sample_plan_mod_2[grepl("12h", sample_plan_mod_2$Sample_Name), "Time_Point"] <- "12h"
sample_plan_mod_2[grepl("18h", sample_plan_mod_2$Sample_Name), "Time_Point"] <- "18h"
sample_plan_mod_2[grepl("24h", sample_plan_mod_2$Sample_Name), "Time_Point"] <- "24h"

sample_plan_mod_2 <- sample_plan_mod_2 %>% tidyr::unite(col = "Treatment_hour", Treatment, Time_Point, remove = FALSE, sep = "_") %>% relocate(Treatment_hour, .after = Time_Point)
rownames(sample_plan_mod_2) <- sample_plan_mod_2$Sample_Name

```

```{r counts_table}

counts_mod_2 <- read_delim("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/preprocessing_in_vitro_RNA/results_pipeline/counts/tablecounts_raw_2.csv")

# Add gene name + gene type to table of counts
counts_mod_2 <- counts_mod_2 %>% 
                 dplyr::rename("gene_id" = "...1") %>% 
                 inner_join(., annot_gene_mod_2, by = "gene_id") %>%
                 dplyr::relocate(gene_name, .after = gene_id) %>% 
                 dplyr::relocate(gene_type, .after = gene_name)
                 

counts_mod_2 <- counts_mod_2[, c("gene_id", "gene_type", "gene_name", sample_plan_mod_2$Sample_ID)]
colnames(counts_mod_2)[4:ncol(counts_mod_2)] <- sample_plan_mod_2$Sample_Name
```



# **1. Principal Component Analysis** 



```{r}
counts_mod_2_pca <- counts_mod_2 %>% dplyr::select(-c(1:3))
dds <- DESeqDataSetFromMatrix(countData = counts_mod_2_pca, colData = DataFrame(Treatment = sample_plan_mod_2$Treatment, Time_point = factor(sample_plan_mod_2$Time_Point)), ~ Treatment)
dds <- estimateSizeFactors(dds)
dds <- dds[rowSums(counts(dds)) > 0, ]
rld <- vst(dds, blind=TRUE)
vst_matrix <- assay(rld)
run_pca <- PCA(t(vst_matrix), ncp=4, graph=FALSE)

fviz_pca_ind(run_pca, label="ind", habillage = as.factor(sample_plan_mod_2$Treatment), repel=TRUE, pointsize = 3, labelsize = 3, invisible = "quali")
ggsave("PCA-PC1 vs PC2 (colored by Treatment).pdf")
fviz_pca_ind(run_pca, label="ind", habillage = as.factor(sample_plan_mod_2$Treatment), repel=TRUE, pointsize = 3, labelsize = 3, invisible = "quali", axes = c(1,3))
ggsave("PCA-PC1 vs PC3 (colored by Treatment).pdf")
fviz_pca_ind(run_pca, label="ind", habillage = as.factor(sample_plan_mod_2$Treatment), repel=TRUE, pointsize = 3, labelsize = 3, invisible = "quali", axes = c(2,3))
ggsave("PCA-PC2 vs PC3 (colored by Treatment).pdf")
fviz_pca_ind(run_pca, label="none", habillage = as.factor(sample_plan_mod_2$Time_Point), repel=TRUE, pointsize = 3, labelsize = 3, invisible = "quali")

```


# **2. Differential Expression Analysis** 


```{r run_dea}
dge <- DGEList(counts = dplyr::select(counts_mod_2, -c(1:3)), samples = sample_plan_mod_2, genes = counts_mod_2$gene_name)
design_dge <- model.matrix(~ 0 + Treatment_hour, data= dge$samples)
colnames(design_dge) <- sub("Treatment_hour", "", colnames(design_dge))
keep <- filterByExpr(dge, design_dge)
dge_filtered <- dge[keep,]
dge_filtered <- calcNormFactors(dge_filtered, method="TMM")
voom <- voomWithQualityWeights(dge_filtered, design_dge)
fit_dea <- lmFit(voom, design_dge)
```

```{r get_contrasts}

contrasts_dea_3h <- makeContrasts(MP_3h = MTX_3h - Control_3h, OP_3h = OXA_3h - Control_3h, CP_3h = CIS_3h - Control_3h, levels = design_dge)
fit_contrast_3h <- contrasts.fit(fit_dea, contrasts_dea_3h)
fit_contrast_3h <- eBayes(fit_contrast_3h)

contrasts_dea_6h <- makeContrasts(MP_6h = MTX_6h - Control_6h, OP_6h = OXA_6h - Control_6h, CP_6h = CIS_6h - Control_6h, levels = design_dge)
fit_contrast_6h <- contrasts.fit(fit_dea, contrasts_dea_6h)
fit_contrast_6h <- eBayes(fit_contrast_6h)

contrasts_dea_12h <- makeContrasts(MP_12h = MTX_12h - Control_12h, OP_12h = OXA_12h - Control_12h, CP_12h = CIS_12h - Control_12h, levels = design_dge)
fit_contrast_12h <- contrasts.fit(fit_dea, contrasts_dea_12h)
fit_contrast_12h <- eBayes(fit_contrast_12h)

contrasts_dea_18h <- makeContrasts(MP_18h = MTX_18h - Control_18h, OP_18h = OXA_18h - Control_18h, CP_18h = CIS_18h - Control_18h, levels = design_dge)
fit_contrast_18h <- contrasts.fit(fit_dea, contrasts_dea_18h)
fit_contrast_18h <- eBayes(fit_contrast_18h)

contrasts_dea_24h <- makeContrasts(MP_24h = MTX_24h - Control_24h, OP_24h = OXA_24h - Control_24h, CP_24h = CIS_24h - Control_24h, levels = design_dge)
fit_contrast_24h <- contrasts.fit(fit_dea, contrasts_dea_24h)
fit_contrast_24h <- eBayes(fit_contrast_24h)

```


```{r get_results_dea}
get_results_dea <- function(fit_contrast, a, toptable_file, genes_up_reg_filename, genes_down_reg_filename, diff_gene_list, label, volcano_plot_colored_by_logFC_png, volcano_plot_colored_by_coding_genes_png, volcano_plot_colored_by_non_coding_genes_png, volcano_plot_colored_by_logFC_html, volcano_plot_colored_by_coding_genes_html, volcano_plot_colored_by_non_coding_genes_html, proportion_diff_gene_by_type, proportion_diff_gene_by_type_barplot, proportion_of_up_down_reg_by_type){
  
  # Top table (+ update Top table)
  genes <- topTable(fit_contrast, sort.by= "P", adjust.method = "BH", number = Inf, coef = a) %>%
  rownames_to_column("gene_id") %>%
  left_join(annot_gene_mod_2[,c("gene_id","gene_type")], by="gene_id") %>%
  mutate(gene_type_summary = case_when(gene_type != "protein_coding" & gene_type != "Mt_tRNA" & gene_type != "Mt_rRNA" &  adj.P.Val < 0.05 & abs(logFC) > 1 ~ "significant non_coding_gene (not mitochondrial)", (gene_type == "Mt_tRNA" | gene_type == "Mt_rRNA") &  adj.P.Val < 0.05 & abs(logFC) > 1 ~ "significant non_coding_gene (mitochondrial)", gene_type == "protein_coding" & adj.P.Val < 0.05 & abs(logFC) > 1 ~ "significant protein_coding_gene", TRUE ~ "not_significant"))


  attach(genes)
  gene_type_summary[which(gene_type_summary == "not_significant" & gene_type == "protein_coding")]  <- "not_significant protein_coding_gene"
  gene_type_summary[which(gene_type_summary == "not_significant" & (gene_type == "Mt_tRNA" | gene_type == "Mt_rRNA"))]  <- "not_significant non_coding_gene (mitochondrial)"
  gene_type_summary[which(gene_type_summary == "not_significant" & gene_type != "Mt_tRNA"
                                      & gene_type != "Mt_rRNA" & gene_type != "protein_coding")]  <- "not_significant non_coding_gene (not mitochondrial)"
  
get_genes <- genes %>% write.csv(toptable_file, col.names = TRUE, row.names = TRUE)
  
  # Filter by adj p-value < 0.05
  diff_genes <- genes  %>%
    filter(adj.P.Val < 0.05, abs(logFC) > 1) %>% 
    dplyr::select(gene_id, genes, logFC, adj.P.Val, gene_type, gene_type_summary) %>% 
    mutate(group = if_else(logFC < 0, "down", "up"))
  
  diff_genes_up <- diff_genes %>% filter(group == "up") %>% 
    pull("genes") %>% write.csv(genes_up_reg_filename)
  
  diff_genes_down <- diff_genes %>% filter(group == "down") %>% 
    pull("genes") %>% write.csv(genes_down_reg_filename)
  
  # Concatenate in vectors (list of genes)
  diff_genes %>% 
    dplyr::select(genes, group) %>% 
    write.csv(diff_gene_list)
  
  # Volcano Plot - Colored by logFC/adj p-value
  volcano_by_logFC <- genes %>% 
    ggplot(aes(x=logFC, y=-log10(adj.P.Val), label=genes)) +
    geom_point(color="grey") +
    geom_point(data = filter(genes, logFC > 1 & adj.P.Val < 0.05), color="red") +
    geom_point(data = filter(genes, logFC < -1 & adj.P.Val < 0.05), color="blue") +
    geom_point(data = filter(genes, adj.P.Val < 0.05 & (logFC > 0 & logFC < 1) ), color="orange") +
    geom_point(data = filter(genes, adj.P.Val < 0.05 & (logFC < 0 & logFC >  -1)), color="lightblue") +
    geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") +
    geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") +
    ylab("-log10(adj.P.value)") +
    xlab("log2(FoldChange)") +
    theme_linedraw() +
    ggtitle(label) +
    theme(plot.title=element_text(hjust=0.5, face="bold"))
  
  ggsave(volcano_plot_colored_by_logFC_png, width = 9, height = 5)



# Volcano plot -  Colored by coding genes
volcano_by_coding <- genes %>% subset(gene_type_summary == "significant protein_coding_gene" | gene_type_summary == "not_significant protein_coding_gene") %>% 
  ggplot(aes(x=logFC, y=-log10(adj.P.Val), label=genes)) +
  geom_point(mapping = aes(color=gene_type_summary), pch = 1, size = 3) +
  scale_color_manual(values = c("blue","red")) +
  geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") +
  geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") +
  ylab("-log10(adj.P.value)") +
  xlab("log2(FoldChange)") +
  theme_linedraw() +
  ggtitle(label) +
  theme(plot.title=element_text(hjust=0.5, face="bold"))

ggsave(volcano_plot_colored_by_coding_genes_png, width=9, height=5)



# Volcano plot -  Colored by non-coding genes
mito_genes <- genes %>% filter(gene_type_summary == "significant non_coding_gene (mitochondrial)" | gene_type_summary == "not_significant non_coding_gene (mitochondrial)")
volcano_by_non_coding <- genes %>% subset(gene_type_summary != "significant protein_coding_gene" & gene_type_summary != "not_significant protein_coding_gene") %>% bind_rows(mito_genes) %>% 
  ggplot(aes(x=logFC, y=-log10(adj.P.Val), label=genes)) +
  geom_point(mapping = aes(color=gene_type_summary), pch = 1, size = 3) +
  scale_color_manual(values = c("blue","yellow", "green", "red")) +
  geom_vline(xintercept = c(-1,1), colour = "black", linetype = "dashed") +
  geom_hline(yintercept = (-log10(0.05)), colour = "black", linetype = "dashed") +
  ylab("-log10(adj.P.value)") +
  xlab("log2(FoldChange)") +
  theme_linedraw() +
  ggtitle(label) +
  theme(plot.title=element_text(hjust=0.5, face="bold"))


ggsave(volcano_plot_colored_by_non_coding_genes_png, width=9, height=5)


# Plotly + Save object
volcano_by_logFC_plotly <- plotly::ggplotly(volcano_by_logFC)
htmlwidgets::saveWidget(volcano_by_logFC_plotly, volcano_plot_colored_by_logFC_html)

volcano_by_coding_plotly <- plotly::ggplotly(volcano_by_coding)
htmlwidgets::saveWidget(volcano_by_coding_plotly, volcano_plot_colored_by_coding_genes_html)

volcano_by_non_coding_plotly <- plotly::ggplotly(volcano_by_non_coding)
htmlwidgets::saveWidget(volcano_by_non_coding_plotly, volcano_plot_colored_by_non_coding_genes_html)


# Get proportion of differentially expressed coding and non-coding genes
prop_by_type_diff_gene <- diff_genes %>%
  dplyr::group_by(gene_type_summary) %>%
  dplyr::summarise(count = n()) %>%
  mutate(prop = count / sum(count))
  
write.csv(prop_by_type_diff_gene, file=proportion_diff_gene_by_type, quote=FALSE, col.names = TRUE, row.names = FALSE)

# Corresponding Barplot
prop_by_type_diff_gene_barplot <- ggplot(prop_by_type_diff_gene, aes(x=gene_type_summary, y=prop)) + geom_bar(stat = "identity")
ggsave(proportion_diff_gene_by_type_barplot)


# Get proportion of up and down regulated genes by gene type
prop_by_type_up_down_genes <- diff_genes %>%
  dplyr::count(gene_type_summary, group) %>%
  dplyr::group_by(group) %>%
  dplyr::mutate(prop = n / sum(n)) %>%
  ungroup()

write.csv(prop_by_type_up_down_genes, file=proportion_of_up_down_reg_by_type, quote=FALSE, col.names=TRUE, row.names=FALSE)
}
```


## **2.1. MTX vs PBS** {.tabset .tabset-fade .tabset-pills}


### 3h
```{r results_dea_MTX(3h)_vs_PBS(3h)}
get_results_dea(fit_contrast_3h, "MP_3h", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_MTX(3h)_vs_PBS(3h).csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_MTX(3h)_vs_PBS(3h)_up_reg.csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_MTX(3h)_vs_PBS(3h)_down_reg.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_3h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano Plot: MTX(3h)_vs_PBS(3h)", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(3h)_vs_PBS(3h)_colored_by_logFC_and_adj.P.val.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(3h)_vs_PBS(3h)_colored_by_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(3h)_vs_PBS(3h)_colored_by_non_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(3h)_vs_PBS(3h)_colored_by_logFC_and_adj.P.val.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(3h)_vs_PBS(3h)_colored_by_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(3h)_vs_PBS(3h)_colored_by_non_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_3h_MP.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_3h_MP_barplot.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/proportion_of_up_down_reg_by_type_3h_MP.csv")
```

### 6h
```{r results_dea_MTX(6h)_vs_PBS(6h)}
get_results_dea(fit_contrast_6h, "MP_6h", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_MTX(6h)_vs_PBS(6h).csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_MTX(6h)_vs_PBS(6h)_up_reg.csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_MTX(6h)_vs_PBS(6h)_down_reg.csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_6h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano Plot: MTX(6h)_vs_PBS(6h)", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(6h)_vs_PBS(6h)_colored_by_logFC_and_adj.P.val.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(6h)_vs_PBS(6h)_colored_by_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(6h)_vs_PBS(6h)_colored_by_non_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(6h)_vs_PBS(6h)_colored_by_logFC_and_adj.P.val.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(6h)_vs_PBS(6h)_colored_by_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(6h)_vs_PBS(6h)_colored_by_non_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_6h_MP.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_6h_MP_barplot.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/proportion_of_up_down_reg_by_type_6h_MP.csv")
```

### 12h
```{r results_dea_MTX(12h)_vs_PBS(12h)}
get_results_dea(fit_contrast_12h, "MP_12h", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_MTX(12h)_vs_PBS(12h).csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_MTX(12h)_vs_PBS(12h)_up_reg.csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_MTX(12h)_vs_PBS(12h)_down_reg.csv","/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_12h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano Plot: MTX(12h)_vs_PBS(12h)", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(12h)_vs_PBS(12h)_colored_by_logFC_and_adj.P.val.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(12h)_vs_PBS(12h)_colored_by_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(12h)_vs_PBS(12h)_colored_by_non_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(12h)_vs_PBS(12h)_colored_by_logFC_and_adj.P.val.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(12h)_vs_PBS(12h)_colored_by_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(12h)_vs_PBS(12h)_colored_by_non_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_12h_MP.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_12h_MP_barplot.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/proportion_of_up_down_reg_by_type_12h_MP.csv")
```

### 18h
```{r results_dea_MTX(18h)_vs_PBS(18h)}
get_results_dea(fit_contrast_18h, "MP_18h", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_MTX(18h)_vs_PBS(18h).csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_MTX(18h)_vs_PBS(18h)_up_reg.csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_MTX(18h)_vs_PBS(18h)_down_reg.csv","/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_18h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano Plot: MTX(18h)_vs_PBS(18h)", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(18h)_vs_PBS(18h)_colored_by_logFC_and_adj.P.val.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(18h)_vs_PBS(18h)_colored_by_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(18h)_vs_PBS(18h)_colored_by_non_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(18h)_vs_PBS(18h)_colored_by_logFC_and_adj.P.val.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(18h)_vs_PBS(18h)_colored_by_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(18h)_vs_PBS(18h)_colored_by_non_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_18h_MP.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_18h_MP_barplot.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/proportion_of_up_down_reg_by_type_18h_MP.csv")
```


### 24h
```{r results_dea_MTX(24h)_vs_PBS(24h)}
get_results_dea(fit_contrast_24h, "MP_24h", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_MTX(24h)_vs_PBS(24h).csv", 
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_MTX(24h)_vs_PBS(24h)_up_reg.csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_MTX(24h)_vs_PBS(24h)_down_reg.csv","/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_24h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano Plot: MTX(24h)_vs_PBS(24h)", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(24h)_vs_PBS(24h)_colored_by_logFC_and_adj.P.val.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(24h)_vs_PBS(24h)_colored_by_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(24h)_vs_PBS(24h)_colored_by_non_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(24h)_vs_PBS(24h)_colored_by_logFC_and_adj.P.val.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(24h)_vs_PBS(24h)_colored_by_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_MTX(24h)_vs_PBS(24h)_colored_by_non_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_24h_MP.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_24h_MP_barplot.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/proportion_of_up_down_reg_by_type_24h_MP.csv")
```




## **2.2. Oxa vs PBS** {.tabset .tabset-fade .tabset-pills}


### 3h
```{r results_dea_Oxa(3h)_vs_PBS(3h)}
get_results_dea(fit_contrast_3h, "OP_3h", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_OXA(3h)_vs_PBS(3h).csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_OXA(3h)_vs_PBS(3h)_up_reg.csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_OXA(3h)_vs_PBS(3h)_down_reg.csv", 
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_3h.csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano Plot: Oxa(3h)_vs_PBS(3h)", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(3h)_vs_PBS(3h)_colored_by_logFC_and_adj.P.val.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(3h)_vs_PBS(3h)_colored_by_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(3h)_vs_PBS(3h)_colored_by_non_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(3h)_vs_PBS(3h)_colored_by_logFC_and_adj.P.val.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(3h)_vs_PBS(3h)_colored_by_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(3h)_vs_PBS(3h)_colored_by_non_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_3h_OP.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_3h_OP_barplot.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/proportion_of_up_down_reg_by_type_3h_OP.csv")
```

### 6h
```{r results_dea_Oxa(6h)_vs_PBS(6h)}
get_results_dea(fit_contrast_6h, "OP_6h",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_OXA(6h)_vs_PBS(6h).csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_OXA(6h)_vs_PBS(6h)_up_reg.csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_OXA(6h)_vs_PBS(6h)_down_reg.csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_6h.csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano Plot: Oxa(6h)_vs_PBS(6h)", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(6h)_vs_PBS(6h)_colored_by_logFC_and_adj.P.val.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(6h)_vs_PBS(6h)_colored_by_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(6h)_vs_PBS(6h)_colored_by_non_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(6h)_vs_PBS(6h)_colored_by_logFC_and_adj.P.val.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(6h)_vs_PBS(6h)_colored_by_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(6h)_vs_PBS(6h)_colored_by_non_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_6h_OP.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_6h_OP_barplot.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/proportion_of_up_down_reg_by_type_6h_OP.csv")
```

### 12h
```{r results_dea_Oxa(12h)_vs_PBS(12h)}
get_results_dea(fit_contrast_12h, "OP_12h", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_OXA(12h)_vs_PBS(12h).csv",
                "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_OXA(12h)_vs_PBS(12h)_up_reg.csv", 
                "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_OXA(12h)_vs_PBS(12h)_down_reg.csv",
                "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_12h.csv",
                "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano Plot: Oxa(12h)_vs_PBS(12h)", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(12h)_vs_PBS(12h)_colored_by_logFC_and_adj.P.val.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(12h)_vs_PBS(12h)_colored_by_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(12h)_vs_PBS(12h)_colored_by_non_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(12h)_vs_PBS(12h)_colored_by_logFC_and_adj.P.val.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(12h)_vs_PBS(12h)_colored_by_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(12h)_vs_PBS(12h)_colored_by_non_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_12h_OP.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_12h_OP_barplot.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/proportion_of_up_down_reg_by_type_12h_OP.csv")
```

### 18h
```{r results_dea_Oxa(18h)_vs_PBS(18h)}
get_results_dea(fit_contrast_18h, "OP_18h", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_OXA(18h)_vs_PBS(18h).csv",
                "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_OXA(18h)_vs_PBS(18h)_up_reg.csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_OXA(18h)_vs_PBS(18h)_down_reg.csv","/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_18h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano Plot: Oxa(18h)_vs_PBS(18h)", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(18h)_vs_PBS(18h)_colored_by_logFC_and_adj.P.val.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(18h)_vs_PBS(18h)_colored_by_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(18h)_vs_PBS(18h)_colored_by_non_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(18h)_vs_PBS(18h)_colored_by_logFC_and_adj.P.val.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(18h)_vs_PBS(18h)_colored_by_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(18h)_vs_PBS(18h)_colored_by_non_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_18h_OP.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_18h_OP_barplot.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/proportion_of_up_down_reg_by_type_18h_OP.csv")
```


### 24h
```{r results_dea_Oxa(24h)_vs_PBS(24h)}
get_results_dea(fit_contrast_24h, "OP_24h", 
                "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_OXA(24h)_vs_PBS(24h).csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_OXA(24h)_vs_PBS(24h)_up_reg.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_OXA(24h)_vs_PBS(24h)_down_reg.csv" ,"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_24h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano Plot: Oxa(24h)_vs_PBS(24h)", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(24h)_vs_PBS(24h)_colored_by_logFC_and_adj.P.val.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(24h)_vs_PBS(24h)_colored_by_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(24h)_vs_PBS(24h)_colored_by_non_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(24h)_vs_PBS(24h)_colored_by_logFC_and_adj.P.val.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(24h)_vs_PBS(24h)_colored_by_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Oxa(24h)_vs_PBS(24h)_colored_by_non_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_24h_OP.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_24h_OP_barplot.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/proportion_of_up_down_reg_by_type_24h_OP.csv")
```




## **2.3. Cis vs PBS** {.tabset .tabset-fade .tabset-pills}


### 3h
```{r results_dea_Cis(3h)_vs_PBS(3h)}
get_results_dea(fit_contrast_3h, "CP_3h",
                "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_CIS(3h)_vs_PBS(3h).csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_CIS(3h)_vs_PBS(3h)_up_reg.csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_CIS(3h)_vs_PBS(3h)_down_reg.csv",
                "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_3h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano Plot: Cis(3h)_vs_PBS(3h)", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(3h)_vs_PBS(3h)_colored_by_logFC_and_adj.P.val.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(3h)_vs_PBS(3h)_colored_by_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(3h)_vs_PBS(3h)_colored_by_non_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(3h)_vs_PBS(3h)_colored_by_logFC_and_adj.P.val.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(3h)_vs_PBS(3h)_colored_by_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(3h)_vs_PBS(3h)_colored_by_non_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_3h_CP.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_3h_CP_barplot.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/proportion_of_up_down_reg_by_type_3h_CP.csv")
```

### 6h
```{r results_dea_Cis(6h)_vs_PBS(6h)}
get_results_dea(fit_contrast_6h, "CP_6h",
                "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_CIS(6h)_vs_PBS(6h).csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_CIS(6h)_vs_PBS(6h)_up_reg.csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_CIS(6h)_vs_PBS(6h)_down_reg.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_6h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano Plot: Cis(6h)_vs_PBS(6h)", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(6h)_vs_PBS(6h)_colored_by_logFC_and_adj.P.val.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(6h)_vs_PBS(6h)_colored_by_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(6h)_vs_PBS(6h)_colored_by_non_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(6h)_vs_PBS(6h)_colored_by_logFC_and_adj.P.val.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(6h)_vs_PBS(6h)_colored_by_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(6h)_vs_PBS(6h)_colored_by_non_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_6h_CP.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_6h_CP_barplot.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/proportion_of_up_down_reg_by_type_6h_CP.csv")
```

### 12h
```{r results_dea_Cis(12h)_vs_PBS(12h)}
get_results_dea(fit_contrast_12h, "CP_12h",
                "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_CIS(12h)_vs_PBS(12h).csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_CIS(12h)_vs_PBS(12h)_up_reg.csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_CIS(12h)_vs_PBS(12h)_down_reg.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_12h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano Plot: Cis(12h)_vs_PBS(12h)", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(12h)_vs_PBS(12h)_colored_by_logFC_and_adj.P.val.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(12h)_vs_PBS(12h)_colored_by_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(12h)_vs_PBS(12h)_colored_by_non_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(12h)_vs_PBS(12h)_colored_by_logFC_and_adj.P.val.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(12h)_vs_PBS(12h)_colored_by_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(12h)_vs_PBS(12h)_colored_by_non_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_12h_CP.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_12h_CP_barplot.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/proportion_of_up_down_reg_by_type_12h_CP.csv")
```

### 18h
```{r results_dea_Cis(18h)_vs_PBS(18h)}
get_results_dea(fit_contrast_18h, "CP_18h",
                "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_CIS(18h)_vs_PBS(18h).csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_CIS(18h)_vs_PBS(18h)_up_reg.csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_CIS(18h)_vs_PBS(18h)_down_reg.csv",
                "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_18h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano Plot: Cis(18h)_vs_PBS(18h)", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(18h)_vs_PBS(18h)_colored_by_logFC_and_adj.P.val.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(18h)_vs_PBS(18h)_colored_by_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(18h)_vs_PBS(18h)_colored_by_non_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(18h)_vs_PBS(18h)_colored_by_logFC_and_adj.P.val.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(18h)_vs_PBS(18h)_colored_by_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(18h)_vs_PBS(18h)_colored_by_non_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_18h_CP.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_18h_CP_barplot.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/proportion_of_up_down_reg_by_type_18h_CP.csv")
```


### 24h
```{r results_dea_Cis(24h)_vs_PBS(24h)}
get_results_dea(fit_contrast_24h, "CP_24h",
                "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_CIS(24h)_vs_PBS(24h).csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_CIS(24h)_vs_PBS(24h)_up_reg.csv",
"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/genes_CIS(24h)_vs_PBS(24h)_down_reg.csv",
                "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_24h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano Plot: Cis(24h)_vs_PBS(24h)", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(24h)_vs_PBS(24h)_colored_by_logFC_and_adj.P.val.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(24h)_vs_PBS(24h)_colored_by_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(24h)_vs_PBS(24h)_colored_by_non_coding.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(24h)_vs_PBS(24h)_colored_by_logFC_and_adj.P.val.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(24h)_vs_PBS(24h)_colored_by_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Volcano_plot_Cis(24h)_vs_PBS(24h)_colored_by_non_coding.html", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_24h_CP.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/prop_by_type_diff_genes_24h_CP_barplot.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/proportion_of_up_down_reg_by_type_24h_CP.csv")
```

















# **3. Gene Set Enrichment Analysis**

## 3.1. Gene Ontology



```{r}
# GO dotplot function
enrich_plot_go <- function(test){
if (nrow(test) >= 20){
  ggplot(data = test[1:20,], 
       mapping = aes(x = prop_overlap,
                     y = reorder(Biological_Processes,prop_overlap),
                     color = p.adjust,
                     size = prop_overlap
                     )
       ) + 
geom_point() + 
scale_color_gradient(low = "red", high = "blue") + 
theme_bw() +
xlab("Proportion of Overlap (in %)") +
ylab("Biological Processes") +
theme(axis.text= element_text(face = "bold")) +
theme(axis.title.x = element_text(size = 9)) 
}
else {
    ggplot(data = test, 
       mapping = aes(x = prop_overlap,
                     y = reorder(Biological_Processes,prop_overlap),
                     color = p.adjust,
                     size = prop_overlap
                     )
       ) + 
geom_point() + 
scale_color_gradient(low = "red", high = "blue") + 
theme_bw() +
xlab("Proportion of Overlap (in %)") +
ylab("Biological Processes") +
theme(axis.text= element_text(face = "bold")) +
theme(axis.title.x = element_text(size = 9))
}
}
```



```{r}
# Get GO final results (Dotplot)
get_go <- function(filename, filename_2, filename_3, filename_4, filename_5, filename_6, filename_7){
  
  # Get diff genes
  diff <- read.csv(filename)
  diff_up <- diff %>% filter(group == "up")
  diff_down <- diff %>% filter(group == "down")
  
  
  # Get gene symbol
  all_genes_symbol <- diff$genes
  diff_up_symbol <- diff_up$genes
  diff_down_symbol <- diff_down$genes
  
  # Retrieve ENSEMBL and ENTREZID
  res_bitr_all <- bitr(all_genes_symbol, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = "org.Mm.eg.db")
  res_bitr_up <- bitr(diff_up_symbol, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = "org.Mm.eg.db")
  res_bitr_down <- bitr(diff_down_symbol, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = "org.Mm.eg.db")
  
  # Get ENTREZ ID for list 
  res_bitr_all_list <- list(genes = res_bitr_all$ENTREZID)
  res_bitr_up_list <- list(genes = res_bitr_up$ENTREZID)
  res_bitr_down_list <- list(genes = res_bitr_down$ENTREZID)
  
  # Run GO enrichment analysis
  go_analysis_res_bitr_all_df <- enrichGO(res_bitr_all_list$genes, ont="BP", OrgDb = "org.Mm.eg.db", readable = TRUE)
  go_analysis_res_bitr_up_df <- enrichGO(res_bitr_up_list$genes, ont="BP", OrgDb = "org.Mm.eg.db", readable = TRUE)
  go_analysis_res_bitr_down_df <- enrichGO(res_bitr_down_list$genes, ont="BP", OrgDb = "org.Mm.eg.db", readable = TRUE)
  
  
  # Compute proportion of genes in the GO term that overlaps with the DEGs
  go_analysis_res_bitr_all_df_not_redundant <- simplify(go_analysis_res_bitr_all_df, cutoff=0.7, by="p.adjust", select_fun=min)
  go_analysis_res_bitr_all_df_not_redundant <- go_analysis_res_bitr_all_df_not_redundant %>% dplyr::mutate(prop_overlap  = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),
                                                     Biological_Processes = Description)
  
  
  go_analysis_res_bitr_up_df_not_redundant <- simplify(go_analysis_res_bitr_up_df, cutoff=0.7, by="p.adjust", select_fun=min)
  go_analysis_res_bitr_up_df_not_redundant <- go_analysis_res_bitr_up_df_not_redundant %>% dplyr::mutate(prop_overlap  = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),
                                                     Biological_Processes = Description)
  
  
  go_analysis_res_bitr_down_df_not_redundant <- simplify(go_analysis_res_bitr_down_df, cutoff=0.7, by="p.adjust", select_fun=min)
  go_analysis_res_bitr_down_df_not_redundant <- go_analysis_res_bitr_down_df_not_redundant %>% dplyr::mutate(prop_overlap  = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),
                                                     Biological_Processes = Description)
  
  
  
  # Convert prop overlap in percentage
  go_analysis_res_bitr_all_df_not_redundant <- go_analysis_res_bitr_all_df_not_redundant %>% mutate(prop_overlap = prop_overlap * 100)
  
  go_analysis_res_bitr_up_df_not_redundant <- go_analysis_res_bitr_up_df_not_redundant %>% mutate(prop_overlap = prop_overlap * 100)
  
  go_analysis_res_bitr_down_df_not_redundant <- go_analysis_res_bitr_down_df_not_redundant %>% mutate(prop_overlap = prop_overlap * 100)
  

  # Rank GO terms by prop of overlap
  ordered_go_analysis_res_bitr_all_df <- go_analysis_res_bitr_all_df_not_redundant[order(go_analysis_res_bitr_all_df_not_redundant$prop_overlap, decreasing = TRUE),]
  write.csv(ordered_go_analysis_res_bitr_all_df, filename_5)
  
  ordered_go_analysis_res_bitr_up_df <- go_analysis_res_bitr_up_df_not_redundant[order(go_analysis_res_bitr_up_df_not_redundant$prop_overlap, decreasing = TRUE),] 
  write.csv(ordered_go_analysis_res_bitr_up_df, filename_6)
  
  ordered_go_analysis_res_bitr_down_df <- go_analysis_res_bitr_down_df_not_redundant[order(go_analysis_res_bitr_down_df_not_redundant$prop_overlap, decreasing = TRUE),] 
  write.csv(ordered_go_analysis_res_bitr_down_df, filename_7)
  

  # Dotplot and save it
  enrich_plot_go(ordered_go_analysis_res_bitr_all_df)
  ggsave(filename_2, width=12, height=4)
  enrich_plot_go(ordered_go_analysis_res_bitr_up_df)
  ggsave(filename_3, width=12, height=4)
  enrich_plot_go(ordered_go_analysis_res_bitr_down_df)
  ggsave(filename_4, width=12, height=4)

}

```


```{r}
overlap_intersect_go_by_2 <- function(filename_1, filename_2, filename_3){
  enriched_go_terms_1 <- read.csv(filename_1)
  enriched_go_terms_2 <- read.csv(filename_2)
  intersect_go_terms <- intersect(enriched_go_terms_1$Biological_Processes, enriched_go_terms_2$Biological_Processes)
  write.csv(overlap_intersect_go_by_2, filename_3)
}

overlap_intersect_go_by_3 <- function(filename_1, filename_2, filename_3, filename_4, filename_5){
  enriched_go_terms_1 <- read.csv(filename_1)
  enriched_go_terms_2 <- read.csv(filename_2)
  enriched_go_terms_3 <- read.csv(filename_3)
  intersect_go_terms <- intersect(intersect(enriched_go_terms_1$Biological_Processes, enriched_go_terms_2$Biological_Processes), enriched_go_terms_3$Biological_Processes)
  write.csv(intersect_go_terms, filename_4)
  list_intersect_go_terms <- list(Oxa_vs_PBS = enriched_go_terms_1$Biological_Processes, Cis_vs_PBS = enriched_go_terms_2$Biological_Processes, MTX_vs_PBS = enriched_go_terms_3$Biological_Processes)
  ggvenn(list_intersect_go_terms, stroke_size = 0.5)
  ggsave(filename_5)
}


overlap_intersect_go_by_3_by_treatment <- function(filename_1, filename_2, filename_3, filename_4, filename_5){
  enriched_go_terms_1 <- read.csv(filename_1)
  enriched_go_terms_2 <- read.csv(filename_2)
  enriched_go_terms_3 <- read.csv(filename_3)
  intersect_go_terms <- intersect(intersect(enriched_go_terms_1$Biological_Processes, enriched_go_terms_2$Biological_Processes), enriched_go_terms_3$Biological_Processes)
  write.csv(intersect_go_terms, filename_4)
  list_intersect_go_terms <- list(up_reg_genes_BP = enriched_go_terms_1$Biological_Processes, down_reg_genes_BP = enriched_go_terms_2$Biological_Processes, all_genes_BP = enriched_go_terms_3$Biological_Processes)
  ggvenn(list_intersect_go_terms, stroke_size = 0.5)
  ggsave(filename_5)
}
```


### 3h

```{r}
get_go(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_3h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (all genes): MTX(3h) vs PBS(3h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (up reg genes): MTX(3h) vs PBS(3h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (down reg genes): MTX(3h) vs PBS(3h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_down_genes.csv")

get_go(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_3h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (all genes): Oxa(3h) vs PBS(3h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (up reg genes): Oxa(3h) vs PBS(3h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (down reg genes): Oxa(3h) vs PBS(3h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_down_genes.csv")

get_go(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_3h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (all genes): Cis(3h) vs PBS(3h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (up reg genes): Cis(3h) vs PBS(3h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (down reg genes): Cis(3h) vs PBS(3h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_down_genes.csv")
```


```{r}
# Overlapping enriched GO term on 3h between Oxa and Cis (all genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_all_genes.csv")

# Overlapping enriched GO term on 3h between MTX and Cis (all genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_all_genes.csv")

# Overlapping enriched GO term on 3h between MTX and Oxa (all genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_all_genes.csv")

# Overlapping enriched GO term on 3h between MTX, Oxa and Cis (all genes)
overlap_intersect_go_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_all_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_all_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_all_genes.png")

```

```{r}
# Overlapping enriched GO term on 3h between Oxa and Cis (up genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_up_genes.csv")

# Overlapping enriched GO term on 3h between MTX and Cis (up genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_up_genes.csv")

# Overlapping enriched GO term on 3h between MTX and Oxa (up genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_up_genes.csv")

# Overlapping enriched GO term on 3h between MTX, Oxa and Cis (up genes)
overlap_intersect_go_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_up_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_up_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_up_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_up_genes.png")

```


```{r}
# Overlapping enriched GO term on 3h between Oxa and Cis (down genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_down_genes.csv")

# Overlapping enriched GO term on 3h between MTX and Cis (down genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_down_genes.csv")

# Overlapping enriched GO term on 3h between MTX and Oxa (down genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_down_genes.csv")

# Overlapping enriched GO term on 3h between MTX, Oxa and Cis (down genes)
overlap_intersect_go_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_down_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_down_genes.png")

```

```{r}
# Overlapping enriched GO term between up, down and all the genes for MTX
overlap_intersect_go_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(3h)_vs_PBS(3h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(3h)_vs_PBS(3h)_all_up_down_genes.png")



# Overlapping enriched GO term between up, down and all the genes for OXA
overlap_intersect_go_by_3_by_treatment(filename_1 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_up_genes.csv', filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_OXA(3h)_vs_PBS(3h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_OXA(3h)_vs_PBS(3h)_all_up_down_genes.png")


# Overlapping enriched GO term between up, down and all the genes for CIS
overlap_intersect_go_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_up_genes.csv", filename_2 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_down_genes.csv', filename_3 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_all_genes.csv', filename_4 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_CIS(3h)_vs_PBS(3h)_all_up_down_genes.csv', filename_5 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_CIS(3h)_vs_PBS(3h)_all_up_down_genes.png')
```




### 6h

```{r}
get_go(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_6h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (all genes): MTX(6h) vs PBS(6h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (up reg genes): MTX(6h) vs PBS(6h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (down reg genes): MTX(6h) vs PBS(6h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_down_genes.csv")

get_go(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_6h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (all genes): Oxa(6h) vs PBS(6h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (up reg genes): Oxa(6h) vs PBS(6h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (down reg genes): Oxa(6h) vs PBS(6h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_down_genes.csv")

get_go(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_6h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (all genes): Cis(6h) vs PBS(6h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (up reg genes): Cis(6h) vs PBS(6h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (down reg genes): Cis(6h) vs PBS(6h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_down_genes.csv")
```


```{r}
# Overlapping enriched GO term on 6h between Oxa and Cis (all genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_all_genes.csv")

# Overlapping enriched GO term on 6h between MTX and Cis (all genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_all_genes.csv")

# Overlapping enriched GO term on 6h between MTX and Oxa (all genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_all_genes.csv")

# Overlapping enriched GO term on 6h between MTX, Oxa and Cis (all genes)
overlap_intersect_go_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_all_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_all_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_all_genes.png")

```

```{r}
# Overlapping enriched GO term on 6h between Oxa and Cis (up genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_up_genes.csv")

# Overlapping enriched GO term on 6h between MTX and Cis (up genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_up_genes.csv")

# Overlapping enriched GO term on 6h between MTX and Oxa (up genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_up_genes.csv")

# Overlapping enriched GO term on 6h between MTX, Oxa and Cis (up genes)
overlap_intersect_go_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_up_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_up_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_up_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_up_genes.png")

```


```{r}
# Overlapping enriched GO term on 6h between Oxa and Cis (down genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_down_genes.csv")

# Overlapping enriched GO term on 6h between MTX and Cis (down genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_down_genes.csv")

# Overlapping enriched GO term on 6h between MTX and Oxa (down genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_down_genes.csv")

# Overlapping enriched GO term on 6h between MTX, Oxa and Cis (down genes)
overlap_intersect_go_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_down_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_down_genes.png")

```


```{r}
# Overlapping enriched GO term between up, down and all the genes for MTX
overlap_intersect_go_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(6h)_vs_PBS(6h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(6h)_vs_PBS(6h)_all_up_down_genes.png")



# Overlapping enriched GO term between up, down and all the genes for OXA
overlap_intersect_go_by_3_by_treatment(filename_1 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_up_genes.csv', filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_OXA(6h)_vs_PBS(6h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_OXA(6h)_vs_PBS(6h)_all_up_down_genes.png")


# Overlapping enriched GO term between up, down and all the genes for CIS
overlap_intersect_go_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_up_genes.csv", filename_2 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_down_genes.csv', filename_3 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_all_genes.csv', filename_4 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_CIS(6h)_vs_PBS(6h)_all_up_down_genes.csv', filename_5 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_CIS(6h)_vs_PBS(6h)_all_up_down_genes.png')
```


### 12h

```{r}
get_go(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_12h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (all genes): MTX(12h) vs PBS(12h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (up reg genes): MTX(12h) vs PBS(12h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (down reg genes): MTX(12h) vs PBS(12h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_down_genes.csv")

get_go(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_12h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (all genes): Oxa(12h) vs PBS(12h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (up reg genes): Oxa(12h) vs PBS(12h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (down reg genes): Oxa(12h) vs PBS(12h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_down_genes.csv")

get_go(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_12h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (all genes): Cis(12h) vs PBS(12h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (up reg genes): Cis(12h) vs PBS(12h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (down reg genes): Cis(12h) vs PBS(12h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_down_genes.csv")
```


```{r}
# Overlapping enriched GO term on 12h between Oxa and Cis (all genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_all_genes.csv")

# Overlapping enriched GO term on 12h between MTX and Cis (all genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_all_genes.csv")

# Overlapping enriched GO term on 12h between MTX and Oxa (all genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_all_genes.csv")

# Overlapping enriched GO term on 12h between MTX, Oxa and Cis (all genes)
overlap_intersect_go_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_all_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_all_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_all_genes.png")

```

```{r}
# Overlapping enriched GO term on 12h between Oxa and Cis (up genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_up_genes.csv")

# Overlapping enriched GO term on 12h between MTX and Cis (up genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_up_genes.csv")

# Overlapping enriched GO term on 12h between MTX and Oxa (up genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_up_genes.csv")

# Overlapping enriched GO term on 12h between MTX, Oxa and Cis (up genes)
overlap_intersect_go_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_up_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_up_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_up_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_up_genes.png")

```


```{r}
# Overlapping enriched GO term on 12h between Oxa and Cis (down genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_down_genes.csv")

# Overlapping enriched GO term on 12h between MTX and Cis (down genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_down_genes.csv")

# Overlapping enriched GO term on 12h between MTX and Oxa (down genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_down_genes.csv")

# Overlapping enriched GO term on 12h between MTX, Oxa and Cis (down genes)
overlap_intersect_go_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_down_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_down_genes.png")

```


```{r}
# Overlapping enriched GO term between up, down and all the genes for MTX
overlap_intersect_go_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(12h)_vs_PBS(12h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(12h)_vs_PBS(12h)_all_up_down_genes.png")



# Overlapping enriched GO term between up, down and all the genes for OXA
overlap_intersect_go_by_3_by_treatment(filename_1 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_up_genes.csv', filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_OXA(12h)_vs_PBS(12h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_OXA(12h)_vs_PBS(12h)_all_up_down_genes.png")


# Overlapping enriched GO term between up, down and all the genes for CIS
overlap_intersect_go_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_up_genes.csv", filename_2 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_down_genes.csv', filename_3 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_all_genes.csv', filename_4 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_CIS(12h)_vs_PBS(12h)_all_up_down_genes.csv', filename_5 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_CIS(12h)_vs_PBS(12h)_all_up_down_genes.png')
```


### 18h

```{r}
get_go(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_18h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (all genes): MTX(18h) vs PBS(18h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (up reg genes): MTX(18h) vs PBS(18h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (down reg genes): MTX(18h) vs PBS(18h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_down_genes.csv")

get_go(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_18h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (all genes): Oxa(18h) vs PBS(18h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (up reg genes): Oxa(18h) vs PBS(18h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (down reg genes): Oxa(18h) vs PBS(18h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_down_genes.csv")

get_go(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_18h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (all genes): Cis(18h) vs PBS(18h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (up reg genes): Cis(18h) vs PBS(18h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (down reg genes): Cis(18h) vs PBS(18h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_down_genes.csv")
```


```{r}
# Overlapping enriched GO term on 18h between Oxa and Cis (all genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_all_genes.csv")

# Overlapping enriched GO term on 18h between MTX and Cis (all genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_all_genes.csv")

# Overlapping enriched GO term on 18h between MTX and Oxa (all genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_all_genes.csv")

# Overlapping enriched GO term on 18h between MTX, Oxa and Cis (all genes)
overlap_intersect_go_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_all_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_all_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_all_genes.png")

```

```{r}
# Overlapping enriched GO term on 18h between Oxa and Cis (up genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_up_genes.csv")

# Overlapping enriched GO term on 18h between MTX and Cis (up genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_up_genes.csv")

# Overlapping enriched GO term on 18h between MTX and Oxa (up genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_up_genes.csv")

# Overlapping enriched GO term on 18h between MTX, Oxa and Cis (up genes)
overlap_intersect_go_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_up_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_up_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_up_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_up_genes.png")

```


```{r}
# Overlapping enriched GO term on 18h between Oxa and Cis (down genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_down_genes.csv")

# Overlapping enriched GO term on 18h between MTX and Cis (down genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_down_genes.csv")

# Overlapping enriched GO term on 18h between MTX and Oxa (down genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_down_genes.csv")

# Overlapping enriched GO term on 18h between MTX, Oxa and Cis (down genes)
overlap_intersect_go_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_down_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_down_genes.png")

```


```{r}
# Overlapping enriched GO term between up, down and all the genes for MTX
overlap_intersect_go_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(18h)_vs_PBS(18h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(18h)_vs_PBS(18h)_all_up_down_genes.png")



# Overlapping enriched GO term between up, down and all the genes for OXA
overlap_intersect_go_by_3_by_treatment(filename_1 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_up_genes.csv', filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_OXA(18h)_vs_PBS(18h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_OXA(18h)_vs_PBS(18h)_all_up_down_genes.png")


# Overlapping enriched GO term between up, down and all the genes for CIS
overlap_intersect_go_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_up_genes.csv", filename_2 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_down_genes.csv', filename_3 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_all_genes.csv', filename_4 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_CIS(18h)_vs_PBS(18h)_all_up_down_genes.csv', filename_5 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_CIS(18h)_vs_PBS(18h)_all_up_down_genes.png')
```


### 24h

```{r}
get_go(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_24h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (all genes): MTX(24h) vs PBS(24h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (up reg genes): MTX(24h) vs PBS(24h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (down reg genes): MTX(24h) vs PBS(24h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_down_genes.csv")

get_go(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_24h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (all genes): Oxa(24h) vs PBS(24h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (up reg genes): Oxa(24h) vs PBS(24h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (down reg genes): Oxa(24h) vs PBS(24h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_down_genes.csv")

get_go(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_24h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (all genes): Cis(24h) vs PBS(24h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (up reg genes): Cis(24h) vs PBS(24h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/GO enrichment (down reg genes): Cis(24h) vs PBS(24h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_down_genes.csv")
```


```{r}
# Overlapping enriched GO term on 24h between Oxa and Cis (all genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_all_genes.csv")

# Overlapping enriched GO term on 24h between MTX and Cis (all genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_all_genes.csv")

# Overlapping enriched GO term on 24h between MTX and Oxa (all genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_all_genes.csv")

# Overlapping enriched GO term on 24h between MTX, Oxa and Cis (all genes)
overlap_intersect_go_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_all_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_all_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_all_genes.png")

```

```{r}
# Overlapping enriched GO term on 24h between Oxa and Cis (up genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_up_genes.csv")

# Overlapping enriched GO term on 24h between MTX and Cis (up genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_up_genes.csv")

# Overlapping enriched GO term on 24h between MTX and Oxa (up genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_up_genes.csv")

# Overlapping enriched GO term on 24h between MTX, Oxa and Cis (up genes)
overlap_intersect_go_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_up_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_up_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_up_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_up_genes.png")

```


```{r}
# Overlapping enriched GO term on 24h between Oxa and Cis (down genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_down_genes.csv")

# Overlapping enriched GO term on 24h between MTX and Cis (down genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_down_genes.csv")

# Overlapping enriched GO term on 24h between MTX and Oxa (down genes)
overlap_intersect_go_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_down_genes.csv")

# Overlapping enriched GO term on 24h between MTX, Oxa and Cis (down genes)
overlap_intersect_go_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_down_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_down_genes.png")

```

```{r}
# Overlapping enriched GO term between up, down and all the genes for MTX
overlap_intersect_go_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(24h)_vs_PBS(24h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_MTX(24h)_vs_PBS(24h)_all_up_down_genes.png")



# Overlapping enriched GO term between up, down and all the genes for OXA
overlap_intersect_go_by_3_by_treatment(filename_1 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_up_genes.csv', filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_OXA(24h)_vs_PBS(24h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_OXA(24h)_vs_PBS(24h)_all_up_down_genes.png")


# Overlapping enriched GO term between up, down and all the genes for CIS
overlap_intersect_go_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_up_genes.csv", filename_2 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_down_genes.csv', filename_3 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_all_genes.csv', filename_4 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_CIS(24h)_vs_PBS(24h)_all_up_down_genes.csv', filename_5 = '/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_go_terms_CIS(24h)_vs_PBS(24h)_all_up_down_genes.png')
```



## **3.2. Reactome enrichment analysis**


```{r}
# Reactome dotplot function
enrich_plot_reactome <- function(test){
if (nrow(test) >= 20){
  ggplot(data = test[1:20,], 
       mapping = aes(x = prop_overlap,
                     y = reorder(Reactome_Pathway, prop_overlap),
                     color = p.adjust,
                     size = prop_overlap
                     )
       ) + 
geom_point() + 
scale_color_gradient(low = "red", high = "blue") + 
theme_bw() +
xlab("Proportion of Overlap (in %)") +
ylab("Reactome Pathway") +
theme(axis.text= element_text(face = "bold")) +
theme(axis.title.x = element_text(size = 9))
}
else {
    ggplot(data = test, 
       mapping = aes(x = prop_overlap,
                     y = reorder(Reactome_Pathway,prop_overlap),
                     color = p.adjust,
                     size = prop_overlap
                     )
       ) + 
geom_point() + 
scale_color_gradient(low = "red", high = "blue") + 
theme_bw() +
xlab("Proportion of Overlap (in %)") +
ylab("Reactome Pathway") +
theme(axis.text= element_text(face = "bold")) +
theme(axis.title.x = element_text(size = 9))
}
}
```


```{r}
# Get reactome final results (Dotplot)
get_reactome <- function(filename, filename_2, filename_3, filename_4, filename_5, filename_6, filename_7){
  
  # Get diff genes
  diff <- read.csv(filename)
  diff_up <- diff %>% filter(group == "up")
  diff_down <- diff %>% filter(group == "down")
  
  
  # Get gene symbol
  all_genes_symbol <- diff$genes
  diff_up_symbol <- diff_up$genes
  diff_down_symbol <- diff_down$genes
  
  # Retrieve ENSEMBL and ENTREZID
  res_bitr_all <- bitr(all_genes_symbol, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = "org.Mm.eg.db")
  res_bitr_up <- bitr(diff_up_symbol, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = "org.Mm.eg.db")
  res_bitr_down <- bitr(diff_down_symbol, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = "org.Mm.eg.db")
  
  # Get ENTREZ ID for list 
  res_bitr_all_list <- list(genes = res_bitr_all$ENTREZID)
  res_bitr_up_list <- list(genes = res_bitr_up$ENTREZID)
  res_bitr_down_list <- list(genes = res_bitr_down$ENTREZID)
  
  # Run reactome enrichment analysis
  reactome_analysis_res_bitr_all_df <- enrichPathway(res_bitr_all_list$genes, organism="mouse")
  reactome_analysis_res_bitr_up_df <- enrichPathway(res_bitr_up_list$genes, organism="mouse")
  reactome_analysis_res_bitr_down_df <- enrichPathway(res_bitr_down_list$genes, organism="mouse")
  
# Get prop of overlap (+ convert in percentage)
reactome_analysis_res_bitr_all_df <- reactome_analysis_res_bitr_all_df %>%
                                              as.data.frame() %>% 
                                              mutate(prop_overlap = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),                                                   Reactome_Pathway = Description) %>% mutate(prop_overlap = prop_overlap * 100) 


reactome_analysis_res_bitr_up_df <- reactome_analysis_res_bitr_up_df %>%
                                              as.data.frame() %>% 
                                              mutate(prop_overlap = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),                                                   Reactome_Pathway = Description) %>% mutate(prop_overlap = prop_overlap * 100)
  


reactome_analysis_res_bitr_down_df <- reactome_analysis_res_bitr_down_df %>%
                                              as.data.frame() %>% 
                                              mutate(prop_overlap = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),                                                   Reactome_Pathway = Description) %>% mutate(prop_overlap = prop_overlap * 100)


# Rank reactome terms by prop of overlap
  ordered_reactome_analysis_res_bitr_all_df <- reactome_analysis_res_bitr_all_df[order(reactome_analysis_res_bitr_all_df$prop_overlap, decreasing = TRUE),]
  write.csv(ordered_reactome_analysis_res_bitr_all_df, filename_5)
  
  ordered_reactome_analysis_res_bitr_up_df <- reactome_analysis_res_bitr_up_df[order(reactome_analysis_res_bitr_up_df$prop_overlap, decreasing = TRUE),] 
  write.csv(ordered_reactome_analysis_res_bitr_up_df, filename_6)
  
  ordered_reactome_analysis_res_bitr_down_df <- reactome_analysis_res_bitr_down_df[order(reactome_analysis_res_bitr_down_df$prop_overlap, decreasing = TRUE),] 
  write.csv(ordered_reactome_analysis_res_bitr_down_df, filename_7)
  

  # Dotplot and save it
  enrich_plot_reactome(ordered_reactome_analysis_res_bitr_all_df)
  ggsave(filename_2, width=12, height=4)
  enrich_plot_reactome(ordered_reactome_analysis_res_bitr_up_df)
  ggsave(filename_3, width=12, height=4)
  enrich_plot_reactome(ordered_reactome_analysis_res_bitr_down_df)
  ggsave(filename_4, width=12, height=4)

}
```

```{r}
overlap_intersect_reactome_by_2 <- function(filename_1, filename_2, filename_3){
  enriched_reactome_pathways_1 <- read.csv(filename_1)
  enriched_reactome_pathways_2 <- read.csv(filename_2)
  intersect_reactome_pathways <- intersect(enriched_reactome_pathways_1$Reactome_Pathway, enriched_reactome_pathways_2$Reactome_Pathway)
  write.csv(overlap_intersect_reactome_by_2, filename_3)
}

overlap_intersect_reactome_by_3 <- function(filename_1, filename_2, filename_3, filename_4, filename_5){
  enriched_reactome_pathways_1 <- read.csv(filename_1)
  enriched_reactome_pathways_2 <- read.csv(filename_2)
  enriched_reactome_pathways_3 <- read.csv(filename_3)
  intersect_reactome_pathways <- intersect(intersect(enriched_reactome_pathways_1$Reactome_Pathway, enriched_reactome_pathways_2$Reactome_Pathway), enriched_reactome_pathways_3$Reactome_Pathway)
  write.csv(intersect_reactome_pathways, filename_4)
  list_intersect_reactome_pathways <- list(Oxa_vs_PBS = enriched_reactome_pathways_1$Reactome_Pathway, Cis_vs_PBS = enriched_reactome_pathways_2$Reactome_Pathway, MTX_vs_PBS = enriched_reactome_pathways_3$Reactome_Pathway)
  ggvenn(list_intersect_reactome_pathways, stroke_size = 0.5)
  ggsave(filename_5)
}

overlap_intersect_reactome_by_3_by_treatment <- function(filename_1, filename_2, filename_3, filename_4, filename_5){
  enriched_reactome_terms_1 <- read.csv(filename_1)
  enriched_reactome_terms_2 <- read.csv(filename_2)
  enriched_reactome_terms_3 <- read.csv(filename_3)
  intersect_reactome_terms <- intersect(intersect(enriched_reactome_terms_1$Reactome_Pathway, enriched_reactome_terms_2$Reactome_Pathway), enriched_reactome_terms_3$Reactome_Pathway)
  write.csv(intersect_reactome_terms, filename_4)
  list_intersect_reactome_terms <- list(up_reg_genes_reactome = enriched_reactome_terms_1$Reactome_Pathway, down_reg_genes_reactome = enriched_reactome_terms_2$Reactome_Pathway, all_genes_reactome = enriched_reactome_terms_3$Reactome_Pathway)
  ggvenn(list_intersect_reactome_terms, stroke_size = 0.5)
  ggsave(filename_5)
}
```


### 3h

```{r}
get_reactome(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_3h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (all genes): MTX(3h) vs PBS(3h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (up reg genes): MTX(3h) vs PBS(3h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (down reg genes): MTX(3h) vs PBS(3h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_down_genes.csv")

get_reactome(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_3h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (all genes): Oxa(3h) vs PBS(3h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (up reg genes): Oxa(3h) vs PBS(3h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (down reg genes): Oxa(3h) vs PBS(3h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_down_genes.csv")

get_reactome(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_3h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (all genes): Cis(3h) vs PBS(3h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (up reg genes): Cis(3h) vs PBS(3h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (down reg genes): Cis(3h) vs PBS(3h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_down_genes.csv")
```


```{r}
# Overlapping enriched reactome term on 3h between Oxa and Cis (all genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_all_genes.csv")

# Overlapping enriched reactome term on 3h between MTX and Cis (all genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_all_genes.csv")

# Overlapping enriched reactome term on 3h between MTX and Oxa (all genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_all_genes.csv")

# Overlapping enriched reactome term on 3h between MTX, Oxa and Cis (all genes)
overlap_intersect_reactome_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_all_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_all_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_all_genes.png")

```


```{r}
# Overlapping enriched reactome term on 3h between Oxa and Cis (up genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_up_genes.csv")

# Overlapping enriched reactome term on 3h between MTX and Cis (up genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_up_genes.csv")

# Overlapping enriched reactome term on 3h between MTX and Oxa (up genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_up_genes.csv")

# Overlapping enriched reactome term on 3h between MTX, Oxa and Cis (up genes)
overlap_intersect_reactome_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_up_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_up_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_up_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_up_genes.png")
```


```{r}
# Overlapping enriched reactome term on 3h between Oxa and Cis (down genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_down_genes.csv")

# Overlapping enriched reactome term on 3h between MTX and Cis (down genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_down_genes.csv")

# Overlapping enriched reactome term on 3h between MTX and Oxa (down genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_down_genes.csv")


# Overlapping enriched reactome term on 3h between MTX, Oxa and Cis (down genes)
overlap_intersect_reactome_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_down_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_down_genes.png")
```

```{r}
# Overlapping enriched reactome pathway between up, down and all the genes for MTX
overlap_intersect_reactome_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(3h) vs PBS(3h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(3h)_vs_PBS(3h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(3h)_vs_PBS(3h)_all_up_down_genes.png")



# Overlapping enriched reactome pathway between up, down and all the genes for OXA
overlap_intersect_reactome_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(3h) vs PBS(3h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_OXA(3h)_vs_PBS(3h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_OXA(3h)_vs_PBS(3h)_all_up_down_genes.png")


# Overlapping enriched reactome pathway between up, down and all the genes for CIS
overlap_intersect_reactome_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(3h) vs PBS(3h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_CIS(3h)_vs_PBS(3h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_CIS(3h)_vs_PBS(3h)_all_up_down_genes.png")
```



### 6h

```{r}
get_reactome(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_6h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (all genes): MTX(6h) vs PBS(6h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (up reg genes): MTX(6h) vs PBS(6h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (down reg genes): MTX(6h) vs PBS(6h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_down_genes.csv")

get_reactome(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_6h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (all genes): Oxa(6h) vs PBS(6h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (up reg genes): Oxa(6h) vs PBS(6h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (down reg genes): Oxa(6h) vs PBS(6h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_down_genes.csv")

get_reactome(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_6h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (all genes): Cis(6h) vs PBS(6h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (up reg genes): Cis(6h) vs PBS(6h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (down reg genes): Cis(6h) vs PBS(6h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_down_genes.csv")
```


```{r}
# Overlapping enriched reactome term on 6h between Oxa and Cis (all genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_all_genes.csv")

# Overlapping enriched reactome term on 6h between MTX and Cis (all genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_all_genes.csv")

# Overlapping enriched reactome term on 6h between MTX and Oxa (all genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_all_genes.csv")

# Overlapping enriched reactome term on 6h between MTX, Oxa and Cis (all genes)
overlap_intersect_reactome_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_all_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_all_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_all_genes.png")

```


```{r}
# Overlapping enriched reactome term on 6h between Oxa and Cis (up genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_up_genes.csv")

# Overlapping enriched reactome term on 6h between MTX and Cis (up genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_up_genes.csv")

# Overlapping enriched reactome term on 6h between MTX and Oxa (up genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_up_genes.csv")

# Overlapping enriched reactome term on 6h between MTX, Oxa and Cis (up genes)
overlap_intersect_reactome_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_up_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_up_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_up_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_up_genes.png")
```


```{r}
# Overlapping enriched reactome term on 6h between Oxa and Cis (down genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_down_genes.csv")

# Overlapping enriched reactome term on 6h between MTX and Cis (down genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_down_genes.csv")

# Overlapping enriched reactome term on 6h between MTX and Oxa (down genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_down_genes.csv")

# Overlapping enriched reactome term on 6h between MTX, Oxa and Cis (down genes)
overlap_intersect_reactome_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_down_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_down_genes.png")
```


```{r}
# Overlapping enriched reactome pathway between up, down and all the genes for MTX
overlap_intersect_reactome_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(6h) vs PBS(6h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(6h)_vs_PBS(6h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(6h)_vs_PBS(6h)_all_up_down_genes.png")



# Overlapping enriched reactome pathway between up, down and all the genes for OXA
overlap_intersect_reactome_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(6h) vs PBS(6h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_OXA(6h)_vs_PBS(6h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_OXA(6h)_vs_PBS(6h)_all_up_down_genes.png")


# Overlapping enriched reactome pathway between up, down and all the genes for CIS
overlap_intersect_reactome_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(6h) vs PBS(6h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_CIS(6h)_vs_PBS(6h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_CIS(6h)_vs_PBS(6h)_all_up_down_genes.png")
```




### 12h

```{r}
get_reactome(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_12h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (all genes): MTX(12h) vs PBS(12h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (up reg genes): MTX(12h) vs PBS(12h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (down reg genes): MTX(12h) vs PBS(12h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_down_genes.csv")

get_reactome(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_12h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (all genes): Oxa(12h) vs PBS(12h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (up reg genes): Oxa(12h) vs PBS(12h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (down reg genes): Oxa(12h) vs PBS(12h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_down_genes.csv")

get_reactome(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_12h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (all genes): Cis(12h) vs PBS(12h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (up reg genes): Cis(12h) vs PBS(12h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (down reg genes): Cis(12h) vs PBS(12h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_down_genes.csv")
```


```{r}
# Overlapping enriched reactome term on 12h between Oxa and Cis (all genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_all_genes.csv")

# Overlapping enriched reactome term on 12h between MTX and Cis (all genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_all_genes.csv")

# Overlapping enriched reactome term on 12h between MTX and Oxa (all genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_all_genes.csv")

# Overlapping enriched reactome term on 12h between MTX, Oxa and Cis (all genes)
overlap_intersect_reactome_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_all_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_all_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_all_genes.png")

```


```{r}
# Overlapping enriched reactome term on 12h between Oxa and Cis (up genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_up_genes.csv")

# Overlapping enriched reactome term on 12h between MTX and Cis (up genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_up_genes.csv")

# Overlapping enriched reactome term on 12h between MTX and Oxa (up genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_up_genes.csv")

# Overlapping enriched reactome term on 12h between MTX, Oxa and Cis (up genes)
overlap_intersect_reactome_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_up_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_up_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_up_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_up_genes.png")
```


```{r}
# Overlapping enriched reactome term on 12h between Oxa and Cis (down genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_down_genes.csv")

# Overlapping enriched reactome term on 12h between MTX and Cis (down genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_down_genes.csv")

# Overlapping enriched reactome term on 12h between MTX and Oxa (down genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_down_genes.csv")

# Overlapping enriched reactome term on 12h between MTX, Oxa and Cis (down genes)
overlap_intersect_reactome_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_down_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_down_genes.png")
```

```{r}
# Overlapping enriched reactome pathway between up, down and all the genes for MTX
overlap_intersect_reactome_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(12h) vs PBS(12h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(12h)_vs_PBS(12h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(12h)_vs_PBS(12h)_all_up_down_genes.png")



# Overlapping enriched reactome pathway between up, down and all the genes for OXA
overlap_intersect_reactome_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(12h) vs PBS(12h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_OXA(12h)_vs_PBS(12h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_OXA(12h)_vs_PBS(12h)_all_up_down_genes.png")


# Overlapping enriched reactome pathway between up, down and all the genes for CIS
overlap_intersect_reactome_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(12h) vs PBS(12h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_CIS(12h)_vs_PBS(12h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_CIS(12h)_vs_PBS(12h)_all_up_down_genes.png")
```



### 18h

```{r}
get_reactome(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_18h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (all genes): MTX(18h) vs PBS(18h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (up reg genes): MTX(18h) vs PBS(18h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (down reg genes): MTX(18h) vs PBS(18h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_down_genes.csv")

get_reactome(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_18h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (all genes): Oxa(18h) vs PBS(18h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (up reg genes): Oxa(18h) vs PBS(18h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (down reg genes): Oxa(18h) vs PBS(18h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_down_genes.csv")

get_reactome(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_18h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (all genes): Cis(18h) vs PBS(18h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (up reg genes): Cis(18h) vs PBS(18h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (down reg genes): Cis(18h) vs PBS(18h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_down_genes.csv")
```


```{r}
# Overlapping enriched reactome term on 18h between Oxa and Cis (all genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_all_genes.csv")

# Overlapping enriched reactome term on 18h between MTX and Cis (all genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_all_genes.csv")

# Overlapping enriched reactome term on 18h between MTX and Oxa (all genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_all_genes.csv")

# Overlapping enriched reactome term on 18h between MTX, Oxa and Cis (all genes)
overlap_intersect_reactome_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_all_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_all_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_all_genes.png")

```


```{r}
# Overlapping enriched reactome term on 18h between Oxa and Cis (up genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_up_genes.csv")

# Overlapping enriched reactome term on 18h between MTX and Cis (up genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_up_genes.csv")

# Overlapping enriched reactome term on 18h between MTX and Oxa (up genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_up_genes.csv")

# Overlapping enriched reactome term on 18h between MTX, Oxa and Cis (up genes)
overlap_intersect_reactome_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_up_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_up_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_up_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_up_genes.png")
```


```{r}
# Overlapping enriched reactome term on 18h between Oxa and Cis (down genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_down_genes.csv")

# Overlapping enriched reactome term on 18h between MTX and Cis (down genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_down_genes.csv")

# Overlapping enriched reactome term on 18h between MTX and Oxa (down genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_down_genes.csv")

# Overlapping enriched reactome term on 18h between MTX, Oxa and Cis (down genes)
overlap_intersect_reactome_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_down_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_down_genes.png")
```

```{r}
# Overlapping enriched reactome pathway between up, down and all the genes for MTX
overlap_intersect_reactome_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(18h) vs PBS(18h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(18h)_vs_PBS(18h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(18h)_vs_PBS(18h)_all_up_down_genes.png")



# Overlapping enriched reactome pathway between up, down and all the genes for OXA
overlap_intersect_reactome_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(18h) vs PBS(18h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_OXA(18h)_vs_PBS(18h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_OXA(18h)_vs_PBS(18h)_all_up_down_genes.png")


# Overlapping enriched reactome pathway between up, down and all the genes for CIS
overlap_intersect_reactome_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(18h) vs PBS(18h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_CIS(18h)_vs_PBS(18h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_CIS(18h)_vs_PBS(18h)_all_up_down_genes.png")
```


### 24h

```{r}
get_reactome(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_24h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (all genes): MTX(24h) vs PBS(24h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (up reg genes): MTX(24h) vs PBS(24h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (down reg genes): MTX(24h) vs PBS(24h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_down_genes.csv")

get_reactome(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_24h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (all genes): Oxa(24h) vs PBS(24h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (up reg genes): Oxa(24h) vs PBS(24h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (down reg genes): Oxa(24h) vs PBS(24h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_down_genes.csv")

get_reactome(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_24h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (all genes): Cis(24h) vs PBS(24h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (up reg genes): Cis(24h) vs PBS(24h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/Reactome enrichment (down reg genes): Cis(24h) vs PBS(24h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_down_genes.csv")
```


```{r}
# Overlapping enriched reactome term on 24h between Oxa and Cis (all genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_all_genes.csv")

# Overlapping enriched reactome term on 24h between MTX and Cis (all genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_all_genes.csv")

# Overlapping enriched reactome term on 24h between MTX and Oxa (all genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_all_genes.csv")

# Overlapping enriched reactome term on 24h between MTX, Oxa and Cis (all genes)
overlap_intersect_reactome_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_all_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_all_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_all_genes.png")

```


```{r}
# Overlapping enriched reactome term on 24h between Oxa and Cis (up genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_up_genes.csv")

# Overlapping enriched reactome term on 24h between MTX and Cis (up genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_up_genes.csv")

# Overlapping enriched reactome term on 24h between MTX and Oxa (up genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_up_genes.csv")

# Overlapping enriched reactome term on 24h between MTX, Oxa and Cis (up genes)
overlap_intersect_reactome_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_up_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_up_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_up_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_up_genes.png")
```


```{r}
# Overlapping enriched reactome term on 24h between Oxa and Cis (down genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_down_genes.csv")

# Overlapping enriched reactome term on 24h between MTX and Cis (down genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_down_genes.csv")

# Overlapping enriched reactome term on 24h between MTX and Oxa (down genes)
overlap_intersect_reactome_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_down_genes.csv")

# Overlapping enriched reactome term on 24h between MTX, Oxa and Cis (down genes)
overlap_intersect_reactome_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_down_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_down_genes.png")
```

```{r}
# Overlapping enriched reactome pathway between up, down and all the genes for MTX
overlap_intersect_reactome_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_MTX(24h) vs PBS(24h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(24h)_vs_PBS(24h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_MTX(24h)_vs_PBS(24h)_all_up_down_genes.png")



# Overlapping enriched reactome pathway between up, down and all the genes for OXA
overlap_intersect_reactome_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Oxa(24h) vs PBS(24h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_OXA(24h)_vs_PBS(24h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_OXA(24h)_vs_PBS(24h)_all_up_down_genes.png")


# Overlapping enriched reactome pathway between up, down and all the genes for CIS
overlap_intersect_reactome_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_Reactome_terms_Cis(24h) vs PBS(24h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_CIS(24h)_vs_PBS(24h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_reactome_terms_CIS(24h)_vs_PBS(24h)_all_up_down_genes.png")
```



## **4.3. Kegg enrichment analysis**

```{r}
# kegg dotplot function
enrich_plot_kegg <- function(test){
if (nrow(test) >= 20){
  ggplot(data = test[1:20,], 
       mapping = aes(x = prop_overlap,
                     y = reorder(Kegg_Pathway, prop_overlap),
                     color = p.adjust,
                     size = prop_overlap
                     )
       ) + 
geom_point() + 
scale_color_gradient(low = "red", high = "blue") + 
theme_bw() +
xlab("Proportion of Overlap (in %)") +
ylab("kegg Pathway") +
theme(axis.text= element_text(face = "bold")) +
theme(axis.title.x = element_text(size = 9))
}
else {
    ggplot(data = test, 
       mapping = aes(x = prop_overlap,
                     y = reorder(Kegg_Pathway,prop_overlap),
                     color = p.adjust,
                     size = prop_overlap
                     )
       ) + 
geom_point() + 
scale_color_gradient(low = "red", high = "blue") + 
theme_bw() +
xlab("Proportion of Overlap (in %)") +
ylab("kegg Pathway") +
theme(axis.text= element_text(face = "bold")) +
theme(axis.title.x = element_text(size = 9))
}
}
```


```{r}
# Get kegg final results (Dotplot)
get_kegg <- function(filename, filename_2, filename_3, filename_4, filename_5, filename_6, filename_7){
  
  # Get diff genes
  diff <- read.csv(filename)
  diff_up <- diff %>% filter(group == "up")
  diff_down <- diff %>% filter(group == "down")
  
  
  # Get gene symbol
  all_genes_symbol <- diff$genes
  diff_up_symbol <- diff_up$genes
  diff_down_symbol <- diff_down$genes
  
  # Retrieve ENSEMBL and ENTREZID
  res_bitr_all <- bitr(all_genes_symbol, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = "org.Mm.eg.db")
  res_bitr_up <- bitr(diff_up_symbol, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = "org.Mm.eg.db")
  res_bitr_down <- bitr(diff_down_symbol, fromType = "SYMBOL", toType = "ENTREZID", OrgDb = "org.Mm.eg.db")
  
  # Get ENTREZ ID for list 
  res_bitr_all_list <- list(genes = res_bitr_all$ENTREZID)
  res_bitr_up_list <- list(genes = res_bitr_up$ENTREZID)
  res_bitr_down_list <- list(genes = res_bitr_down$ENTREZID)
  
  # Run kegg enrichment analysis
  kegg_analysis_res_bitr_all_df <- enrichKEGG(res_bitr_all_list$genes, organism="mmu")
  kegg_analysis_res_bitr_up_df <- enrichKEGG(res_bitr_up_list$genes, organism = "mmu")
  kegg_analysis_res_bitr_down_df <- enrichKEGG(res_bitr_down_list$genes, organism = "mmu")
  
  

  # Get prop of overlap (+ convert in percentage)
kegg_analysis_res_bitr_all_df <- kegg_analysis_res_bitr_all_df %>%
                                              as.data.frame() %>% 
                                              mutate(prop_overlap = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),                                                   Kegg_Pathway = Description) %>% mutate(prop_overlap = prop_overlap * 100) 


kegg_analysis_res_bitr_up_df <- kegg_analysis_res_bitr_up_df %>%
                                              as.data.frame() %>% 
                                              mutate(prop_overlap = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),                                                   Kegg_Pathway = Description) %>% mutate(prop_overlap = prop_overlap * 100)
  


kegg_analysis_res_bitr_down_df <- kegg_analysis_res_bitr_down_df %>%
                                              as.data.frame() %>% 
                                              mutate(prop_overlap = as.integer(str_remove(GeneRatio, "/.*")) / as.integer(str_remove(BgRatio, "/.*")),                                                   Kegg_Pathway = Description) %>% mutate(prop_overlap = prop_overlap * 100)
  

  # Rank kegg terms by prop of overlap
  ordered_kegg_analysis_res_bitr_all_df <- kegg_analysis_res_bitr_all_df[order(kegg_analysis_res_bitr_all_df$prop_overlap, decreasing = TRUE),]
  write.csv(ordered_kegg_analysis_res_bitr_all_df, filename_5)
  
  ordered_kegg_analysis_res_bitr_up_df <- kegg_analysis_res_bitr_up_df[order(kegg_analysis_res_bitr_up_df$prop_overlap, decreasing = TRUE),] 
  write.csv(ordered_kegg_analysis_res_bitr_up_df, filename_6)
  
  ordered_kegg_analysis_res_bitr_down_df <- kegg_analysis_res_bitr_down_df[order(kegg_analysis_res_bitr_down_df$prop_overlap, decreasing = TRUE),] 
  write.csv(ordered_kegg_analysis_res_bitr_down_df, filename_7)
  

  # Dotplot and save it
  enrich_plot_kegg(ordered_kegg_analysis_res_bitr_all_df)
  ggsave(filename_2, width=12, height=4)
  enrich_plot_kegg(ordered_kegg_analysis_res_bitr_up_df)
  ggsave(filename_3, width=12, height=4)
  enrich_plot_kegg(ordered_kegg_analysis_res_bitr_down_df)
  ggsave(filename_4, width=12, height=4)

}

```

```{r}
overlap_intersect_kegg_by_2 <- function(filename_1, filename_2, filename_3){
  enriched_kegg_pathways_1 <- read.csv(filename_1)
  enriched_kegg_pathways_2 <- read.csv(filename_2)
  intersect_kegg_pathways <- intersect(enriched_kegg_pathways_1$kegg_Pathway, enriched_kegg_pathways_2$kegg_Pathway)
  write.csv(overlap_intersect_kegg_by_2, filename_3)
}

overlap_intersect_kegg_by_3 <- function(filename_1, filename_2, filename_3, filename_4, filename_5){
  enriched_kegg_pathways_1 <- read.csv(filename_1)
  enriched_kegg_pathways_2 <- read.csv(filename_2)
  enriched_kegg_pathways_3 <- read.csv(filename_3)
  intersect_kegg_pathways <- intersect(intersect(enriched_kegg_pathways_1$kegg_Pathway, enriched_kegg_pathways_2$kegg_Pathway), enriched_kegg_pathways_3$kegg_Pathway)
  write.csv(intersect_kegg_pathways, filename_4)
  list_intersect_kegg_pathways <- list(Oxa_vs_PBS = enriched_kegg_pathways_1$kegg_Pathway, Cis_vs_PBS = enriched_kegg_pathways_2$kegg_Pathway, MTX_vs_PBS = enriched_kegg_pathways_3$kegg_Pathway)
  ggvenn(list_intersect_kegg_pathways, stroke_size = 0.5)
  ggsave(filename_5)
}


overlap_intersect_kegg_by_3_by_treatment <- function(filename_1, filename_2, filename_3, filename_4, filename_5){
  enriched_kegg_terms_1 <- read.csv(filename_1)
  enriched_kegg_terms_2 <- read.csv(filename_2)
  enriched_kegg_terms_3 <- read.csv(filename_3)
  intersect_kegg_terms <- intersect(intersect(enriched_kegg_terms_1$Kegg_Pathway, enriched_kegg_terms_2$Kegg_Pathway), enriched_kegg_terms_3$Kegg_Pathway)
  write.csv(intersect_kegg_terms, filename_4)
  list_intersect_kegg_terms <- list(up_reg_genes_kegg = enriched_kegg_terms_1$Kegg_Pathway, down_reg_genes_kegg = enriched_kegg_terms_2$Kegg_Pathway, all_genes_kegg = enriched_kegg_terms_3$Kegg_Pathway)
  ggvenn(list_intersect_kegg_terms, stroke_size = 0.5)
  ggsave(filename_5)
}
```

### 3h

```{r}
get_kegg(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_3h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (all genes): MTX(3h) vs PBS(3h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (up reg genes): MTX(3h) vs PBS(3h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (down reg genes): MTX(3h) vs PBS(3h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_down_genes.csv")

get_kegg(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_3h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (all genes): Oxa(3h) vs PBS(3h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (up reg genes): Oxa(3h) vs PBS(3h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (down reg genes): Oxa(3h) vs PBS(3h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_down_genes.csv")

get_kegg(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_3h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (all genes): Cis(3h) vs PBS(3h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (up reg genes): Cis(3h) vs PBS(3h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (down reg genes): Cis(3h) vs PBS(3h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_down_genes.csv")
```


```{r}
# Overlapping enriched kegg term on 3h between Oxa and Cis (all genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_all_genes.csv")

# Overlapping enriched kegg term on 3h between MTX and Cis (all genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_all_genes.csv")

# Overlapping enriched kegg term on 3h between MTX and Oxa (all genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_all_genes.csv")

# Overlapping enriched kegg term on 3h between MTX, Oxa and Cis (all genes)
overlap_intersect_kegg_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_all_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_all_genes.csv", filename_4 = "overlapping_kegg_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_all_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_all_genes.png")

```


```{r}
# Overlapping enriched kegg term on 3h between Oxa and Cis (up genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_up_genes.csv")

# Overlapping enriched kegg term on 3h between MTX and Cis (up genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_up_genes.csv")

# Overlapping enriched kegg term on 3h between MTX and Oxa (up genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_up_genes.csv")

# Overlapping enriched kegg term on 3h between MTX, Oxa and Cis (up genes)
overlap_intersect_kegg_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_up_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_up_genes.csv", filename_4 = "overlapping_kegg_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_up_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_up_genes.png")
```


```{r}
# Overlapping enriched kegg term on 3h between Oxa and Cis (down genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_down_genes.csv")

# Overlapping enriched kegg term on 3h between MTX and Cis (down genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_down_genes.csv")

# Overlapping enriched kegg term on 3hbetween MTX and Oxa (down genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_down_genes.csv")


# Overlapping enriched kegg term on 3hbetween MTX, Oxa and Cis (down genes)
overlap_intersect_kegg_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_down_genes.csv", filename_4 = "overlapping_kegg_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(3h)_vs_PBS(3h)_vs_Oxa(3h)_vs_PBS(3h)_vs_Cis(3h)_vs_PBS(3h)_down_genes.png")
```


```{r}
# Overlapping enriched kegg pathway between up, down and all the genes for MTX
overlap_intersect_kegg_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(3h) vs PBS(3h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(3h)_vs_PBS(3h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(3h)_vs_PBS(3h)_all_up_down_genes.png")



# Overlapping enriched kegg pathway between up, down and all the genes for OXA
overlap_intersect_kegg_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(3h) vs PBS(3h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_OXA(3h)_vs_PBS(3h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_OXA(3h)_vs_PBS(3h)_all_up_down_genes.png")


# Overlapping enriched kegg pathway between up, down and all the genes for CIS
overlap_intersect_kegg_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(3h) vs PBS(3h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_CIS(3h)_vs_PBS(3h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_CIS(3h)_vs_PBS(3h)_all_up_down_genes.png")
```





### 6h

```{r}
get_kegg(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_6h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (all genes): MTX(6h) vs PBS(6h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (up reg genes): MTX(6h) vs PBS(6h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (down reg genes): MTX(6h) vs PBS(6h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_down_genes.csv")

get_kegg(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_6h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (all genes): Oxa(6h) vs PBS(6h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (up reg genes): Oxa(6h) vs PBS(6h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (down reg genes): Oxa(6h) vs PBS(6h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_down_genes.csv")

get_kegg(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_6h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (all genes): Cis(6h) vs PBS(6h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (up reg genes): Cis(6h) vs PBS(6h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (down reg genes): Cis(6h) vs PBS(6h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_down_genes.csv")
```




```{r}
# Overlapping enriched kegg term on 6h between Oxa and Cis (all genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_all_genes.csv")

# Overlapping enriched kegg term on 6h between MTX and Cis (all genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_all_genes.csv")

# Overlapping enriched kegg term on 6h between MTX and Oxa (all genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_all_genes.csv")

# Overlapping enriched kegg term on 6h between MTX, Oxa and Cis (all genes)
overlap_intersect_kegg_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_all_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_all_genes.csv", filename_4 = "overlapping_kegg_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_all_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_all_genes.png")

```


```{r}
# Overlapping enriched kegg term on 6h between Oxa and Cis (up genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_up_genes.csv")

# Overlapping enriched kegg term on 6h between MTX and Cis (up genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_up_genes.csv")

# Overlapping enriched kegg term on 6h between MTX and Oxa (up genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_up_genes.csv")

# Overlapping enriched kegg term on 6h between MTX, Oxa and Cis (up genes)
overlap_intersect_kegg_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_up_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_up_genes.csv", filename_4 = "overlapping_kegg_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_up_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_up_genes.png")
```


```{r}
# Overlapping enriched kegg term on 6h between Oxa and Cis (down genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_down_genes.csv")

# Overlapping enriched kegg term on 6h between MTX and Cis (down genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_down_genes.csv")

# Overlapping enriched kegg term on 6hbetween MTX and Oxa (down genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_down_genes.csv")


# Overlapping enriched kegg term on 6hbetween MTX, Oxa and Cis (down genes)
overlap_intersect_kegg_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_down_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(6h)_vs_PBS(6h)_vs_Oxa(6h)_vs_PBS(6h)_vs_Cis(6h)_vs_PBS(6h)_down_genes.png")
```


```{r}
# Overlapping enriched kegg pathway between up, down and all the genes for MTX
overlap_intersect_kegg_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(6h) vs PBS(6h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(6h)_vs_PBS(6h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(6h)_vs_PBS(6h)_all_up_down_genes.png")



# Overlapping enriched kegg pathway between up, down and all the genes for OXA
overlap_intersect_kegg_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(6h) vs PBS(6h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_OXA(6h)_vs_PBS(6h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_OXA(6h)_vs_PBS(6h)_all_up_down_genes.png")


# Overlapping enriched kegg pathway between up, down and all the genes for CIS
overlap_intersect_kegg_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(6h) vs PBS(6h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_CIS(6h)_vs_PBS(6h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_CIS(6h)_vs_PBS(6h)_all_up_down_genes.png")
```





### 12h

```{r}
get_kegg(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_12h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (all genes): MTX(12h) vs PBS(12h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (up reg genes): MTX(12h) vs PBS(12h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (down reg genes): MTX(12h) vs PBS(12h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_down_genes.csv")

get_kegg(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_12h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (all genes): Oxa(12h) vs PBS(12h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (up reg genes): Oxa(12h) vs PBS(12h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (down reg genes): Oxa(12h) vs PBS(12h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_down_genes.csv")

get_kegg(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_12h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (all genes): Cis(12h) vs PBS(12h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (up reg genes): Cis(12h) vs PBS(12h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (down reg genes): Cis(12h) vs PBS(12h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_down_genes.csv")
```



```{r}
# Overlapping enriched kegg term on 12h between Oxa and Cis (all genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_all_genes.csv")

# Overlapping enriched kegg term on 12h between MTX and Cis (all genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_all_genes.csv")

# Overlapping enriched kegg term on 12h between MTX and Oxa (all genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_all_genes.csv")

# Overlapping enriched kegg term on 12h between MTX, Oxa and Cis (all genes)
overlap_intersect_kegg_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_all_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_all_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_all_genes.png")

```


```{r}
# Overlapping enriched kegg term on 12h between Oxa and Cis (up genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_up_genes.csv")

# Overlapping enriched kegg term on 12h between MTX and Cis (up genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_up_genes.csv")

# Overlapping enriched kegg term on 12h between MTX and Oxa (up genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_up_genes.csv")

# Overlapping enriched kegg term on 12h between MTX, Oxa and Cis (up genes)
overlap_intersect_kegg_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_up_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_up_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_up_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_up_genes.png")
```


```{r}
# Overlapping enriched kegg term on 12h between Oxa and Cis (down genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_down_genes.csv")

# Overlapping enriched kegg term on 12h between MTX and Cis (down genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_down_genes.csv")

# Overlapping enriched kegg term on 12h between MTX and Oxa (down genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_down_genes.csv")

# Overlapping enriched kegg term on 12h between MTX, Oxa and Cis (down genes)
overlap_intersect_kegg_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_down_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(12h)_vs_PBS(12h)_vs_Oxa(12h)_vs_PBS(12h)_vs_Cis(12h)_vs_PBS(12h)_down_genes.png")
```



```{r}
# Overlapping enriched kegg pathway between up, down and all the genes for MTX
overlap_intersect_kegg_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(12h) vs PBS(12h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(12h)_vs_PBS(12h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(12h)_vs_PBS(12h)_all_up_down_genes.png")



# Overlapping enriched kegg pathway between up, down and all the genes for OXA
overlap_intersect_kegg_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(12h) vs PBS(12h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_OXA(12h)_vs_PBS(12h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_OXA(12h)_vs_PBS(12h)_all_up_down_genes.png")


# Overlapping enriched kegg pathway between up, down and all the genes for CIS
overlap_intersect_kegg_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(12h) vs PBS(12h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_CIS(12h)_vs_PBS(12h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_CIS(12h)_vs_PBS(12h)_all_up_down_genes.png")
```


### 18h

```{r}
get_kegg(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_18h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (all genes): MTX(18h) vs PBS(18h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (up reg genes): MTX(18h) vs PBS(18h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (down reg genes): MTX(18h) vs PBS(18h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_down_genes.csv")

get_kegg(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_18h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (all genes): Oxa(18h) vs PBS(18h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (up reg genes): Oxa(18h) vs PBS(18h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (down reg genes): Oxa(18h) vs PBS(18h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_down_genes.csv")

get_kegg(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_18h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (all genes): Cis(18h) vs PBS(18h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (up reg genes): Cis(18h) vs PBS(18h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (down reg genes): Cis(18h) vs PBS(18h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_down_genes.csv")
```



```{r}
# Overlapping enriched kegg term on 18h between Oxa and Cis (all genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_all_genes.csv")

# Overlapping enriched kegg term on 18h between MTX and Cis (all genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_all_genes.csv")

# Overlapping enriched kegg term on 18h between MTX and Oxa (all genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_all_genes.csv")

# Overlapping enriched kegg term on 18h between MTX, Oxa and Cis (all genes)
overlap_intersect_kegg_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_all_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_all_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_all_genes.png")

```


```{r}
# Overlapping enriched kegg term on 18h between Oxa and Cis (up genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_up_genes.csv")

# Overlapping enriched kegg term on 18h between MTX and Cis (up genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_up_genes.csv")

# Overlapping enriched kegg term on 18h between MTX and Oxa (up genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_up_genes.csv")

# Overlapping enriched kegg term on 18h between MTX, Oxa and Cis (up genes)
overlap_intersect_kegg_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_up_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_up_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_up_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_up_genes.png")
```


```{r}
# Overlapping enriched kegg term on 18h between Oxa and Cis (down genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_down_genes.csv")

# Overlapping enriched kegg term on 18h between MTX and Cis (down genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_down_genes.csv")

# Overlapping enriched kegg term on 18h between MTX and Oxa (down genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_down_genes.csv")


# Overlapping enriched kegg term on 18h between MTX, Oxa and Cis (down genes)
overlap_intersect_kegg_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_down_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(18h)_vs_PBS(18h)_vs_Oxa(18h)_vs_PBS(18h)_vs_Cis(18h)_vs_PBS(18h)_down_genes.png")
```


```{r}
# Overlapping enriched kegg pathway between up, down and all the genes for MTX
overlap_intersect_kegg_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(18h) vs PBS(18h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(18h)_vs_PBS(18h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(18h)_vs_PBS(18h)_all_up_down_genes.png")



# Overlapping enriched kegg pathway between up, down and all the genes for OXA
overlap_intersect_kegg_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(18h) vs PBS(18h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_OXA(18h)_vs_PBS(18h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_OXA(18h)_vs_PBS(18h)_all_up_down_genes.png")


# Overlapping enriched kegg pathway between up, down and all the genes for CIS
overlap_intersect_kegg_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(18h) vs PBS(18h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_CIS(18h)_vs_PBS(18h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_CIS(18h)_vs_PBS(18h)_all_up_down_genes.png")
```



### 24h

```{r}
get_kegg(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_MTX_vs_PBS_24h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (all genes): MTX(24h) vs PBS(24h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (up reg genes): MTX(24h) vs PBS(24h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (down reg genes): MTX(24h) vs PBS(24h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_down_genes.csv")

get_kegg(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Oxa_vs_PBS_24h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (all genes): Oxa(24h) vs PBS(24h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (up reg genes): Oxa(24h) vs PBS(24h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (down reg genes): Oxa(24h) vs PBS(24h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_down_genes.csv")

get_kegg(filename = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/gene_list_Cis_vs_PBS_24h.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (all genes): Cis(24h) vs PBS(24h).png", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (up reg genes): Cis(24h) vs PBS(24h).png", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/kegg enrichment (down reg genes): Cis(24h) vs PBS(24h).png", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_all_genes.csv", filename_6 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_up_genes.csv", filename_7 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_down_genes.csv")
```



```{r}
# Overlapping enriched kegg term on 24h between Oxa and Cis (all genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_all_genes.csv")

# Overlapping enriched kegg term on 24h between MTX and Cis (all genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_all_genes.csv")

# Overlapping enriched kegg term on 24h between MTX and Oxa (all genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_all_genes.csv")

# Overlapping enriched kegg term on 24h between MTX, Oxa and Cis (all genes)
overlap_intersect_kegg_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_all_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_all_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_all_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_all_genes.png")

```


```{r}
# Overlapping enriched kegg term on 24h between Oxa and Cis (up genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_up_genes.csv")

# Overlapping enriched kegg term on 24h between MTX and Cis (up genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_up_genes.csv")

# Overlapping enriched kegg term on 24h between MTX and Oxa (up genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_up_genes.csv")

# Overlapping enriched kegg term on 24h between MTX, Oxa and Cis (up genes)
overlap_intersect_kegg_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_up_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_up_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_up_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_up_genes.png")
```


```{r}
# Overlapping enriched kegg term on 24h between Oxa and Cis (down genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_down_genes.csv")

# Overlapping enriched kegg term on 24h between MTX and Cis (down genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_down_genes.csv")

# Overlapping enriched kegg term on 24h between MTX and Oxa (down genes)
overlap_intersect_kegg_by_2(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_down_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_down_genes.csv")


# Overlapping enriched kegg term on 24h between MTX, Oxa and Cis (down genes)
overlap_intersect_kegg_by_3(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_down_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_down_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(24h)_vs_PBS(24h)_vs_Oxa(24h)_vs_PBS(24h)_vs_Cis(24h)_vs_PBS(24h)_down_genes.png")
```


```{r}
# Overlapping enriched kegg pathway between up, down and all the genes for MTX
overlap_intersect_kegg_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_MTX(24h) vs PBS(24h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(24h)_vs_PBS(24h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_MTX(24h)_vs_PBS(24h)_all_up_down_genes.png")



# Overlapping enriched kegg pathway between up, down and all the genes for OXA
overlap_intersect_kegg_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Oxa(24h) vs PBS(24h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_OXA(24h)_vs_PBS(24h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_OXA(24h)_vs_PBS(24h)_all_up_down_genes.png")


# Overlapping enriched kegg pathway between up, down and all the genes for CIS
overlap_intersect_kegg_by_3_by_treatment(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_up_genes.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_down_genes.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_kegg_terms_Cis(24h) vs PBS(24h)_all_genes.csv", filename_4 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_CIS(24h)_vs_PBS(24h)_all_up_down_genes.csv", filename_5 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/overlapping_kegg_terms_CIS(24h)_vs_PBS(24h)_all_up_down_genes.png")
```


# **4. Longitudinal analysis**



```{r}
# cpm normalisation of the raw counts
counts_normalized <- cpm(counts_mod_2 %>% dplyr::select(-c("gene_id", "gene_type", "gene_name")))
counts_normalized <- counts_normalized %>% bind_cols(counts_mod_2$gene_name) %>% dplyr::rename("gene_name" = "...61") %>% as.data.frame()
rownames(counts_normalized) <- make.names(counts_normalized$gene_name, unique=TRUE)

# Filter genes with at least read counts
counts_normalized <- counts_normalized %>% dplyr::select(-"gene_name")
counts_normalized <- counts_normalized[rowSums(counts_normalized) > 10,]

# Get normalized table of counts for trendy for MTX, OXA, CIS
counts_normalized_sorted <- counts_normalized[, c(1:12, 25:36, 49:60, 13:24, 37:48)]

```


```{r}
run_trendy <- function(filename_1, filename_2, filename_3){
  cpm <- read.csv(filename_1) %>% column_to_rownames("X")
  time.vector <- read.csv(filename_2)
  trendy_output <- trendy(Data = cpm, tVectIn= time.vector, minNumInSeg = 3, NCores = 1, maxK = 4)
  res_trendy_output <- results(trendy_output)
  res_trendy_output_top <- topTrendy(res_trendy_output)
  res_trendy_output_top_heatmap <- trendHeatmap(res_trendy_output_top)
  par(mfrow = c(2,2))
  png(filename_3)
  plotFeature(Data = cpm, tVectIn = time.vector, simple = FALSE, featureNames = c("Mef2a", "Nf2", "Il6", "Esr1"), trendyOutData = res_trendy_output, showFit = TRUE)
  dev.off()
}
```


### MTX

```{r}
# Get normalized counts for MTX
counts_normalized_sorted_MTX <- counts_normalized_sorted %>% dplyr::select(contains("MTX")) %>% write.csv("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/
cpm_MTX.csv") 

# Create Time Vector for MTX
time.vector_MTX <- c(rep(3,3), rep(6,3), rep(12,3), rep(18,3), rep(24,3))
names(time.vector_MTX) <- colnames(counts_normalized_sorted_MTX)
write.csv(time.vector_MTX, "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/time.vector_MTX.csv")

# Run trendy for MTX
run_trendy(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/
cpm_MTX.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/time.vector_MTX.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/trendy_trajectories_genes_MTX.png")

```


### OXA

```{r}
# Get normalized counts for OXA
counts_normalized_sorted_OXA <- counts_normalized_sorted %>% select(contains("OXA")) %>% write.csv("cpm_OXA.csv") 

# Create Time Vector for OXA
time.vector_OXA <- c(rep(3,3), rep(6,3), rep(12,3), rep(18,3), rep(24,3))
names(time.vector_OXA) <- colnames(counts_normalized_sorted_OXA)
write.csv(time.vector_OXA, "time.vector_OXA.csv")

# Run trendy for OXA
run_trendy(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/cpm_OXA.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/time.vector_OXA.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/trendy_trajectories_genes_OXA.png")

```

### CIS


```{r}
# Get normalized counts for CIS
counts_normalized_sorted_CIS <- counts_normalized_sorted %>% select(contains("CIS")) %>% write.csv("cpm_CIS.csv") 

# Create Time Vector for CIS
time.vector_CIS <- c(rep(3,3), rep(6,3), rep(12,3), rep(18,3), rep(24,3))
names(time.vector_CIS) <- colnames(counts_normalized_sorted_CIS)
write.csv(time.vector_CIS, "time.vector_CIS.csv")

# Run trendy for CIS
run_trendy(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/cpm_CIS.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/time.vector_CIS.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/trendy_trajectories_genes_CIS.png")

```

```{r}
# Get normalized counts for Control
counts_normalized_sorted_control <- counts_normalized_sorted %>% select(contains("Control"))
write.csv("cpm_Control.csv") 

# Create Time Vector for Control
time.vector_Control <- c(rep(3,3), rep(6,3), rep(12,3), rep(18,3), rep(24,3))
names(time.vector_Control) <- colnames(counts_normalized_sorted_control)
write.csv(time.vector_Control, "time.vector_Control.csv")

# Run trendy for Control
run_trendy(filename_1 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/cpm_Control.csv", filename_2 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/time.vector_Control.csv", filename_3 = "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/trendy_trajectories_genes_Control.png")
```







```{r}
genes_MTX_3h <- topTable(fit_contrast_3h, sort.by= "P", adjust.method = "BH", number = Inf, coef = "MP_3h") %>% rename("gene_name" = "genes") %>% mutate(contrast = "MTX_3h")
rownames(genes_MTX_3h) <- NULL
genes_MTX_3h <- genes_MTX_3h %>% left_join(annot_gene_mod_2, by="gene_name") %>% dplyr::relocate(gene_id, .after = gene_name) %>% dplyr::relocate(contrast, .after = gene_type)

genes_MTX_6h <- topTable(fit_contrast_6h, sort.by= "P", adjust.method = "BH", number = Inf, coef = "MP_6h") %>% rename("gene_name" = "genes") %>% mutate(contrast = "MTX_6h")
rownames(genes_MTX_6h) <- NULL
genes_MTX_6h <- genes_MTX_6h %>% left_join(annot_gene_mod_2, by="gene_name", relationship = "many-to-many") %>% dplyr::relocate(gene_id, .after = gene_name) %>% dplyr::relocate(contrast, .after = gene_type)


genes_MTX_12h <- topTable(fit_contrast_12h, sort.by= "P", adjust.method = "BH", number = Inf, coef = "MP_12h") %>% rename("gene_name" = "genes") %>% mutate(contrast = "MTX_12h")
rownames(genes_MTX_12h) <- NULL
genes_MTX_12h <- genes_MTX_12h %>% left_join(annot_gene_mod_2, by="gene_name", relationship = "many-to-many") %>% dplyr::relocate(gene_id, .after = gene_name) %>% dplyr::relocate(contrast, .after = gene_type)


genes_MTX_18h <- topTable(fit_contrast_18h, sort.by= "P", adjust.method = "BH", number = Inf, coef = "MP_18h") %>% rename("gene_name" = "genes") %>% mutate(contrast = "MTX_18h")
rownames(genes_MTX_18h) <- NULL
genes_MTX_18h <- genes_MTX_18h %>% left_join(annot_gene_mod_2, by="gene_name", relationship = "many-to-many") %>% dplyr::relocate(gene_id, .after = gene_name) %>% dplyr::relocate(contrast, .after = gene_type)


genes_MTX_24h <- topTable(fit_contrast_24h, sort.by= "P", adjust.method = "BH", number = Inf, coef = "MP_24h") %>% rename("gene_name" = "genes") %>% mutate(contrast = "MTX_24h")
rownames(genes_MTX_24h) <- NULL
genes_MTX_24h <- genes_MTX_24h %>% left_join(annot_gene_mod_2, by="gene_name", relationship = "many-to-many") %>% dplyr::relocate(gene_id, .after = gene_name) %>% dplyr::relocate(contrast, .after = gene_type)


genes_MTX <- bind_rows(genes_MTX_3h, genes_MTX_6h, genes_MTX_12h, genes_MTX_18h, genes_MTX_24h)

```


```{r}
genes_OXA_3h <- topTable(fit_contrast_3h, sort.by= "P", adjust.method = "BH", number = Inf, coef = "OP_3h") %>% rename("gene_name" = "genes") %>% mutate(contrast = "OXA_3h")
rownames(genes_OXA_3h) <- NULL
genes_OXA_3h <- genes_OXA_3h %>% left_join(annot_gene_mod_2, by="gene_name", relationship = "many-to-many") %>% dplyr::relocate(gene_id, .after = gene_name) %>% dplyr::relocate(contrast, .after = gene_type)

genes_OXA_6h <- topTable(fit_contrast_6h, sort.by= "P", adjust.method = "BH", number = Inf, coef = "OP_6h") %>% rename("gene_name" = "genes") %>% mutate(contrast = "OXA_6h")
rownames(genes_OXA_6h) <- NULL
genes_OXA_6h <- genes_OXA_6h %>% left_join(annot_gene_mod_2, by="gene_name", relationship = "many-to-many") %>% dplyr::relocate(gene_id, .after = gene_name) %>% dplyr::relocate(contrast, .after = gene_type)


genes_OXA_12h <- topTable(fit_contrast_12h, sort.by= "P", adjust.method = "BH", number = Inf, coef = "OP_12h") %>% rename("gene_name" = "genes") %>% mutate(contrast = "OXA_12h")
rownames(genes_OXA_12h) <- NULL
genes_OXA_12h <- genes_OXA_12h %>% left_join(annot_gene_mod_2, by="gene_name", relationship = "many-to-many") %>% dplyr::relocate(gene_id, .after = gene_name) %>% dplyr::relocate(contrast, .after = gene_type)


genes_OXA_18h <- topTable(fit_contrast_18h, sort.by= "P", adjust.method = "BH", number = Inf, coef = "OP_18h") %>% rename("gene_name" = "genes") %>% mutate(contrast = "OXA_18h")
rownames(genes_OXA_18h) <- NULL
genes_OXA_18h <- genes_OXA_18h %>% left_join(annot_gene_mod_2, by="gene_name", relationship = "many-to-many") %>% dplyr::relocate(gene_id, .after = gene_name) %>% dplyr::relocate(contrast, .after = gene_type)


genes_OXA_24h <- topTable(fit_contrast_24h, sort.by= "P", adjust.method = "BH", number = Inf, coef = "OP_24h") %>% rename("gene_name" = "genes") %>% mutate(contrast = "OXA_24h")
rownames(genes_OXA_24h) <- NULL
genes_OXA_24h <- genes_OXA_24h %>% left_join(annot_gene_mod_2, by="gene_name", relationship = "many-to-many") %>% dplyr::relocate(gene_id, .after = gene_name) %>% dplyr::relocate(contrast, .after = gene_type)


genes_OXA <- bind_rows(genes_OXA_3h, genes_OXA_6h, genes_OXA_12h, genes_OXA_18h, genes_OXA_24h)
```

```{r}
genes_CIS_3h <- topTable(fit_contrast_3h, sort.by= "P", adjust.method = "BH", number = Inf, coef = "CP_3h") %>% rename("gene_name" = "genes") %>% mutate(contrast = "CIS_3h")
rownames(genes_CIS_3h) <- NULL
genes_CIS_3h <- genes_CIS_3h %>% left_join(annot_gene_mod_2, by="gene_name", relationship = "many-to-many") %>% dplyr::relocate(gene_id, .after = gene_name) %>% dplyr::relocate(contrast, .after = gene_type)

genes_CIS_6h <- topTable(fit_contrast_6h, sort.by= "P", adjust.method = "BH", number = Inf, coef = "CP_6h") %>% rename("gene_name" = "genes") %>% mutate(contrast = "CIS_6h")
rownames(genes_CIS_6h) <- NULL
genes_CIS_6h <- genes_CIS_6h %>% left_join(annot_gene_mod_2, by="gene_name", relationship = "many-to-many") %>% dplyr::relocate(gene_id, .after = gene_name) %>% dplyr::relocate(contrast, .after = gene_type)


genes_CIS_12h <- topTable(fit_contrast_12h, sort.by= "P", adjust.method = "BH", number = Inf, coef = "CP_12h") %>% rename("gene_name" = "genes") %>% mutate(contrast = "CIS_12h")
rownames(genes_CIS_12h) <- NULL
genes_CIS_12h <- genes_CIS_12h %>% left_join(annot_gene_mod_2, by="gene_name", relationship = "many-to-many") %>% dplyr::relocate(gene_id, .after = gene_name) %>% dplyr::relocate(contrast, .after = gene_type)


genes_CIS_18h <- topTable(fit_contrast_18h, sort.by= "P", adjust.method = "BH", number = Inf, coef = "CP_18h") %>% rename("gene_name" = "genes") %>% mutate(contrast = "CIS_18h")
rownames(genes_CIS_18h) <- NULL
genes_CIS_18h <- genes_CIS_18h %>% left_join(annot_gene_mod_2, by="gene_name", relationship = "many-to-many") %>% dplyr::relocate(gene_id, .after = gene_name) %>% dplyr::relocate(contrast, .after = gene_type)


genes_CIS_24h <- topTable(fit_contrast_24h, sort.by= "P", adjust.method = "BH", number = Inf, coef = "CP_24h") %>% rename("gene_name" = "genes") %>% mutate(contrast = "CIS_24h")
rownames(genes_CIS_24h) <- NULL
genes_CIS_24h <- genes_CIS_24h %>% left_join(annot_gene_mod_2, by="gene_name", relationship = "many-to-many") %>% dplyr::relocate(gene_id, .after = gene_name) %>% dplyr::relocate(contrast, .after = gene_type)


genes_CIS <- bind_rows(genes_CIS_3h, genes_CIS_6h, genes_CIS_12h, genes_CIS_18h, genes_CIS_24h)
```

```{r}
genes_total <- bind_rows(genes_MTX, genes_OXA, genes_CIS)
genes_total
```


# **6. ROMA **{.tabset .tabset-fade .tabset-pills}


```{r import counts_gmt}
dge_filtered_roma <- cbind(dge_filtered$counts, dge_filtered$genes)
dge_filtered_roma <- dge_filtered_roma %>% relocate(genes, .before= "1_MTX1_3h")
rownames(dge_filtered_roma) <- make.names(dge_filtered_roma$genes, unique=TRUE)
dge_filtered_roma <- dge_filtered_roma %>% dplyr::select(-genes)
dge_filtered_roma_new <- cpm(dge_filtered_roma, log=TRUE)
dge_filtered_roma_df <- dge_filtered_roma_new %>% as.data.frame()
go_bp_genesymbols <- ReadGMTFile("/data/kdi_prod/.kdi/project_workspace_0/1929/acl/01.00/go_bp_genesymbol.gmt")
```


```{r get_load_roma_results}
get_load_roma_results <- function(time, no_drug1, no_drug2, filen){
  # MTX
  dge_filtered_roma_df <- dge_filtered_roma_df %>% dplyr::select(contains(time) & !contains(no_drug1) & !contains(no_drug2))
  dge_filtered_roma_df <- dge_filtered_roma_df[, c(4,5,6,1,2,3)]
  roma_output <- readRDS(filen)
}
```

```{r get_shited_modules}
get_shifted_modules <- function(filen3, filen4, filen5, filen6, filen7){
  
  # Load roma output
  roma_output <- readRDS(filen3)
  rownames(roma_output$ModuleMatrix) <- gsub("GOBP_", "", rownames(roma_output$ModuleMatrix))
  rownames(roma_output$SampleMatrix) <- gsub("GOBP_", "", rownames(roma_output$SampleMatrix))
  
  # Get shifted modules
  shifted_modules_all <- roma_output$ModuleMatrix %>% as.data.frame() %>% dplyr::filter(`ppv Median Exp`<= 0.05) %>% rownames_to_column("shifted_modules") %>% dplyr::arrange(`ppv Median Exp`, desc(abs(`Median Exp`)))
  write(shifted_modules_all, filen4)
  
  # Get shifted modules (index for plot)
  shifted.modules <- which(roma_output$ModuleMatrix[,"ppv Median Exp"] <= 0.05)
  
  # Get top 20 shifted modules + Save them
  shifted_modules_top_20 <- roma_output$ModuleMatrix %>% as.data.frame() %>% dplyr::filter(`ppv Median Exp`<= 0.05) %>% rownames_to_column("shifted_modules") %>% dplyr::arrange(`ppv Median Exp`, desc(abs(`Median Exp`))) %>% dplyr::slice(1:20)
  write.csv(shifted_modules_top_20, filen5)
  
  # Plot activity scores of top 20 shifted modules
  png(filen6, width=1000, height=502)
  Plot.Genesets.Samples(roma_output, Selected = shifted.modules[shifted_modules_top_20$shifted_modules], cluster_cols = TRUE)
  dev.off()
  
  # Get intersection between BP and shifted modules
  shifted_modules_lower <- tolower(shifted_modules$shifted_modules)
  enriched_go_terms <- read.csv(filen7)
  intersect_roma_go <- intersect(shifted_modules_lower, enriched_go_terms$Description)
  intersect_roma_go_df <- intersect_roma_go %>% as.data.frame()
  colnames(intersect_roma_go_df) <- "intersection_BP_shifted"
  write.csv(intersect_roma_go_df, filen8)
}
```


```{r get_overdispersed_modules}
get_overdispersed_modules <- function(filen3, filen4, filen5, filen6, filen7, filen8, filen9){
  
  # Load roma output
  roma_output <- readRDS(filen3)
  rownames(roma_output$ModuleMatrix) <- gsub("GOBP_", "", rownames(roma_output$ModuleMatrix))
  rownames(roma_output$SampleMatrix) <- gsub("GOBP_", "", rownames(roma_output$SampleMatrix))
  
  # Get overdispersed modules
  overdispersed_modules_all <- roma_output$ModuleMatrix %>% as.data.frame() %>% dplyr::filter(`ppv L1`<= 0.05 & `ppv Median Exp` > 0.05) %>% rownames_to_column("overdispersed_modules") %>% dplyr::arrange(`ppv L1`, desc(`L1`))
  write.csv(overdispersed_modules_all, filen4)
  
  # Get overdispersed modules (index for plot)
  overdispersed.modules <- which(roma_output$ModuleMatrix[,"ppv L1"] <= 0.05)

  # Get top 20 overdispersed modules + Save them
  overdispersed_modules_top_20 <- roma_output$ModuleMatrix %>% as.data.frame() %>% dplyr::filter(`ppv L1`<= 0.05) %>% rownames_to_column("overdispersed_modules") %>% dplyr::arrange(`ppv L1`, desc(`L1`)) %>% dplyr::slice(1:20)
  write.csv(overdispersed_modules_top_20, filen5)
  
  # Plot activity scores of top 20 overdispersed modules
  png(filen6, width=1000, height=502)
  Plot.Genesets.Samples(roma_output, Selected = overdispersed.modules[overdispersed_modules_top_20$overdispersed_modules], cluster_cols = TRUE)
  dev.off()

  # Get top contributing genes (top 30) to activity score of overdispersed pathways
  for (i in 1:20){
    add_graph_number <- paste0(unlist(strsplit(filen7, ".png")), "_", i, ".png")
    png(add_graph_number, width=1000, height=502)
    PlotGeneWeight(RomaData = roma_output, PlotGenes = 30, LogExpression = FALSE, 
                   Selected = overdispersed.modules[overdispersed_modules_top_20$overdispersed_modules[i]])
    dev.off()
    }
  
  
  # Get intersection between BP and overdispersed
  overdispersed_modules_lower <- tolower(overdispersed_modules_all$overdispersed_modules)
  enriched_go_terms <- read.csv(filen8)
  intersect_roma_go <- intersect(overdispersed_modules_lower, enriched_go_terms$Description)
  intersect_roma_go_df <- intersect_roma_go %>% as.data.frame()
  colnames(intersect_roma_go_df) <- "intersection_BP_overdispersed"
  write.csv(intersect_roma_go_df, filen9)

}
```



## **6.1. MTX** {.tabset .tabset-fade .tabset-pills}


### 3h

```{r get_roma_results_MTX}
get_load_roma_results("3h", "CIS", "OXA", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_MTX_3h.rds")
get_shifted_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_MTX_3h.rds","/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/MTX/all_shifted_MTX_3h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/MTX/top_20_shifted_MTX_3h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/MTX/activity_scores_top_20_shifted_MTX_3h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/MTX/intersect_BP_shifted_MTX_3h.csv")
get_overdispersed_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_MTX_3h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/MTX/all_overdispersed_MTX_3h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/MTX/top_20_overdispersed_MTX_3h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/MTX/activity_scores_top_20_overdispersed_MTX_3h.png",  "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/MTX/top_10_genes_weights_top_20_overdispersed_MTX_3h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(3h) vs PBS(3h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/MTX/intersect_BP_overdispersed_MTX_3h.csv")
```


### 6h

```{r get_roma_results_MTX}
get_load_roma_results("6h", "CIS", "OXA", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_MTX_6h.rds")
get_shifted_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_MTX_6h.rds",
                    "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/MTX/all_shifted_MTX_6h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/MTX/top_20_shifted_MTX_6h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/MTX/activity_scores_top_20_shifted_MTX_6h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/MTX/intersect_BP_shifted_MTX_6h.csv")
get_overdispersed_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_MTX_6h.rds",  "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/MTX/all_overdispersed_MTX_6h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/MTX/top_20_overdispersed_MTX_6h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/MTX/activity_scores_top_20_overdispersed_MTX_6h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/MTX/top_10_genes_weights_top_20_overdispersed_MTX_6h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(6h) vs PBS(6h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/MTX/intersect_BP_overdispersed_MTX_6h.csv")
```

### 12h

```{r get_roma_results_MTX}
get_load_roma_results("12h", "CIS", "OXA", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_MTX_12h.rds")
get_shifted_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_MTX_12h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/MTX/all_shifted_MTX_12h.csv","/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/MTX/top_20_shifted_MTX_12h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/MTX/activity_scores_top_20_shifted_MTX_12h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/MTX/intersect_BP_shifted_MTX_12h.csv")
get_overdispersed_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_MTX_12h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/MTX/all_overdispersed_MTX_12h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/MTX/top_20_overdispersed_MTX_12h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/MTX/activity_scores_top_20_overdispersed_MTX_12h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/MTX/top_10_genes_weights_top_20_overdispersed_MTX_12h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(12h) vs PBS(12h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/MTX/intersect_BP_overdispersed_MTX_12h.csv")
```

### 18h

```{r get_roma_results_MTX}
get_load_roma_results("18h", "CIS", "OXA", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_MTX_18h.rds")
get_shifted_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_MTX_18h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/MTX/all_shifted_MTX_18h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/MTX/top_20_shifted_MTX_18h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/MTX/activity_scores_top_20_shifted_MTX_18h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/MTX/intersect_BP_shifted_MTX_18h.csv")
get_overdispersed_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_MTX_18h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/MTX/all_overdispersed_MTX_18h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/MTX/top_20_overdispersed_MTX_18h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/MTX/activity_scores_top_20_overdispersed_MTX_18h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/MTX/top_10_genes_weights_top_20_overdispersed_MTX_18h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(18h) vs PBS(18h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/MTX/intersect_BP_overdispersed_MTX_18h.csv")
```

### 24h

```{r get_roma_results_MTX}
get_load_roma_results("24h", "CIS", "OXA", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_MTX_24h.rds")
get_shifted_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_MTX_24h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/MTX/all_shifted_MTX_24h.csv",
                    "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/MTX/top_20_shifted_MTX_24h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/MTX/activity_scores_top_20_shifted_MTX_24h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/MTX/intersect_BP_shifted_MTX_24h.csv")
get_overdispersed_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_MTX_24h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/MTX/all_overdispersed_MTX_24h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/MTX/top_20_overdispersed_MTX_24h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/MTX/activity_scores_top_20_overdispersed_MTX_24h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/MTX/MTX/top_10_genes_weights_top_20_overdispersed_MTX_24h.png" ,"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_MTX(24h) vs PBS(24h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/MTX/intersect_BP_overdispersed_MTX_24h.csv")
```


## **6.2. OXA** {.tabset .tabset-fade .tabset-pills}


### 3h

```{r get_roma_results_OXA}
get_load_roma_results("3h", "CIS", "MTX", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_OXA_3h.rds")
get_shifted_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_OXA_3h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/MTX/all_shifted_MTX_6h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/OXA/top_20_shifted_OXA_3h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/OXA/activity_scores_top_20_shifted_OXA_3h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/OXA/intersect_BP_shifted_OXA_3h.csv")
get_overdispersed_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_OXA_3h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/OXA/top_20_overdispersed_OXA_3h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/OXA/activity_scores_top_20_overdispersed_OXA_3h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/OXA/top_10_genes_weights_top_20_overdispersed_OXA_3h.png" ,"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(3h) vs PBS(3h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/OXA/intersect_BP_overdispersed_OXA_3h.csv")
```


### 6h

```{r get_roma_results_OXA}
get_load_roma_results("6h", "CIS", "MTX", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_OXA_6h.rds")
get_shifted_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_OXA_6h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/OXA/top_20_shifted_OXA_6h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/OXA/activity_scores_top_20_shifted_OXA_6h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/OXA/intersect_BP_shifted_OXA_6h.csv")
get_overdispersed_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_OXA_6h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/OXA/top_20_overdispersed_OXA_6h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/OXA/activity_scores_top_20_overdispersed_OXA_6h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/OXA/top_10_genes_weights_top_20_overdispersed_OXA_6h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(6h) vs PBS(6h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/OXA/intersect_BP_overdispersed_OXA_6h.csv")
```

### 12h

```{r get_roma_results_OXA}
get_load_roma_results("12h", "CIS", "MTX", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_OXA_12h.rds")
get_shifted_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_OXA_12h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/OXA/top_20_shifted_OXA_12h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/OXA/activity_scores_top_20_shifted_OXA_12h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/OXA/intersect_BP_shifted_OXA_12h.csv")
get_overdispersed_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_OXA_12h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/OXA/top_20_overdispersed_OXA_12h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/OXA/activity_scores_top_20_overdispersed_OXA_12h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/OXA/top_10_genes_weights_top_20_overdispersed_OXA_12h.png","/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(12h) vs PBS(12h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/OXA/intersect_BP_overdispersed_OXA_12h.csv")
```

### 18h

```{r get_roma_results_OXA}
get_load_roma_results("18h", "CIS", "MTX", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_OXA_18h.rds")
get_shifted_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_OXA_18h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/OXA/top_20_shifted_OXA_18h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/OXA/activity_scores_top_20_shifted_OXA_18h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/OXA/intersect_BP_shifted_OXA_18h.csv")
get_overdispersed_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_OXA_18h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/OXA/top_20_overdispersed_OXA_18h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/OXA/activity_scores_top_20_overdispersed_OXA_18h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/OXA/top_10_genes_weights_top_20_overdispersed_OXA_18h.png" ,"/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(18h) vs PBS(18h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/OXA/intersect_BP_overdispersed_OXA_18h.csv")
```

### 24h

```{r get_roma_results_OXA}
get_load_roma_results("24h", "CIS", "MTX", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_OXA_24h.rds")
get_shifted_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_OXA_24h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/OXA/top_20_shifted_OXA_24h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/OXA/activity_scores_top_20_shifted_OXA_24h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/OXA/intersect_BP_shifted_OXA_24h.csv")
get_overdispersed_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_OXA_24h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/OXA/top_20_overdispersed_OXA_24h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/OXA/activity_scores_top_20_overdispersed_OXA_24h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/OXA/top_10_genes_weights_top_20_overdispersed_OXA_24h.png","/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Oxa(24h) vs PBS(24h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/OXA/intersect_BP_overdispersed_OXA_24h.csv")
```




## **6.3. CIS** {.tabset .tabset-fade .tabset-pills}

### 3h

```{r get_roma_results_CIS}
get_load_roma_results("3h", "OXA", "MTX", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_CIS_3h.rds")
get_shifted_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_CIS_3h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/CIS/top_20_shifted_CIS_3h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/CIS/activity_scores_top_20_shifted_CIS_3h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_CIS(3h) vs PBS(3h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/CIS/intersect_BP_shifted_CIS_3h.csv")
get_overdispersed_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_CIS_3h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/CIS/top_20_overdispersed_CIS_3h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/CIS/activity_scores_top_20_overdispersed_CIS_3h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/CIS/top_10_genes_weights_top_20_overdispersed_CIS_3h.png","/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(3h) vs PBS(3h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/3h/CIS/intersect_BP_overdispersed_CIS_3h.csv")
```


### 6h

```{r get_roma_results_CIS}
get_load_roma_results("6h", "OXA", "MTX", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_CIS_6h.rds")
get_shifted_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_CIS_6h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/CIS/top_20_shifted_CIS_6h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/CIS/activity_scores_top_20_shifted_CIS_6h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_CIS(6h) vs PBS(6h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/CIS/intersect_BP_shifted_CIS_6h.csv")
get_overdispersed_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_CIS_6h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/CIS/top_20_overdispersed_CIS_6h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/CIS/activity_scores_top_20_overdispersed_CIS_6h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/CIS/top_10_genes_weights_top_20_overdispersed_CIS_6h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(6h) vs PBS(6h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/6h/CIS/intersect_BP_overdispersed_CIS_6h.csv")
```

### 12h

```{r get_roma_results_CIS}
get_load_roma_results("12h", "OXA", "MTX", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_CIS_12h.rds")
get_shifted_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_CIS_12h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/CIS/top_20_shifted_CIS_12h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/CIS/activity_scores_top_20_shifted_CIS_12h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_CIS(12h) vs PBS(12h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/CIS/intersect_BP_shifted_CIS_12h.csv")
get_overdispersed_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_CIS_12h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/CIS/top_20_overdispersed_CIS_12h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/CIS/activity_scores_top_20_overdispersed_CIS_12h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/CIS/top_10_genes_weights_top_20_overdispersed_CIS_12h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(12h) vs PBS(12h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/12h/CIS/intersect_BP_overdispersed_CIS_12h.csv")
```


### 18h

```{r get_roma_results_CIS}
get_load_roma_results("18h", "OXA", "MTX", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_CIS_18h.rds")
get_shifted_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_CIS_18h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/CIS/top_20_shifted_CIS_18h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/CIS/activity_scores_top_20_shifted_CIS_18h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_CIS(18h) vs PBS(18h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/CIS/intersect_BP_shifted_CIS_18h.csv")
get_overdispersed_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_CIS_18h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/CIS/top_20_overdispersed_CIS_18h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/CIS/activity_scores_top_20_overdispersed_CIS_18h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/CIS/top_10_genes_weights_top_20_overdispersed_CIS_18h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(18h) vs PBS(18h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/18h/CIS/intersect_BP_overdispersed_CIS_18h.csv")
```



### 24h

```{r get_roma_results_CIS}
get_load_roma_results("24h", "OXA", "MTX", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_CIS_24h.rds")
get_shifted_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_CIS_24h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/CIS/top_20_shifted_CIS_24h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/CIS/activity_scores_top_20_shifted_CIS_24h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_CIS(24h) vs PBS(24h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/CIS/intersect_BP_shifted_CIS_24h.csv")
get_overdispersed_modules("/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_output_CIS_24h.rds", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/CIS/top_20_overdispersed_CIS_24h.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/CIS/activity_scores_top_20_overdispersed_CIS_24h.png", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/CIS/top_10_genes_weights_top_20_overdispersed_CIS_24h.png","/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/enriched_go_terms_Cis(24h) vs PBS(24h)_all_genes.csv", "/data/users/tlassale/MODICED_link/Bulk_RNA_in_vitro/in_vitro_results/roma_results/24h/CIS/intersect_BP_overdispersed_CIS_24h.csv")
```



# **7. Longitudinal expression of genes**


```{r get_counts}
counts_in_vitro_df <- counts_mod_2 %>% as.data.frame() 
rownames(counts_in_vitro_df) <- make.names(counts_in_vitro_df$gene_name, unique=TRUE)
counts_in_vitro_time <- counts_in_vitro_df %>% dplyr::select(-c("gene_id", "gene_type", "gene_name"))
counts_in_vitro_to_keep <- counts_in_vitro_time[rowSums(counts_in_vitro_time) > 10,]
```


```{r get_mean_counts}
get_mean_counts_in_vitro <- function(control, treatment){
  
  # Get cpm counts at treatment/timepoint of interest
  counts_normalized_in_vitro <- counts_in_vitro_to_keep %>% cpm() %>% as.data.frame() %>% dplyr::select(!contains(control))
  
  # Get counts+mean_counts at 3h for treatment of interest
  counts_normalized_in_vitro_3h <- counts_normalized_in_vitro %>% dplyr::select(contains(treatment) | contains("3h"))
  mean_counts_in_vitro_3h <- rowMeans(counts_normalized_in_vitro_3h) %>% as.data.frame() %>% dplyr::rename("3" = ".")

  # Get counts+mean_counts at 6h for treatment of interest
  counts_normalized_in_vitro_6h <- counts_normalized_in_vitro %>% dplyr::select(contains(treatment) | contains("6h"))
  mean_counts_in_vitro_6h <- rowMeans(counts_normalized_in_vitro_6h) %>% as.data.frame() %>% dplyr::rename("6" = ".")

  # Get counts+mean_counts at 12h for treatment of interest
   counts_normalized_in_vitro_12h <- counts_normalized_in_vitro %>% dplyr::select(contains(treatment) | contains("12h"))
  mean_counts_in_vitro_12h <- rowMeans(counts_normalized_in_vitro_12h) %>% as.data.frame() %>% dplyr::rename("12" = ".")

  # Get counts+mean_counts at 18h for treatment of interest
  counts_normalized_in_vitro_18h <- counts_normalized_in_vitro %>% dplyr::select(contains(treatment) | contains("18h"))
  mean_counts_in_vitro_18h <- rowMeans(counts_normalized_in_vitro_18h) %>% as.data.frame() %>% dplyr::rename("18" = ".")
  
  # Get counts+mean_counts at 24h for treatment of interest
   counts_normalized_in_vitro_24h <- counts_normalized_in_vitro %>% dplyr::select(contains(treatment) | contains("24h"))
  mean_counts_in_vitro_24h <- rowMeans(counts_normalized_in_vitro_24h) %>% as.data.frame() %>% dplyr::rename("24" = ".")
  
  
  # Get mean counts for treatment of interest at all timepoints
  mean_counts_in_vitro_df <- bind_cols(mean_counts_in_vitro_3h, mean_counts_in_vitro_6h, mean_counts_in_vitro_12h, mean_counts_in_vitro_18h, mean_counts_in_vitro_24h)
  
}
```


```{r}
# MTX
mean_counts_in_vitro_MTX <- get_mean_counts_in_vitro("Control", "MTX")
# OXA
mean_counts_in_vitro_OXA <- get_mean_counts_in_vitro("Control", "OXA")
# CIS
mean_counts_in_vitro_CIS <- get_mean_counts_in_vitro("Control", "CIS")
```


```{r}
get_mean_expression_in_vitro <- function(gene, filen, treatment1, treatment2, treatment3){

  # Get and plot mean expression of gene of interest over MTX
  expression_gene_in_vitro_MTX <- mean_counts_in_vitro_MTX[gene,]

  expression_gene_in_vitro_MTX_t <- expression_gene_in_vitro_MTX %>% t() %>% as_tibble() %>% rownames_to_column("Time") %>% as.data.frame() %>% dplyr::rename(mean_expression_gene_in_vitro_MTX = gene)
  expression_gene_in_vitro_MTX_t$Time <- c(3, 6, 12, 18, 24)
  expression_gene_in_vitro_MTX_t_plot <- ggplot(expression_gene_in_vitro_MTX_t, mapping=aes(x=Time, y=mean_expression_gene_in_vitro_MTX)) + geom_line() + labs(x  = "Time", y = paste0("mean_expression_", gene, "_","MTX"), title = paste0(gene, "_", "longitudinal_expression", "_", treatment1)) + theme(plot.title = element_text(face="bold", hjust = 0.5))
  
  
  # Get and plot mean expression of gene of interest over OXA
  expression_gene_in_vitro_Oxa <- mean_counts_in_vitro_OXA[gene,]
  expression_gene_in_vitro_Oxa_t <- expression_gene_in_vitro_Oxa %>% t() %>% as_tibble() %>% rownames_to_column("Time") %>% as.data.frame() %>% dplyr::rename(mean_expression_gene_in_vitro_OXA = gene)
  expression_gene_in_vitro_Oxa_t$Time <- c(3, 6, 12, 18, 24)
  expression_gene_in_vitro_Oxa_t_plot <- ggplot(expression_gene_in_vitro_Oxa_t, mapping=aes(x=Time, y=mean_expression_gene_in_vitro_OXA)) + geom_line() + labs(x  = "Time", y = paste0("mean_expression_", gene, "_","OXA"), title = paste0(gene, "_", "longitudinal_expression", "_", treatment2)) + theme(plot.title = element_text(face="bold", hjust = 0.5))

  
  # Get and plot mean expression of gene of interest over CIS
  expression_gene_in_vitro_Cis <- mean_counts_in_vitro_CIS[gene,]
  expression_gene_in_vitro_Cis_t <- expression_gene_in_vitro_Cis %>% t() %>% as_tibble() %>% rownames_to_column("Time") %>% as.data.frame() %>% dplyr::rename(mean_expression_gene_in_vitro_CIS = gene)
  expression_gene_in_vitro_Cis_t$Time <- c(3, 6, 12, 18, 24)
  expression_gene_in_vitro_Cis_t_plot <- ggplot(expression_gene_in_vitro_Cis_t, mapping=aes(x=Time, y=mean_expression_gene_in_vitro_CIS)) + geom_line() + labs(x  = "Time", y = paste0("mean_expression_", gene, "_","CIS"), title = paste0(gene, "_", "longitudinal_expression", "_", treatment3)) + theme(plot.title = element_text(face="bold", hjust = 0.5))
  
  # Save mean expression plots as a grid
  pdf(filen) 
  grid.arrange(expression_gene_in_vitro_MTX_t_plot, expression_gene_in_vitro_Oxa_t_plot, expression_gene_in_vitro_Cis_t_plot, ncol = 2, nrow = 2)
  dev.off()
  
  }
```



```{r get_mean_counts}
get_mean_counts_in_vitro_treated_control <- function(counts){

  # Get cpm counts at treatment/timepoint of interest  
  counts_normalized <- counts %>% cpm() %>% as.data.frame()
  
  counts_normalized %>% 
    rownames_to_column("gene_symbols") %>% 
    pivot_longer(cols = -gene_symbols, names_to = "samples", values_to = "cpm") %>% 
    tidyr::separate(col = samples, into = c("id", "treatment", "timepoint"), remove = FALSE, sep = "_") %>% 
    mutate(treatment = str_sub(treatment, start = 1, end = -2)) %>% 
    group_by(gene_symbols, treatment, timepoint) %>% 
    summarise(mean_cpm = mean(cpm)) %>% 
    ungroup()
}
```

```{r}
# Get mean counts (good one)
mean_counts_in_vitro_tc <- get_mean_counts_in_vitro_treated_control(counts_in_vitro_to_keep)

# Get mean expression over treatment (+ control) of interest
get_mean_expression_genes_treated_in_vitro <- function(tc_interest, time, gene, titlegraph){
  mean_counts_in_vitro <- mean_counts_in_vitro_tc %>% filter(grepl(tc_interest, treatment) & grepl(time, timepoint)) 
  ggplot(mean_counts_in_vitro %>% filter(gene_symbols == gene), mapping = aes(x = treatment, y = mean_cpm, group = 2)) + geom_point() + geom_line() + labs(title = paste0(gene,"_mean_expression_", time,"_", titlegraph)) + theme(plot.title = element_text(hjust = 0.5, face="bold"))
}

# Cd44: (MTX(3h) vs Control(3h))
get_mean_expression_genes_treated_in_vitro("OXA|Control" , "3h", "Slc7a5", "OXA_vs_Control")


```



